export const __webpack_id__ = "vendors-node_modules_arcgis_core_layers_support_ElevationQuery_js";
export const __webpack_ids__ = ["vendors-node_modules_arcgis_core_layers_support_ElevationQuery_js"];
export const __webpack_modules__ = {

/***/ "./node_modules/@arcgis/core/layers/support/ElevationQuery.js":
/*!********************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/support/ElevationQuery.js ***!
  \********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ElevationQuery: () => (/* binding */ T),
/* harmony export */   GeometryDescriptor: () => (/* binding */ v),
/* harmony export */   getFinestLodIndex: () => (/* binding */ E)
/* harmony export */ });
/* harmony import */ var _core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/asyncUtils.js */ "./node_modules/@arcgis/core/core/asyncUtils.js");
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/maybe.js */ "./node_modules/@arcgis/core/core/maybe.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _core_unitUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/unitUtils.js */ "./node_modules/@arcgis/core/core/unitUtils.js");
/* harmony import */ var _geometry_Multipoint_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../geometry/Multipoint.js */ "./node_modules/@arcgis/core/geometry/Multipoint.js");
/* harmony import */ var _geometry_Point_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../geometry/Point.js */ "./node_modules/@arcgis/core/geometry/Point.js");
/* harmony import */ var _geometry_Polyline_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../geometry/Polyline.js */ "./node_modules/@arcgis/core/geometry/Polyline.js");
/* harmony import */ var _geometry_projectionUtils_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../geometry/projectionUtils.js */ "./node_modules/@arcgis/core/geometry/projectionUtils.js");
/* harmony import */ var _geometry_support_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../geometry/support/aaBoundingRect.js */ "./node_modules/@arcgis/core/geometry/support/aaBoundingRect.js");
/* harmony import */ var _ElevationSampler_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./ElevationSampler.js */ "./node_modules/@arcgis/core/layers/support/ElevationSampler.js");
/* harmony import */ var _ElevationTile_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./ElevationTile.js */ "./node_modules/@arcgis/core/layers/support/ElevationTile.js");
/* harmony import */ var _TileKey_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./TileKey.js */ "./node_modules/@arcgis/core/layers/support/TileKey.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class T{async queryAll(e,i,n){if(!(e=n?.ignoreInvisibleLayers?e.filter((e=>e.visible)):e.slice()).length)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("elevation-query:invalid-layer","Elevation queries require at least one elevation layer to fetch tiles from");const o=v.fromGeometry(i);let l=!1;n?.returnSampleInfo||(l=!0);const s={...R,...n,returnSampleInfo:!0},a=await this.query(e[e.length-1],o,s),r=await this._queryAllContinue(e,a,s);return r.geometry=r.geometry.export(),l&&delete r.sampleInfo,r}async query(e,i,n){if(!e)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("elevation-query:invalid-layer","Elevation queries require an elevation layer to fetch tiles from");if(!i||!(i instanceof v)&&"point"!==i.type&&"multipoint"!==i.type&&"polyline"!==i.type)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("elevation-query:invalid-geometry","Only point, polyline and multipoint geometries can be used to query elevation");const o={...R,...n},l=new x(e,i.spatialReference,o),s=o.signal;return await e.load({signal:s}),await q(l,i,s),await this._selectTiles(l,s),await F(l,s),b(l),z(l,s)}async createSampler(e,i,n){if(!e)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("elevation-query:invalid-layer","Elevation queries require an elevation layer to fetch tiles from");if(!i||"extent"!==i.type)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("elevation-query:invalid-extent","Invalid or undefined extent");const o={...R,...n};return this._createSampler(e,i,o)}async createSamplerAll(e,i,n){if(!(e=n?.ignoreInvisibleLayers?e.filter((e=>e.visible)):e.slice()).length)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("elevation-query:invalid-layer","Elevation queries require at least one elevation layer to fetch tiles from");if(!i||"extent"!==i.type)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("elevation-query:invalid-extent","Invalid or undefined extent");const o={...R,...n,returnSampleInfo:!0},l=await this._createSampler(e[e.length-1],i,o);return this._createSamplerAllContinue(e,i,l,o)}async _createSampler(e,t,i,n){const o=i.signal;await e.load({signal:o});const l=t.spatialReference,s=e.tileInfo.spatialReference;l.equals(s)||(await (0,_geometry_projectionUtils_js__WEBPACK_IMPORTED_MODULE_8__.initializeProjection)([{source:l,dest:s}],{signal:o}),t=(0,_geometry_projectionUtils_js__WEBPACK_IMPORTED_MODULE_8__.project)(t,s));const a=new _(e,t,i,n);return await this._selectTiles(a,o),await F(a,o),new _ElevationSampler_js__WEBPACK_IMPORTED_MODULE_10__.MultiTileElevationSampler(a.elevationTiles,a.layer.tileInfo,a.options.noDataValue)}async _createSamplerAllContinue(e,t,i,n){if(e.pop(),!e.length)return i;const o=i.samplers.filter((e=>!e.tile.hasNoDataValues)).map((e=>(0,_geometry_support_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_9__.fromExtent)(e.extent))),l=await this._createSampler(e[e.length-1],t,n,o);if(0===l.samplers.length)return i;const s=i.samplers.concat(l.samplers),a=new _ElevationSampler_js__WEBPACK_IMPORTED_MODULE_10__.MultiTileElevationSampler(s,n.noDataValue);return this._createSamplerAllContinue(e,t,a,n)}async _queryAllContinue(e,t,n){const o=e.pop(),l=t.geometry.coordinates,s=t.sampleInfo;(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_2__.assertIsSome)(s);const a=[],r=[];for(let i=0;i<l.length;i++){const t=s[i];t.demResolution>=0?t.source||(t.source=o):e.length&&(a.push(l[i]),r.push(i))}if(!e.length||0===a.length)return t;const c=t.geometry.clone(a),u=await this.query(e[e.length-1],c,n),h=u.sampleInfo;if(!h)throw new Error("no sampleInfo");return r.forEach(((e,t)=>{l[e].z=u.geometry.coordinates[t].z,s[e].demResolution=h[t].demResolution})),this._queryAllContinue(e,t,n)}async _selectTiles(e,i){"geometry"===e.type&&I(e);const n=e.options.demResolution;if("number"==typeof n)C(e,n);else if("finest-contiguous"===n)await this._selectTilesFinestContiguous(e,i);else{if("auto"!==n)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("elevation-query:invalid-dem-resolution",`Invalid dem resolution value '${n}', expected a number, "finest-contiguous" or "auto"`);await this._selectTilesAuto(e,i)}}async _selectTilesFinestContiguous(e,t){const{tileInfo:i,tilemapCache:n}=e.layer,o=E(i,n,e.options.minDemResolution);await this._selectTilesFinestContiguousAt(e,o,t)}async _selectTilesFinestContiguousAt(e,i,l){const s=e.layer;if(e.selectTilesAtLOD(i),i<0)return;const a=s.tilemapCache,r=e.getTilesToFetch();try{if(a&&!L(a))await (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.whenOrAbort)(Promise.all(r.map((e=>a.fetchAvailability(e.level,e.row,e.col,{signal:l})))),l);else if(await F(e,l),!e.allElevationTilesFetched())throw e.clearElevationTiles(),new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("elevation-query:has-unavailable-tiles","Some elevation tiles are unavailable")}catch(c){(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.throwIfAbortError)(c),await this._selectTilesFinestContiguousAt(e,i-1,l)}}async _selectTilesAuto(t,i){M(t),S(t);const l=t.layer.tilemapCache;if(!l||L(l))return this._selectTilesAutoPrefetchUpsample(t,i);const s=t.getTilesToFetch(),a={},r=s.map((async t=>{const n=new _TileKey_js__WEBPACK_IMPORTED_MODULE_12__.TileKey(null,0,0,0,(0,_geometry_support_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_9__.create)()),s=await (0,_core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_0__.result)(l.fetchAvailabilityUpsample(t.level,t.row,t.col,n,{signal:i}));!1!==s.ok?null!=t.id&&(a[t.id]=n):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.throwIfAbortError)(s.error)}));await (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.whenOrAbort)(Promise.all(r),i),t.remapTiles(a)}async _selectTilesAutoPrefetchUpsample(e,t){const i=e.layer.tileInfo;await F(e,t);let n=!1;e.forEachTileToFetch(((e,t)=>{i.upsampleTile(e)?n=!0:t()})),n&&await this._selectTilesAutoPrefetchUpsample(e,t)}}class v{export(){return this._exporter(this.coordinates,this.spatialReference)}clone(e){const t=new v;return t.geometry=this.geometry,t.spatialReference=this.spatialReference,t.coordinates=e||this.coordinates.map((e=>e.clone())),t._exporter=this._exporter,t}async project(e,t){if(this.spatialReference.equals(e))return this.clone();await (0,_geometry_projectionUtils_js__WEBPACK_IMPORTED_MODULE_8__.initializeProjection)([{source:this.spatialReference,dest:e}],{signal:t});const i=new _geometry_Multipoint_js__WEBPACK_IMPORTED_MODULE_5__["default"]({spatialReference:this.spatialReference,points:this.coordinates.map((e=>[e.x,e.y]))}),n=(0,_geometry_projectionUtils_js__WEBPACK_IMPORTED_MODULE_8__.project)(i,e);if(!n)return null;const o=this.coordinates.map(((e,t)=>{const i=e.clone(),o=n.points[t];return i.x=o[0],i.y=o[1],i})),l=this.clone(o);return l.spatialReference=e,l}static fromGeometry(e){const t=new v;if(t.geometry=e,t.spatialReference=e.spatialReference,e instanceof v)t.coordinates=e.coordinates.map((e=>e.clone())),t._exporter=(t,i)=>{const n=e.clone(t);return n.spatialReference=i,n};else switch(e.type){case"point":{const i=e,{hasZ:n,hasM:o}=i;t.coordinates=n&&o?[new w(i.x,i.y,i.z,i.m)]:n?[new w(i.x,i.y,i.z)]:o?[new w(i.x,i.y,null,i.m)]:[new w(i.x,i.y)],t._exporter=(t,i)=>e.hasM?new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_6__["default"](t[0].x,t[0].y,t[0].z,t[0].m,i):new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_6__["default"](t[0].x,t[0].y,t[0].z,i);break}case"multipoint":{const i=e,{hasZ:n,hasM:o}=i;t.coordinates=n&&o?i.points.map((e=>new w(e[0],e[1],e[2],e[3]))):n?i.points.map((e=>new w(e[0],e[1],e[2]))):o?i.points.map((e=>new w(e[0],e[1],null,e[2]))):i.points.map((e=>new w(e[0],e[1]))),t._exporter=(t,i)=>e.hasM?new _geometry_Multipoint_js__WEBPACK_IMPORTED_MODULE_5__["default"]({points:t.map((e=>[e.x,e.y,e.z,e.m])),hasZ:!0,hasM:!0,spatialReference:i}):new _geometry_Multipoint_js__WEBPACK_IMPORTED_MODULE_5__["default"](t.map((e=>[e.x,e.y,e.z])),i);break}case"polyline":{const i=e,n=[],o=[],{hasZ:l,hasM:s}=e;let a=0;for(const e of i.paths)if(o.push([a,a+e.length]),a+=e.length,l&&s)for(const t of e)n.push(new w(t[0],t[1],t[2],t[3]));else if(l)for(const t of e)n.push(new w(t[0],t[1],t[2]));else if(s)for(const t of e)n.push(new w(t[0],t[1],null,t[2]));else for(const t of e)n.push(new w(t[0],t[1]));t.coordinates=n,t._exporter=(t,i)=>{const n=e.hasM?t.map((e=>[e.x,e.y,e.z??0,e.m??0])):t.map((e=>[e.x,e.y,e.z??0])),l=o.map((e=>n.slice(e[0],e[1])));return new _geometry_Polyline_js__WEBPACK_IMPORTED_MODULE_7__["default"]({paths:l,hasM:e.hasM,hasZ:!0,spatialReference:i})};break}}return t}}class w{constructor(e,t,i=null,n=null,o=null,l=null){this.x=e,this.y=t,this.z=i,this.m=n,this.tile=o,this.elevationTile=l}clone(){return new w(this.x,this.y,this.z,this.m)}}class g{constructor(e,t){this.layer=e,this.options=t}}class x extends g{constructor(e,t,i){super(e,i),this.outSpatialReference=t,this.type="geometry"}selectTilesAtLOD(e){if(e<0)this.geometry.coordinates.forEach((e=>e.tile=null));else{const{tileInfo:t,tilemapCache:i}=this.layer,n=D(t,i)[e].level;this.geometry.coordinates.forEach((e=>e.tile=t.tileAt(n,e.x,e.y)))}}allElevationTilesFetched(){return!this.geometry.coordinates.some((e=>!e.elevationTile))}clearElevationTiles(){for(const e of this.geometry.coordinates)e.elevationTile!==this.outsideExtentTile&&(e.elevationTile=null)}populateElevationTiles(e){for(const t of this.geometry.coordinates)!t.elevationTile&&t.tile?.id&&(t.elevationTile=e[t.tile.id])}remapTiles(e){for(const t of this.geometry.coordinates){const i=t.tile?.id;t.tile=i?e[i]:null}}getTilesToFetch(){const e={},t=[];for(const i of this.geometry.coordinates){const n=i.tile;if(!n)continue;const o=i.tile?.id;i.elevationTile||!o||e[o]||(e[o]=n,t.push(n))}return t}forEachTileToFetch(e){for(const t of this.geometry.coordinates)t.tile&&!t.elevationTile&&e(t.tile,(()=>{t.tile=null}))}}class _ extends g{constructor(e,t,i,n){super(e,i),this.type="extent",this.elevationTiles=[],this._candidateTiles=[],this._fetchedCandidates=new Set,this.extent=t.clone().intersection(e.fullExtent),this.maskExtents=n}selectTilesAtLOD(e,t){const i=this._maximumLodForRequests(t),n=Math.min(i,e);n<0?this._candidateTiles.length=0:this._selectCandidateTilesCoveringExtentAt(n)}_maximumLodForRequests(e){const{tileInfo:t,tilemapCache:i}=this.layer,n=D(t,i);if(!e)return n.length-1;const o=this.extent;if(null==o)return-1;for(let l=n.length-1;l>=0;l--){const i=n[l],s=i.resolution*t.size[0],a=i.resolution*t.size[1];if(Math.ceil(o.width/s)*Math.ceil(o.height/a)<=e)return l}return-1}allElevationTilesFetched(){return this._candidateTiles.length===this.elevationTiles.length}clearElevationTiles(){this.elevationTiles.length=0,this._fetchedCandidates.clear()}populateElevationTiles(e){for(const t of this._candidateTiles){const i=t.id&&e[t.id];i&&(this._fetchedCandidates.add(t),this.elevationTiles.push(i))}}remapTiles(e){this._candidateTiles=j(this._candidateTiles.map((t=>e[t.id])))}getTilesToFetch(){return this._candidateTiles}forEachTileToFetch(e,t){const i=this._candidateTiles;this._candidateTiles=[],i.forEach((i=>{if(this._fetchedCandidates.has(i))return void(t&&t(i));let n=!1;e(i,(()=>n=!0)),n?t&&t(i):this._candidateTiles.push(i)})),this._candidateTiles=j(this._candidateTiles,t)}_selectCandidateTilesCoveringExtentAt(e){this._candidateTiles.length=0;const t=this.extent;if(null==t)return;const{tileInfo:i,tilemapCache:n}=this.layer,o=D(i,n)[e],l=i.tileAt(o.level,t.xmin,t.ymin),s=l.extent;if(null==s)return;const a=o.resolution*i.size[0],r=o.resolution*i.size[1],c=Math.ceil((t.xmax-s[0])/a),u=Math.ceil((t.ymax-s[1])/r);for(let h=0;h<u;h++)for(let e=0;e<c;e++){const t=new _TileKey_js__WEBPACK_IMPORTED_MODULE_12__.TileKey(null,l.level,l.row-h,l.col+e);i.updateTileInfo(t),this._tileIsMasked(t)||this._candidateTiles.push(t)}}_tileIsMasked(e){return!!this.maskExtents&&this.maskExtents.some((t=>e.extent&&(0,_geometry_support_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_9__.contains)(t,e.extent)))}}function E(e,t,i=0){const n=D(e,t);let o=n.length-1;if(i>0){const t=i/(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_4__.getMetersPerUnitForSR)(e.spatialReference),s=n.findIndex((e=>e.resolution<t));0===s?o=0:s>0&&(o=s-1)}return o}const R={maximumAutoTileRequests:20,noDataValue:0,returnSampleInfo:!1,demResolution:"auto",minDemResolution:0};async function q(e,i,n){let o;const l=e.layer.tileInfo.spatialReference;if(i instanceof v?o=await i.project(l,n):(await (0,_geometry_projectionUtils_js__WEBPACK_IMPORTED_MODULE_8__.initializeProjection)([{source:i.spatialReference,dest:l}],{signal:n}),o=(0,_geometry_projectionUtils_js__WEBPACK_IMPORTED_MODULE_8__.project)(i,l)),!o)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("elevation-query:spatial-reference-mismatch",`Cannot query elevation in '${i.spatialReference.wkid}' on an elevation service in '${l.wkid}'`);e.geometry=v.fromGeometry(o)}function I(e){if(null==e.layer.fullExtent)return;const t=new _ElevationTile_js__WEBPACK_IMPORTED_MODULE_11__.ElevationTile(null);t.sample=()=>e.options.noDataValue,e.outsideExtentTile=t;const i=e.layer.fullExtent;e.geometry.coordinates.forEach((e=>{const n=e.x,o=e.y;(n<i.xmin||n>i.xmax||o<i.ymin||o>i.ymax)&&(e.elevationTile=t)}))}function A(e,t){const{tileInfo:i,tilemapCache:n}=e.layer,o=t/(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_4__.getMetersPerUnitForSR)(i.spatialReference),s=D(i,n);let a=s[0],r=0;for(let l=1;l<s.length;l++){const e=s[l];Math.abs(e.resolution-o)<Math.abs(a.resolution-o)&&(a=e,r=l)}return r}function C(e,t){const i=A(e,t);e.selectTilesAtLOD(i)}function M(e){const{tileInfo:t,tilemapCache:i}=e.layer,n=E(t,i,e.options.minDemResolution);e.selectTilesAtLOD(n,e.options.maximumAutoTileRequests)}function D(e,t){const i=e.lods;if(L(t)){const{effectiveMinLOD:e,effectiveMaxLOD:n}=t;return i.filter((t=>t.level>=e&&t.level<=n))}return i}async function F(e,t){const i=e.getTilesToFetch(),o={},l=e.options.cache,s=e.options.noDataValue,a=i.map((async i=>{if(null==i.id)return;const n=`${e.layer.uid}:${i.id}:${s}`,a=null!=l?l.get(n):null,r=null!=a?a:await e.layer.fetchTile(i.level,i.row,i.col,{noDataValue:s,signal:t});null!=l&&l.put(n,r),o[i.id]=new _ElevationTile_js__WEBPACK_IMPORTED_MODULE_11__.ElevationTile(i,r)}));await (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.whenOrAbort)(Promise.allSettled(a),t),e.populateElevationTiles(o)}function S(e){const t=e.layer.tileInfo;let i=0;const n={},o=e=>{null!=e.id&&(e.id in n?n[e.id]++:(n[e.id]=1,i++))},l=e=>{if(null==e.id)return;const t=n[e.id];1===t?(delete n[e.id],i--):n[e.id]=t-1};e.forEachTileToFetch(o,l);let s=!0;for(;s&&(s=!1,e.forEachTileToFetch((n=>{i<=e.options.maximumAutoTileRequests||(l(n),t.upsampleTile(n)&&(s=!0),o(n))}),l),s););}function b(e){e.geometry.coordinates.forEach((t=>{const i=t.elevationTile;let n=e.options.noDataValue;if(i){const e=i.sample(t.x,t.y);null!=e?n=e:t.elevationTile=null}t.z=n}))}function j(e,t){const i={},n=[];for(const l of e){const e=l.id;e&&!i[e]?(i[e]=l,n.push(l)):t&&t(l)}const o=n.sort(((e,t)=>e.level-t.level));return o.filter(((e,i)=>{for(let n=0;n<i;n++){const i=o[n].extent;if(i&&e.extent&&(0,_geometry_support_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_9__.contains)(i,e.extent))return t&&t(e),!1}return!0}))}async function z(e,t){const n=await e.geometry.project(e.outSpatialReference,t);(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_2__.assertIsSome)(n);const o={geometry:n.export(),noDataValue:e.options.noDataValue};return e.options.returnSampleInfo&&(o.sampleInfo=k(e)),e.geometry.coordinates.forEach((e=>{e.tile=null,e.elevationTile=null})),o}function k(e){const t=e.layer.tileInfo,i=(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_4__.getMetersPerUnitForSR)(t.spatialReference);return e.geometry.coordinates.map((n=>{let o=-1;if(n.elevationTile&&n.elevationTile!==e.outsideExtentTile){o=t.lodAt(n.elevationTile.tile.level).resolution*i}return{demResolution:o}}))}function L(e){return null!=e?.tileInfo}


/***/ }),

/***/ "./node_modules/@arcgis/core/layers/support/ElevationTile.js":
/*!*******************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/support/ElevationTile.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ElevationTile: () => (/* binding */ t)
/* harmony export */ });
/* harmony import */ var _ElevationSamplerData_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ElevationSamplerData.js */ "./node_modules/@arcgis/core/layers/support/ElevationSamplerData.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class t{constructor(t,l=null){if(this.tile=t,null!=l&&null!=t){const e=t.extent;this._samplerData=new _ElevationSamplerData_js__WEBPACK_IMPORTED_MODULE_0__.ElevationSamplerData(l,e)}}get zmin(){return null!=this._samplerData?this._samplerData.data.minValue:0}get zmax(){return null!=this._samplerData?this._samplerData.data.maxValue:0}get hasNoDataValues(){return!!this._samplerData?.data.hasNoDataValues}sample(a,t){if(null==this._samplerData)return;const{safeWidth:e,data:s,dx:r,dy:n,y1:i,x0:u}=this._samplerData,{width:o,values:m,noDataValue:h}=s,p=l(n*(i-t),0,e),D=l(r*(a-u),0,e),d=Math.floor(p),f=Math.floor(D),_=d*o+f,c=_+o,x=m[_],V=m[c],g=m[_+1],v=m[c+1];if(x!==h&&V!==h&&g!==h&&v!==h){const a=D-f,t=x+(g-x)*a;return t+(V+(v-V)*a-t)*(p-d)}}}function l(a,t,l){return a<t?t:a>l?l:a}


/***/ })

};

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVuZG9ycy1ub2RlX21vZHVsZXNfYXJjZ2lzX2NvcmVfbGF5ZXJzX3N1cHBvcnRfRWxldmF0aW9uUXVlcnlfanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUN1dUIsUUFBUSxzQkFBc0IscUZBQXFGLHNEQUFDLCtHQUErRywwQkFBMEIsU0FBUyw0QkFBNEIsU0FBUyw4QkFBOEIsNkVBQTZFLCtEQUErRCxtQkFBbUIsZ0JBQWdCLHNEQUFDLHFHQUFxRyxpR0FBaUcsc0RBQUMscUhBQXFILFNBQVMsVUFBVSw0Q0FBNEMscUJBQXFCLFNBQVMsdUVBQXVFLDJCQUEyQixnQkFBZ0Isc0RBQUMscUdBQXFHLG1DQUFtQyxzREFBQyxpRUFBaUUsU0FBUyxXQUFXLGtDQUFrQyw4QkFBOEIscUZBQXFGLHNEQUFDLCtHQUErRyxtQ0FBbUMsc0RBQUMsaUVBQWlFLFNBQVMsOEJBQThCLGdEQUFnRCwrQ0FBK0MsOEJBQThCLGlCQUFpQixjQUFjLFNBQVMsRUFBRSx5REFBeUQsb0JBQW9CLGtGQUFDLEdBQUcsZ0JBQWdCLEdBQUcsU0FBUyxJQUFJLHFFQUFDLE9BQU8sdUJBQXVCLHFEQUFxRCw0RUFBQywwREFBMEQseUNBQXlDLDhCQUE4QixnRUFBZ0UsK0VBQUMsOERBQThELGtDQUFrQyw0Q0FBNEMsNEVBQUMsa0JBQWtCLCtDQUErQywrQkFBK0Isd0RBQXdELDREQUFDLElBQUksZ0JBQWdCLFlBQVksV0FBVyxLQUFLLGFBQWEsNkVBQTZFLG9DQUFvQyxpRkFBaUYsdUNBQXVDLDBCQUEwQix5RUFBeUUsaUNBQWlDLHdCQUF3QiwwQkFBMEIsZ0NBQWdDLDZCQUE2Qiw2RUFBNkUsS0FBSyx3QkFBd0Isc0RBQUMsMkVBQTJFLEVBQUUsc0RBQXNELGtDQUFrQyx3Q0FBd0MsTUFBTSwwQkFBMEIsNkNBQTZDLGlEQUFpRCw0Q0FBNEMsZ0JBQWdCLG9DQUFvQyw2Q0FBNkMsSUFBSSxrQkFBa0Isa0VBQUMsZ0VB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RUFBRSxtRkFBbUYsdUJBQXVCLEVBQUUsZ0NBQWdDLDZEQUFDLE1BQU0sR0FBRyxNQUFNLGtFQUFDLHNEQUFzRCxjQUFjLHlCQUF5QixRQUFRLFVBQVUsT0FBTyxrREFBa0QsT0FBTyxxQkFBcUIsZ0JBQWdCLHdDQUF3QywwQkFBMEIsU0FBUyxLQUFLLG1DQUFtQyw0RUFBNEUsUUFBUSxHQUFHLGNBQWMsb0NBQW9DLHdCQUF3Qiw0QkFBNEIsTUFBTSwwQkFBMEIsaUNBQWlDLE1BQU0sR0FBRyxnQkFBZ0IsVUFBVSxNQUFNLGtCQUFrQixhQUFhLG9DQUFvQyx5Q0FBeUMseUJBQXlCLFlBQVksSUFBSSxLQUFLLG9CQUFvQixnQkFBZ0IsNkVBQUMsK0JBQStCLFNBQVMsR0FBRyxzQkFBc0IsMERBQTBELDREQUFDLElBQUksU0FBUyx1REFBdUQsMkZBQTJGLGlDQUFpQyxLQUFLLGNBQWMsMkJBQTJCLHlFQUFDLHFCQUFxQix1Q0FBdUMsU0FBUywyREFBMkQsbURBQW1ELE9BQU8saUJBQWlCLEdBQUcsY0FBYyx5QkFBb0c7Ozs7Ozs7Ozs7Ozs7Ozs7QUNKL25iO0FBQ0E7QUFDQTtBQUNBO0FBQ2lFLFFBQVEsc0JBQXNCLGlDQUFpQyxpQkFBaUIsc0JBQXNCLDBFQUFDLE9BQU8sV0FBVyxpRUFBaUUsV0FBVyxpRUFBaUUsc0JBQXNCLGdEQUFnRCxZQUFZLGtDQUFrQyxNQUFNLHVDQUF1QyxvQkFBb0IsK0JBQStCLG1IQUFtSCwrQkFBK0Isd0JBQXdCLCtCQUErQixrQkFBa0IscUJBQWdEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJlY2lzaW9uZmFybXMvLi9ub2RlX21vZHVsZXMvQGFyY2dpcy9jb3JlL2xheWVycy9zdXBwb3J0L0VsZXZhdGlvblF1ZXJ5LmpzIiwid2VicGFjazovL3ByZWNpc2lvbmZhcm1zLy4vbm9kZV9tb2R1bGVzL0BhcmNnaXMvY29yZS9sYXllcnMvc3VwcG9ydC9FbGV2YXRpb25UaWxlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXG5BbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuU2VlIGh0dHBzOi8vanMuYXJjZ2lzLmNvbS80LjMzL2VzcmkvY29weXJpZ2h0LnR4dCBmb3IgZGV0YWlscy5cbiovXG5pbXBvcnR7cmVzdWx0IGFzIGV9ZnJvbVwiLi4vLi4vY29yZS9hc3luY1V0aWxzLmpzXCI7aW1wb3J0IHQgZnJvbVwiLi4vLi4vY29yZS9FcnJvci5qc1wiO2ltcG9ydHthc3NlcnRJc1NvbWUgYXMgaX1mcm9tXCIuLi8uLi9jb3JlL21heWJlLmpzXCI7aW1wb3J0e3doZW5PckFib3J0IGFzIG4sdGhyb3dJZkFib3J0RXJyb3IgYXMgb31mcm9tXCIuLi8uLi9jb3JlL3Byb21pc2VVdGlscy5qc1wiO2ltcG9ydHtnZXRNZXRlcnNQZXJVbml0Rm9yU1IgYXMgbH1mcm9tXCIuLi8uLi9jb3JlL3VuaXRVdGlscy5qc1wiO2ltcG9ydCBzIGZyb21cIi4uLy4uL2dlb21ldHJ5L011bHRpcG9pbnQuanNcIjtpbXBvcnQgYSBmcm9tXCIuLi8uLi9nZW9tZXRyeS9Qb2ludC5qc1wiO2ltcG9ydCByIGZyb21cIi4uLy4uL2dlb21ldHJ5L1BvbHlsaW5lLmpzXCI7aW1wb3J0e2luaXRpYWxpemVQcm9qZWN0aW9uIGFzIGMscHJvamVjdCBhcyB1fWZyb21cIi4uLy4uL2dlb21ldHJ5L3Byb2plY3Rpb25VdGlscy5qc1wiO2ltcG9ydHtmcm9tRXh0ZW50IGFzIGgsY3JlYXRlIGFzIGYsY29udGFpbnMgYXMgbX1mcm9tXCIuLi8uLi9nZW9tZXRyeS9zdXBwb3J0L2FhQm91bmRpbmdSZWN0LmpzXCI7aW1wb3J0e011bHRpVGlsZUVsZXZhdGlvblNhbXBsZXIgYXMgcH1mcm9tXCIuL0VsZXZhdGlvblNhbXBsZXIuanNcIjtpbXBvcnR7RWxldmF0aW9uVGlsZSBhcyBkfWZyb21cIi4vRWxldmF0aW9uVGlsZS5qc1wiO2ltcG9ydHtUaWxlS2V5IGFzIHl9ZnJvbVwiLi9UaWxlS2V5LmpzXCI7Y2xhc3MgVHthc3luYyBxdWVyeUFsbChlLGksbil7aWYoIShlPW4/Lmlnbm9yZUludmlzaWJsZUxheWVycz9lLmZpbHRlcigoZT0+ZS52aXNpYmxlKSk6ZS5zbGljZSgpKS5sZW5ndGgpdGhyb3cgbmV3IHQoXCJlbGV2YXRpb24tcXVlcnk6aW52YWxpZC1sYXllclwiLFwiRWxldmF0aW9uIHF1ZXJpZXMgcmVxdWlyZSBhdCBsZWFzdCBvbmUgZWxldmF0aW9uIGxheWVyIHRvIGZldGNoIHRpbGVzIGZyb21cIik7Y29uc3Qgbz12LmZyb21HZW9tZXRyeShpKTtsZXQgbD0hMTtuPy5yZXR1cm5TYW1wbGVJbmZvfHwobD0hMCk7Y29uc3Qgcz17Li4uUiwuLi5uLHJldHVyblNhbXBsZUluZm86ITB9LGE9YXdhaXQgdGhpcy5xdWVyeShlW2UubGVuZ3RoLTFdLG8scykscj1hd2FpdCB0aGlzLl9xdWVyeUFsbENvbnRpbnVlKGUsYSxzKTtyZXR1cm4gci5nZW9tZXRyeT1yLmdlb21ldHJ5LmV4cG9ydCgpLGwmJmRlbGV0ZSByLnNhbXBsZUluZm8scn1hc3luYyBxdWVyeShlLGksbil7aWYoIWUpdGhyb3cgbmV3IHQoXCJlbGV2YXRpb24tcXVlcnk6aW52YWxpZC1sYXllclwiLFwiRWxldmF0aW9uIHF1ZXJpZXMgcmVxdWlyZSBhbiBlbGV2YXRpb24gbGF5ZXIgdG8gZmV0Y2ggdGlsZXMgZnJvbVwiKTtpZighaXx8IShpIGluc3RhbmNlb2YgdikmJlwicG9pbnRcIiE9PWkudHlwZSYmXCJtdWx0aXBvaW50XCIhPT1pLnR5cGUmJlwicG9seWxpbmVcIiE9PWkudHlwZSl0aHJvdyBuZXcgdChcImVsZXZhdGlvbi1xdWVyeTppbnZhbGlkLWdlb21ldHJ5XCIsXCJPbmx5IHBvaW50LCBwb2x5bGluZSBhbmQgbXVsdGlwb2ludCBnZW9tZXRyaWVzIGNhbiBiZSB1c2VkIHRvIHF1ZXJ5IGVsZXZhdGlvblwiKTtjb25zdCBvPXsuLi5SLC4uLm59LGw9bmV3IHgoZSxpLnNwYXRpYWxSZWZlcmVuY2Usbykscz1vLnNpZ25hbDtyZXR1cm4gYXdhaXQgZS5sb2FkKHtzaWduYWw6c30pLGF3YWl0IHEobCxpLHMpLGF3YWl0IHRoaXMuX3NlbGVjdFRpbGVzKGwscyksYXdhaXQgRihsLHMpLGIobCkseihsLHMpfWFzeW5jIGNyZWF0ZVNhbXBsZXIoZSxpLG4pe2lmKCFlKXRocm93IG5ldyB0KFwiZWxldmF0aW9uLXF1ZXJ5OmludmFsaWQtbGF5ZXJcIixcIkVsZXZhdGlvbiBxdWVyaWVzIHJlcXVpcmUgYW4gZWxldmF0aW9uIGxheWVyIHRvIGZldGNoIHRpbGVzIGZyb21cIik7aWYoIWl8fFwiZXh0ZW50XCIhPT1pLnR5cGUpdGhyb3cgbmV3IHQoXCJlbGV2YXRpb24tcXVlcnk6aW52YWxpZC1leHRlbnRcIixcIkludmFsaWQgb3IgdW5kZWZpbmVkIGV4dGVudFwiKTtjb25zdCBvPXsuLi5SLC4uLm59O3JldHVybiB0aGlzLl9jcmVhdGVTYW1wbGVyKGUsaSxvKX1hc3luYyBjcmVhdGVTYW1wbGVyQWxsKGUsaSxuKXtpZighKGU9bj8uaWdub3JlSW52aXNpYmxlTGF5ZXJzP2UuZmlsdGVyKChlPT5lLnZpc2libGUpKTplLnNsaWNlKCkpLmxlbmd0aCl0aHJvdyBuZXcgdChcImVsZXZhdGlvbi1xdWVyeTppbnZhbGlkLWxheWVyXCIsXCJFbGV2YXRpb24gcXVlcmllcyByZXF1aXJlIGF0IGxlYXN0IG9uZSBlbGV2YXRpb24gbGF5ZXIgdG8gZmV0Y2ggdGlsZXMgZnJvbVwiKTtpZighaXx8XCJleHRlbnRcIiE9PWkudHlwZSl0aHJvdyBuZXcgdChcImVsZXZhdGlvbi1xdWVyeTppbnZhbGlkLWV4dGVudFwiLFwiSW52YWxpZCBvciB1bmRlZmluZWQgZXh0ZW50XCIpO2NvbnN0IG89ey4uLlIsLi4ubixyZXR1cm5TYW1wbGVJbmZvOiEwfSxsPWF3YWl0IHRoaXMuX2NyZWF0ZVNhbXBsZXIoZVtlLmxlbmd0aC0xXSxpLG8pO3JldHVybiB0aGlzLl9jcmVhdGVTYW1wbGVyQWxsQ29udGludWUoZSxpLGwsbyl9YXN5bmMgX2NyZWF0ZVNhbXBsZXIoZSx0LGksbil7Y29uc3Qgbz1pLnNpZ25hbDthd2FpdCBlLmxvYWQoe3NpZ25hbDpvfSk7Y29uc3QgbD10LnNwYXRpYWxSZWZlcmVuY2Uscz1lLnRpbGVJbmZvLnNwYXRpYWxSZWZlcmVuY2U7bC5lcXVhbHMocyl8fChhd2FpdCBjKFt7c291cmNlOmwsZGVzdDpzfV0se3NpZ25hbDpvfSksdD11KHQscykpO2NvbnN0IGE9bmV3IF8oZSx0LGksbik7cmV0dXJuIGF3YWl0IHRoaXMuX3NlbGVjdFRpbGVzKGEsbyksYXdhaXQgRihhLG8pLG5ldyBwKGEuZWxldmF0aW9uVGlsZXMsYS5sYXllci50aWxlSW5mbyxhLm9wdGlvbnMubm9EYXRhVmFsdWUpfWFzeW5jIF9jcmVhdGVTYW1wbGVyQWxsQ29udGludWUoZSx0LGksbil7aWYoZS5wb3AoKSwhZS5sZW5ndGgpcmV0dXJuIGk7Y29uc3Qgbz1pLnNhbXBsZXJzLmZpbHRlcigoZT0+IWUudGlsZS5oYXNOb0RhdGFWYWx1ZXMpKS5tYXAoKGU9PmgoZS5leHRlbnQpKSksbD1hd2FpdCB0aGlzLl9jcmVhdGVTYW1wbGVyKGVbZS5sZW5ndGgtMV0sdCxuLG8pO2lmKDA9PT1sLnNhbXBsZXJzLmxlbmd0aClyZXR1cm4gaTtjb25zdCBzPWkuc2FtcGxlcnMuY29uY2F0KGwuc2FtcGxlcnMpLGE9bmV3IHAocyxuLm5vRGF0YVZhbHVlKTtyZXR1cm4gdGhpcy5fY3JlYXRlU2FtcGxlckFsbENvbnRpbnVlKGUsdCxhLG4pfWFzeW5jIF9xdWVyeUFsbENvbnRpbnVlKGUsdCxuKXtjb25zdCBvPWUucG9wKCksbD10Lmdlb21ldHJ5LmNvb3JkaW5hdGVzLHM9dC5zYW1wbGVJbmZvO2kocyk7Y29uc3QgYT1bXSxyPVtdO2ZvcihsZXQgaT0wO2k8bC5sZW5ndGg7aSsrKXtjb25zdCB0PXNbaV07dC5kZW1SZXNvbHV0aW9uPj0wP3Quc291cmNlfHwodC5zb3VyY2U9byk6ZS5sZW5ndGgmJihhLnB1c2gobFtpXSksci5wdXNoKGkpKX1pZighZS5sZW5ndGh8fDA9PT1hLmxlbmd0aClyZXR1cm4gdDtjb25zdCBjPXQuZ2VvbWV0cnkuY2xvbmUoYSksdT1hd2FpdCB0aGlzLnF1ZXJ5KGVbZS5sZW5ndGgtMV0sYyxuKSxoPXUuc2FtcGxlSW5mbztpZighaCl0aHJvdyBuZXcgRXJyb3IoXCJubyBzYW1wbGVJbmZvXCIpO3JldHVybiByLmZvckVhY2goKChlLHQpPT57bFtlXS56PXUuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbdF0ueixzW2VdLmRlbVJlc29sdXRpb249aFt0XS5kZW1SZXNvbHV0aW9ufSkpLHRoaXMuX3F1ZXJ5QWxsQ29udGludWUoZSx0LG4pfWFzeW5jIF9zZWxlY3RUaWxlcyhlLGkpe1wiZ2VvbWV0cnlcIj09PWUudHlwZSYmSShlKTtjb25zdCBuPWUub3B0aW9ucy5kZW1SZXNvbHV0aW9uO2lmKFwibnVtYmVyXCI9PXR5cGVvZiBuKUMoZSxuKTtlbHNlIGlmKFwiZmluZXN0LWNvbnRpZ3VvdXNcIj09PW4pYXdhaXQgdGhpcy5fc2VsZWN0VGlsZXNGaW5lc3RDb250aWd1b3VzKGUsaSk7ZWxzZXtpZihcImF1dG9cIiE9PW4pdGhyb3cgbmV3IHQoXCJlbGV2YXRpb24tcXVlcnk6aW52YWxpZC1kZW0tcmVzb2x1dGlvblwiLGBJbnZhbGlkIGRlbSByZXNvbHV0aW9uIHZhbHVlICcke259JywgZXhwZWN0ZWQgYSBudW1iZXIsIFwiZmluZXN0LWNvbnRpZ3VvdXNcIiBvciBcImF1dG9cImApO2F3YWl0IHRoaXMuX3NlbGVjdFRpbGVzQXV0byhlLGkpfX1hc3luYyBfc2VsZWN0VGlsZXNGaW5lc3RDb250aWd1b3VzKGUsdCl7Y29uc3R7dGlsZUluZm86aSx0aWxlbWFwQ2FjaGU6bn09ZS5sYXllcixvPUUoaSxuLGUub3B0aW9ucy5taW5EZW1SZXNvbHV0aW9uKTthd2FpdCB0aGlzLl9zZWxlY3RUaWxlc0ZpbmVzdENvbnRpZ3VvdXNBdChlLG8sdCl9YXN5bmMgX3NlbGVjdFRpbGVzRmluZXN0Q29udGlndW91c0F0KGUsaSxsKXtjb25zdCBzPWUubGF5ZXI7aWYoZS5zZWxlY3RUaWxlc0F0TE9EKGkpLGk8MClyZXR1cm47Y29uc3QgYT1zLnRpbGVtYXBDYWNoZSxyPWUuZ2V0VGlsZXNUb0ZldGNoKCk7dHJ5e2lmKGEmJiFMKGEpKWF3YWl0IG4oUHJvbWlzZS5hbGwoci5tYXAoKGU9PmEuZmV0Y2hBdmFpbGFiaWxpdHkoZS5sZXZlbCxlLnJvdyxlLmNvbCx7c2lnbmFsOmx9KSkpKSxsKTtlbHNlIGlmKGF3YWl0IEYoZSxsKSwhZS5hbGxFbGV2YXRpb25UaWxlc0ZldGNoZWQoKSl0aHJvdyBlLmNsZWFyRWxldmF0aW9uVGlsZXMoKSxuZXcgdChcImVsZXZhdGlvbi1xdWVyeTpoYXMtdW5hdmFpbGFibGUtdGlsZXNcIixcIlNvbWUgZWxldmF0aW9uIHRpbGVzIGFyZSB1bmF2YWlsYWJsZVwiKX1jYXRjaChjKXtvKGMpLGF3YWl0IHRoaXMuX3NlbGVjdFRpbGVzRmluZXN0Q29udGlndW91c0F0KGUsaS0xLGwpfX1hc3luYyBfc2VsZWN0VGlsZXNBdXRvKHQsaSl7TSh0KSxTKHQpO2NvbnN0IGw9dC5sYXllci50aWxlbWFwQ2FjaGU7aWYoIWx8fEwobCkpcmV0dXJuIHRoaXMuX3NlbGVjdFRpbGVzQXV0b1ByZWZldGNoVXBzYW1wbGUodCxpKTtjb25zdCBzPXQuZ2V0VGlsZXNUb0ZldGNoKCksYT17fSxyPXMubWFwKChhc3luYyB0PT57Y29uc3Qgbj1uZXcgeShudWxsLDAsMCwwLGYoKSkscz1hd2FpdCBlKGwuZmV0Y2hBdmFpbGFiaWxpdHlVcHNhbXBsZSh0LmxldmVsLHQucm93LHQuY29sLG4se3NpZ25hbDppfSkpOyExIT09cy5vaz9udWxsIT10LmlkJiYoYVt0LmlkXT1uKTpvKHMuZXJyb3IpfSkpO2F3YWl0IG4oUHJvbWlzZS5hbGwociksaSksdC5yZW1hcFRpbGVzKGEpfWFzeW5jIF9zZWxlY3RUaWxlc0F1dG9QcmVmZXRjaFVwc2FtcGxlKGUsdCl7Y29uc3QgaT1lLmxheWVyLnRpbGVJbmZvO2F3YWl0IEYoZSx0KTtsZXQgbj0hMTtlLmZvckVhY2hUaWxlVG9GZXRjaCgoKGUsdCk9PntpLnVwc2FtcGxlVGlsZShlKT9uPSEwOnQoKX0pKSxuJiZhd2FpdCB0aGlzLl9zZWxlY3RUaWxlc0F1dG9QcmVmZXRjaFVwc2FtcGxlKGUsdCl9fWNsYXNzIHZ7ZXhwb3J0KCl7cmV0dXJuIHRoaXMuX2V4cG9ydGVyKHRoaXMuY29vcmRpbmF0ZXMsdGhpcy5zcGF0aWFsUmVmZXJlbmNlKX1jbG9uZShlKXtjb25zdCB0PW5ldyB2O3JldHVybiB0Lmdlb21ldHJ5PXRoaXMuZ2VvbWV0cnksdC5zcGF0aWFsUmVmZXJlbmNlPXRoaXMuc3BhdGlhbFJlZmVyZW5jZSx0LmNvb3JkaW5hdGVzPWV8fHRoaXMuY29vcmRpbmF0ZXMubWFwKChlPT5lLmNsb25lKCkpKSx0Ll9leHBvcnRlcj10aGlzLl9leHBvcnRlcix0fWFzeW5jIHByb2plY3QoZSx0KXtpZih0aGlzLnNwYXRpYWxSZWZlcmVuY2UuZXF1YWxzKGUpKXJldHVybiB0aGlzLmNsb25lKCk7YXdhaXQgYyhbe3NvdXJjZTp0aGlzLnNwYXRpYWxSZWZlcmVuY2UsZGVzdDplfV0se3NpZ25hbDp0fSk7Y29uc3QgaT1uZXcgcyh7c3BhdGlhbFJlZmVyZW5jZTp0aGlzLnNwYXRpYWxSZWZlcmVuY2UscG9pbnRzOnRoaXMuY29vcmRpbmF0ZXMubWFwKChlPT5bZS54LGUueV0pKX0pLG49dShpLGUpO2lmKCFuKXJldHVybiBudWxsO2NvbnN0IG89dGhpcy5jb29yZGluYXRlcy5tYXAoKChlLHQpPT57Y29uc3QgaT1lLmNsb25lKCksbz1uLnBvaW50c1t0XTtyZXR1cm4gaS54PW9bMF0saS55PW9bMV0saX0pKSxsPXRoaXMuY2xvbmUobyk7cmV0dXJuIGwuc3BhdGlhbFJlZmVyZW5jZT1lLGx9c3RhdGljIGZyb21HZW9tZXRyeShlKXtjb25zdCB0PW5ldyB2O2lmKHQuZ2VvbWV0cnk9ZSx0LnNwYXRpYWxSZWZlcmVuY2U9ZS5zcGF0aWFsUmVmZXJlbmNlLGUgaW5zdGFuY2VvZiB2KXQuY29vcmRpbmF0ZXM9ZS5jb29yZGluYXRlcy5tYXAoKGU9PmUuY2xvbmUoKSkpLHQuX2V4cG9ydGVyPSh0LGkpPT57Y29uc3Qgbj1lLmNsb25lKHQpO3JldHVybiBuLnNwYXRpYWxSZWZlcmVuY2U9aSxufTtlbHNlIHN3aXRjaChlLnR5cGUpe2Nhc2VcInBvaW50XCI6e2NvbnN0IGk9ZSx7aGFzWjpuLGhhc006b309aTt0LmNvb3JkaW5hdGVzPW4mJm8/W25ldyB3KGkueCxpLnksaS56LGkubSldOm4/W25ldyB3KGkueCxpLnksaS56KV06bz9bbmV3IHcoaS54LGkueSxudWxsLGkubSldOltuZXcgdyhpLngsaS55KV0sdC5fZXhwb3J0ZXI9KHQsaSk9PmUuaGFzTT9uZXcgYSh0WzBdLngsdFswXS55LHRbMF0ueix0WzBdLm0saSk6bmV3IGEodFswXS54LHRbMF0ueSx0WzBdLnosaSk7YnJlYWt9Y2FzZVwibXVsdGlwb2ludFwiOntjb25zdCBpPWUse2hhc1o6bixoYXNNOm99PWk7dC5jb29yZGluYXRlcz1uJiZvP2kucG9pbnRzLm1hcCgoZT0+bmV3IHcoZVswXSxlWzFdLGVbMl0sZVszXSkpKTpuP2kucG9pbnRzLm1hcCgoZT0+bmV3IHcoZVswXSxlWzFdLGVbMl0pKSk6bz9pLnBvaW50cy5tYXAoKGU9Pm5ldyB3KGVbMF0sZVsxXSxudWxsLGVbMl0pKSk6aS5wb2ludHMubWFwKChlPT5uZXcgdyhlWzBdLGVbMV0pKSksdC5fZXhwb3J0ZXI9KHQsaSk9PmUuaGFzTT9uZXcgcyh7cG9pbnRzOnQubWFwKChlPT5bZS54LGUueSxlLnosZS5tXSkpLGhhc1o6ITAsaGFzTTohMCxzcGF0aWFsUmVmZXJlbmNlOml9KTpuZXcgcyh0Lm1hcCgoZT0+W2UueCxlLnksZS56XSkpLGkpO2JyZWFrfWNhc2VcInBvbHlsaW5lXCI6e2NvbnN0IGk9ZSxuPVtdLG89W10se2hhc1o6bCxoYXNNOnN9PWU7bGV0IGE9MDtmb3IoY29uc3QgZSBvZiBpLnBhdGhzKWlmKG8ucHVzaChbYSxhK2UubGVuZ3RoXSksYSs9ZS5sZW5ndGgsbCYmcylmb3IoY29uc3QgdCBvZiBlKW4ucHVzaChuZXcgdyh0WzBdLHRbMV0sdFsyXSx0WzNdKSk7ZWxzZSBpZihsKWZvcihjb25zdCB0IG9mIGUpbi5wdXNoKG5ldyB3KHRbMF0sdFsxXSx0WzJdKSk7ZWxzZSBpZihzKWZvcihjb25zdCB0IG9mIGUpbi5wdXNoKG5ldyB3KHRbMF0sdFsxXSxudWxsLHRbMl0pKTtlbHNlIGZvcihjb25zdCB0IG9mIGUpbi5wdXNoKG5ldyB3KHRbMF0sdFsxXSkpO3QuY29vcmRpbmF0ZXM9bix0Ll9leHBvcnRlcj0odCxpKT0+e2NvbnN0IG49ZS5oYXNNP3QubWFwKChlPT5bZS54LGUueSxlLno/PzAsZS5tPz8wXSkpOnQubWFwKChlPT5bZS54LGUueSxlLno/PzBdKSksbD1vLm1hcCgoZT0+bi5zbGljZShlWzBdLGVbMV0pKSk7cmV0dXJuIG5ldyByKHtwYXRoczpsLGhhc006ZS5oYXNNLGhhc1o6ITAsc3BhdGlhbFJlZmVyZW5jZTppfSl9O2JyZWFrfX1yZXR1cm4gdH19Y2xhc3Mgd3tjb25zdHJ1Y3RvcihlLHQsaT1udWxsLG49bnVsbCxvPW51bGwsbD1udWxsKXt0aGlzLng9ZSx0aGlzLnk9dCx0aGlzLno9aSx0aGlzLm09bix0aGlzLnRpbGU9byx0aGlzLmVsZXZhdGlvblRpbGU9bH1jbG9uZSgpe3JldHVybiBuZXcgdyh0aGlzLngsdGhpcy55LHRoaXMueix0aGlzLm0pfX1jbGFzcyBne2NvbnN0cnVjdG9yKGUsdCl7dGhpcy5sYXllcj1lLHRoaXMub3B0aW9ucz10fX1jbGFzcyB4IGV4dGVuZHMgZ3tjb25zdHJ1Y3RvcihlLHQsaSl7c3VwZXIoZSxpKSx0aGlzLm91dFNwYXRpYWxSZWZlcmVuY2U9dCx0aGlzLnR5cGU9XCJnZW9tZXRyeVwifXNlbGVjdFRpbGVzQXRMT0QoZSl7aWYoZTwwKXRoaXMuZ2VvbWV0cnkuY29vcmRpbmF0ZXMuZm9yRWFjaCgoZT0+ZS50aWxlPW51bGwpKTtlbHNle2NvbnN0e3RpbGVJbmZvOnQsdGlsZW1hcENhY2hlOml9PXRoaXMubGF5ZXIsbj1EKHQsaSlbZV0ubGV2ZWw7dGhpcy5nZW9tZXRyeS5jb29yZGluYXRlcy5mb3JFYWNoKChlPT5lLnRpbGU9dC50aWxlQXQobixlLngsZS55KSkpfX1hbGxFbGV2YXRpb25UaWxlc0ZldGNoZWQoKXtyZXR1cm4hdGhpcy5nZW9tZXRyeS5jb29yZGluYXRlcy5zb21lKChlPT4hZS5lbGV2YXRpb25UaWxlKSl9Y2xlYXJFbGV2YXRpb25UaWxlcygpe2Zvcihjb25zdCBlIG9mIHRoaXMuZ2VvbWV0cnkuY29vcmRpbmF0ZXMpZS5lbGV2YXRpb25UaWxlIT09dGhpcy5vdXRzaWRlRXh0ZW50VGlsZSYmKGUuZWxldmF0aW9uVGlsZT1udWxsKX1wb3B1bGF0ZUVsZXZhdGlvblRpbGVzKGUpe2Zvcihjb25zdCB0IG9mIHRoaXMuZ2VvbWV0cnkuY29vcmRpbmF0ZXMpIXQuZWxldmF0aW9uVGlsZSYmdC50aWxlPy5pZCYmKHQuZWxldmF0aW9uVGlsZT1lW3QudGlsZS5pZF0pfXJlbWFwVGlsZXMoZSl7Zm9yKGNvbnN0IHQgb2YgdGhpcy5nZW9tZXRyeS5jb29yZGluYXRlcyl7Y29uc3QgaT10LnRpbGU/LmlkO3QudGlsZT1pP2VbaV06bnVsbH19Z2V0VGlsZXNUb0ZldGNoKCl7Y29uc3QgZT17fSx0PVtdO2Zvcihjb25zdCBpIG9mIHRoaXMuZ2VvbWV0cnkuY29vcmRpbmF0ZXMpe2NvbnN0IG49aS50aWxlO2lmKCFuKWNvbnRpbnVlO2NvbnN0IG89aS50aWxlPy5pZDtpLmVsZXZhdGlvblRpbGV8fCFvfHxlW29dfHwoZVtvXT1uLHQucHVzaChuKSl9cmV0dXJuIHR9Zm9yRWFjaFRpbGVUb0ZldGNoKGUpe2Zvcihjb25zdCB0IG9mIHRoaXMuZ2VvbWV0cnkuY29vcmRpbmF0ZXMpdC50aWxlJiYhdC5lbGV2YXRpb25UaWxlJiZlKHQudGlsZSwoKCk9Pnt0LnRpbGU9bnVsbH0pKX19Y2xhc3MgXyBleHRlbmRzIGd7Y29uc3RydWN0b3IoZSx0LGksbil7c3VwZXIoZSxpKSx0aGlzLnR5cGU9XCJleHRlbnRcIix0aGlzLmVsZXZhdGlvblRpbGVzPVtdLHRoaXMuX2NhbmRpZGF0ZVRpbGVzPVtdLHRoaXMuX2ZldGNoZWRDYW5kaWRhdGVzPW5ldyBTZXQsdGhpcy5leHRlbnQ9dC5jbG9uZSgpLmludGVyc2VjdGlvbihlLmZ1bGxFeHRlbnQpLHRoaXMubWFza0V4dGVudHM9bn1zZWxlY3RUaWxlc0F0TE9EKGUsdCl7Y29uc3QgaT10aGlzLl9tYXhpbXVtTG9kRm9yUmVxdWVzdHModCksbj1NYXRoLm1pbihpLGUpO248MD90aGlzLl9jYW5kaWRhdGVUaWxlcy5sZW5ndGg9MDp0aGlzLl9zZWxlY3RDYW5kaWRhdGVUaWxlc0NvdmVyaW5nRXh0ZW50QXQobil9X21heGltdW1Mb2RGb3JSZXF1ZXN0cyhlKXtjb25zdHt0aWxlSW5mbzp0LHRpbGVtYXBDYWNoZTppfT10aGlzLmxheWVyLG49RCh0LGkpO2lmKCFlKXJldHVybiBuLmxlbmd0aC0xO2NvbnN0IG89dGhpcy5leHRlbnQ7aWYobnVsbD09bylyZXR1cm4tMTtmb3IobGV0IGw9bi5sZW5ndGgtMTtsPj0wO2wtLSl7Y29uc3QgaT1uW2xdLHM9aS5yZXNvbHV0aW9uKnQuc2l6ZVswXSxhPWkucmVzb2x1dGlvbip0LnNpemVbMV07aWYoTWF0aC5jZWlsKG8ud2lkdGgvcykqTWF0aC5jZWlsKG8uaGVpZ2h0L2EpPD1lKXJldHVybiBsfXJldHVybi0xfWFsbEVsZXZhdGlvblRpbGVzRmV0Y2hlZCgpe3JldHVybiB0aGlzLl9jYW5kaWRhdGVUaWxlcy5sZW5ndGg9PT10aGlzLmVsZXZhdGlvblRpbGVzLmxlbmd0aH1jbGVhckVsZXZhdGlvblRpbGVzKCl7dGhpcy5lbGV2YXRpb25UaWxlcy5sZW5ndGg9MCx0aGlzLl9mZXRjaGVkQ2FuZGlkYXRlcy5jbGVhcigpfXBvcHVsYXRlRWxldmF0aW9uVGlsZXMoZSl7Zm9yKGNvbnN0IHQgb2YgdGhpcy5fY2FuZGlkYXRlVGlsZXMpe2NvbnN0IGk9dC5pZCYmZVt0LmlkXTtpJiYodGhpcy5fZmV0Y2hlZENhbmRpZGF0ZXMuYWRkKHQpLHRoaXMuZWxldmF0aW9uVGlsZXMucHVzaChpKSl9fXJlbWFwVGlsZXMoZSl7dGhpcy5fY2FuZGlkYXRlVGlsZXM9aih0aGlzLl9jYW5kaWRhdGVUaWxlcy5tYXAoKHQ9PmVbdC5pZF0pKSl9Z2V0VGlsZXNUb0ZldGNoKCl7cmV0dXJuIHRoaXMuX2NhbmRpZGF0ZVRpbGVzfWZvckVhY2hUaWxlVG9GZXRjaChlLHQpe2NvbnN0IGk9dGhpcy5fY2FuZGlkYXRlVGlsZXM7dGhpcy5fY2FuZGlkYXRlVGlsZXM9W10saS5mb3JFYWNoKChpPT57aWYodGhpcy5fZmV0Y2hlZENhbmRpZGF0ZXMuaGFzKGkpKXJldHVybiB2b2lkKHQmJnQoaSkpO2xldCBuPSExO2UoaSwoKCk9Pm49ITApKSxuP3QmJnQoaSk6dGhpcy5fY2FuZGlkYXRlVGlsZXMucHVzaChpKX0pKSx0aGlzLl9jYW5kaWRhdGVUaWxlcz1qKHRoaXMuX2NhbmRpZGF0ZVRpbGVzLHQpfV9zZWxlY3RDYW5kaWRhdGVUaWxlc0NvdmVyaW5nRXh0ZW50QXQoZSl7dGhpcy5fY2FuZGlkYXRlVGlsZXMubGVuZ3RoPTA7Y29uc3QgdD10aGlzLmV4dGVudDtpZihudWxsPT10KXJldHVybjtjb25zdHt0aWxlSW5mbzppLHRpbGVtYXBDYWNoZTpufT10aGlzLmxheWVyLG89RChpLG4pW2VdLGw9aS50aWxlQXQoby5sZXZlbCx0LnhtaW4sdC55bWluKSxzPWwuZXh0ZW50O2lmKG51bGw9PXMpcmV0dXJuO2NvbnN0IGE9by5yZXNvbHV0aW9uKmkuc2l6ZVswXSxyPW8ucmVzb2x1dGlvbippLnNpemVbMV0sYz1NYXRoLmNlaWwoKHQueG1heC1zWzBdKS9hKSx1PU1hdGguY2VpbCgodC55bWF4LXNbMV0pL3IpO2ZvcihsZXQgaD0wO2g8dTtoKyspZm9yKGxldCBlPTA7ZTxjO2UrKyl7Y29uc3QgdD1uZXcgeShudWxsLGwubGV2ZWwsbC5yb3ctaCxsLmNvbCtlKTtpLnVwZGF0ZVRpbGVJbmZvKHQpLHRoaXMuX3RpbGVJc01hc2tlZCh0KXx8dGhpcy5fY2FuZGlkYXRlVGlsZXMucHVzaCh0KX19X3RpbGVJc01hc2tlZChlKXtyZXR1cm4hIXRoaXMubWFza0V4dGVudHMmJnRoaXMubWFza0V4dGVudHMuc29tZSgodD0+ZS5leHRlbnQmJm0odCxlLmV4dGVudCkpKX19ZnVuY3Rpb24gRShlLHQsaT0wKXtjb25zdCBuPUQoZSx0KTtsZXQgbz1uLmxlbmd0aC0xO2lmKGk+MCl7Y29uc3QgdD1pL2woZS5zcGF0aWFsUmVmZXJlbmNlKSxzPW4uZmluZEluZGV4KChlPT5lLnJlc29sdXRpb248dCkpOzA9PT1zP289MDpzPjAmJihvPXMtMSl9cmV0dXJuIG99Y29uc3QgUj17bWF4aW11bUF1dG9UaWxlUmVxdWVzdHM6MjAsbm9EYXRhVmFsdWU6MCxyZXR1cm5TYW1wbGVJbmZvOiExLGRlbVJlc29sdXRpb246XCJhdXRvXCIsbWluRGVtUmVzb2x1dGlvbjowfTthc3luYyBmdW5jdGlvbiBxKGUsaSxuKXtsZXQgbztjb25zdCBsPWUubGF5ZXIudGlsZUluZm8uc3BhdGlhbFJlZmVyZW5jZTtpZihpIGluc3RhbmNlb2Ygdj9vPWF3YWl0IGkucHJvamVjdChsLG4pOihhd2FpdCBjKFt7c291cmNlOmkuc3BhdGlhbFJlZmVyZW5jZSxkZXN0Omx9XSx7c2lnbmFsOm59KSxvPXUoaSxsKSksIW8pdGhyb3cgbmV3IHQoXCJlbGV2YXRpb24tcXVlcnk6c3BhdGlhbC1yZWZlcmVuY2UtbWlzbWF0Y2hcIixgQ2Fubm90IHF1ZXJ5IGVsZXZhdGlvbiBpbiAnJHtpLnNwYXRpYWxSZWZlcmVuY2Uud2tpZH0nIG9uIGFuIGVsZXZhdGlvbiBzZXJ2aWNlIGluICcke2wud2tpZH0nYCk7ZS5nZW9tZXRyeT12LmZyb21HZW9tZXRyeShvKX1mdW5jdGlvbiBJKGUpe2lmKG51bGw9PWUubGF5ZXIuZnVsbEV4dGVudClyZXR1cm47Y29uc3QgdD1uZXcgZChudWxsKTt0LnNhbXBsZT0oKT0+ZS5vcHRpb25zLm5vRGF0YVZhbHVlLGUub3V0c2lkZUV4dGVudFRpbGU9dDtjb25zdCBpPWUubGF5ZXIuZnVsbEV4dGVudDtlLmdlb21ldHJ5LmNvb3JkaW5hdGVzLmZvckVhY2goKGU9Pntjb25zdCBuPWUueCxvPWUueTsobjxpLnhtaW58fG4+aS54bWF4fHxvPGkueW1pbnx8bz5pLnltYXgpJiYoZS5lbGV2YXRpb25UaWxlPXQpfSkpfWZ1bmN0aW9uIEEoZSx0KXtjb25zdHt0aWxlSW5mbzppLHRpbGVtYXBDYWNoZTpufT1lLmxheWVyLG89dC9sKGkuc3BhdGlhbFJlZmVyZW5jZSkscz1EKGksbik7bGV0IGE9c1swXSxyPTA7Zm9yKGxldCBsPTE7bDxzLmxlbmd0aDtsKyspe2NvbnN0IGU9c1tsXTtNYXRoLmFicyhlLnJlc29sdXRpb24tbyk8TWF0aC5hYnMoYS5yZXNvbHV0aW9uLW8pJiYoYT1lLHI9bCl9cmV0dXJuIHJ9ZnVuY3Rpb24gQyhlLHQpe2NvbnN0IGk9QShlLHQpO2Uuc2VsZWN0VGlsZXNBdExPRChpKX1mdW5jdGlvbiBNKGUpe2NvbnN0e3RpbGVJbmZvOnQsdGlsZW1hcENhY2hlOml9PWUubGF5ZXIsbj1FKHQsaSxlLm9wdGlvbnMubWluRGVtUmVzb2x1dGlvbik7ZS5zZWxlY3RUaWxlc0F0TE9EKG4sZS5vcHRpb25zLm1heGltdW1BdXRvVGlsZVJlcXVlc3RzKX1mdW5jdGlvbiBEKGUsdCl7Y29uc3QgaT1lLmxvZHM7aWYoTCh0KSl7Y29uc3R7ZWZmZWN0aXZlTWluTE9EOmUsZWZmZWN0aXZlTWF4TE9EOm59PXQ7cmV0dXJuIGkuZmlsdGVyKCh0PT50LmxldmVsPj1lJiZ0LmxldmVsPD1uKSl9cmV0dXJuIGl9YXN5bmMgZnVuY3Rpb24gRihlLHQpe2NvbnN0IGk9ZS5nZXRUaWxlc1RvRmV0Y2goKSxvPXt9LGw9ZS5vcHRpb25zLmNhY2hlLHM9ZS5vcHRpb25zLm5vRGF0YVZhbHVlLGE9aS5tYXAoKGFzeW5jIGk9PntpZihudWxsPT1pLmlkKXJldHVybjtjb25zdCBuPWAke2UubGF5ZXIudWlkfToke2kuaWR9OiR7c31gLGE9bnVsbCE9bD9sLmdldChuKTpudWxsLHI9bnVsbCE9YT9hOmF3YWl0IGUubGF5ZXIuZmV0Y2hUaWxlKGkubGV2ZWwsaS5yb3csaS5jb2wse25vRGF0YVZhbHVlOnMsc2lnbmFsOnR9KTtudWxsIT1sJiZsLnB1dChuLHIpLG9baS5pZF09bmV3IGQoaSxyKX0pKTthd2FpdCBuKFByb21pc2UuYWxsU2V0dGxlZChhKSx0KSxlLnBvcHVsYXRlRWxldmF0aW9uVGlsZXMobyl9ZnVuY3Rpb24gUyhlKXtjb25zdCB0PWUubGF5ZXIudGlsZUluZm87bGV0IGk9MDtjb25zdCBuPXt9LG89ZT0+e251bGwhPWUuaWQmJihlLmlkIGluIG4/bltlLmlkXSsrOihuW2UuaWRdPTEsaSsrKSl9LGw9ZT0+e2lmKG51bGw9PWUuaWQpcmV0dXJuO2NvbnN0IHQ9bltlLmlkXTsxPT09dD8oZGVsZXRlIG5bZS5pZF0saS0tKTpuW2UuaWRdPXQtMX07ZS5mb3JFYWNoVGlsZVRvRmV0Y2gobyxsKTtsZXQgcz0hMDtmb3IoO3MmJihzPSExLGUuZm9yRWFjaFRpbGVUb0ZldGNoKChuPT57aTw9ZS5vcHRpb25zLm1heGltdW1BdXRvVGlsZVJlcXVlc3RzfHwobChuKSx0LnVwc2FtcGxlVGlsZShuKSYmKHM9ITApLG8obikpfSksbCkscyk7KTt9ZnVuY3Rpb24gYihlKXtlLmdlb21ldHJ5LmNvb3JkaW5hdGVzLmZvckVhY2goKHQ9Pntjb25zdCBpPXQuZWxldmF0aW9uVGlsZTtsZXQgbj1lLm9wdGlvbnMubm9EYXRhVmFsdWU7aWYoaSl7Y29uc3QgZT1pLnNhbXBsZSh0LngsdC55KTtudWxsIT1lP249ZTp0LmVsZXZhdGlvblRpbGU9bnVsbH10Lno9bn0pKX1mdW5jdGlvbiBqKGUsdCl7Y29uc3QgaT17fSxuPVtdO2Zvcihjb25zdCBsIG9mIGUpe2NvbnN0IGU9bC5pZDtlJiYhaVtlXT8oaVtlXT1sLG4ucHVzaChsKSk6dCYmdChsKX1jb25zdCBvPW4uc29ydCgoKGUsdCk9PmUubGV2ZWwtdC5sZXZlbCkpO3JldHVybiBvLmZpbHRlcigoKGUsaSk9Pntmb3IobGV0IG49MDtuPGk7bisrKXtjb25zdCBpPW9bbl0uZXh0ZW50O2lmKGkmJmUuZXh0ZW50JiZtKGksZS5leHRlbnQpKXJldHVybiB0JiZ0KGUpLCExfXJldHVybiEwfSkpfWFzeW5jIGZ1bmN0aW9uIHooZSx0KXtjb25zdCBuPWF3YWl0IGUuZ2VvbWV0cnkucHJvamVjdChlLm91dFNwYXRpYWxSZWZlcmVuY2UsdCk7aShuKTtjb25zdCBvPXtnZW9tZXRyeTpuLmV4cG9ydCgpLG5vRGF0YVZhbHVlOmUub3B0aW9ucy5ub0RhdGFWYWx1ZX07cmV0dXJuIGUub3B0aW9ucy5yZXR1cm5TYW1wbGVJbmZvJiYoby5zYW1wbGVJbmZvPWsoZSkpLGUuZ2VvbWV0cnkuY29vcmRpbmF0ZXMuZm9yRWFjaCgoZT0+e2UudGlsZT1udWxsLGUuZWxldmF0aW9uVGlsZT1udWxsfSkpLG99ZnVuY3Rpb24gayhlKXtjb25zdCB0PWUubGF5ZXIudGlsZUluZm8saT1sKHQuc3BhdGlhbFJlZmVyZW5jZSk7cmV0dXJuIGUuZ2VvbWV0cnkuY29vcmRpbmF0ZXMubWFwKChuPT57bGV0IG89LTE7aWYobi5lbGV2YXRpb25UaWxlJiZuLmVsZXZhdGlvblRpbGUhPT1lLm91dHNpZGVFeHRlbnRUaWxlKXtvPXQubG9kQXQobi5lbGV2YXRpb25UaWxlLnRpbGUubGV2ZWwpLnJlc29sdXRpb24qaX1yZXR1cm57ZGVtUmVzb2x1dGlvbjpvfX0pKX1mdW5jdGlvbiBMKGUpe3JldHVybiBudWxsIT1lPy50aWxlSW5mb31leHBvcnR7VCBhcyBFbGV2YXRpb25RdWVyeSx2IGFzIEdlb21ldHJ5RGVzY3JpcHRvcixFIGFzIGdldEZpbmVzdExvZEluZGV4fTtcbiIsIi8qXG5BbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuU2VlIGh0dHBzOi8vanMuYXJjZ2lzLmNvbS80LjMzL2VzcmkvY29weXJpZ2h0LnR4dCBmb3IgZGV0YWlscy5cbiovXG5pbXBvcnR7RWxldmF0aW9uU2FtcGxlckRhdGEgYXMgYX1mcm9tXCIuL0VsZXZhdGlvblNhbXBsZXJEYXRhLmpzXCI7Y2xhc3MgdHtjb25zdHJ1Y3Rvcih0LGw9bnVsbCl7aWYodGhpcy50aWxlPXQsbnVsbCE9bCYmbnVsbCE9dCl7Y29uc3QgZT10LmV4dGVudDt0aGlzLl9zYW1wbGVyRGF0YT1uZXcgYShsLGUpfX1nZXQgem1pbigpe3JldHVybiBudWxsIT10aGlzLl9zYW1wbGVyRGF0YT90aGlzLl9zYW1wbGVyRGF0YS5kYXRhLm1pblZhbHVlOjB9Z2V0IHptYXgoKXtyZXR1cm4gbnVsbCE9dGhpcy5fc2FtcGxlckRhdGE/dGhpcy5fc2FtcGxlckRhdGEuZGF0YS5tYXhWYWx1ZTowfWdldCBoYXNOb0RhdGFWYWx1ZXMoKXtyZXR1cm4hIXRoaXMuX3NhbXBsZXJEYXRhPy5kYXRhLmhhc05vRGF0YVZhbHVlc31zYW1wbGUoYSx0KXtpZihudWxsPT10aGlzLl9zYW1wbGVyRGF0YSlyZXR1cm47Y29uc3R7c2FmZVdpZHRoOmUsZGF0YTpzLGR4OnIsZHk6bix5MTppLHgwOnV9PXRoaXMuX3NhbXBsZXJEYXRhLHt3aWR0aDpvLHZhbHVlczptLG5vRGF0YVZhbHVlOmh9PXMscD1sKG4qKGktdCksMCxlKSxEPWwociooYS11KSwwLGUpLGQ9TWF0aC5mbG9vcihwKSxmPU1hdGguZmxvb3IoRCksXz1kKm8rZixjPV8rbyx4PW1bX10sVj1tW2NdLGc9bVtfKzFdLHY9bVtjKzFdO2lmKHghPT1oJiZWIT09aCYmZyE9PWgmJnYhPT1oKXtjb25zdCBhPUQtZix0PXgrKGcteCkqYTtyZXR1cm4gdCsoVisodi1WKSphLXQpKihwLWQpfX19ZnVuY3Rpb24gbChhLHQsbCl7cmV0dXJuIGE8dD90OmE+bD9sOmF9ZXhwb3J0e3QgYXMgRWxldmF0aW9uVGlsZX07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=