export const __webpack_id__ = "vendors-node_modules_esri_calcite-components_dist_components_calcite-dialog_index_js";
export const __webpack_ids__ = ["vendors-node_modules_esri_calcite-components_dist_components_calcite-dialog_index_js"];
export const __webpack_modules__ = {

/***/ "./node_modules/@esri/calcite-components/dist/chunks/dynamicClasses.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/chunks/dynamicClasses.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   g: () => (/* binding */ getDimensionClass)
/* harmony export */ });
/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */
function getDimensionClass(type, size, scale) {
  return size ? `${type}-${size}` : scale ? `${type}-${scale}` : `${type}-m`;
}



/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/chunks/interact.min.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/chunks/interact.min.js ***!
  \***************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   i: () => (/* binding */ interact)
/* harmony export */ });
/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */
function getDefaultExportFromCjs(x) {
  return x && x.__esModule && Object.prototype.hasOwnProperty.call(x, "default") ? x["default"] : x;
}
var interact_min$1 = { exports: {} };
var interact_min = interact_min$1.exports;
var hasRequiredInteract_min;
function requireInteract_min() {
  if (hasRequiredInteract_min) return interact_min$1.exports;
  hasRequiredInteract_min = 1;
  (function(module, exports) {
    !function(t, e) {
      module.exports = e();
    }(interact_min, function() {
      function t(t2, e2) {
        var n2 = Object.keys(t2);
        if (Object.getOwnPropertySymbols) {
          var r2 = Object.getOwnPropertySymbols(t2);
          e2 && (r2 = r2.filter(function(e3) {
            return Object.getOwnPropertyDescriptor(t2, e3).enumerable;
          })), n2.push.apply(n2, r2);
        }
        return n2;
      }
      function e(e2) {
        for (var n2 = 1; n2 < arguments.length; n2++) {
          var r2 = null != arguments[n2] ? arguments[n2] : {};
          n2 % 2 ? t(Object(r2), true).forEach(function(t2) {
            a(e2, t2, r2[t2]);
          }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e2, Object.getOwnPropertyDescriptors(r2)) : t(Object(r2)).forEach(function(t2) {
            Object.defineProperty(e2, t2, Object.getOwnPropertyDescriptor(r2, t2));
          });
        }
        return e2;
      }
      function n(t2) {
        return n = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(t3) {
          return typeof t3;
        } : function(t3) {
          return t3 && "function" == typeof Symbol && t3.constructor === Symbol && t3 !== Symbol.prototype ? "symbol" : typeof t3;
        }, n(t2);
      }
      function r(t2, e2) {
        if (!(t2 instanceof e2)) throw new TypeError("Cannot call a class as a function");
      }
      function i(t2, e2) {
        for (var n2 = 0; n2 < e2.length; n2++) {
          var r2 = e2[n2];
          r2.enumerable = r2.enumerable || false, r2.configurable = true, "value" in r2 && (r2.writable = true), Object.defineProperty(t2, d(r2.key), r2);
        }
      }
      function o(t2, e2, n2) {
        return e2 && i(t2.prototype, e2), Object.defineProperty(t2, "prototype", { writable: false }), t2;
      }
      function a(t2, e2, n2) {
        return (e2 = d(e2)) in t2 ? Object.defineProperty(t2, e2, { value: n2, enumerable: true, configurable: true, writable: true }) : t2[e2] = n2, t2;
      }
      function s(t2, e2) {
        if ("function" != typeof e2 && null !== e2) throw new TypeError("Super expression must either be null or a function");
        t2.prototype = Object.create(e2 && e2.prototype, { constructor: { value: t2, writable: true, configurable: true } }), Object.defineProperty(t2, "prototype", { writable: false }), e2 && l(t2, e2);
      }
      function c(t2) {
        return c = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function(t3) {
          return t3.__proto__ || Object.getPrototypeOf(t3);
        }, c(t2);
      }
      function l(t2, e2) {
        return l = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function(t3, e3) {
          return t3.__proto__ = e3, t3;
        }, l(t2, e2);
      }
      function u(t2) {
        if (void 0 === t2) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return t2;
      }
      function p(t2) {
        var e2 = function() {
          if ("undefined" == typeof Reflect || !Reflect.construct) return false;
          if (Reflect.construct.sham) return false;
          if ("function" == typeof Proxy) return true;
          try {
            return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
            })), true;
          } catch (t3) {
            return false;
          }
        }();
        return function() {
          var n2, r2 = c(t2);
          if (e2) {
            var i2 = c(this).constructor;
            n2 = Reflect.construct(r2, arguments, i2);
          } else n2 = r2.apply(this, arguments);
          return function(t3, e3) {
            if (e3 && ("object" == typeof e3 || "function" == typeof e3)) return e3;
            if (void 0 !== e3) throw new TypeError("Derived constructors may only return object or undefined");
            return u(t3);
          }(this, n2);
        };
      }
      function f() {
        return f = "undefined" != typeof Reflect && Reflect.get ? Reflect.get.bind() : function(t2, e2, n2) {
          var r2 = function(t3, e3) {
            for (; !Object.prototype.hasOwnProperty.call(t3, e3) && null !== (t3 = c(t3)); ) ;
            return t3;
          }(t2, e2);
          if (r2) {
            var i2 = Object.getOwnPropertyDescriptor(r2, e2);
            return i2.get ? i2.get.call(arguments.length < 3 ? t2 : n2) : i2.value;
          }
        }, f.apply(this, arguments);
      }
      function d(t2) {
        var e2 = function(t3, e3) {
          if ("object" != typeof t3 || null === t3) return t3;
          var n2 = t3[Symbol.toPrimitive];
          if (void 0 !== n2) {
            var r2 = n2.call(t3, e3);
            if ("object" != typeof r2) return r2;
            throw new TypeError("@@toPrimitive must return a primitive value.");
          }
          return String(t3);
        }(t2, "string");
        return "symbol" == typeof e2 ? e2 : e2 + "";
      }
      var h = function(t2) {
        return !(!t2 || !t2.Window) && t2 instanceof t2.Window;
      }, v = void 0, g = void 0;
      function m(t2) {
        v = t2;
        var e2 = t2.document.createTextNode("");
        e2.ownerDocument !== t2.document && "function" == typeof t2.wrap && t2.wrap(e2) === e2 && (t2 = t2.wrap(t2)), g = t2;
      }
      function y(t2) {
        return h(t2) ? t2 : (t2.ownerDocument || t2).defaultView || g.window;
      }
      "undefined" != typeof window && window && m(window);
      var b = function(t2) {
        return !!t2 && "object" === n(t2);
      }, x = function(t2) {
        return "function" == typeof t2;
      }, w = { window: function(t2) {
        return t2 === g || h(t2);
      }, docFrag: function(t2) {
        return b(t2) && 11 === t2.nodeType;
      }, object: b, func: x, number: function(t2) {
        return "number" == typeof t2;
      }, bool: function(t2) {
        return "boolean" == typeof t2;
      }, string: function(t2) {
        return "string" == typeof t2;
      }, element: function(t2) {
        if (!t2 || "object" !== n(t2)) return false;
        var e2 = y(t2) || g;
        return /object|function/.test("undefined" == typeof Element ? "undefined" : n(Element)) ? t2 instanceof Element || t2 instanceof e2.Element : 1 === t2.nodeType && "string" == typeof t2.nodeName;
      }, plainObject: function(t2) {
        return b(t2) && !!t2.constructor && /function Object\b/.test(t2.constructor.toString());
      }, array: function(t2) {
        return b(t2) && void 0 !== t2.length && x(t2.splice);
      } };
      function E(t2) {
        var e2 = t2.interaction;
        if ("drag" === e2.prepared.name) {
          var n2 = e2.prepared.axis;
          "x" === n2 ? (e2.coords.cur.page.y = e2.coords.start.page.y, e2.coords.cur.client.y = e2.coords.start.client.y, e2.coords.velocity.client.y = 0, e2.coords.velocity.page.y = 0) : "y" === n2 && (e2.coords.cur.page.x = e2.coords.start.page.x, e2.coords.cur.client.x = e2.coords.start.client.x, e2.coords.velocity.client.x = 0, e2.coords.velocity.page.x = 0);
        }
      }
      function T(t2) {
        var e2 = t2.iEvent, n2 = t2.interaction;
        if ("drag" === n2.prepared.name) {
          var r2 = n2.prepared.axis;
          if ("x" === r2 || "y" === r2) {
            var i2 = "x" === r2 ? "y" : "x";
            e2.page[i2] = n2.coords.start.page[i2], e2.client[i2] = n2.coords.start.client[i2], e2.delta[i2] = 0;
          }
        }
      }
      var S = { id: "actions/drag", install: function(t2) {
        var e2 = t2.actions, n2 = t2.Interactable, r2 = t2.defaults;
        n2.prototype.draggable = S.draggable, e2.map.drag = S, e2.methodDict.drag = "draggable", r2.actions.drag = S.defaults;
      }, listeners: { "interactions:before-action-move": E, "interactions:action-resume": E, "interactions:action-move": T, "auto-start:check": function(t2) {
        var e2 = t2.interaction, n2 = t2.interactable, r2 = t2.buttons, i2 = n2.options.drag;
        if (i2 && i2.enabled && (!e2.pointerIsDown || !/mouse|pointer/.test(e2.pointerType) || 0 != (r2 & n2.options.drag.mouseButtons))) return t2.action = { name: "drag", axis: "start" === i2.lockAxis ? i2.startAxis : i2.lockAxis }, false;
      } }, draggable: function(t2) {
        return w.object(t2) ? (this.options.drag.enabled = false !== t2.enabled, this.setPerAction("drag", t2), this.setOnEvents("drag", t2), /^(xy|x|y|start)$/.test(t2.lockAxis) && (this.options.drag.lockAxis = t2.lockAxis), /^(xy|x|y)$/.test(t2.startAxis) && (this.options.drag.startAxis = t2.startAxis), this) : w.bool(t2) ? (this.options.drag.enabled = t2, this) : this.options.drag;
      }, beforeMove: E, move: T, defaults: { startAxis: "xy", lockAxis: "xy" }, getCursor: function() {
        return "move";
      }, filterEventType: function(t2) {
        return 0 === t2.search("drag");
      } }, _ = S, P = { init: function(t2) {
        var e2 = t2;
        P.document = e2.document, P.DocumentFragment = e2.DocumentFragment || O, P.SVGElement = e2.SVGElement || O, P.SVGSVGElement = e2.SVGSVGElement || O, P.SVGElementInstance = e2.SVGElementInstance || O, P.Element = e2.Element || O, P.HTMLElement = e2.HTMLElement || P.Element, P.Event = e2.Event, P.Touch = e2.Touch || O, P.PointerEvent = e2.PointerEvent || e2.MSPointerEvent;
      }, document: null, DocumentFragment: null, SVGElement: null, SVGSVGElement: null, SVGElementInstance: null, Element: null, HTMLElement: null, Event: null, Touch: null, PointerEvent: null };
      function O() {
      }
      var k = P;
      var D = { init: function(t2) {
        var e2 = k.Element, n2 = t2.navigator || {};
        D.supportsTouch = "ontouchstart" in t2 || w.func(t2.DocumentTouch) && k.document instanceof t2.DocumentTouch, D.supportsPointerEvent = false !== n2.pointerEnabled && !!k.PointerEvent, D.isIOS = /iP(hone|od|ad)/.test(n2.platform), D.isIOS7 = /iP(hone|od|ad)/.test(n2.platform) && /OS 7[^\d]/.test(n2.appVersion), D.isIe9 = /MSIE 9/.test(n2.userAgent), D.isOperaMobile = "Opera" === n2.appName && D.supportsTouch && /Presto/.test(n2.userAgent), D.prefixedMatchesSelector = "matches" in e2.prototype ? "matches" : "webkitMatchesSelector" in e2.prototype ? "webkitMatchesSelector" : "mozMatchesSelector" in e2.prototype ? "mozMatchesSelector" : "oMatchesSelector" in e2.prototype ? "oMatchesSelector" : "msMatchesSelector", D.pEventTypes = D.supportsPointerEvent ? k.PointerEvent === t2.MSPointerEvent ? { up: "MSPointerUp", down: "MSPointerDown", over: "mouseover", out: "mouseout", move: "MSPointerMove", cancel: "MSPointerCancel" } : { up: "pointerup", down: "pointerdown", over: "pointerover", out: "pointerout", move: "pointermove", cancel: "pointercancel" } : null, D.wheelEvent = k.document && "onmousewheel" in k.document ? "mousewheel" : "wheel";
      }, supportsTouch: null, supportsPointerEvent: null, isIOS7: null, isIOS: null, isIe9: null, isOperaMobile: null, prefixedMatchesSelector: null, pEventTypes: null, wheelEvent: null };
      var I = D;
      function M(t2, e2) {
        if (t2.contains) return t2.contains(e2);
        for (; e2; ) {
          if (e2 === t2) return true;
          e2 = e2.parentNode;
        }
        return false;
      }
      function z(t2, e2) {
        for (; w.element(t2); ) {
          if (R(t2, e2)) return t2;
          t2 = A(t2);
        }
        return null;
      }
      function A(t2) {
        var e2 = t2.parentNode;
        if (w.docFrag(e2)) {
          for (; (e2 = e2.host) && w.docFrag(e2); ) ;
          return e2;
        }
        return e2;
      }
      function R(t2, e2) {
        return g !== v && (e2 = e2.replace(/\/deep\//g, " ")), t2[I.prefixedMatchesSelector](e2);
      }
      var C = function(t2) {
        return t2.parentNode || t2.host;
      };
      function j(t2, e2) {
        for (var n2, r2 = [], i2 = t2; (n2 = C(i2)) && i2 !== e2 && n2 !== i2.ownerDocument; ) r2.unshift(i2), i2 = n2;
        return r2;
      }
      function F(t2, e2, n2) {
        for (; w.element(t2); ) {
          if (R(t2, e2)) return true;
          if ((t2 = A(t2)) === n2) return R(t2, e2);
        }
        return false;
      }
      function X(t2) {
        return t2.correspondingUseElement || t2;
      }
      function Y(t2) {
        var e2 = t2 instanceof k.SVGElement ? t2.getBoundingClientRect() : t2.getClientRects()[0];
        return e2 && { left: e2.left, right: e2.right, top: e2.top, bottom: e2.bottom, width: e2.width || e2.right - e2.left, height: e2.height || e2.bottom - e2.top };
      }
      function L(t2) {
        var e2, n2 = Y(t2);
        if (!I.isIOS7 && n2) {
          var r2 = { x: (e2 = (e2 = y(t2)) || g).scrollX || e2.document.documentElement.scrollLeft, y: e2.scrollY || e2.document.documentElement.scrollTop };
          n2.left += r2.x, n2.right += r2.x, n2.top += r2.y, n2.bottom += r2.y;
        }
        return n2;
      }
      function q(t2) {
        for (var e2 = []; t2; ) e2.push(t2), t2 = A(t2);
        return e2;
      }
      function B(t2) {
        return !!w.string(t2) && (k.document.querySelector(t2), true);
      }
      function V(t2, e2) {
        for (var n2 in e2) t2[n2] = e2[n2];
        return t2;
      }
      function W(t2, e2, n2) {
        return "parent" === t2 ? A(n2) : "self" === t2 ? e2.getRect(n2) : z(n2, t2);
      }
      function G(t2, e2, n2, r2) {
        var i2 = t2;
        return w.string(i2) ? i2 = W(i2, e2, n2) : w.func(i2) && (i2 = i2.apply(void 0, r2)), w.element(i2) && (i2 = L(i2)), i2;
      }
      function N(t2) {
        return t2 && { x: "x" in t2 ? t2.x : t2.left, y: "y" in t2 ? t2.y : t2.top };
      }
      function U(t2) {
        return !t2 || "x" in t2 && "y" in t2 || ((t2 = V({}, t2)).x = t2.left || 0, t2.y = t2.top || 0, t2.width = t2.width || (t2.right || 0) - t2.x, t2.height = t2.height || (t2.bottom || 0) - t2.y), t2;
      }
      function H(t2, e2, n2) {
        t2.left && (e2.left += n2.x), t2.right && (e2.right += n2.x), t2.top && (e2.top += n2.y), t2.bottom && (e2.bottom += n2.y), e2.width = e2.right - e2.left, e2.height = e2.bottom - e2.top;
      }
      function K(t2, e2, n2) {
        var r2 = n2 && t2.options[n2];
        return N(G(r2 && r2.origin || t2.options.origin, t2, e2, [t2 && e2])) || { x: 0, y: 0 };
      }
      function $(t2, e2) {
        var n2 = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : function(t3) {
          return true;
        }, r2 = arguments.length > 3 ? arguments[3] : void 0;
        if (r2 = r2 || {}, w.string(t2) && -1 !== t2.search(" ") && (t2 = J(t2)), w.array(t2)) return t2.forEach(function(t3) {
          return $(t3, e2, n2, r2);
        }), r2;
        if (w.object(t2) && (e2 = t2, t2 = ""), w.func(e2) && n2(t2)) r2[t2] = r2[t2] || [], r2[t2].push(e2);
        else if (w.array(e2)) for (var i2 = 0, o2 = e2; i2 < o2.length; i2++) {
          var a2 = o2[i2];
          $(t2, a2, n2, r2);
        }
        else if (w.object(e2)) for (var s2 in e2) {
          $(J(s2).map(function(e3) {
            return "".concat(t2).concat(e3);
          }), e2[s2], n2, r2);
        }
        return r2;
      }
      function J(t2) {
        return t2.trim().split(/ +/);
      }
      var Q = function(t2, e2) {
        return Math.sqrt(t2 * t2 + e2 * e2);
      }, Z = ["webkit", "moz"];
      function tt(t2, e2) {
        t2.__set || (t2.__set = {});
        var n2 = function(n3) {
          if (Z.some(function(t3) {
            return 0 === n3.indexOf(t3);
          })) return 1;
          "function" != typeof t2[n3] && "__set" !== n3 && Object.defineProperty(t2, n3, { get: function() {
            return n3 in t2.__set ? t2.__set[n3] : t2.__set[n3] = e2[n3];
          }, set: function(e3) {
            t2.__set[n3] = e3;
          }, configurable: true });
        };
        for (var r2 in e2) n2(r2);
        return t2;
      }
      function et(t2, e2) {
        t2.page = t2.page || {}, t2.page.x = e2.page.x, t2.page.y = e2.page.y, t2.client = t2.client || {}, t2.client.x = e2.client.x, t2.client.y = e2.client.y, t2.timeStamp = e2.timeStamp;
      }
      function nt(t2) {
        t2.page.x = 0, t2.page.y = 0, t2.client.x = 0, t2.client.y = 0;
      }
      function rt(t2) {
        return t2 instanceof k.Event || t2 instanceof k.Touch;
      }
      function it(t2, e2, n2) {
        return t2 = t2 || "page", (n2 = n2 || {}).x = e2[t2 + "X"], n2.y = e2[t2 + "Y"], n2;
      }
      function ot(t2, e2) {
        return e2 = e2 || { x: 0, y: 0 }, I.isOperaMobile && rt(t2) ? (it("screen", t2, e2), e2.x += window.scrollX, e2.y += window.scrollY) : it("page", t2, e2), e2;
      }
      function at(t2) {
        return w.number(t2.pointerId) ? t2.pointerId : t2.identifier;
      }
      function st(t2, e2, n2) {
        var r2 = e2.length > 1 ? lt(e2) : e2[0];
        ot(r2, t2.page), function(t3, e3) {
          e3 = e3 || {}, I.isOperaMobile && rt(t3) ? it("screen", t3, e3) : it("client", t3, e3);
        }(r2, t2.client), t2.timeStamp = n2;
      }
      function ct(t2) {
        var e2 = [];
        return w.array(t2) ? (e2[0] = t2[0], e2[1] = t2[1]) : "touchend" === t2.type ? 1 === t2.touches.length ? (e2[0] = t2.touches[0], e2[1] = t2.changedTouches[0]) : 0 === t2.touches.length && (e2[0] = t2.changedTouches[0], e2[1] = t2.changedTouches[1]) : (e2[0] = t2.touches[0], e2[1] = t2.touches[1]), e2;
      }
      function lt(t2) {
        for (var e2 = { pageX: 0, pageY: 0, clientX: 0, clientY: 0, screenX: 0, screenY: 0 }, n2 = 0; n2 < t2.length; n2++) {
          var r2 = t2[n2];
          for (var i2 in e2) e2[i2] += r2[i2];
        }
        for (var o2 in e2) e2[o2] /= t2.length;
        return e2;
      }
      function ut(t2) {
        if (!t2.length) return null;
        var e2 = ct(t2), n2 = Math.min(e2[0].pageX, e2[1].pageX), r2 = Math.min(e2[0].pageY, e2[1].pageY), i2 = Math.max(e2[0].pageX, e2[1].pageX), o2 = Math.max(e2[0].pageY, e2[1].pageY);
        return { x: n2, y: r2, left: n2, top: r2, right: i2, bottom: o2, width: i2 - n2, height: o2 - r2 };
      }
      function pt(t2, e2) {
        var n2 = e2 + "X", r2 = e2 + "Y", i2 = ct(t2), o2 = i2[0][n2] - i2[1][n2], a2 = i2[0][r2] - i2[1][r2];
        return Q(o2, a2);
      }
      function ft(t2, e2) {
        var n2 = e2 + "X", r2 = e2 + "Y", i2 = ct(t2), o2 = i2[1][n2] - i2[0][n2], a2 = i2[1][r2] - i2[0][r2];
        return 180 * Math.atan2(a2, o2) / Math.PI;
      }
      function dt(t2) {
        return w.string(t2.pointerType) ? t2.pointerType : w.number(t2.pointerType) ? [void 0, void 0, "touch", "pen", "mouse"][t2.pointerType] : /touch/.test(t2.type || "") || t2 instanceof k.Touch ? "touch" : "mouse";
      }
      function ht(t2) {
        var e2 = w.func(t2.composedPath) ? t2.composedPath() : t2.path;
        return [X(e2 ? e2[0] : t2.target), X(t2.currentTarget)];
      }
      var vt = function() {
        function t2(e2) {
          r(this, t2), this.immediatePropagationStopped = false, this.propagationStopped = false, this._interaction = e2;
        }
        return o(t2, [{ key: "preventDefault", value: function() {
        } }, { key: "stopPropagation", value: function() {
          this.propagationStopped = true;
        } }, { key: "stopImmediatePropagation", value: function() {
          this.immediatePropagationStopped = this.propagationStopped = true;
        } }]), t2;
      }();
      Object.defineProperty(vt.prototype, "interaction", { get: function() {
        return this._interaction._proxy;
      }, set: function() {
      } });
      var gt = function(t2, e2) {
        for (var n2 = 0; n2 < e2.length; n2++) {
          var r2 = e2[n2];
          t2.push(r2);
        }
        return t2;
      }, mt = function(t2) {
        return gt([], t2);
      }, yt = function(t2, e2) {
        for (var n2 = 0; n2 < t2.length; n2++) if (e2(t2[n2], n2, t2)) return n2;
        return -1;
      }, bt = function(t2, e2) {
        return t2[yt(t2, e2)];
      }, xt = function(t2) {
        s(n2, t2);
        var e2 = p(n2);
        function n2(t3, i2, o2) {
          var a2;
          r(this, n2), (a2 = e2.call(this, i2._interaction)).dropzone = void 0, a2.dragEvent = void 0, a2.relatedTarget = void 0, a2.draggable = void 0, a2.propagationStopped = false, a2.immediatePropagationStopped = false;
          var s2 = "dragleave" === o2 ? t3.prev : t3.cur, c2 = s2.element, l2 = s2.dropzone;
          return a2.type = o2, a2.target = c2, a2.currentTarget = c2, a2.dropzone = l2, a2.dragEvent = i2, a2.relatedTarget = i2.target, a2.draggable = i2.interactable, a2.timeStamp = i2.timeStamp, a2;
        }
        return o(n2, [{ key: "reject", value: function() {
          var t3 = this, e3 = this._interaction.dropState;
          if ("dropactivate" === this.type || this.dropzone && e3.cur.dropzone === this.dropzone && e3.cur.element === this.target) if (e3.prev.dropzone = this.dropzone, e3.prev.element = this.target, e3.rejected = true, e3.events.enter = null, this.stopImmediatePropagation(), "dropactivate" === this.type) {
            var r2 = e3.activeDrops, i2 = yt(r2, function(e4) {
              var n3 = e4.dropzone, r3 = e4.element;
              return n3 === t3.dropzone && r3 === t3.target;
            });
            e3.activeDrops.splice(i2, 1);
            var o2 = new n2(e3, this.dragEvent, "dropdeactivate");
            o2.dropzone = this.dropzone, o2.target = this.target, this.dropzone.fire(o2);
          } else this.dropzone.fire(new n2(e3, this.dragEvent, "dragleave"));
        } }, { key: "preventDefault", value: function() {
        } }, { key: "stopPropagation", value: function() {
          this.propagationStopped = true;
        } }, { key: "stopImmediatePropagation", value: function() {
          this.immediatePropagationStopped = this.propagationStopped = true;
        } }]), n2;
      }(vt);
      function wt(t2, e2) {
        for (var n2 = 0, r2 = t2.slice(); n2 < r2.length; n2++) {
          var i2 = r2[n2], o2 = i2.dropzone, a2 = i2.element;
          e2.dropzone = o2, e2.target = a2, o2.fire(e2), e2.propagationStopped = e2.immediatePropagationStopped = false;
        }
      }
      function Et(t2, e2) {
        for (var n2 = function(t3, e3) {
          for (var n3 = [], r3 = 0, i3 = t3.interactables.list; r3 < i3.length; r3++) {
            var o2 = i3[r3];
            if (o2.options.drop.enabled) {
              var a2 = o2.options.drop.accept;
              if (!(w.element(a2) && a2 !== e3 || w.string(a2) && !R(e3, a2) || w.func(a2) && !a2({ dropzone: o2, draggableElement: e3 }))) for (var s2 = 0, c2 = o2.getAllElements(); s2 < c2.length; s2++) {
                var l2 = c2[s2];
                l2 !== e3 && n3.push({ dropzone: o2, element: l2, rect: o2.getRect(l2) });
              }
            }
          }
          return n3;
        }(t2, e2), r2 = 0; r2 < n2.length; r2++) {
          var i2 = n2[r2];
          i2.rect = i2.dropzone.getRect(i2.element);
        }
        return n2;
      }
      function Tt(t2, e2, n2) {
        for (var r2 = t2.dropState, i2 = t2.interactable, o2 = t2.element, a2 = [], s2 = 0, c2 = r2.activeDrops; s2 < c2.length; s2++) {
          var l2 = c2[s2], u2 = l2.dropzone, p2 = l2.element, f2 = l2.rect, d2 = u2.dropCheck(e2, n2, i2, o2, p2, f2);
          a2.push(d2 ? p2 : null);
        }
        var h2 = function(t3) {
          for (var e3, n3, r3, i3 = [], o3 = 0; o3 < t3.length; o3++) {
            var a3 = t3[o3], s3 = t3[e3];
            if (a3 && o3 !== e3) if (s3) {
              var c3 = C(a3), l3 = C(s3);
              if (c3 !== a3.ownerDocument) if (l3 !== a3.ownerDocument) if (c3 !== l3) {
                i3 = i3.length ? i3 : j(s3);
                var u3 = void 0;
                if (s3 instanceof k.HTMLElement && a3 instanceof k.SVGElement && !(a3 instanceof k.SVGSVGElement)) {
                  if (a3 === l3) continue;
                  u3 = a3.ownerSVGElement;
                } else u3 = a3;
                for (var p3 = j(u3, s3.ownerDocument), f3 = 0; p3[f3] && p3[f3] === i3[f3]; ) f3++;
                var d3 = [p3[f3 - 1], p3[f3], i3[f3]];
                if (d3[0]) for (var h3 = d3[0].lastChild; h3; ) {
                  if (h3 === d3[1]) {
                    e3 = o3, i3 = p3;
                    break;
                  }
                  if (h3 === d3[2]) break;
                  h3 = h3.previousSibling;
                }
              } else r3 = s3, (parseInt(y(n3 = a3).getComputedStyle(n3).zIndex, 10) || 0) >= (parseInt(y(r3).getComputedStyle(r3).zIndex, 10) || 0) && (e3 = o3);
              else e3 = o3;
            } else e3 = o3;
          }
          return e3;
        }(a2);
        return r2.activeDrops[h2] || null;
      }
      function St(t2, e2, n2) {
        var r2 = t2.dropState, i2 = { enter: null, leave: null, activate: null, deactivate: null, move: null, drop: null };
        return "dragstart" === n2.type && (i2.activate = new xt(r2, n2, "dropactivate"), i2.activate.target = null, i2.activate.dropzone = null), "dragend" === n2.type && (i2.deactivate = new xt(r2, n2, "dropdeactivate"), i2.deactivate.target = null, i2.deactivate.dropzone = null), r2.rejected || (r2.cur.element !== r2.prev.element && (r2.prev.dropzone && (i2.leave = new xt(r2, n2, "dragleave"), n2.dragLeave = i2.leave.target = r2.prev.element, n2.prevDropzone = i2.leave.dropzone = r2.prev.dropzone), r2.cur.dropzone && (i2.enter = new xt(r2, n2, "dragenter"), n2.dragEnter = r2.cur.element, n2.dropzone = r2.cur.dropzone)), "dragend" === n2.type && r2.cur.dropzone && (i2.drop = new xt(r2, n2, "drop"), n2.dropzone = r2.cur.dropzone, n2.relatedTarget = r2.cur.element), "dragmove" === n2.type && r2.cur.dropzone && (i2.move = new xt(r2, n2, "dropmove"), n2.dropzone = r2.cur.dropzone)), i2;
      }
      function _t(t2, e2) {
        var n2 = t2.dropState, r2 = n2.activeDrops, i2 = n2.cur, o2 = n2.prev;
        e2.leave && o2.dropzone.fire(e2.leave), e2.enter && i2.dropzone.fire(e2.enter), e2.move && i2.dropzone.fire(e2.move), e2.drop && i2.dropzone.fire(e2.drop), e2.deactivate && wt(r2, e2.deactivate), n2.prev.dropzone = i2.dropzone, n2.prev.element = i2.element;
      }
      function Pt(t2, e2) {
        var n2 = t2.interaction, r2 = t2.iEvent, i2 = t2.event;
        if ("dragmove" === r2.type || "dragend" === r2.type) {
          var o2 = n2.dropState;
          e2.dynamicDrop && (o2.activeDrops = Et(e2, n2.element));
          var a2 = r2, s2 = Tt(n2, a2, i2);
          o2.rejected = o2.rejected && !!s2 && s2.dropzone === o2.cur.dropzone && s2.element === o2.cur.element, o2.cur.dropzone = s2 && s2.dropzone, o2.cur.element = s2 && s2.element, o2.events = St(n2, 0, a2);
        }
      }
      var Ot = { id: "actions/drop", install: function(t2) {
        var e2 = t2.actions, n2 = t2.interactStatic, r2 = t2.Interactable, i2 = t2.defaults;
        t2.usePlugin(_), r2.prototype.dropzone = function(t3) {
          return function(t4, e3) {
            if (w.object(e3)) {
              if (t4.options.drop.enabled = false !== e3.enabled, e3.listeners) {
                var n3 = $(e3.listeners), r3 = Object.keys(n3).reduce(function(t5, e4) {
                  return t5[/^(enter|leave)/.test(e4) ? "drag".concat(e4) : /^(activate|deactivate|move)/.test(e4) ? "drop".concat(e4) : e4] = n3[e4], t5;
                }, {}), i3 = t4.options.drop.listeners;
                i3 && t4.off(i3), t4.on(r3), t4.options.drop.listeners = r3;
              }
              return w.func(e3.ondrop) && t4.on("drop", e3.ondrop), w.func(e3.ondropactivate) && t4.on("dropactivate", e3.ondropactivate), w.func(e3.ondropdeactivate) && t4.on("dropdeactivate", e3.ondropdeactivate), w.func(e3.ondragenter) && t4.on("dragenter", e3.ondragenter), w.func(e3.ondragleave) && t4.on("dragleave", e3.ondragleave), w.func(e3.ondropmove) && t4.on("dropmove", e3.ondropmove), /^(pointer|center)$/.test(e3.overlap) ? t4.options.drop.overlap = e3.overlap : w.number(e3.overlap) && (t4.options.drop.overlap = Math.max(Math.min(1, e3.overlap), 0)), "accept" in e3 && (t4.options.drop.accept = e3.accept), "checker" in e3 && (t4.options.drop.checker = e3.checker), t4;
            }
            if (w.bool(e3)) return t4.options.drop.enabled = e3, t4;
            return t4.options.drop;
          }(this, t3);
        }, r2.prototype.dropCheck = function(t3, e3, n3, r3, i3, o2) {
          return function(t4, e4, n4, r4, i4, o3, a2) {
            var s2 = false;
            if (!(a2 = a2 || t4.getRect(o3))) return !!t4.options.drop.checker && t4.options.drop.checker(e4, n4, s2, t4, o3, r4, i4);
            var c2 = t4.options.drop.overlap;
            if ("pointer" === c2) {
              var l2 = K(r4, i4, "drag"), u2 = ot(e4);
              u2.x += l2.x, u2.y += l2.y;
              var p2 = u2.x > a2.left && u2.x < a2.right, f2 = u2.y > a2.top && u2.y < a2.bottom;
              s2 = p2 && f2;
            }
            var d2 = r4.getRect(i4);
            if (d2 && "center" === c2) {
              var h2 = d2.left + d2.width / 2, v2 = d2.top + d2.height / 2;
              s2 = h2 >= a2.left && h2 <= a2.right && v2 >= a2.top && v2 <= a2.bottom;
            }
            if (d2 && w.number(c2)) {
              s2 = Math.max(0, Math.min(a2.right, d2.right) - Math.max(a2.left, d2.left)) * Math.max(0, Math.min(a2.bottom, d2.bottom) - Math.max(a2.top, d2.top)) / (d2.width * d2.height) >= c2;
            }
            t4.options.drop.checker && (s2 = t4.options.drop.checker(e4, n4, s2, t4, o3, r4, i4));
            return s2;
          }(this, t3, e3, n3, r3, i3, o2);
        }, n2.dynamicDrop = function(e3) {
          return w.bool(e3) ? (t2.dynamicDrop = e3, n2) : t2.dynamicDrop;
        }, V(e2.phaselessTypes, { dragenter: true, dragleave: true, dropactivate: true, dropdeactivate: true, dropmove: true, drop: true }), e2.methodDict.drop = "dropzone", t2.dynamicDrop = false, i2.actions.drop = Ot.defaults;
      }, listeners: { "interactions:before-action-start": function(t2) {
        var e2 = t2.interaction;
        "drag" === e2.prepared.name && (e2.dropState = { cur: { dropzone: null, element: null }, prev: { dropzone: null, element: null }, rejected: null, events: null, activeDrops: [] });
      }, "interactions:after-action-start": function(t2, e2) {
        var n2 = t2.interaction, r2 = (t2.event, t2.iEvent);
        if ("drag" === n2.prepared.name) {
          var i2 = n2.dropState;
          i2.activeDrops = [], i2.events = {}, i2.activeDrops = Et(e2, n2.element), i2.events = St(n2, 0, r2), i2.events.activate && (wt(i2.activeDrops, i2.events.activate), e2.fire("actions/drop:start", { interaction: n2, dragEvent: r2 }));
        }
      }, "interactions:action-move": Pt, "interactions:after-action-move": function(t2, e2) {
        var n2 = t2.interaction, r2 = t2.iEvent;
        if ("drag" === n2.prepared.name) {
          var i2 = n2.dropState;
          _t(n2, i2.events), e2.fire("actions/drop:move", { interaction: n2, dragEvent: r2 }), i2.events = {};
        }
      }, "interactions:action-end": function(t2, e2) {
        if ("drag" === t2.interaction.prepared.name) {
          var n2 = t2.interaction, r2 = t2.iEvent;
          Pt(t2, e2), _t(n2, n2.dropState.events), e2.fire("actions/drop:end", { interaction: n2, dragEvent: r2 });
        }
      }, "interactions:stop": function(t2) {
        var e2 = t2.interaction;
        if ("drag" === e2.prepared.name) {
          var n2 = e2.dropState;
          n2 && (n2.activeDrops = null, n2.events = null, n2.cur.dropzone = null, n2.cur.element = null, n2.prev.dropzone = null, n2.prev.element = null, n2.rejected = false);
        }
      } }, getActiveDrops: Et, getDrop: Tt, getDropEvents: St, fireDropEvents: _t, filterEventType: function(t2) {
        return 0 === t2.search("drag") || 0 === t2.search("drop");
      }, defaults: { enabled: false, accept: null, overlap: "pointer" } }, kt = Ot;
      function Dt(t2) {
        var e2 = t2.interaction, n2 = t2.iEvent, r2 = t2.phase;
        if ("gesture" === e2.prepared.name) {
          var i2 = e2.pointers.map(function(t3) {
            return t3.pointer;
          }), o2 = "start" === r2, a2 = "end" === r2, s2 = e2.interactable.options.deltaSource;
          if (n2.touches = [i2[0], i2[1]], o2) n2.distance = pt(i2, s2), n2.box = ut(i2), n2.scale = 1, n2.ds = 0, n2.angle = ft(i2, s2), n2.da = 0, e2.gesture.startDistance = n2.distance, e2.gesture.startAngle = n2.angle;
          else if (a2 || e2.pointers.length < 2) {
            var c2 = e2.prevEvent;
            n2.distance = c2.distance, n2.box = c2.box, n2.scale = c2.scale, n2.ds = 0, n2.angle = c2.angle, n2.da = 0;
          } else n2.distance = pt(i2, s2), n2.box = ut(i2), n2.scale = n2.distance / e2.gesture.startDistance, n2.angle = ft(i2, s2), n2.ds = n2.scale - e2.gesture.scale, n2.da = n2.angle - e2.gesture.angle;
          e2.gesture.distance = n2.distance, e2.gesture.angle = n2.angle, w.number(n2.scale) && n2.scale !== 1 / 0 && !isNaN(n2.scale) && (e2.gesture.scale = n2.scale);
        }
      }
      var It = { id: "actions/gesture", before: ["actions/drag", "actions/resize"], install: function(t2) {
        var e2 = t2.actions, n2 = t2.Interactable, r2 = t2.defaults;
        n2.prototype.gesturable = function(t3) {
          return w.object(t3) ? (this.options.gesture.enabled = false !== t3.enabled, this.setPerAction("gesture", t3), this.setOnEvents("gesture", t3), this) : w.bool(t3) ? (this.options.gesture.enabled = t3, this) : this.options.gesture;
        }, e2.map.gesture = It, e2.methodDict.gesture = "gesturable", r2.actions.gesture = It.defaults;
      }, listeners: { "interactions:action-start": Dt, "interactions:action-move": Dt, "interactions:action-end": Dt, "interactions:new": function(t2) {
        t2.interaction.gesture = { angle: 0, distance: 0, scale: 1, startAngle: 0, startDistance: 0 };
      }, "auto-start:check": function(t2) {
        if (!(t2.interaction.pointers.length < 2)) {
          var e2 = t2.interactable.options.gesture;
          if (e2 && e2.enabled) return t2.action = { name: "gesture" }, false;
        }
      } }, defaults: {}, getCursor: function() {
        return "";
      }, filterEventType: function(t2) {
        return 0 === t2.search("gesture");
      } }, Mt = It;
      function zt(t2, e2, n2, r2, i2, o2, a2) {
        if (!e2) return false;
        if (true === e2) {
          var s2 = w.number(o2.width) ? o2.width : o2.right - o2.left, c2 = w.number(o2.height) ? o2.height : o2.bottom - o2.top;
          if (a2 = Math.min(a2, Math.abs(("left" === t2 || "right" === t2 ? s2 : c2) / 2)), s2 < 0 && ("left" === t2 ? t2 = "right" : "right" === t2 && (t2 = "left")), c2 < 0 && ("top" === t2 ? t2 = "bottom" : "bottom" === t2 && (t2 = "top")), "left" === t2) {
            var l2 = s2 >= 0 ? o2.left : o2.right;
            return n2.x < l2 + a2;
          }
          if ("top" === t2) {
            var u2 = c2 >= 0 ? o2.top : o2.bottom;
            return n2.y < u2 + a2;
          }
          if ("right" === t2) return n2.x > (s2 >= 0 ? o2.right : o2.left) - a2;
          if ("bottom" === t2) return n2.y > (c2 >= 0 ? o2.bottom : o2.top) - a2;
        }
        return !!w.element(r2) && (w.element(e2) ? e2 === r2 : F(r2, e2, i2));
      }
      function At(t2) {
        var e2 = t2.iEvent, n2 = t2.interaction;
        if ("resize" === n2.prepared.name && n2.resizeAxes) {
          var r2 = e2;
          n2.interactable.options.resize.square ? ("y" === n2.resizeAxes ? r2.delta.x = r2.delta.y : r2.delta.y = r2.delta.x, r2.axes = "xy") : (r2.axes = n2.resizeAxes, "x" === n2.resizeAxes ? r2.delta.y = 0 : "y" === n2.resizeAxes && (r2.delta.x = 0));
        }
      }
      var Rt, Ct, jt = { id: "actions/resize", before: ["actions/drag"], install: function(t2) {
        var e2 = t2.actions, n2 = t2.browser, r2 = t2.Interactable, i2 = t2.defaults;
        jt.cursors = function(t3) {
          return t3.isIe9 ? { x: "e-resize", y: "s-resize", xy: "se-resize", top: "n-resize", left: "w-resize", bottom: "s-resize", right: "e-resize", topleft: "se-resize", bottomright: "se-resize", topright: "ne-resize", bottomleft: "ne-resize" } : { x: "ew-resize", y: "ns-resize", xy: "nwse-resize", top: "ns-resize", left: "ew-resize", bottom: "ns-resize", right: "ew-resize", topleft: "nwse-resize", bottomright: "nwse-resize", topright: "nesw-resize", bottomleft: "nesw-resize" };
        }(n2), jt.defaultMargin = n2.supportsTouch || n2.supportsPointerEvent ? 20 : 10, r2.prototype.resizable = function(e3) {
          return function(t3, e4, n3) {
            if (w.object(e4)) return t3.options.resize.enabled = false !== e4.enabled, t3.setPerAction("resize", e4), t3.setOnEvents("resize", e4), w.string(e4.axis) && /^x$|^y$|^xy$/.test(e4.axis) ? t3.options.resize.axis = e4.axis : null === e4.axis && (t3.options.resize.axis = n3.defaults.actions.resize.axis), w.bool(e4.preserveAspectRatio) ? t3.options.resize.preserveAspectRatio = e4.preserveAspectRatio : w.bool(e4.square) && (t3.options.resize.square = e4.square), t3;
            if (w.bool(e4)) return t3.options.resize.enabled = e4, t3;
            return t3.options.resize;
          }(this, e3, t2);
        }, e2.map.resize = jt, e2.methodDict.resize = "resizable", i2.actions.resize = jt.defaults;
      }, listeners: { "interactions:new": function(t2) {
        t2.interaction.resizeAxes = "xy";
      }, "interactions:action-start": function(t2) {
        !function(t3) {
          var e2 = t3.iEvent, n2 = t3.interaction;
          if ("resize" === n2.prepared.name && n2.prepared.edges) {
            var r2 = e2, i2 = n2.rect;
            n2._rects = { start: V({}, i2), corrected: V({}, i2), previous: V({}, i2), delta: { left: 0, right: 0, width: 0, top: 0, bottom: 0, height: 0 } }, r2.edges = n2.prepared.edges, r2.rect = n2._rects.corrected, r2.deltaRect = n2._rects.delta;
          }
        }(t2), At(t2);
      }, "interactions:action-move": function(t2) {
        !function(t3) {
          var e2 = t3.iEvent, n2 = t3.interaction;
          if ("resize" === n2.prepared.name && n2.prepared.edges) {
            var r2 = e2, i2 = n2.interactable.options.resize.invert, o2 = "reposition" === i2 || "negate" === i2, a2 = n2.rect, s2 = n2._rects, c2 = s2.start, l2 = s2.corrected, u2 = s2.delta, p2 = s2.previous;
            if (V(p2, l2), o2) {
              if (V(l2, a2), "reposition" === i2) {
                if (l2.top > l2.bottom) {
                  var f2 = l2.top;
                  l2.top = l2.bottom, l2.bottom = f2;
                }
                if (l2.left > l2.right) {
                  var d2 = l2.left;
                  l2.left = l2.right, l2.right = d2;
                }
              }
            } else l2.top = Math.min(a2.top, c2.bottom), l2.bottom = Math.max(a2.bottom, c2.top), l2.left = Math.min(a2.left, c2.right), l2.right = Math.max(a2.right, c2.left);
            for (var h2 in l2.width = l2.right - l2.left, l2.height = l2.bottom - l2.top, l2) u2[h2] = l2[h2] - p2[h2];
            r2.edges = n2.prepared.edges, r2.rect = l2, r2.deltaRect = u2;
          }
        }(t2), At(t2);
      }, "interactions:action-end": function(t2) {
        var e2 = t2.iEvent, n2 = t2.interaction;
        if ("resize" === n2.prepared.name && n2.prepared.edges) {
          var r2 = e2;
          r2.edges = n2.prepared.edges, r2.rect = n2._rects.corrected, r2.deltaRect = n2._rects.delta;
        }
      }, "auto-start:check": function(t2) {
        var e2 = t2.interaction, n2 = t2.interactable, r2 = t2.element, i2 = t2.rect, o2 = t2.buttons;
        if (i2) {
          var a2 = V({}, e2.coords.cur.page), s2 = n2.options.resize;
          if (s2 && s2.enabled && (!e2.pointerIsDown || !/mouse|pointer/.test(e2.pointerType) || 0 != (o2 & s2.mouseButtons))) {
            if (w.object(s2.edges)) {
              var c2 = { left: false, right: false, top: false, bottom: false };
              for (var l2 in c2) c2[l2] = zt(l2, s2.edges[l2], a2, e2._latestPointer.eventTarget, r2, i2, s2.margin || jt.defaultMargin);
              c2.left = c2.left && !c2.right, c2.top = c2.top && !c2.bottom, (c2.left || c2.right || c2.top || c2.bottom) && (t2.action = { name: "resize", edges: c2 });
            } else {
              var u2 = "y" !== s2.axis && a2.x > i2.right - jt.defaultMargin, p2 = "x" !== s2.axis && a2.y > i2.bottom - jt.defaultMargin;
              (u2 || p2) && (t2.action = { name: "resize", axes: (u2 ? "x" : "") + (p2 ? "y" : "") });
            }
            return !t2.action && void 0;
          }
        }
      } }, defaults: { square: false, preserveAspectRatio: false, axis: "xy", margin: NaN, edges: null, invert: "none" }, cursors: null, getCursor: function(t2) {
        var e2 = t2.edges, n2 = t2.axis, r2 = t2.name, i2 = jt.cursors, o2 = null;
        if (n2) o2 = i2[r2 + n2];
        else if (e2) {
          for (var a2 = "", s2 = 0, c2 = ["top", "bottom", "left", "right"]; s2 < c2.length; s2++) {
            var l2 = c2[s2];
            e2[l2] && (a2 += l2);
          }
          o2 = i2[a2];
        }
        return o2;
      }, filterEventType: function(t2) {
        return 0 === t2.search("resize");
      }, defaultMargin: null }, Ft = jt, Xt = { id: "actions", install: function(t2) {
        t2.usePlugin(Mt), t2.usePlugin(Ft), t2.usePlugin(_), t2.usePlugin(kt);
      } }, Yt = 0;
      var Lt = { request: function(t2) {
        return Rt(t2);
      }, cancel: function(t2) {
        return Ct(t2);
      }, init: function(t2) {
        if (Rt = t2.requestAnimationFrame, Ct = t2.cancelAnimationFrame, !Rt) for (var e2 = ["ms", "moz", "webkit", "o"], n2 = 0; n2 < e2.length; n2++) {
          var r2 = e2[n2];
          Rt = t2["".concat(r2, "RequestAnimationFrame")], Ct = t2["".concat(r2, "CancelAnimationFrame")] || t2["".concat(r2, "CancelRequestAnimationFrame")];
        }
        Rt = Rt && Rt.bind(t2), Ct = Ct && Ct.bind(t2), Rt || (Rt = function(e3) {
          var n3 = Date.now(), r3 = Math.max(0, 16 - (n3 - Yt)), i2 = t2.setTimeout(function() {
            e3(n3 + r3);
          }, r3);
          return Yt = n3 + r3, i2;
        }, Ct = function(t3) {
          return clearTimeout(t3);
        });
      } };
      var qt = { defaults: { enabled: false, margin: 60, container: null, speed: 300 }, now: Date.now, interaction: null, i: 0, x: 0, y: 0, isScrolling: false, prevTime: 0, margin: 0, speed: 0, start: function(t2) {
        qt.isScrolling = true, Lt.cancel(qt.i), t2.autoScroll = qt, qt.interaction = t2, qt.prevTime = qt.now(), qt.i = Lt.request(qt.scroll);
      }, stop: function() {
        qt.isScrolling = false, qt.interaction && (qt.interaction.autoScroll = null), Lt.cancel(qt.i);
      }, scroll: function() {
        var t2 = qt.interaction, e2 = t2.interactable, n2 = t2.element, r2 = t2.prepared.name, i2 = e2.options[r2].autoScroll, o2 = Bt(i2.container, e2, n2), a2 = qt.now(), s2 = (a2 - qt.prevTime) / 1e3, c2 = i2.speed * s2;
        if (c2 >= 1) {
          var l2 = { x: qt.x * c2, y: qt.y * c2 };
          if (l2.x || l2.y) {
            var u2 = Vt(o2);
            w.window(o2) ? o2.scrollBy(l2.x, l2.y) : o2 && (o2.scrollLeft += l2.x, o2.scrollTop += l2.y);
            var p2 = Vt(o2), f2 = { x: p2.x - u2.x, y: p2.y - u2.y };
            (f2.x || f2.y) && e2.fire({ type: "autoscroll", target: n2, interactable: e2, delta: f2, interaction: t2, container: o2 });
          }
          qt.prevTime = a2;
        }
        qt.isScrolling && (Lt.cancel(qt.i), qt.i = Lt.request(qt.scroll));
      }, check: function(t2, e2) {
        var n2;
        return null == (n2 = t2.options[e2].autoScroll) ? void 0 : n2.enabled;
      }, onInteractionMove: function(t2) {
        var e2 = t2.interaction, n2 = t2.pointer;
        if (e2.interacting() && qt.check(e2.interactable, e2.prepared.name)) if (e2.simulation) qt.x = qt.y = 0;
        else {
          var r2, i2, o2, a2, s2 = e2.interactable, c2 = e2.element, l2 = e2.prepared.name, u2 = s2.options[l2].autoScroll, p2 = Bt(u2.container, s2, c2);
          if (w.window(p2)) a2 = n2.clientX < qt.margin, r2 = n2.clientY < qt.margin, i2 = n2.clientX > p2.innerWidth - qt.margin, o2 = n2.clientY > p2.innerHeight - qt.margin;
          else {
            var f2 = Y(p2);
            a2 = n2.clientX < f2.left + qt.margin, r2 = n2.clientY < f2.top + qt.margin, i2 = n2.clientX > f2.right - qt.margin, o2 = n2.clientY > f2.bottom - qt.margin;
          }
          qt.x = i2 ? 1 : a2 ? -1 : 0, qt.y = o2 ? 1 : r2 ? -1 : 0, qt.isScrolling || (qt.margin = u2.margin, qt.speed = u2.speed, qt.start(e2));
        }
      } };
      function Bt(t2, e2, n2) {
        return (w.string(t2) ? W(t2, e2, n2) : t2) || y(n2);
      }
      function Vt(t2) {
        return w.window(t2) && (t2 = window.document.body), { x: t2.scrollLeft, y: t2.scrollTop };
      }
      var Wt = { id: "auto-scroll", install: function(t2) {
        var e2 = t2.defaults, n2 = t2.actions;
        t2.autoScroll = qt, qt.now = function() {
          return t2.now();
        }, n2.phaselessTypes.autoscroll = true, e2.perAction.autoScroll = qt.defaults;
      }, listeners: { "interactions:new": function(t2) {
        t2.interaction.autoScroll = null;
      }, "interactions:destroy": function(t2) {
        t2.interaction.autoScroll = null, qt.stop(), qt.interaction && (qt.interaction = null);
      }, "interactions:stop": qt.stop, "interactions:action-move": function(t2) {
        return qt.onInteractionMove(t2);
      } } }, Gt = Wt;
      function Nt(t2, e2) {
        var n2 = false;
        return function() {
          return n2 || (g.console.warn(e2), n2 = true), t2.apply(this, arguments);
        };
      }
      function Ut(t2, e2) {
        return t2.name = e2.name, t2.axis = e2.axis, t2.edges = e2.edges, t2;
      }
      function Ht(t2) {
        return w.bool(t2) ? (this.options.styleCursor = t2, this) : null === t2 ? (delete this.options.styleCursor, this) : this.options.styleCursor;
      }
      function Kt(t2) {
        return w.func(t2) ? (this.options.actionChecker = t2, this) : null === t2 ? (delete this.options.actionChecker, this) : this.options.actionChecker;
      }
      var $t = { id: "auto-start/interactableMethods", install: function(t2) {
        var e2 = t2.Interactable;
        e2.prototype.getAction = function(e3, n2, r2, i2) {
          var o2 = function(t3, e4, n3, r3, i3) {
            var o3 = t3.getRect(r3), a2 = e4.buttons || { 0: 1, 1: 4, 3: 8, 4: 16 }[e4.button], s2 = { action: null, interactable: t3, interaction: n3, element: r3, rect: o3, buttons: a2 };
            return i3.fire("auto-start:check", s2), s2.action;
          }(this, n2, r2, i2, t2);
          return this.options.actionChecker ? this.options.actionChecker(e3, n2, o2, this, i2, r2) : o2;
        }, e2.prototype.ignoreFrom = Nt(function(t3) {
          return this._backCompatOption("ignoreFrom", t3);
        }, "Interactable.ignoreFrom() has been deprecated. Use Interactble.draggable({ignoreFrom: newValue})."), e2.prototype.allowFrom = Nt(function(t3) {
          return this._backCompatOption("allowFrom", t3);
        }, "Interactable.allowFrom() has been deprecated. Use Interactble.draggable({allowFrom: newValue})."), e2.prototype.actionChecker = Kt, e2.prototype.styleCursor = Ht;
      } };
      function Jt(t2, e2, n2, r2, i2) {
        return e2.testIgnoreAllow(e2.options[t2.name], n2, r2) && e2.options[t2.name].enabled && ee(e2, n2, t2, i2) ? t2 : null;
      }
      function Qt(t2, e2, n2, r2, i2, o2, a2) {
        for (var s2 = 0, c2 = r2.length; s2 < c2; s2++) {
          var l2 = r2[s2], u2 = i2[s2], p2 = l2.getAction(e2, n2, t2, u2);
          if (p2) {
            var f2 = Jt(p2, l2, u2, o2, a2);
            if (f2) return { action: f2, interactable: l2, element: u2 };
          }
        }
        return { action: null, interactable: null, element: null };
      }
      function Zt(t2, e2, n2, r2, i2) {
        var o2 = [], a2 = [], s2 = r2;
        function c2(t3) {
          o2.push(t3), a2.push(s2);
        }
        for (; w.element(s2); ) {
          o2 = [], a2 = [], i2.interactables.forEachMatch(s2, c2);
          var l2 = Qt(t2, e2, n2, o2, a2, r2, i2);
          if (l2.action && !l2.interactable.options[l2.action.name].manualStart) return l2;
          s2 = A(s2);
        }
        return { action: null, interactable: null, element: null };
      }
      function te(t2, e2, n2) {
        var r2 = e2.action, i2 = e2.interactable, o2 = e2.element;
        r2 = r2 || { name: null }, t2.interactable = i2, t2.element = o2, Ut(t2.prepared, r2), t2.rect = i2 && r2.name ? i2.getRect(o2) : null, ie(t2, n2), n2.fire("autoStart:prepared", { interaction: t2 });
      }
      function ee(t2, e2, n2, r2) {
        var i2 = t2.options, o2 = i2[n2.name].max, a2 = i2[n2.name].maxPerElement, s2 = r2.autoStart.maxInteractions, c2 = 0, l2 = 0, u2 = 0;
        if (!(o2 && a2 && s2)) return false;
        for (var p2 = 0, f2 = r2.interactions.list; p2 < f2.length; p2++) {
          var d2 = f2[p2], h2 = d2.prepared.name;
          if (d2.interacting()) {
            if (++c2 >= s2) return false;
            if (d2.interactable === t2) {
              if ((l2 += h2 === n2.name ? 1 : 0) >= o2) return false;
              if (d2.element === e2 && (u2++, h2 === n2.name && u2 >= a2)) return false;
            }
          }
        }
        return s2 > 0;
      }
      function ne(t2, e2) {
        return w.number(t2) ? (e2.autoStart.maxInteractions = t2, this) : e2.autoStart.maxInteractions;
      }
      function re(t2, e2, n2) {
        var r2 = n2.autoStart.cursorElement;
        r2 && r2 !== t2 && (r2.style.cursor = ""), t2.ownerDocument.documentElement.style.cursor = e2, t2.style.cursor = e2, n2.autoStart.cursorElement = e2 ? t2 : null;
      }
      function ie(t2, e2) {
        var n2 = t2.interactable, r2 = t2.element, i2 = t2.prepared;
        if ("mouse" === t2.pointerType && n2 && n2.options.styleCursor) {
          var o2 = "";
          if (i2.name) {
            var a2 = n2.options[i2.name].cursorChecker;
            o2 = w.func(a2) ? a2(i2, n2, r2, t2._interacting) : e2.actions.map[i2.name].getCursor(i2);
          }
          re(t2.element, o2 || "", e2);
        } else e2.autoStart.cursorElement && re(e2.autoStart.cursorElement, "", e2);
      }
      var oe = { id: "auto-start/base", before: ["actions"], install: function(t2) {
        var e2 = t2.interactStatic, n2 = t2.defaults;
        t2.usePlugin($t), n2.base.actionChecker = null, n2.base.styleCursor = true, V(n2.perAction, { manualStart: false, max: 1 / 0, maxPerElement: 1, allowFrom: null, ignoreFrom: null, mouseButtons: 1 }), e2.maxInteractions = function(e3) {
          return ne(e3, t2);
        }, t2.autoStart = { maxInteractions: 1 / 0, withinInteractionLimit: ee, cursorElement: null };
      }, listeners: { "interactions:down": function(t2, e2) {
        var n2 = t2.interaction, r2 = t2.pointer, i2 = t2.event, o2 = t2.eventTarget;
        n2.interacting() || te(n2, Zt(n2, r2, i2, o2, e2), e2);
      }, "interactions:move": function(t2, e2) {
        !function(t3, e3) {
          var n2 = t3.interaction, r2 = t3.pointer, i2 = t3.event, o2 = t3.eventTarget;
          "mouse" !== n2.pointerType || n2.pointerIsDown || n2.interacting() || te(n2, Zt(n2, r2, i2, o2, e3), e3);
        }(t2, e2), function(t3, e3) {
          var n2 = t3.interaction;
          if (n2.pointerIsDown && !n2.interacting() && n2.pointerWasMoved && n2.prepared.name) {
            e3.fire("autoStart:before-start", t3);
            var r2 = n2.interactable, i2 = n2.prepared.name;
            i2 && r2 && (r2.options[i2].manualStart || !ee(r2, n2.element, n2.prepared, e3) ? n2.stop() : (n2.start(n2.prepared, r2, n2.element), ie(n2, e3)));
          }
        }(t2, e2);
      }, "interactions:stop": function(t2, e2) {
        var n2 = t2.interaction, r2 = n2.interactable;
        r2 && r2.options.styleCursor && re(n2.element, "", e2);
      } }, maxInteractions: ne, withinInteractionLimit: ee, validateAction: Jt }, ae = oe;
      var se = { id: "auto-start/dragAxis", listeners: { "autoStart:before-start": function(t2, e2) {
        var n2 = t2.interaction, r2 = t2.eventTarget, i2 = t2.dx, o2 = t2.dy;
        if ("drag" === n2.prepared.name) {
          var a2 = Math.abs(i2), s2 = Math.abs(o2), c2 = n2.interactable.options.drag, l2 = c2.startAxis, u2 = a2 > s2 ? "x" : a2 < s2 ? "y" : "xy";
          if (n2.prepared.axis = "start" === c2.lockAxis ? u2[0] : c2.lockAxis, "xy" !== u2 && "xy" !== l2 && l2 !== u2) {
            n2.prepared.name = null;
            for (var p2 = r2, f2 = function(t3) {
              if (t3 !== n2.interactable) {
                var i3 = n2.interactable.options.drag;
                if (!i3.manualStart && t3.testIgnoreAllow(i3, p2, r2)) {
                  var o3 = t3.getAction(n2.downPointer, n2.downEvent, n2, p2);
                  if (o3 && "drag" === o3.name && function(t4, e3) {
                    if (!e3) return false;
                    var n3 = e3.options.drag.startAxis;
                    return "xy" === t4 || "xy" === n3 || n3 === t4;
                  }(u2, t3) && ae.validateAction(o3, t3, p2, r2, e2)) return t3;
                }
              }
            }; w.element(p2); ) {
              var d2 = e2.interactables.forEachMatch(p2, f2);
              if (d2) {
                n2.prepared.name = "drag", n2.interactable = d2, n2.element = p2;
                break;
              }
              p2 = A(p2);
            }
          }
        }
      } } };
      function ce(t2) {
        var e2 = t2.prepared && t2.prepared.name;
        if (!e2) return null;
        var n2 = t2.interactable.options;
        return n2[e2].hold || n2[e2].delay;
      }
      var le = { id: "auto-start/hold", install: function(t2) {
        var e2 = t2.defaults;
        t2.usePlugin(ae), e2.perAction.hold = 0, e2.perAction.delay = 0;
      }, listeners: { "interactions:new": function(t2) {
        t2.interaction.autoStartHoldTimer = null;
      }, "autoStart:prepared": function(t2) {
        var e2 = t2.interaction, n2 = ce(e2);
        n2 > 0 && (e2.autoStartHoldTimer = setTimeout(function() {
          e2.start(e2.prepared, e2.interactable, e2.element);
        }, n2));
      }, "interactions:move": function(t2) {
        var e2 = t2.interaction, n2 = t2.duplicate;
        e2.autoStartHoldTimer && e2.pointerWasMoved && !n2 && (clearTimeout(e2.autoStartHoldTimer), e2.autoStartHoldTimer = null);
      }, "autoStart:before-start": function(t2) {
        var e2 = t2.interaction;
        ce(e2) > 0 && (e2.prepared.name = null);
      } }, getHoldDuration: ce }, ue = le, pe = { id: "auto-start", install: function(t2) {
        t2.usePlugin(ae), t2.usePlugin(ue), t2.usePlugin(se);
      } }, fe = function(t2) {
        return /^(always|never|auto)$/.test(t2) ? (this.options.preventDefault = t2, this) : w.bool(t2) ? (this.options.preventDefault = t2 ? "always" : "never", this) : this.options.preventDefault;
      };
      function de(t2) {
        var e2 = t2.interaction, n2 = t2.event;
        e2.interactable && e2.interactable.checkAndPreventDefault(n2);
      }
      var he = { id: "core/interactablePreventDefault", install: function(t2) {
        var e2 = t2.Interactable;
        e2.prototype.preventDefault = fe, e2.prototype.checkAndPreventDefault = function(e3) {
          return function(t3, e4, n2) {
            var r2 = t3.options.preventDefault;
            if ("never" !== r2) if ("always" !== r2) {
              if (e4.events.supportsPassive && /^touch(start|move)$/.test(n2.type)) {
                var i2 = y(n2.target).document, o2 = e4.getDocOptions(i2);
                if (!o2 || !o2.events || false !== o2.events.passive) return;
              }
              /^(mouse|pointer|touch)*(down|start)/i.test(n2.type) || w.element(n2.target) && R(n2.target, "input,select,textarea,[contenteditable=true],[contenteditable=true] *") || n2.preventDefault();
            } else n2.preventDefault();
          }(this, t2, e3);
        }, t2.interactions.docEvents.push({ type: "dragstart", listener: function(e3) {
          for (var n2 = 0, r2 = t2.interactions.list; n2 < r2.length; n2++) {
            var i2 = r2[n2];
            if (i2.element && (i2.element === e3.target || M(i2.element, e3.target))) return void i2.interactable.checkAndPreventDefault(e3);
          }
        } });
      }, listeners: ["down", "move", "up", "cancel"].reduce(function(t2, e2) {
        return t2["interactions:".concat(e2)] = de, t2;
      }, {}) };
      function ve(t2, e2) {
        if (e2.phaselessTypes[t2]) return true;
        for (var n2 in e2.map) if (0 === t2.indexOf(n2) && t2.substr(n2.length) in e2.phases) return true;
        return false;
      }
      function ge(t2) {
        var e2 = {};
        for (var n2 in t2) {
          var r2 = t2[n2];
          w.plainObject(r2) ? e2[n2] = ge(r2) : w.array(r2) ? e2[n2] = mt(r2) : e2[n2] = r2;
        }
        return e2;
      }
      var me = function() {
        function t2(e2) {
          r(this, t2), this.states = [], this.startOffset = { left: 0, right: 0, top: 0, bottom: 0 }, this.startDelta = void 0, this.result = void 0, this.endResult = void 0, this.startEdges = void 0, this.edges = void 0, this.interaction = void 0, this.interaction = e2, this.result = ye(), this.edges = { left: false, right: false, top: false, bottom: false };
        }
        return o(t2, [{ key: "start", value: function(t3, e2) {
          var n2, r2, i2 = t3.phase, o2 = this.interaction, a2 = function(t4) {
            var e3 = t4.interactable.options[t4.prepared.name], n3 = e3.modifiers;
            if (n3 && n3.length) return n3;
            return ["snap", "snapSize", "snapEdges", "restrict", "restrictEdges", "restrictSize"].map(function(t5) {
              var n4 = e3[t5];
              return n4 && n4.enabled && { options: n4, methods: n4._methods };
            }).filter(function(t5) {
              return !!t5;
            });
          }(o2);
          this.prepareStates(a2), this.startEdges = V({}, o2.edges), this.edges = V({}, this.startEdges), this.startOffset = (n2 = o2.rect, r2 = e2, n2 ? { left: r2.x - n2.left, top: r2.y - n2.top, right: n2.right - r2.x, bottom: n2.bottom - r2.y } : { left: 0, top: 0, right: 0, bottom: 0 }), this.startDelta = { x: 0, y: 0 };
          var s2 = this.fillArg({ phase: i2, pageCoords: e2, preEnd: false });
          return this.result = ye(), this.startAll(s2), this.result = this.setAll(s2);
        } }, { key: "fillArg", value: function(t3) {
          var e2 = this.interaction;
          return t3.interaction = e2, t3.interactable = e2.interactable, t3.element = e2.element, t3.rect || (t3.rect = e2.rect), t3.edges || (t3.edges = this.startEdges), t3.startOffset = this.startOffset, t3;
        } }, { key: "startAll", value: function(t3) {
          for (var e2 = 0, n2 = this.states; e2 < n2.length; e2++) {
            var r2 = n2[e2];
            r2.methods.start && (t3.state = r2, r2.methods.start(t3));
          }
        } }, { key: "setAll", value: function(t3) {
          var e2 = t3.phase, n2 = t3.preEnd, r2 = t3.skipModifiers, i2 = t3.rect, o2 = t3.edges;
          t3.coords = V({}, t3.pageCoords), t3.rect = V({}, i2), t3.edges = V({}, o2);
          for (var a2 = r2 ? this.states.slice(r2) : this.states, s2 = ye(t3.coords, t3.rect), c2 = 0; c2 < a2.length; c2++) {
            var l2, u2 = a2[c2], p2 = u2.options, f2 = V({}, t3.coords), d2 = null;
            null != (l2 = u2.methods) && l2.set && this.shouldDo(p2, n2, e2) && (t3.state = u2, d2 = u2.methods.set(t3), H(t3.edges, t3.rect, { x: t3.coords.x - f2.x, y: t3.coords.y - f2.y })), s2.eventProps.push(d2);
          }
          V(this.edges, t3.edges), s2.delta.x = t3.coords.x - t3.pageCoords.x, s2.delta.y = t3.coords.y - t3.pageCoords.y, s2.rectDelta.left = t3.rect.left - i2.left, s2.rectDelta.right = t3.rect.right - i2.right, s2.rectDelta.top = t3.rect.top - i2.top, s2.rectDelta.bottom = t3.rect.bottom - i2.bottom;
          var h2 = this.result.coords, v2 = this.result.rect;
          if (h2 && v2) {
            var g2 = s2.rect.left !== v2.left || s2.rect.right !== v2.right || s2.rect.top !== v2.top || s2.rect.bottom !== v2.bottom;
            s2.changed = g2 || h2.x !== s2.coords.x || h2.y !== s2.coords.y;
          }
          return s2;
        } }, { key: "applyToInteraction", value: function(t3) {
          var e2 = this.interaction, n2 = t3.phase, r2 = e2.coords.cur, i2 = e2.coords.start, o2 = this.result, a2 = this.startDelta, s2 = o2.delta;
          "start" === n2 && V(this.startDelta, o2.delta);
          for (var c2 = 0, l2 = [[i2, a2], [r2, s2]]; c2 < l2.length; c2++) {
            var u2 = l2[c2], p2 = u2[0], f2 = u2[1];
            p2.page.x += f2.x, p2.page.y += f2.y, p2.client.x += f2.x, p2.client.y += f2.y;
          }
          var d2 = this.result.rectDelta, h2 = t3.rect || e2.rect;
          h2.left += d2.left, h2.right += d2.right, h2.top += d2.top, h2.bottom += d2.bottom, h2.width = h2.right - h2.left, h2.height = h2.bottom - h2.top;
        } }, { key: "setAndApply", value: function(t3) {
          var e2 = this.interaction, n2 = t3.phase, r2 = t3.preEnd, i2 = t3.skipModifiers, o2 = this.setAll(this.fillArg({ preEnd: r2, phase: n2, pageCoords: t3.modifiedCoords || e2.coords.cur.page }));
          if (this.result = o2, !o2.changed && (!i2 || i2 < this.states.length) && e2.interacting()) return false;
          if (t3.modifiedCoords) {
            var a2 = e2.coords.cur.page, s2 = { x: t3.modifiedCoords.x - a2.x, y: t3.modifiedCoords.y - a2.y };
            o2.coords.x += s2.x, o2.coords.y += s2.y, o2.delta.x += s2.x, o2.delta.y += s2.y;
          }
          this.applyToInteraction(t3);
        } }, { key: "beforeEnd", value: function(t3) {
          var e2 = t3.interaction, n2 = t3.event, r2 = this.states;
          if (r2 && r2.length) {
            for (var i2 = false, o2 = 0; o2 < r2.length; o2++) {
              var a2 = r2[o2];
              t3.state = a2;
              var s2 = a2.options, c2 = a2.methods, l2 = c2.beforeEnd && c2.beforeEnd(t3);
              if (l2) return this.endResult = l2, false;
              i2 = i2 || !i2 && this.shouldDo(s2, true, t3.phase, true);
            }
            i2 && e2.move({ event: n2, preEnd: true });
          }
        } }, { key: "stop", value: function(t3) {
          var e2 = t3.interaction;
          if (this.states && this.states.length) {
            var n2 = V({ states: this.states, interactable: e2.interactable, element: e2.element, rect: null }, t3);
            this.fillArg(n2);
            for (var r2 = 0, i2 = this.states; r2 < i2.length; r2++) {
              var o2 = i2[r2];
              n2.state = o2, o2.methods.stop && o2.methods.stop(n2);
            }
            this.states = null, this.endResult = null;
          }
        } }, { key: "prepareStates", value: function(t3) {
          this.states = [];
          for (var e2 = 0; e2 < t3.length; e2++) {
            var n2 = t3[e2], r2 = n2.options, i2 = n2.methods, o2 = n2.name;
            this.states.push({ options: r2, methods: i2, index: e2, name: o2 });
          }
          return this.states;
        } }, { key: "restoreInteractionCoords", value: function(t3) {
          var e2 = t3.interaction, n2 = e2.coords, r2 = e2.rect, i2 = e2.modification;
          if (i2.result) {
            for (var o2 = i2.startDelta, a2 = i2.result, s2 = a2.delta, c2 = a2.rectDelta, l2 = 0, u2 = [[n2.start, o2], [n2.cur, s2]]; l2 < u2.length; l2++) {
              var p2 = u2[l2], f2 = p2[0], d2 = p2[1];
              f2.page.x -= d2.x, f2.page.y -= d2.y, f2.client.x -= d2.x, f2.client.y -= d2.y;
            }
            r2.left -= c2.left, r2.right -= c2.right, r2.top -= c2.top, r2.bottom -= c2.bottom;
          }
        } }, { key: "shouldDo", value: function(t3, e2, n2, r2) {
          return !(!t3 || false === t3.enabled || r2 && !t3.endOnly || t3.endOnly && !e2 || "start" === n2 && !t3.setStart);
        } }, { key: "copyFrom", value: function(t3) {
          this.startOffset = t3.startOffset, this.startDelta = t3.startDelta, this.startEdges = t3.startEdges, this.edges = t3.edges, this.states = t3.states.map(function(t4) {
            return ge(t4);
          }), this.result = ye(V({}, t3.result.coords), V({}, t3.result.rect));
        } }, { key: "destroy", value: function() {
          for (var t3 in this) this[t3] = null;
        } }]), t2;
      }();
      function ye(t2, e2) {
        return { rect: e2, coords: t2, delta: { x: 0, y: 0 }, rectDelta: { left: 0, right: 0, top: 0, bottom: 0 }, eventProps: [], changed: true };
      }
      function be(t2, e2) {
        var n2 = t2.defaults, r2 = { start: t2.start, set: t2.set, beforeEnd: t2.beforeEnd, stop: t2.stop }, i2 = function(t3) {
          var i3 = t3 || {};
          for (var o2 in i3.enabled = false !== i3.enabled, n2) o2 in i3 || (i3[o2] = n2[o2]);
          var a2 = { options: i3, methods: r2, name: e2, enable: function() {
            return i3.enabled = true, a2;
          }, disable: function() {
            return i3.enabled = false, a2;
          } };
          return a2;
        };
        return e2 && "string" == typeof e2 && (i2._defaults = n2, i2._methods = r2), i2;
      }
      function xe(t2) {
        var e2 = t2.iEvent, n2 = t2.interaction.modification.result;
        n2 && (e2.modifiers = n2.eventProps);
      }
      var we = { id: "modifiers/base", before: ["actions"], install: function(t2) {
        t2.defaults.perAction.modifiers = [];
      }, listeners: { "interactions:new": function(t2) {
        var e2 = t2.interaction;
        e2.modification = new me(e2);
      }, "interactions:before-action-start": function(t2) {
        var e2 = t2.interaction, n2 = t2.interaction.modification;
        n2.start(t2, e2.coords.start.page), e2.edges = n2.edges, n2.applyToInteraction(t2);
      }, "interactions:before-action-move": function(t2) {
        var e2 = t2.interaction, n2 = e2.modification, r2 = n2.setAndApply(t2);
        return e2.edges = n2.edges, r2;
      }, "interactions:before-action-end": function(t2) {
        var e2 = t2.interaction, n2 = e2.modification, r2 = n2.beforeEnd(t2);
        return e2.edges = n2.startEdges, r2;
      }, "interactions:action-start": xe, "interactions:action-move": xe, "interactions:action-end": xe, "interactions:after-action-start": function(t2) {
        return t2.interaction.modification.restoreInteractionCoords(t2);
      }, "interactions:after-action-move": function(t2) {
        return t2.interaction.modification.restoreInteractionCoords(t2);
      }, "interactions:stop": function(t2) {
        return t2.interaction.modification.stop(t2);
      } } }, Ee = we, Te = { base: { preventDefault: "auto", deltaSource: "page" }, perAction: { enabled: false, origin: { x: 0, y: 0 } }, actions: {} }, Se = function(t2) {
        s(n2, t2);
        var e2 = p(n2);
        function n2(t3, i2, o2, a2, s2, c2, l2) {
          var p2;
          r(this, n2), (p2 = e2.call(this, t3)).relatedTarget = null, p2.screenX = void 0, p2.screenY = void 0, p2.button = void 0, p2.buttons = void 0, p2.ctrlKey = void 0, p2.shiftKey = void 0, p2.altKey = void 0, p2.metaKey = void 0, p2.page = void 0, p2.client = void 0, p2.delta = void 0, p2.rect = void 0, p2.x0 = void 0, p2.y0 = void 0, p2.t0 = void 0, p2.dt = void 0, p2.duration = void 0, p2.clientX0 = void 0, p2.clientY0 = void 0, p2.velocity = void 0, p2.speed = void 0, p2.swipe = void 0, p2.axes = void 0, p2.preEnd = void 0, s2 = s2 || t3.element;
          var f2 = t3.interactable, d2 = (f2 && f2.options || Te).deltaSource, h2 = K(f2, s2, o2), v2 = "start" === a2, g2 = "end" === a2, m2 = v2 ? u(p2) : t3.prevEvent, y2 = v2 ? t3.coords.start : g2 ? { page: m2.page, client: m2.client, timeStamp: t3.coords.cur.timeStamp } : t3.coords.cur;
          return p2.page = V({}, y2.page), p2.client = V({}, y2.client), p2.rect = V({}, t3.rect), p2.timeStamp = y2.timeStamp, g2 || (p2.page.x -= h2.x, p2.page.y -= h2.y, p2.client.x -= h2.x, p2.client.y -= h2.y), p2.ctrlKey = i2.ctrlKey, p2.altKey = i2.altKey, p2.shiftKey = i2.shiftKey, p2.metaKey = i2.metaKey, p2.button = i2.button, p2.buttons = i2.buttons, p2.target = s2, p2.currentTarget = s2, p2.preEnd = c2, p2.type = l2 || o2 + (a2 || ""), p2.interactable = f2, p2.t0 = v2 ? t3.pointers[t3.pointers.length - 1].downTime : m2.t0, p2.x0 = t3.coords.start.page.x - h2.x, p2.y0 = t3.coords.start.page.y - h2.y, p2.clientX0 = t3.coords.start.client.x - h2.x, p2.clientY0 = t3.coords.start.client.y - h2.y, p2.delta = v2 || g2 ? { x: 0, y: 0 } : { x: p2[d2].x - m2[d2].x, y: p2[d2].y - m2[d2].y }, p2.dt = t3.coords.delta.timeStamp, p2.duration = p2.timeStamp - p2.t0, p2.velocity = V({}, t3.coords.velocity[d2]), p2.speed = Q(p2.velocity.x, p2.velocity.y), p2.swipe = g2 || "inertiastart" === a2 ? p2.getSwipe() : null, p2;
        }
        return o(n2, [{ key: "getSwipe", value: function() {
          var t3 = this._interaction;
          if (t3.prevEvent.speed < 600 || this.timeStamp - t3.prevEvent.timeStamp > 150) return null;
          var e3 = 180 * Math.atan2(t3.prevEvent.velocityY, t3.prevEvent.velocityX) / Math.PI;
          e3 < 0 && (e3 += 360);
          var n3 = 112.5 <= e3 && e3 < 247.5, r2 = 202.5 <= e3 && e3 < 337.5;
          return { up: r2, down: !r2 && 22.5 <= e3 && e3 < 157.5, left: n3, right: !n3 && (292.5 <= e3 || e3 < 67.5), angle: e3, speed: t3.prevEvent.speed, velocity: { x: t3.prevEvent.velocityX, y: t3.prevEvent.velocityY } };
        } }, { key: "preventDefault", value: function() {
        } }, { key: "stopImmediatePropagation", value: function() {
          this.immediatePropagationStopped = this.propagationStopped = true;
        } }, { key: "stopPropagation", value: function() {
          this.propagationStopped = true;
        } }]), n2;
      }(vt);
      Object.defineProperties(Se.prototype, { pageX: { get: function() {
        return this.page.x;
      }, set: function(t2) {
        this.page.x = t2;
      } }, pageY: { get: function() {
        return this.page.y;
      }, set: function(t2) {
        this.page.y = t2;
      } }, clientX: { get: function() {
        return this.client.x;
      }, set: function(t2) {
        this.client.x = t2;
      } }, clientY: { get: function() {
        return this.client.y;
      }, set: function(t2) {
        this.client.y = t2;
      } }, dx: { get: function() {
        return this.delta.x;
      }, set: function(t2) {
        this.delta.x = t2;
      } }, dy: { get: function() {
        return this.delta.y;
      }, set: function(t2) {
        this.delta.y = t2;
      } }, velocityX: { get: function() {
        return this.velocity.x;
      }, set: function(t2) {
        this.velocity.x = t2;
      } }, velocityY: { get: function() {
        return this.velocity.y;
      }, set: function(t2) {
        this.velocity.y = t2;
      } } });
      var _e = o(function t2(e2, n2, i2, o2, a2) {
        r(this, t2), this.id = void 0, this.pointer = void 0, this.event = void 0, this.downTime = void 0, this.downTarget = void 0, this.id = e2, this.pointer = n2, this.event = i2, this.downTime = o2, this.downTarget = a2;
      }), Pe = function(t2) {
        return t2.interactable = "", t2.element = "", t2.prepared = "", t2.pointerIsDown = "", t2.pointerWasMoved = "", t2._proxy = "", t2;
      }({}), Oe = function(t2) {
        return t2.start = "", t2.move = "", t2.end = "", t2.stop = "", t2.interacting = "", t2;
      }({}), ke = 0, De = function() {
        function t2(e2) {
          var n2 = this, i2 = e2.pointerType, o2 = e2.scopeFire;
          r(this, t2), this.interactable = null, this.element = null, this.rect = null, this._rects = void 0, this.edges = null, this._scopeFire = void 0, this.prepared = { name: null, axis: null, edges: null }, this.pointerType = void 0, this.pointers = [], this.downEvent = null, this.downPointer = {}, this._latestPointer = { pointer: null, event: null, eventTarget: null }, this.prevEvent = null, this.pointerIsDown = false, this.pointerWasMoved = false, this._interacting = false, this._ending = false, this._stopped = true, this._proxy = void 0, this.simulation = null, this.doMove = Nt(function(t3) {
            this.move(t3);
          }, "The interaction.doMove() method has been renamed to interaction.move()"), this.coords = { start: { page: { x: 0, y: 0 }, client: { x: 0, y: 0 }, timeStamp: 0 }, prev: { page: { x: 0, y: 0 }, client: { x: 0, y: 0 }, timeStamp: 0 }, cur: { page: { x: 0, y: 0 }, client: { x: 0, y: 0 }, timeStamp: 0 }, delta: { page: { x: 0, y: 0 }, client: { x: 0, y: 0 }, timeStamp: 0 }, velocity: { page: { x: 0, y: 0 }, client: { x: 0, y: 0 }, timeStamp: 0 } }, this._id = ke++, this._scopeFire = o2, this.pointerType = i2;
          var a2 = this;
          this._proxy = {};
          var s2 = function(t3) {
            Object.defineProperty(n2._proxy, t3, { get: function() {
              return a2[t3];
            } });
          };
          for (var c2 in Pe) s2(c2);
          var l2 = function(t3) {
            Object.defineProperty(n2._proxy, t3, { value: function() {
              return a2[t3].apply(a2, arguments);
            } });
          };
          for (var u2 in Oe) l2(u2);
          this._scopeFire("interactions:new", { interaction: this });
        }
        return o(t2, [{ key: "pointerMoveTolerance", get: function() {
          return 1;
        } }, { key: "pointerDown", value: function(t3, e2, n2) {
          var r2 = this.updatePointer(t3, e2, n2, true), i2 = this.pointers[r2];
          this._scopeFire("interactions:down", { pointer: t3, event: e2, eventTarget: n2, pointerIndex: r2, pointerInfo: i2, type: "down", interaction: this });
        } }, { key: "start", value: function(t3, e2, n2) {
          return !(this.interacting() || !this.pointerIsDown || this.pointers.length < ("gesture" === t3.name ? 2 : 1) || !e2.options[t3.name].enabled) && (Ut(this.prepared, t3), this.interactable = e2, this.element = n2, this.rect = e2.getRect(n2), this.edges = this.prepared.edges ? V({}, this.prepared.edges) : { left: true, right: true, top: true, bottom: true }, this._stopped = false, this._interacting = this._doPhase({ interaction: this, event: this.downEvent, phase: "start" }) && !this._stopped, this._interacting);
        } }, { key: "pointerMove", value: function(t3, e2, n2) {
          this.simulation || this.modification && this.modification.endResult || this.updatePointer(t3, e2, n2, false);
          var r2, i2, o2 = this.coords.cur.page.x === this.coords.prev.page.x && this.coords.cur.page.y === this.coords.prev.page.y && this.coords.cur.client.x === this.coords.prev.client.x && this.coords.cur.client.y === this.coords.prev.client.y;
          this.pointerIsDown && !this.pointerWasMoved && (r2 = this.coords.cur.client.x - this.coords.start.client.x, i2 = this.coords.cur.client.y - this.coords.start.client.y, this.pointerWasMoved = Q(r2, i2) > this.pointerMoveTolerance);
          var a2, s2, c2, l2 = this.getPointerIndex(t3), u2 = { pointer: t3, pointerIndex: l2, pointerInfo: this.pointers[l2], event: e2, type: "move", eventTarget: n2, dx: r2, dy: i2, duplicate: o2, interaction: this };
          o2 || (a2 = this.coords.velocity, s2 = this.coords.delta, c2 = Math.max(s2.timeStamp / 1e3, 1e-3), a2.page.x = s2.page.x / c2, a2.page.y = s2.page.y / c2, a2.client.x = s2.client.x / c2, a2.client.y = s2.client.y / c2, a2.timeStamp = c2), this._scopeFire("interactions:move", u2), o2 || this.simulation || (this.interacting() && (u2.type = null, this.move(u2)), this.pointerWasMoved && et(this.coords.prev, this.coords.cur));
        } }, { key: "move", value: function(t3) {
          t3 && t3.event || nt(this.coords.delta), (t3 = V({ pointer: this._latestPointer.pointer, event: this._latestPointer.event, eventTarget: this._latestPointer.eventTarget, interaction: this }, t3 || {})).phase = "move", this._doPhase(t3);
        } }, { key: "pointerUp", value: function(t3, e2, n2, r2) {
          var i2 = this.getPointerIndex(t3);
          -1 === i2 && (i2 = this.updatePointer(t3, e2, n2, false));
          var o2 = /cancel$/i.test(e2.type) ? "cancel" : "up";
          this._scopeFire("interactions:".concat(o2), { pointer: t3, pointerIndex: i2, pointerInfo: this.pointers[i2], event: e2, eventTarget: n2, type: o2, curEventTarget: r2, interaction: this }), this.simulation || this.end(e2), this.removePointer(t3, e2);
        } }, { key: "documentBlur", value: function(t3) {
          this.end(t3), this._scopeFire("interactions:blur", { event: t3, type: "blur", interaction: this });
        } }, { key: "end", value: function(t3) {
          var e2;
          this._ending = true, t3 = t3 || this._latestPointer.event, this.interacting() && (e2 = this._doPhase({ event: t3, interaction: this, phase: "end" })), this._ending = false, true === e2 && this.stop();
        } }, { key: "currentAction", value: function() {
          return this._interacting ? this.prepared.name : null;
        } }, { key: "interacting", value: function() {
          return this._interacting;
        } }, { key: "stop", value: function() {
          this._scopeFire("interactions:stop", { interaction: this }), this.interactable = this.element = null, this._interacting = false, this._stopped = true, this.prepared.name = this.prevEvent = null;
        } }, { key: "getPointerIndex", value: function(t3) {
          var e2 = at(t3);
          return "mouse" === this.pointerType || "pen" === this.pointerType ? this.pointers.length - 1 : yt(this.pointers, function(t4) {
            return t4.id === e2;
          });
        } }, { key: "getPointerInfo", value: function(t3) {
          return this.pointers[this.getPointerIndex(t3)];
        } }, { key: "updatePointer", value: function(t3, e2, n2, r2) {
          var i2, o2, a2, s2 = at(t3), c2 = this.getPointerIndex(t3), l2 = this.pointers[c2];
          return r2 = false !== r2 && (r2 || /(down|start)$/i.test(e2.type)), l2 ? l2.pointer = t3 : (l2 = new _e(s2, t3, e2, null, null), c2 = this.pointers.length, this.pointers.push(l2)), st(this.coords.cur, this.pointers.map(function(t4) {
            return t4.pointer;
          }), this._now()), i2 = this.coords.delta, o2 = this.coords.prev, a2 = this.coords.cur, i2.page.x = a2.page.x - o2.page.x, i2.page.y = a2.page.y - o2.page.y, i2.client.x = a2.client.x - o2.client.x, i2.client.y = a2.client.y - o2.client.y, i2.timeStamp = a2.timeStamp - o2.timeStamp, r2 && (this.pointerIsDown = true, l2.downTime = this.coords.cur.timeStamp, l2.downTarget = n2, tt(this.downPointer, t3), this.interacting() || (et(this.coords.start, this.coords.cur), et(this.coords.prev, this.coords.cur), this.downEvent = e2, this.pointerWasMoved = false)), this._updateLatestPointer(t3, e2, n2), this._scopeFire("interactions:update-pointer", { pointer: t3, event: e2, eventTarget: n2, down: r2, pointerInfo: l2, pointerIndex: c2, interaction: this }), c2;
        } }, { key: "removePointer", value: function(t3, e2) {
          var n2 = this.getPointerIndex(t3);
          if (-1 !== n2) {
            var r2 = this.pointers[n2];
            this._scopeFire("interactions:remove-pointer", { pointer: t3, event: e2, eventTarget: null, pointerIndex: n2, pointerInfo: r2, interaction: this }), this.pointers.splice(n2, 1), this.pointerIsDown = false;
          }
        } }, { key: "_updateLatestPointer", value: function(t3, e2, n2) {
          this._latestPointer.pointer = t3, this._latestPointer.event = e2, this._latestPointer.eventTarget = n2;
        } }, { key: "destroy", value: function() {
          this._latestPointer.pointer = null, this._latestPointer.event = null, this._latestPointer.eventTarget = null;
        } }, { key: "_createPreparedEvent", value: function(t3, e2, n2, r2) {
          return new Se(this, t3, this.prepared.name, e2, this.element, n2, r2);
        } }, { key: "_fireEvent", value: function(t3) {
          var e2;
          null == (e2 = this.interactable) || e2.fire(t3), (!this.prevEvent || t3.timeStamp >= this.prevEvent.timeStamp) && (this.prevEvent = t3);
        } }, { key: "_doPhase", value: function(t3) {
          var e2 = t3.event, n2 = t3.phase, r2 = t3.preEnd, i2 = t3.type, o2 = this.rect;
          if (o2 && "move" === n2 && (H(this.edges, o2, this.coords.delta[this.interactable.options.deltaSource]), o2.width = o2.right - o2.left, o2.height = o2.bottom - o2.top), false === this._scopeFire("interactions:before-action-".concat(n2), t3)) return false;
          var a2 = t3.iEvent = this._createPreparedEvent(e2, n2, r2, i2);
          return this._scopeFire("interactions:action-".concat(n2), t3), "start" === n2 && (this.prevEvent = a2), this._fireEvent(a2), this._scopeFire("interactions:after-action-".concat(n2), t3), true;
        } }, { key: "_now", value: function() {
          return Date.now();
        } }]), t2;
      }();
      function Ie(t2) {
        Me(t2.interaction);
      }
      function Me(t2) {
        if (!function(t3) {
          return !(!t3.offset.pending.x && !t3.offset.pending.y);
        }(t2)) return false;
        var e2 = t2.offset.pending;
        return Ae(t2.coords.cur, e2), Ae(t2.coords.delta, e2), H(t2.edges, t2.rect, e2), e2.x = 0, e2.y = 0, true;
      }
      function ze(t2) {
        var e2 = t2.x, n2 = t2.y;
        this.offset.pending.x += e2, this.offset.pending.y += n2, this.offset.total.x += e2, this.offset.total.y += n2;
      }
      function Ae(t2, e2) {
        var n2 = t2.page, r2 = t2.client, i2 = e2.x, o2 = e2.y;
        n2.x += i2, n2.y += o2, r2.x += i2, r2.y += o2;
      }
      Oe.offsetBy = "";
      var Re = { id: "offset", before: ["modifiers", "pointer-events", "actions", "inertia"], install: function(t2) {
        t2.Interaction.prototype.offsetBy = ze;
      }, listeners: { "interactions:new": function(t2) {
        t2.interaction.offset = { total: { x: 0, y: 0 }, pending: { x: 0, y: 0 } };
      }, "interactions:update-pointer": function(t2) {
        return function(t3) {
          t3.pointerIsDown && (Ae(t3.coords.cur, t3.offset.total), t3.offset.pending.x = 0, t3.offset.pending.y = 0);
        }(t2.interaction);
      }, "interactions:before-action-start": Ie, "interactions:before-action-move": Ie, "interactions:before-action-end": function(t2) {
        var e2 = t2.interaction;
        if (Me(e2)) return e2.move({ offset: true }), e2.end(), false;
      }, "interactions:stop": function(t2) {
        var e2 = t2.interaction;
        e2.offset.total.x = 0, e2.offset.total.y = 0, e2.offset.pending.x = 0, e2.offset.pending.y = 0;
      } } }, Ce = Re;
      var je = function() {
        function t2(e2) {
          r(this, t2), this.active = false, this.isModified = false, this.smoothEnd = false, this.allowResume = false, this.modification = void 0, this.modifierCount = 0, this.modifierArg = void 0, this.startCoords = void 0, this.t0 = 0, this.v0 = 0, this.te = 0, this.targetOffset = void 0, this.modifiedOffset = void 0, this.currentOffset = void 0, this.lambda_v0 = 0, this.one_ve_v0 = 0, this.timeout = void 0, this.interaction = void 0, this.interaction = e2;
        }
        return o(t2, [{ key: "start", value: function(t3) {
          var e2 = this.interaction, n2 = Fe(e2);
          if (!n2 || !n2.enabled) return false;
          var r2 = e2.coords.velocity.client, i2 = Q(r2.x, r2.y), o2 = this.modification || (this.modification = new me(e2));
          if (o2.copyFrom(e2.modification), this.t0 = e2._now(), this.allowResume = n2.allowResume, this.v0 = i2, this.currentOffset = { x: 0, y: 0 }, this.startCoords = e2.coords.cur.page, this.modifierArg = o2.fillArg({ pageCoords: this.startCoords, preEnd: true, phase: "inertiastart" }), this.t0 - e2.coords.cur.timeStamp < 50 && i2 > n2.minSpeed && i2 > n2.endSpeed) this.startInertia();
          else {
            if (o2.result = o2.setAll(this.modifierArg), !o2.result.changed) return false;
            this.startSmoothEnd();
          }
          return e2.modification.result.rect = null, e2.offsetBy(this.targetOffset), e2._doPhase({ interaction: e2, event: t3, phase: "inertiastart" }), e2.offsetBy({ x: -this.targetOffset.x, y: -this.targetOffset.y }), e2.modification.result.rect = null, this.active = true, e2.simulation = this, true;
        } }, { key: "startInertia", value: function() {
          var t3 = this, e2 = this.interaction.coords.velocity.client, n2 = Fe(this.interaction), r2 = n2.resistance, i2 = -Math.log(n2.endSpeed / this.v0) / r2;
          this.targetOffset = { x: (e2.x - i2) / r2, y: (e2.y - i2) / r2 }, this.te = i2, this.lambda_v0 = r2 / this.v0, this.one_ve_v0 = 1 - n2.endSpeed / this.v0;
          var o2 = this.modification, a2 = this.modifierArg;
          a2.pageCoords = { x: this.startCoords.x + this.targetOffset.x, y: this.startCoords.y + this.targetOffset.y }, o2.result = o2.setAll(a2), o2.result.changed && (this.isModified = true, this.modifiedOffset = { x: this.targetOffset.x + o2.result.delta.x, y: this.targetOffset.y + o2.result.delta.y }), this.onNextFrame(function() {
            return t3.inertiaTick();
          });
        } }, { key: "startSmoothEnd", value: function() {
          var t3 = this;
          this.smoothEnd = true, this.isModified = true, this.targetOffset = { x: this.modification.result.delta.x, y: this.modification.result.delta.y }, this.onNextFrame(function() {
            return t3.smoothEndTick();
          });
        } }, { key: "onNextFrame", value: function(t3) {
          var e2 = this;
          this.timeout = Lt.request(function() {
            e2.active && t3();
          });
        } }, { key: "inertiaTick", value: function() {
          var t3, e2, n2, r2, i2, o2, a2, s2 = this, c2 = this.interaction, l2 = Fe(c2).resistance, u2 = (c2._now() - this.t0) / 1e3;
          if (u2 < this.te) {
            var p2, f2 = 1 - (Math.exp(-l2 * u2) - this.lambda_v0) / this.one_ve_v0;
            this.isModified ? (t3 = 0, e2 = 0, n2 = this.targetOffset.x, r2 = this.targetOffset.y, i2 = this.modifiedOffset.x, o2 = this.modifiedOffset.y, p2 = { x: Ye(a2 = f2, t3, n2, i2), y: Ye(a2, e2, r2, o2) }) : p2 = { x: this.targetOffset.x * f2, y: this.targetOffset.y * f2 };
            var d2 = { x: p2.x - this.currentOffset.x, y: p2.y - this.currentOffset.y };
            this.currentOffset.x += d2.x, this.currentOffset.y += d2.y, c2.offsetBy(d2), c2.move(), this.onNextFrame(function() {
              return s2.inertiaTick();
            });
          } else c2.offsetBy({ x: this.modifiedOffset.x - this.currentOffset.x, y: this.modifiedOffset.y - this.currentOffset.y }), this.end();
        } }, { key: "smoothEndTick", value: function() {
          var t3 = this, e2 = this.interaction, n2 = e2._now() - this.t0, r2 = Fe(e2).smoothEndDuration;
          if (n2 < r2) {
            var i2 = { x: Le(n2, 0, this.targetOffset.x, r2), y: Le(n2, 0, this.targetOffset.y, r2) }, o2 = { x: i2.x - this.currentOffset.x, y: i2.y - this.currentOffset.y };
            this.currentOffset.x += o2.x, this.currentOffset.y += o2.y, e2.offsetBy(o2), e2.move({ skipModifiers: this.modifierCount }), this.onNextFrame(function() {
              return t3.smoothEndTick();
            });
          } else e2.offsetBy({ x: this.targetOffset.x - this.currentOffset.x, y: this.targetOffset.y - this.currentOffset.y }), this.end();
        } }, { key: "resume", value: function(t3) {
          var e2 = t3.pointer, n2 = t3.event, r2 = t3.eventTarget, i2 = this.interaction;
          i2.offsetBy({ x: -this.currentOffset.x, y: -this.currentOffset.y }), i2.updatePointer(e2, n2, r2, true), i2._doPhase({ interaction: i2, event: n2, phase: "resume" }), et(i2.coords.prev, i2.coords.cur), this.stop();
        } }, { key: "end", value: function() {
          this.interaction.move(), this.interaction.end(), this.stop();
        } }, { key: "stop", value: function() {
          this.active = this.smoothEnd = false, this.interaction.simulation = null, Lt.cancel(this.timeout);
        } }]), t2;
      }();
      function Fe(t2) {
        var e2 = t2.interactable, n2 = t2.prepared;
        return e2 && e2.options && n2.name && e2.options[n2.name].inertia;
      }
      var Xe = { id: "inertia", before: ["modifiers", "actions"], install: function(t2) {
        var e2 = t2.defaults;
        t2.usePlugin(Ce), t2.usePlugin(Ee), t2.actions.phases.inertiastart = true, t2.actions.phases.resume = true, e2.perAction.inertia = { enabled: false, resistance: 10, minSpeed: 100, endSpeed: 10, allowResume: true, smoothEndDuration: 300 };
      }, listeners: { "interactions:new": function(t2) {
        var e2 = t2.interaction;
        e2.inertia = new je(e2);
      }, "interactions:before-action-end": function(t2) {
        var e2 = t2.interaction, n2 = t2.event;
        return (!e2._interacting || e2.simulation || !e2.inertia.start(n2)) && null;
      }, "interactions:down": function(t2) {
        var e2 = t2.interaction, n2 = t2.eventTarget, r2 = e2.inertia;
        if (r2.active) for (var i2 = n2; w.element(i2); ) {
          if (i2 === e2.element) {
            r2.resume(t2);
            break;
          }
          i2 = A(i2);
        }
      }, "interactions:stop": function(t2) {
        var e2 = t2.interaction.inertia;
        e2.active && e2.stop();
      }, "interactions:before-action-resume": function(t2) {
        var e2 = t2.interaction.modification;
        e2.stop(t2), e2.start(t2, t2.interaction.coords.cur.page), e2.applyToInteraction(t2);
      }, "interactions:before-action-inertiastart": function(t2) {
        return t2.interaction.modification.setAndApply(t2);
      }, "interactions:action-resume": xe, "interactions:action-inertiastart": xe, "interactions:after-action-inertiastart": function(t2) {
        return t2.interaction.modification.restoreInteractionCoords(t2);
      }, "interactions:after-action-resume": function(t2) {
        return t2.interaction.modification.restoreInteractionCoords(t2);
      } } };
      function Ye(t2, e2, n2, r2) {
        var i2 = 1 - t2;
        return i2 * i2 * e2 + 2 * i2 * t2 * n2 + t2 * t2 * r2;
      }
      function Le(t2, e2, n2, r2) {
        return -n2 * (t2 /= r2) * (t2 - 2) + e2;
      }
      var qe = Xe;
      function Be(t2, e2) {
        for (var n2 = 0; n2 < e2.length; n2++) {
          var r2 = e2[n2];
          if (t2.immediatePropagationStopped) break;
          r2(t2);
        }
      }
      var Ve = function() {
        function t2(e2) {
          r(this, t2), this.options = void 0, this.types = {}, this.propagationStopped = false, this.immediatePropagationStopped = false, this.global = void 0, this.options = V({}, e2 || {});
        }
        return o(t2, [{ key: "fire", value: function(t3) {
          var e2, n2 = this.global;
          (e2 = this.types[t3.type]) && Be(t3, e2), !t3.propagationStopped && n2 && (e2 = n2[t3.type]) && Be(t3, e2);
        } }, { key: "on", value: function(t3, e2) {
          var n2 = $(t3, e2);
          for (t3 in n2) this.types[t3] = gt(this.types[t3] || [], n2[t3]);
        } }, { key: "off", value: function(t3, e2) {
          var n2 = $(t3, e2);
          for (t3 in n2) {
            var r2 = this.types[t3];
            if (r2 && r2.length) for (var i2 = 0, o2 = n2[t3]; i2 < o2.length; i2++) {
              var a2 = o2[i2], s2 = r2.indexOf(a2);
              -1 !== s2 && r2.splice(s2, 1);
            }
          }
        } }, { key: "getRect", value: function(t3) {
          return null;
        } }]), t2;
      }();
      var We = function() {
        function t2(e2) {
          r(this, t2), this.currentTarget = void 0, this.originalEvent = void 0, this.type = void 0, this.originalEvent = e2, tt(this, e2);
        }
        return o(t2, [{ key: "preventOriginalDefault", value: function() {
          this.originalEvent.preventDefault();
        } }, { key: "stopPropagation", value: function() {
          this.originalEvent.stopPropagation();
        } }, { key: "stopImmediatePropagation", value: function() {
          this.originalEvent.stopImmediatePropagation();
        } }]), t2;
      }();
      function Ge(t2) {
        return w.object(t2) ? { capture: !!t2.capture, passive: !!t2.passive } : { capture: !!t2, passive: false };
      }
      function Ne(t2, e2) {
        return t2 === e2 || ("boolean" == typeof t2 ? !!e2.capture === t2 && false == !!e2.passive : !!t2.capture == !!e2.capture && !!t2.passive == !!e2.passive);
      }
      var Ue = { id: "events", install: function(t2) {
        var e2, n2 = [], r2 = {}, i2 = [], o2 = { add: a2, remove: s2, addDelegate: function(t3, e3, n3, o3, s3) {
          var u2 = Ge(s3);
          if (!r2[n3]) {
            r2[n3] = [];
            for (var p2 = 0; p2 < i2.length; p2++) {
              var f2 = i2[p2];
              a2(f2, n3, c2), a2(f2, n3, l2, true);
            }
          }
          var d2 = r2[n3], h2 = bt(d2, function(n4) {
            return n4.selector === t3 && n4.context === e3;
          });
          h2 || (h2 = { selector: t3, context: e3, listeners: [] }, d2.push(h2));
          h2.listeners.push({ func: o3, options: u2 });
        }, removeDelegate: function(t3, e3, n3, i3, o3) {
          var a3, u2 = Ge(o3), p2 = r2[n3], f2 = false;
          if (!p2) return;
          for (a3 = p2.length - 1; a3 >= 0; a3--) {
            var d2 = p2[a3];
            if (d2.selector === t3 && d2.context === e3) {
              for (var h2 = d2.listeners, v2 = h2.length - 1; v2 >= 0; v2--) {
                var g2 = h2[v2];
                if (g2.func === i3 && Ne(g2.options, u2)) {
                  h2.splice(v2, 1), h2.length || (p2.splice(a3, 1), s2(e3, n3, c2), s2(e3, n3, l2, true)), f2 = true;
                  break;
                }
              }
              if (f2) break;
            }
          }
        }, delegateListener: c2, delegateUseCapture: l2, delegatedEvents: r2, documents: i2, targets: n2, supportsOptions: false, supportsPassive: false };
        function a2(t3, e3, r3, i3) {
          if (t3.addEventListener) {
            var a3 = Ge(i3), s3 = bt(n2, function(e4) {
              return e4.eventTarget === t3;
            });
            s3 || (s3 = { eventTarget: t3, events: {} }, n2.push(s3)), s3.events[e3] || (s3.events[e3] = []), bt(s3.events[e3], function(t4) {
              return t4.func === r3 && Ne(t4.options, a3);
            }) || (t3.addEventListener(e3, r3, o2.supportsOptions ? a3 : a3.capture), s3.events[e3].push({ func: r3, options: a3 }));
          }
        }
        function s2(t3, e3, r3, i3) {
          if (t3.addEventListener && t3.removeEventListener) {
            var a3 = yt(n2, function(e4) {
              return e4.eventTarget === t3;
            }), c3 = n2[a3];
            if (c3 && c3.events) if ("all" !== e3) {
              var l3 = false, u2 = c3.events[e3];
              if (u2) {
                if ("all" === r3) {
                  for (var p2 = u2.length - 1; p2 >= 0; p2--) {
                    var f2 = u2[p2];
                    s2(t3, e3, f2.func, f2.options);
                  }
                  return;
                }
                for (var d2 = Ge(i3), h2 = 0; h2 < u2.length; h2++) {
                  var v2 = u2[h2];
                  if (v2.func === r3 && Ne(v2.options, d2)) {
                    t3.removeEventListener(e3, r3, o2.supportsOptions ? d2 : d2.capture), u2.splice(h2, 1), 0 === u2.length && (delete c3.events[e3], l3 = true);
                    break;
                  }
                }
              }
              l3 && !Object.keys(c3.events).length && n2.splice(a3, 1);
            } else for (e3 in c3.events) c3.events.hasOwnProperty(e3) && s2(t3, e3, "all");
          }
        }
        function c2(t3, e3) {
          for (var n3 = Ge(e3), i3 = new We(t3), o3 = r2[t3.type], a3 = ht(t3)[0], s3 = a3; w.element(s3); ) {
            for (var c3 = 0; c3 < o3.length; c3++) {
              var l3 = o3[c3], u2 = l3.selector, p2 = l3.context;
              if (R(s3, u2) && M(p2, a3) && M(p2, s3)) {
                var f2 = l3.listeners;
                i3.currentTarget = s3;
                for (var d2 = 0; d2 < f2.length; d2++) {
                  var h2 = f2[d2];
                  Ne(h2.options, n3) && h2.func(i3);
                }
              }
            }
            s3 = A(s3);
          }
        }
        function l2(t3) {
          return c2(t3, true);
        }
        return null == (e2 = t2.document) || e2.createElement("div").addEventListener("test", null, { get capture() {
          return o2.supportsOptions = true;
        }, get passive() {
          return o2.supportsPassive = true;
        } }), t2.events = o2, o2;
      } }, He = { methodOrder: ["simulationResume", "mouseOrPen", "hasPointer", "idle"], search: function(t2) {
        for (var e2 = 0, n2 = He.methodOrder; e2 < n2.length; e2++) {
          var r2 = n2[e2], i2 = He[r2](t2);
          if (i2) return i2;
        }
        return null;
      }, simulationResume: function(t2) {
        var e2 = t2.pointerType, n2 = t2.eventType, r2 = t2.eventTarget, i2 = t2.scope;
        if (!/down|start/i.test(n2)) return null;
        for (var o2 = 0, a2 = i2.interactions.list; o2 < a2.length; o2++) {
          var s2 = a2[o2], c2 = r2;
          if (s2.simulation && s2.simulation.allowResume && s2.pointerType === e2) for (; c2; ) {
            if (c2 === s2.element) return s2;
            c2 = A(c2);
          }
        }
        return null;
      }, mouseOrPen: function(t2) {
        var e2, n2 = t2.pointerId, r2 = t2.pointerType, i2 = t2.eventType, o2 = t2.scope;
        if ("mouse" !== r2 && "pen" !== r2) return null;
        for (var a2 = 0, s2 = o2.interactions.list; a2 < s2.length; a2++) {
          var c2 = s2[a2];
          if (c2.pointerType === r2) {
            if (c2.simulation && !Ke(c2, n2)) continue;
            if (c2.interacting()) return c2;
            e2 || (e2 = c2);
          }
        }
        if (e2) return e2;
        for (var l2 = 0, u2 = o2.interactions.list; l2 < u2.length; l2++) {
          var p2 = u2[l2];
          if (!(p2.pointerType !== r2 || /down/i.test(i2) && p2.simulation)) return p2;
        }
        return null;
      }, hasPointer: function(t2) {
        for (var e2 = t2.pointerId, n2 = 0, r2 = t2.scope.interactions.list; n2 < r2.length; n2++) {
          var i2 = r2[n2];
          if (Ke(i2, e2)) return i2;
        }
        return null;
      }, idle: function(t2) {
        for (var e2 = t2.pointerType, n2 = 0, r2 = t2.scope.interactions.list; n2 < r2.length; n2++) {
          var i2 = r2[n2];
          if (1 === i2.pointers.length) {
            var o2 = i2.interactable;
            if (o2 && (!o2.options.gesture || !o2.options.gesture.enabled)) continue;
          } else if (i2.pointers.length >= 2) continue;
          if (!i2.interacting() && e2 === i2.pointerType) return i2;
        }
        return null;
      } };
      function Ke(t2, e2) {
        return t2.pointers.some(function(t3) {
          return t3.id === e2;
        });
      }
      var $e = He, Je = ["pointerDown", "pointerMove", "pointerUp", "updatePointer", "removePointer", "windowBlur"];
      function Qe(t2, e2) {
        return function(n2) {
          var r2 = e2.interactions.list, i2 = dt(n2), o2 = ht(n2), a2 = o2[0], s2 = o2[1], c2 = [];
          if (/^touch/.test(n2.type)) {
            e2.prevTouchTime = e2.now();
            for (var l2 = 0, u2 = n2.changedTouches; l2 < u2.length; l2++) {
              var p2 = u2[l2], f2 = { pointer: p2, pointerId: at(p2), pointerType: i2, eventType: n2.type, eventTarget: a2, curEventTarget: s2, scope: e2 }, d2 = Ze(f2);
              c2.push([f2.pointer, f2.eventTarget, f2.curEventTarget, d2]);
            }
          } else {
            var h2 = false;
            if (!I.supportsPointerEvent && /mouse/.test(n2.type)) {
              for (var v2 = 0; v2 < r2.length && !h2; v2++) h2 = "mouse" !== r2[v2].pointerType && r2[v2].pointerIsDown;
              h2 = h2 || e2.now() - e2.prevTouchTime < 500 || 0 === n2.timeStamp;
            }
            if (!h2) {
              var g2 = { pointer: n2, pointerId: at(n2), pointerType: i2, eventType: n2.type, curEventTarget: s2, eventTarget: a2, scope: e2 }, m2 = Ze(g2);
              c2.push([g2.pointer, g2.eventTarget, g2.curEventTarget, m2]);
            }
          }
          for (var y2 = 0; y2 < c2.length; y2++) {
            var b2 = c2[y2], x2 = b2[0], w2 = b2[1], E2 = b2[2];
            b2[3][t2](x2, n2, w2, E2);
          }
        };
      }
      function Ze(t2) {
        var e2 = t2.pointerType, n2 = t2.scope, r2 = { interaction: $e.search(t2), searchDetails: t2 };
        return n2.fire("interactions:find", r2), r2.interaction || n2.interactions.new({ pointerType: e2 });
      }
      function tn(t2, e2) {
        var n2 = t2.doc, r2 = t2.scope, i2 = t2.options, o2 = r2.interactions.docEvents, a2 = r2.events, s2 = a2[e2];
        for (var c2 in r2.browser.isIOS && !i2.events && (i2.events = { passive: false }), a2.delegatedEvents) s2(n2, c2, a2.delegateListener), s2(n2, c2, a2.delegateUseCapture, true);
        for (var l2 = i2 && i2.events, u2 = 0; u2 < o2.length; u2++) {
          var p2 = o2[u2];
          s2(n2, p2.type, p2.listener, l2);
        }
      }
      var en = { id: "core/interactions", install: function(t2) {
        for (var e2 = {}, n2 = 0; n2 < Je.length; n2++) {
          var i2 = Je[n2];
          e2[i2] = Qe(i2, t2);
        }
        var a2, c2 = I.pEventTypes;
        function l2() {
          for (var e3 = 0, n3 = t2.interactions.list; e3 < n3.length; e3++) {
            var r2 = n3[e3];
            if (r2.pointerIsDown && "touch" === r2.pointerType && !r2._interacting) for (var i3 = function() {
              var e4 = a3[o2];
              t2.documents.some(function(t3) {
                return M(t3.doc, e4.downTarget);
              }) || r2.removePointer(e4.pointer, e4.event);
            }, o2 = 0, a3 = r2.pointers; o2 < a3.length; o2++) i3();
          }
        }
        (a2 = k.PointerEvent ? [{ type: c2.down, listener: l2 }, { type: c2.down, listener: e2.pointerDown }, { type: c2.move, listener: e2.pointerMove }, { type: c2.up, listener: e2.pointerUp }, { type: c2.cancel, listener: e2.pointerUp }] : [{ type: "mousedown", listener: e2.pointerDown }, { type: "mousemove", listener: e2.pointerMove }, { type: "mouseup", listener: e2.pointerUp }, { type: "touchstart", listener: l2 }, { type: "touchstart", listener: e2.pointerDown }, { type: "touchmove", listener: e2.pointerMove }, { type: "touchend", listener: e2.pointerUp }, { type: "touchcancel", listener: e2.pointerUp }]).push({ type: "blur", listener: function(e3) {
          for (var n3 = 0, r2 = t2.interactions.list; n3 < r2.length; n3++) {
            r2[n3].documentBlur(e3);
          }
        } }), t2.prevTouchTime = 0, t2.Interaction = function(e3) {
          s(i3, e3);
          var n3 = p(i3);
          function i3() {
            return r(this, i3), n3.apply(this, arguments);
          }
          return o(i3, [{ key: "pointerMoveTolerance", get: function() {
            return t2.interactions.pointerMoveTolerance;
          }, set: function(e4) {
            t2.interactions.pointerMoveTolerance = e4;
          } }, { key: "_now", value: function() {
            return t2.now();
          } }]), i3;
        }(De), t2.interactions = { list: [], new: function(e3) {
          e3.scopeFire = function(e4, n4) {
            return t2.fire(e4, n4);
          };
          var n3 = new t2.Interaction(e3);
          return t2.interactions.list.push(n3), n3;
        }, listeners: e2, docEvents: a2, pointerMoveTolerance: 1 }, t2.usePlugin(he);
      }, listeners: { "scope:add-document": function(t2) {
        return tn(t2, "add");
      }, "scope:remove-document": function(t2) {
        return tn(t2, "remove");
      }, "interactable:unset": function(t2, e2) {
        for (var n2 = t2.interactable, r2 = e2.interactions.list.length - 1; r2 >= 0; r2--) {
          var i2 = e2.interactions.list[r2];
          i2.interactable === n2 && (i2.stop(), e2.fire("interactions:destroy", { interaction: i2 }), i2.destroy(), e2.interactions.list.length > 2 && e2.interactions.list.splice(r2, 1));
        }
      } }, onDocSignal: tn, doOnInteractions: Qe, methodNames: Je }, nn = en, rn = function(t2) {
        return t2[t2.On = 0] = "On", t2[t2.Off = 1] = "Off", t2;
      }(rn || {}), on = function() {
        function t2(e2, n2, i2, o2) {
          r(this, t2), this.target = void 0, this.options = void 0, this._actions = void 0, this.events = new Ve(), this._context = void 0, this._win = void 0, this._doc = void 0, this._scopeEvents = void 0, this._actions = n2.actions, this.target = e2, this._context = n2.context || i2, this._win = y(B(e2) ? this._context : e2), this._doc = this._win.document, this._scopeEvents = o2, this.set(n2);
        }
        return o(t2, [{ key: "_defaults", get: function() {
          return { base: {}, perAction: {}, actions: {} };
        } }, { key: "setOnEvents", value: function(t3, e2) {
          return w.func(e2.onstart) && this.on("".concat(t3, "start"), e2.onstart), w.func(e2.onmove) && this.on("".concat(t3, "move"), e2.onmove), w.func(e2.onend) && this.on("".concat(t3, "end"), e2.onend), w.func(e2.oninertiastart) && this.on("".concat(t3, "inertiastart"), e2.oninertiastart), this;
        } }, { key: "updatePerActionListeners", value: function(t3, e2, n2) {
          var r2, i2 = this, o2 = null == (r2 = this._actions.map[t3]) ? void 0 : r2.filterEventType, a2 = function(t4) {
            return (null == o2 || o2(t4)) && ve(t4, i2._actions);
          };
          (w.array(e2) || w.object(e2)) && this._onOff(rn.Off, t3, e2, void 0, a2), (w.array(n2) || w.object(n2)) && this._onOff(rn.On, t3, n2, void 0, a2);
        } }, { key: "setPerAction", value: function(t3, e2) {
          var n2 = this._defaults;
          for (var r2 in e2) {
            var i2 = r2, o2 = this.options[t3], a2 = e2[i2];
            "listeners" === i2 && this.updatePerActionListeners(t3, o2.listeners, a2), w.array(a2) ? o2[i2] = mt(a2) : w.plainObject(a2) ? (o2[i2] = V(o2[i2] || {}, ge(a2)), w.object(n2.perAction[i2]) && "enabled" in n2.perAction[i2] && (o2[i2].enabled = false !== a2.enabled)) : w.bool(a2) && w.object(n2.perAction[i2]) ? o2[i2].enabled = a2 : o2[i2] = a2;
          }
        } }, { key: "getRect", value: function(t3) {
          return t3 = t3 || (w.element(this.target) ? this.target : null), w.string(this.target) && (t3 = t3 || this._context.querySelector(this.target)), L(t3);
        } }, { key: "rectChecker", value: function(t3) {
          var e2 = this;
          return w.func(t3) ? (this.getRect = function(n2) {
            var r2 = V({}, t3.apply(e2, n2));
            return "width" in r2 || (r2.width = r2.right - r2.left, r2.height = r2.bottom - r2.top), r2;
          }, this) : null === t3 ? (delete this.getRect, this) : this.getRect;
        } }, { key: "_backCompatOption", value: function(t3, e2) {
          if (B(e2) || w.object(e2)) {
            for (var n2 in this.options[t3] = e2, this._actions.map) this.options[n2][t3] = e2;
            return this;
          }
          return this.options[t3];
        } }, { key: "origin", value: function(t3) {
          return this._backCompatOption("origin", t3);
        } }, { key: "deltaSource", value: function(t3) {
          return "page" === t3 || "client" === t3 ? (this.options.deltaSource = t3, this) : this.options.deltaSource;
        } }, { key: "getAllElements", value: function() {
          var t3 = this.target;
          return w.string(t3) ? Array.from(this._context.querySelectorAll(t3)) : w.func(t3) && t3.getAllElements ? t3.getAllElements() : w.element(t3) ? [t3] : [];
        } }, { key: "context", value: function() {
          return this._context;
        } }, { key: "inContext", value: function(t3) {
          return this._context === t3.ownerDocument || M(this._context, t3);
        } }, { key: "testIgnoreAllow", value: function(t3, e2, n2) {
          return !this.testIgnore(t3.ignoreFrom, e2, n2) && this.testAllow(t3.allowFrom, e2, n2);
        } }, { key: "testAllow", value: function(t3, e2, n2) {
          return !t3 || !!w.element(n2) && (w.string(t3) ? F(n2, t3, e2) : !!w.element(t3) && M(t3, n2));
        } }, { key: "testIgnore", value: function(t3, e2, n2) {
          return !(!t3 || !w.element(n2)) && (w.string(t3) ? F(n2, t3, e2) : !!w.element(t3) && M(t3, n2));
        } }, { key: "fire", value: function(t3) {
          return this.events.fire(t3), this;
        } }, { key: "_onOff", value: function(t3, e2, n2, r2, i2) {
          w.object(e2) && !w.array(e2) && (r2 = n2, n2 = null);
          var o2 = $(e2, n2, i2);
          for (var a2 in o2) {
            "wheel" === a2 && (a2 = I.wheelEvent);
            for (var s2 = 0, c2 = o2[a2]; s2 < c2.length; s2++) {
              var l2 = c2[s2];
              ve(a2, this._actions) ? this.events[t3 === rn.On ? "on" : "off"](a2, l2) : w.string(this.target) ? this._scopeEvents[t3 === rn.On ? "addDelegate" : "removeDelegate"](this.target, this._context, a2, l2, r2) : this._scopeEvents[t3 === rn.On ? "add" : "remove"](this.target, a2, l2, r2);
            }
          }
          return this;
        } }, { key: "on", value: function(t3, e2, n2) {
          return this._onOff(rn.On, t3, e2, n2);
        } }, { key: "off", value: function(t3, e2, n2) {
          return this._onOff(rn.Off, t3, e2, n2);
        } }, { key: "set", value: function(t3) {
          var e2 = this._defaults;
          for (var n2 in w.object(t3) || (t3 = {}), this.options = ge(e2.base), this._actions.methodDict) {
            var r2 = n2, i2 = this._actions.methodDict[r2];
            this.options[r2] = {}, this.setPerAction(r2, V(V({}, e2.perAction), e2.actions[r2])), this[i2](t3[r2]);
          }
          for (var o2 in t3) "getRect" !== o2 ? w.func(this[o2]) && this[o2](t3[o2]) : this.rectChecker(t3.getRect);
          return this;
        } }, { key: "unset", value: function() {
          if (w.string(this.target)) for (var t3 in this._scopeEvents.delegatedEvents) for (var e2 = this._scopeEvents.delegatedEvents[t3], n2 = e2.length - 1; n2 >= 0; n2--) {
            var r2 = e2[n2], i2 = r2.selector, o2 = r2.context, a2 = r2.listeners;
            i2 === this.target && o2 === this._context && e2.splice(n2, 1);
            for (var s2 = a2.length - 1; s2 >= 0; s2--) this._scopeEvents.removeDelegate(this.target, this._context, t3, a2[s2][0], a2[s2][1]);
          }
          else this._scopeEvents.remove(this.target, "all");
        } }]), t2;
      }(), an = function() {
        function t2(e2) {
          var n2 = this;
          r(this, t2), this.list = [], this.selectorMap = {}, this.scope = void 0, this.scope = e2, e2.addListeners({ "interactable:unset": function(t3) {
            var e3 = t3.interactable, r2 = e3.target, i2 = w.string(r2) ? n2.selectorMap[r2] : r2[n2.scope.id], o2 = yt(i2, function(t4) {
              return t4 === e3;
            });
            i2.splice(o2, 1);
          } });
        }
        return o(t2, [{ key: "new", value: function(t3, e2) {
          e2 = V(e2 || {}, { actions: this.scope.actions });
          var n2 = new this.scope.Interactable(t3, e2, this.scope.document, this.scope.events);
          return this.scope.addDocument(n2._doc), this.list.push(n2), w.string(t3) ? (this.selectorMap[t3] || (this.selectorMap[t3] = []), this.selectorMap[t3].push(n2)) : (n2.target[this.scope.id] || Object.defineProperty(t3, this.scope.id, { value: [], configurable: true }), t3[this.scope.id].push(n2)), this.scope.fire("interactable:new", { target: t3, options: e2, interactable: n2, win: this.scope._win }), n2;
        } }, { key: "getExisting", value: function(t3, e2) {
          var n2 = e2 && e2.context || this.scope.document, r2 = w.string(t3), i2 = r2 ? this.selectorMap[t3] : t3[this.scope.id];
          if (i2) return bt(i2, function(e3) {
            return e3._context === n2 && (r2 || e3.inContext(t3));
          });
        } }, { key: "forEachMatch", value: function(t3, e2) {
          for (var n2 = 0, r2 = this.list; n2 < r2.length; n2++) {
            var i2 = r2[n2], o2 = void 0;
            if ((w.string(i2.target) ? w.element(t3) && R(t3, i2.target) : t3 === i2.target) && i2.inContext(t3) && (o2 = e2(i2)), void 0 !== o2) return o2;
          }
        } }]), t2;
      }();
      var sn = function() {
        function t2() {
          var e2 = this;
          r(this, t2), this.id = "__interact_scope_".concat(Math.floor(100 * Math.random())), this.isInitialized = false, this.listenerMaps = [], this.browser = I, this.defaults = ge(Te), this.Eventable = Ve, this.actions = { map: {}, phases: { start: true, move: true, end: true }, methodDict: {}, phaselessTypes: {} }, this.interactStatic = function(t3) {
            var e3 = function e4(n3, r2) {
              var i2 = t3.interactables.getExisting(n3, r2);
              return i2 || ((i2 = t3.interactables.new(n3, r2)).events.global = e4.globalEvents), i2;
            };
            return e3.getPointerAverage = lt, e3.getTouchBBox = ut, e3.getTouchDistance = pt, e3.getTouchAngle = ft, e3.getElementRect = L, e3.getElementClientRect = Y, e3.matchesSelector = R, e3.closest = z, e3.globalEvents = {}, e3.version = "1.10.27", e3.scope = t3, e3.use = function(t4, e4) {
              return this.scope.usePlugin(t4, e4), this;
            }, e3.isSet = function(t4, e4) {
              return !!this.scope.interactables.get(t4, e4 && e4.context);
            }, e3.on = Nt(function(t4, e4, n3) {
              if (w.string(t4) && -1 !== t4.search(" ") && (t4 = t4.trim().split(/ +/)), w.array(t4)) {
                for (var r2 = 0, i2 = t4; r2 < i2.length; r2++) {
                  var o2 = i2[r2];
                  this.on(o2, e4, n3);
                }
                return this;
              }
              if (w.object(t4)) {
                for (var a2 in t4) this.on(a2, t4[a2], e4);
                return this;
              }
              return ve(t4, this.scope.actions) ? this.globalEvents[t4] ? this.globalEvents[t4].push(e4) : this.globalEvents[t4] = [e4] : this.scope.events.add(this.scope.document, t4, e4, { options: n3 }), this;
            }, "The interact.on() method is being deprecated"), e3.off = Nt(function(t4, e4, n3) {
              if (w.string(t4) && -1 !== t4.search(" ") && (t4 = t4.trim().split(/ +/)), w.array(t4)) {
                for (var r2 = 0, i2 = t4; r2 < i2.length; r2++) {
                  var o2 = i2[r2];
                  this.off(o2, e4, n3);
                }
                return this;
              }
              if (w.object(t4)) {
                for (var a2 in t4) this.off(a2, t4[a2], e4);
                return this;
              }
              var s2;
              return ve(t4, this.scope.actions) ? t4 in this.globalEvents && -1 !== (s2 = this.globalEvents[t4].indexOf(e4)) && this.globalEvents[t4].splice(s2, 1) : this.scope.events.remove(this.scope.document, t4, e4, n3), this;
            }, "The interact.off() method is being deprecated"), e3.debug = function() {
              return this.scope;
            }, e3.supportsTouch = function() {
              return I.supportsTouch;
            }, e3.supportsPointerEvent = function() {
              return I.supportsPointerEvent;
            }, e3.stop = function() {
              for (var t4 = 0, e4 = this.scope.interactions.list; t4 < e4.length; t4++) e4[t4].stop();
              return this;
            }, e3.pointerMoveTolerance = function(t4) {
              return w.number(t4) ? (this.scope.interactions.pointerMoveTolerance = t4, this) : this.scope.interactions.pointerMoveTolerance;
            }, e3.addDocument = function(t4, e4) {
              this.scope.addDocument(t4, e4);
            }, e3.removeDocument = function(t4) {
              this.scope.removeDocument(t4);
            }, e3;
          }(this), this.InteractEvent = Se, this.Interactable = void 0, this.interactables = new an(this), this._win = void 0, this.document = void 0, this.window = void 0, this.documents = [], this._plugins = { list: [], map: {} }, this.onWindowUnload = function(t3) {
            return e2.removeDocument(t3.target);
          };
          var n2 = this;
          this.Interactable = function(t3) {
            s(i2, t3);
            var e3 = p(i2);
            function i2() {
              return r(this, i2), e3.apply(this, arguments);
            }
            return o(i2, [{ key: "_defaults", get: function() {
              return n2.defaults;
            } }, { key: "set", value: function(t4) {
              return f(c(i2.prototype), "set", this).call(this, t4), n2.fire("interactable:set", { options: t4, interactable: this }), this;
            } }, { key: "unset", value: function() {
              f(c(i2.prototype), "unset", this).call(this);
              var t4 = n2.interactables.list.indexOf(this);
              t4 < 0 || (n2.interactables.list.splice(t4, 1), n2.fire("interactable:unset", { interactable: this }));
            } }]), i2;
          }(on);
        }
        return o(t2, [{ key: "addListeners", value: function(t3, e2) {
          this.listenerMaps.push({ id: e2, map: t3 });
        } }, { key: "fire", value: function(t3, e2) {
          for (var n2 = 0, r2 = this.listenerMaps; n2 < r2.length; n2++) {
            var i2 = r2[n2].map[t3];
            if (i2 && false === i2(e2, this, t3)) return false;
          }
        } }, { key: "init", value: function(t3) {
          return this.isInitialized ? this : function(t4, e2) {
            t4.isInitialized = true, w.window(e2) && m(e2);
            return k.init(e2), I.init(e2), Lt.init(e2), t4.window = e2, t4.document = e2.document, t4.usePlugin(nn), t4.usePlugin(Ue), t4;
          }(this, t3);
        } }, { key: "pluginIsInstalled", value: function(t3) {
          var e2 = t3.id;
          return e2 ? !!this._plugins.map[e2] : -1 !== this._plugins.list.indexOf(t3);
        } }, { key: "usePlugin", value: function(t3, e2) {
          if (!this.isInitialized) return this;
          if (this.pluginIsInstalled(t3)) return this;
          if (t3.id && (this._plugins.map[t3.id] = t3), this._plugins.list.push(t3), t3.install && t3.install(this, e2), t3.listeners && t3.before) {
            for (var n2 = 0, r2 = this.listenerMaps.length, i2 = t3.before.reduce(function(t4, e3) {
              return t4[e3] = true, t4[cn(e3)] = true, t4;
            }, {}); n2 < r2; n2++) {
              var o2 = this.listenerMaps[n2].id;
              if (o2 && (i2[o2] || i2[cn(o2)])) break;
            }
            this.listenerMaps.splice(n2, 0, { id: t3.id, map: t3.listeners });
          } else t3.listeners && this.listenerMaps.push({ id: t3.id, map: t3.listeners });
          return this;
        } }, { key: "addDocument", value: function(t3, e2) {
          if (-1 !== this.getDocIndex(t3)) return false;
          var n2 = y(t3);
          e2 = e2 ? V({}, e2) : {}, this.documents.push({ doc: t3, options: e2 }), this.events.documents.push(t3), t3 !== this.document && this.events.add(n2, "unload", this.onWindowUnload), this.fire("scope:add-document", { doc: t3, window: n2, scope: this, options: e2 });
        } }, { key: "removeDocument", value: function(t3) {
          var e2 = this.getDocIndex(t3), n2 = y(t3), r2 = this.documents[e2].options;
          this.events.remove(n2, "unload", this.onWindowUnload), this.documents.splice(e2, 1), this.events.documents.splice(e2, 1), this.fire("scope:remove-document", { doc: t3, window: n2, scope: this, options: r2 });
        } }, { key: "getDocIndex", value: function(t3) {
          for (var e2 = 0; e2 < this.documents.length; e2++) if (this.documents[e2].doc === t3) return e2;
          return -1;
        } }, { key: "getDocOptions", value: function(t3) {
          var e2 = this.getDocIndex(t3);
          return -1 === e2 ? null : this.documents[e2].options;
        } }, { key: "now", value: function() {
          return (this.window.Date || Date).now();
        } }]), t2;
      }();
      function cn(t2) {
        return t2 && t2.replace(/\/.*$/, "");
      }
      var ln = new sn(), un = ln.interactStatic, pn = "undefined" != typeof globalThis ? globalThis : window;
      ln.init(pn);
      var fn = Object.freeze({ __proto__: null, edgeTarget: function() {
      }, elements: function() {
      }, grid: function(t2) {
        var e2 = [["x", "y"], ["left", "top"], ["right", "bottom"], ["width", "height"]].filter(function(e3) {
          var n3 = e3[0], r2 = e3[1];
          return n3 in t2 || r2 in t2;
        }), n2 = function(n3, r2) {
          for (var i2 = t2.range, o2 = t2.limits, a2 = void 0 === o2 ? { left: -1 / 0, right: 1 / 0, top: -1 / 0, bottom: 1 / 0 } : o2, s2 = t2.offset, c2 = void 0 === s2 ? { x: 0, y: 0 } : s2, l2 = { range: i2, grid: t2, x: null, y: null }, u2 = 0; u2 < e2.length; u2++) {
            var p2 = e2[u2], f2 = p2[0], d2 = p2[1], h2 = Math.round((n3 - c2.x) / t2[f2]), v2 = Math.round((r2 - c2.y) / t2[d2]);
            l2[f2] = Math.max(a2.left, Math.min(a2.right, h2 * t2[f2] + c2.x)), l2[d2] = Math.max(a2.top, Math.min(a2.bottom, v2 * t2[d2] + c2.y));
          }
          return l2;
        };
        return n2.grid = t2, n2.coordFields = e2, n2;
      } }), dn = { id: "snappers", install: function(t2) {
        var e2 = t2.interactStatic;
        e2.snappers = V(e2.snappers || {}, fn), e2.createSnapGrid = e2.snappers.grid;
      } }, hn = dn, vn = { start: function(t2) {
        var n2 = t2.state, r2 = t2.rect, i2 = t2.edges, o2 = t2.pageCoords, a2 = n2.options, s2 = a2.ratio, c2 = a2.enabled, l2 = n2.options, u2 = l2.equalDelta, p2 = l2.modifiers;
        "preserve" === s2 && (s2 = r2.width / r2.height), n2.startCoords = V({}, o2), n2.startRect = V({}, r2), n2.ratio = s2, n2.equalDelta = u2;
        var f2 = n2.linkedEdges = { top: i2.top || i2.left && !i2.bottom, left: i2.left || i2.top && !i2.right, bottom: i2.bottom || i2.right && !i2.top, right: i2.right || i2.bottom && !i2.left };
        if (n2.xIsPrimaryAxis = !(!i2.left && !i2.right), n2.equalDelta) {
          var d2 = (f2.left ? 1 : -1) * (f2.top ? 1 : -1);
          n2.edgeSign = { x: d2, y: d2 };
        } else n2.edgeSign = { x: f2.left ? -1 : 1, y: f2.top ? -1 : 1 };
        if (false !== c2 && V(i2, f2), null != p2 && p2.length) {
          var h2 = new me(t2.interaction);
          h2.copyFrom(t2.interaction.modification), h2.prepareStates(p2), n2.subModification = h2, h2.startAll(e({}, t2));
        }
      }, set: function(t2) {
        var n2 = t2.state, r2 = t2.rect, i2 = t2.coords, o2 = n2.linkedEdges, a2 = V({}, i2), s2 = n2.equalDelta ? gn : mn;
        if (V(t2.edges, o2), s2(n2, n2.xIsPrimaryAxis, i2, r2), !n2.subModification) return null;
        var c2 = V({}, r2);
        H(o2, c2, { x: i2.x - a2.x, y: i2.y - a2.y });
        var l2 = n2.subModification.setAll(e(e({}, t2), {}, { rect: c2, edges: o2, pageCoords: i2, prevCoords: i2, prevRect: c2 })), u2 = l2.delta;
        l2.changed && (s2(n2, Math.abs(u2.x) > Math.abs(u2.y), l2.coords, l2.rect), V(i2, l2.coords));
        return l2.eventProps;
      }, defaults: { ratio: "preserve", equalDelta: false, modifiers: [], enabled: false } };
      function gn(t2, e2, n2) {
        var r2 = t2.startCoords, i2 = t2.edgeSign;
        e2 ? n2.y = r2.y + (n2.x - r2.x) * i2.y : n2.x = r2.x + (n2.y - r2.y) * i2.x;
      }
      function mn(t2, e2, n2, r2) {
        var i2 = t2.startRect, o2 = t2.startCoords, a2 = t2.ratio, s2 = t2.edgeSign;
        if (e2) {
          var c2 = r2.width / a2;
          n2.y = o2.y + (c2 - i2.height) * s2.y;
        } else {
          var l2 = r2.height * a2;
          n2.x = o2.x + (l2 - i2.width) * s2.x;
        }
      }
      var yn = be(vn, "aspectRatio"), bn = function() {
      };
      bn._defaults = {};
      var xn = bn;
      function wn(t2, e2, n2) {
        return w.func(t2) ? G(t2, e2.interactable, e2.element, [n2.x, n2.y, e2]) : G(t2, e2.interactable, e2.element);
      }
      var En = { start: function(t2) {
        var e2 = t2.rect, n2 = t2.startOffset, r2 = t2.state, i2 = t2.interaction, o2 = t2.pageCoords, a2 = r2.options, s2 = a2.elementRect, c2 = V({ left: 0, top: 0, right: 0, bottom: 0 }, a2.offset || {});
        if (e2 && s2) {
          var l2 = wn(a2.restriction, i2, o2);
          if (l2) {
            var u2 = l2.right - l2.left - e2.width, p2 = l2.bottom - l2.top - e2.height;
            u2 < 0 && (c2.left += u2, c2.right += u2), p2 < 0 && (c2.top += p2, c2.bottom += p2);
          }
          c2.left += n2.left - e2.width * s2.left, c2.top += n2.top - e2.height * s2.top, c2.right += n2.right - e2.width * (1 - s2.right), c2.bottom += n2.bottom - e2.height * (1 - s2.bottom);
        }
        r2.offset = c2;
      }, set: function(t2) {
        var e2 = t2.coords, n2 = t2.interaction, r2 = t2.state, i2 = r2.options, o2 = r2.offset, a2 = wn(i2.restriction, n2, e2);
        if (a2) {
          var s2 = function(t3) {
            return !t3 || "left" in t3 && "top" in t3 || ((t3 = V({}, t3)).left = t3.x || 0, t3.top = t3.y || 0, t3.right = t3.right || t3.left + t3.width, t3.bottom = t3.bottom || t3.top + t3.height), t3;
          }(a2);
          e2.x = Math.max(Math.min(s2.right - o2.right, e2.x), s2.left + o2.left), e2.y = Math.max(Math.min(s2.bottom - o2.bottom, e2.y), s2.top + o2.top);
        }
      }, defaults: { restriction: null, elementRect: null, offset: null, endOnly: false, enabled: false } }, Tn = be(En, "restrict"), Sn = { top: 1 / 0, left: 1 / 0, bottom: -1 / 0, right: -1 / 0 }, _n = { top: -1 / 0, left: -1 / 0, bottom: 1 / 0, right: 1 / 0 };
      function Pn(t2, e2) {
        for (var n2 = 0, r2 = ["top", "left", "bottom", "right"]; n2 < r2.length; n2++) {
          var i2 = r2[n2];
          i2 in t2 || (t2[i2] = e2[i2]);
        }
        return t2;
      }
      var On = { noInner: Sn, noOuter: _n, start: function(t2) {
        var e2, n2 = t2.interaction, r2 = t2.startOffset, i2 = t2.state, o2 = i2.options;
        o2 && (e2 = N(wn(o2.offset, n2, n2.coords.start.page))), e2 = e2 || { x: 0, y: 0 }, i2.offset = { top: e2.y + r2.top, left: e2.x + r2.left, bottom: e2.y - r2.bottom, right: e2.x - r2.right };
      }, set: function(t2) {
        var e2 = t2.coords, n2 = t2.edges, r2 = t2.interaction, i2 = t2.state, o2 = i2.offset, a2 = i2.options;
        if (n2) {
          var s2 = V({}, e2), c2 = wn(a2.inner, r2, s2) || {}, l2 = wn(a2.outer, r2, s2) || {};
          Pn(c2, Sn), Pn(l2, _n), n2.top ? e2.y = Math.min(Math.max(l2.top + o2.top, s2.y), c2.top + o2.top) : n2.bottom && (e2.y = Math.max(Math.min(l2.bottom + o2.bottom, s2.y), c2.bottom + o2.bottom)), n2.left ? e2.x = Math.min(Math.max(l2.left + o2.left, s2.x), c2.left + o2.left) : n2.right && (e2.x = Math.max(Math.min(l2.right + o2.right, s2.x), c2.right + o2.right));
        }
      }, defaults: { inner: null, outer: null, offset: null, endOnly: false, enabled: false } }, kn = be(On, "restrictEdges"), Dn = V({ get elementRect() {
        return { top: 0, left: 0, bottom: 1, right: 1 };
      }, set elementRect(t2) {
      } }, En.defaults), In = be({ start: En.start, set: En.set, defaults: Dn }, "restrictRect"), Mn = { width: -1 / 0, height: -1 / 0 }, zn = { width: 1 / 0, height: 1 / 0 };
      var An = be({ start: function(t2) {
        return On.start(t2);
      }, set: function(t2) {
        var e2 = t2.interaction, n2 = t2.state, r2 = t2.rect, i2 = t2.edges, o2 = n2.options;
        if (i2) {
          var a2 = U(wn(o2.min, e2, t2.coords)) || Mn, s2 = U(wn(o2.max, e2, t2.coords)) || zn;
          n2.options = { endOnly: o2.endOnly, inner: V({}, On.noInner), outer: V({}, On.noOuter) }, i2.top ? (n2.options.inner.top = r2.bottom - a2.height, n2.options.outer.top = r2.bottom - s2.height) : i2.bottom && (n2.options.inner.bottom = r2.top + a2.height, n2.options.outer.bottom = r2.top + s2.height), i2.left ? (n2.options.inner.left = r2.right - a2.width, n2.options.outer.left = r2.right - s2.width) : i2.right && (n2.options.inner.right = r2.left + a2.width, n2.options.outer.right = r2.left + s2.width), On.set(t2), n2.options = o2;
        }
      }, defaults: { min: null, max: null, endOnly: false, enabled: false } }, "restrictSize");
      var Rn = { start: function(t2) {
        var e2, n2 = t2.interaction, r2 = t2.interactable, i2 = t2.element, o2 = t2.rect, a2 = t2.state, s2 = t2.startOffset, c2 = a2.options, l2 = c2.offsetWithOrigin ? function(t3) {
          var e3 = t3.interaction.element, n3 = N(G(t3.state.options.origin, null, null, [e3])), r3 = n3 || K(t3.interactable, e3, t3.interaction.prepared.name);
          return r3;
        }(t2) : { x: 0, y: 0 };
        if ("startCoords" === c2.offset) e2 = { x: n2.coords.start.page.x, y: n2.coords.start.page.y };
        else {
          var u2 = G(c2.offset, r2, i2, [n2]);
          (e2 = N(u2) || { x: 0, y: 0 }).x += l2.x, e2.y += l2.y;
        }
        var p2 = c2.relativePoints;
        a2.offsets = o2 && p2 && p2.length ? p2.map(function(t3, n3) {
          return { index: n3, relativePoint: t3, x: s2.left - o2.width * t3.x + e2.x, y: s2.top - o2.height * t3.y + e2.y };
        }) : [{ index: 0, relativePoint: null, x: e2.x, y: e2.y }];
      }, set: function(t2) {
        var e2 = t2.interaction, n2 = t2.coords, r2 = t2.state, i2 = r2.options, o2 = r2.offsets, a2 = K(e2.interactable, e2.element, e2.prepared.name), s2 = V({}, n2), c2 = [];
        i2.offsetWithOrigin || (s2.x -= a2.x, s2.y -= a2.y);
        for (var l2 = 0, u2 = o2; l2 < u2.length; l2++) for (var p2 = u2[l2], f2 = s2.x - p2.x, d2 = s2.y - p2.y, h2 = 0, v2 = i2.targets.length; h2 < v2; h2++) {
          var g2 = i2.targets[h2], m2 = void 0;
          (m2 = w.func(g2) ? g2(f2, d2, e2._proxy, p2, h2) : g2) && c2.push({ x: (w.number(m2.x) ? m2.x : f2) + p2.x, y: (w.number(m2.y) ? m2.y : d2) + p2.y, range: w.number(m2.range) ? m2.range : i2.range, source: g2, index: h2, offset: p2 });
        }
        for (var y2 = { target: null, inRange: false, distance: 0, range: 0, delta: { x: 0, y: 0 } }, b2 = 0; b2 < c2.length; b2++) {
          var x2 = c2[b2], E2 = x2.range, T2 = x2.x - s2.x, S2 = x2.y - s2.y, _2 = Q(T2, S2), P2 = _2 <= E2;
          E2 === 1 / 0 && y2.inRange && y2.range !== 1 / 0 && (P2 = false), y2.target && !(P2 ? y2.inRange && E2 !== 1 / 0 ? _2 / E2 < y2.distance / y2.range : E2 === 1 / 0 && y2.range !== 1 / 0 || _2 < y2.distance : !y2.inRange && _2 < y2.distance) || (y2.target = x2, y2.distance = _2, y2.range = E2, y2.inRange = P2, y2.delta.x = T2, y2.delta.y = S2);
        }
        return y2.inRange && (n2.x = y2.target.x, n2.y = y2.target.y), r2.closest = y2, y2;
      }, defaults: { range: 1 / 0, targets: null, offset: null, offsetWithOrigin: true, origin: null, relativePoints: null, endOnly: false, enabled: false } }, Cn = be(Rn, "snap");
      var jn = { start: function(t2) {
        var e2 = t2.state, n2 = t2.edges, r2 = e2.options;
        if (!n2) return null;
        t2.state = { options: { targets: null, relativePoints: [{ x: n2.left ? 0 : 1, y: n2.top ? 0 : 1 }], offset: r2.offset || "self", origin: { x: 0, y: 0 }, range: r2.range } }, e2.targetFields = e2.targetFields || [["width", "height"], ["x", "y"]], Rn.start(t2), e2.offsets = t2.state.offsets, t2.state = e2;
      }, set: function(t2) {
        var e2 = t2.interaction, n2 = t2.state, r2 = t2.coords, i2 = n2.options, o2 = n2.offsets, a2 = { x: r2.x - o2[0].x, y: r2.y - o2[0].y };
        n2.options = V({}, i2), n2.options.targets = [];
        for (var s2 = 0, c2 = i2.targets || []; s2 < c2.length; s2++) {
          var l2 = c2[s2], u2 = void 0;
          if (u2 = w.func(l2) ? l2(a2.x, a2.y, e2) : l2) {
            for (var p2 = 0, f2 = n2.targetFields; p2 < f2.length; p2++) {
              var d2 = f2[p2], h2 = d2[0], v2 = d2[1];
              if (h2 in u2 || v2 in u2) {
                u2.x = u2[h2], u2.y = u2[v2];
                break;
              }
            }
            n2.options.targets.push(u2);
          }
        }
        var g2 = Rn.set(t2);
        return n2.options = i2, g2;
      }, defaults: { range: 1 / 0, targets: null, offset: null, endOnly: false, enabled: false } }, Fn = be(jn, "snapSize");
      var Xn = { aspectRatio: yn, restrictEdges: kn, restrict: Tn, restrictRect: In, restrictSize: An, snapEdges: be({ start: function(t2) {
        var e2 = t2.edges;
        return e2 ? (t2.state.targetFields = t2.state.targetFields || [[e2.left ? "left" : "right", e2.top ? "top" : "bottom"]], jn.start(t2)) : null;
      }, set: jn.set, defaults: V(ge(jn.defaults), { targets: void 0, range: void 0, offset: { x: 0, y: 0 } }) }, "snapEdges"), snap: Cn, snapSize: Fn, spring: xn, avoid: xn, transform: xn, rubberband: xn }, Yn = { id: "modifiers", install: function(t2) {
        var e2 = t2.interactStatic;
        for (var n2 in t2.usePlugin(Ee), t2.usePlugin(hn), e2.modifiers = Xn, Xn) {
          var r2 = Xn[n2], i2 = r2._defaults, o2 = r2._methods;
          i2._methods = o2, t2.defaults.perAction[n2] = i2;
        }
      } }, Ln = Yn, qn = function(t2) {
        s(n2, t2);
        var e2 = p(n2);
        function n2(t3, i2, o2, a2, s2, c2) {
          var l2;
          if (r(this, n2), tt(u(l2 = e2.call(this, s2)), o2), o2 !== i2 && tt(u(l2), i2), l2.timeStamp = c2, l2.originalEvent = o2, l2.type = t3, l2.pointerId = at(i2), l2.pointerType = dt(i2), l2.target = a2, l2.currentTarget = null, "tap" === t3) {
            var p2 = s2.getPointerIndex(i2);
            l2.dt = l2.timeStamp - s2.pointers[p2].downTime;
            var f2 = l2.timeStamp - s2.tapTime;
            l2.double = !!s2.prevTap && "doubletap" !== s2.prevTap.type && s2.prevTap.target === l2.target && f2 < 500;
          } else "doubletap" === t3 && (l2.dt = i2.timeStamp - s2.tapTime, l2.double = true);
          return l2;
        }
        return o(n2, [{ key: "_subtractOrigin", value: function(t3) {
          var e3 = t3.x, n3 = t3.y;
          return this.pageX -= e3, this.pageY -= n3, this.clientX -= e3, this.clientY -= n3, this;
        } }, { key: "_addOrigin", value: function(t3) {
          var e3 = t3.x, n3 = t3.y;
          return this.pageX += e3, this.pageY += n3, this.clientX += e3, this.clientY += n3, this;
        } }, { key: "preventDefault", value: function() {
          this.originalEvent.preventDefault();
        } }]), n2;
      }(vt), Bn = { id: "pointer-events/base", before: ["inertia", "modifiers", "auto-start", "actions"], install: function(t2) {
        t2.pointerEvents = Bn, t2.defaults.actions.pointerEvents = Bn.defaults, V(t2.actions.phaselessTypes, Bn.types);
      }, listeners: { "interactions:new": function(t2) {
        var e2 = t2.interaction;
        e2.prevTap = null, e2.tapTime = 0;
      }, "interactions:update-pointer": function(t2) {
        var e2 = t2.down, n2 = t2.pointerInfo;
        if (!e2 && n2.hold) return;
        n2.hold = { duration: 1 / 0, timeout: null };
      }, "interactions:move": function(t2, e2) {
        var n2 = t2.interaction, r2 = t2.pointer, i2 = t2.event, o2 = t2.eventTarget;
        t2.duplicate || n2.pointerIsDown && !n2.pointerWasMoved || (n2.pointerIsDown && Gn(t2), Vn({ interaction: n2, pointer: r2, event: i2, eventTarget: o2, type: "move" }, e2));
      }, "interactions:down": function(t2, e2) {
        !function(t3, e3) {
          for (var n2 = t3.interaction, r2 = t3.pointer, i2 = t3.event, o2 = t3.eventTarget, a2 = t3.pointerIndex, s2 = n2.pointers[a2].hold, c2 = q(o2), l2 = { interaction: n2, pointer: r2, event: i2, eventTarget: o2, type: "hold", targets: [], path: c2, node: null }, u2 = 0; u2 < c2.length; u2++) {
            var p2 = c2[u2];
            l2.node = p2, e3.fire("pointerEvents:collect-targets", l2);
          }
          if (!l2.targets.length) return;
          for (var f2 = 1 / 0, d2 = 0, h2 = l2.targets; d2 < h2.length; d2++) {
            var v2 = h2[d2].eventable.options.holdDuration;
            v2 < f2 && (f2 = v2);
          }
          s2.duration = f2, s2.timeout = setTimeout(function() {
            Vn({ interaction: n2, eventTarget: o2, pointer: r2, event: i2, type: "hold" }, e3);
          }, f2);
        }(t2, e2), Vn(t2, e2);
      }, "interactions:up": function(t2, e2) {
        Gn(t2), Vn(t2, e2), function(t3, e3) {
          var n2 = t3.interaction, r2 = t3.pointer, i2 = t3.event, o2 = t3.eventTarget;
          n2.pointerWasMoved || Vn({ interaction: n2, eventTarget: o2, pointer: r2, event: i2, type: "tap" }, e3);
        }(t2, e2);
      }, "interactions:cancel": function(t2, e2) {
        Gn(t2), Vn(t2, e2);
      } }, PointerEvent: qn, fire: Vn, collectEventTargets: Wn, defaults: { holdDuration: 600, ignoreFrom: null, allowFrom: null, origin: { x: 0, y: 0 } }, types: { down: true, move: true, up: true, cancel: true, tap: true, doubletap: true, hold: true } };
      function Vn(t2, e2) {
        var n2 = t2.interaction, r2 = t2.pointer, i2 = t2.event, o2 = t2.eventTarget, a2 = t2.type, s2 = t2.targets, c2 = void 0 === s2 ? Wn(t2, e2) : s2, l2 = new qn(a2, r2, i2, o2, n2, e2.now());
        e2.fire("pointerEvents:new", { pointerEvent: l2 });
        for (var u2 = { interaction: n2, pointer: r2, event: i2, eventTarget: o2, targets: c2, type: a2, pointerEvent: l2 }, p2 = 0; p2 < c2.length; p2++) {
          var f2 = c2[p2];
          for (var d2 in f2.props || {}) l2[d2] = f2.props[d2];
          var h2 = K(f2.eventable, f2.node);
          if (l2._subtractOrigin(h2), l2.eventable = f2.eventable, l2.currentTarget = f2.node, f2.eventable.fire(l2), l2._addOrigin(h2), l2.immediatePropagationStopped || l2.propagationStopped && p2 + 1 < c2.length && c2[p2 + 1].node !== l2.currentTarget) break;
        }
        if (e2.fire("pointerEvents:fired", u2), "tap" === a2) {
          var v2 = l2.double ? Vn({ interaction: n2, pointer: r2, event: i2, eventTarget: o2, type: "doubletap" }, e2) : l2;
          n2.prevTap = v2, n2.tapTime = v2.timeStamp;
        }
        return l2;
      }
      function Wn(t2, e2) {
        var n2 = t2.interaction, r2 = t2.pointer, i2 = t2.event, o2 = t2.eventTarget, a2 = t2.type, s2 = n2.getPointerIndex(r2), c2 = n2.pointers[s2];
        if ("tap" === a2 && (n2.pointerWasMoved || !c2 || c2.downTarget !== o2)) return [];
        for (var l2 = q(o2), u2 = { interaction: n2, pointer: r2, event: i2, eventTarget: o2, type: a2, path: l2, targets: [], node: null }, p2 = 0; p2 < l2.length; p2++) {
          var f2 = l2[p2];
          u2.node = f2, e2.fire("pointerEvents:collect-targets", u2);
        }
        return "hold" === a2 && (u2.targets = u2.targets.filter(function(t3) {
          var e3, r3;
          return t3.eventable.options.holdDuration === (null == (e3 = n2.pointers[s2]) || null == (r3 = e3.hold) ? void 0 : r3.duration);
        })), u2.targets;
      }
      function Gn(t2) {
        var e2 = t2.interaction, n2 = t2.pointerIndex, r2 = e2.pointers[n2].hold;
        r2 && r2.timeout && (clearTimeout(r2.timeout), r2.timeout = null);
      }
      var Nn = Object.freeze({ __proto__: null, default: Bn });
      function Un(t2) {
        var e2 = t2.interaction;
        e2.holdIntervalHandle && (clearInterval(e2.holdIntervalHandle), e2.holdIntervalHandle = null);
      }
      var Hn = { id: "pointer-events/holdRepeat", install: function(t2) {
        t2.usePlugin(Bn);
        var e2 = t2.pointerEvents;
        e2.defaults.holdRepeatInterval = 0, e2.types.holdrepeat = t2.actions.phaselessTypes.holdrepeat = true;
      }, listeners: ["move", "up", "cancel", "endall"].reduce(function(t2, e2) {
        return t2["pointerEvents:".concat(e2)] = Un, t2;
      }, { "pointerEvents:new": function(t2) {
        var e2 = t2.pointerEvent;
        "hold" === e2.type && (e2.count = (e2.count || 0) + 1);
      }, "pointerEvents:fired": function(t2, e2) {
        var n2 = t2.interaction, r2 = t2.pointerEvent, i2 = t2.eventTarget, o2 = t2.targets;
        if ("hold" === r2.type && o2.length) {
          var a2 = o2[0].eventable.options.holdRepeatInterval;
          a2 <= 0 || (n2.holdIntervalHandle = setTimeout(function() {
            e2.pointerEvents.fire({ interaction: n2, eventTarget: i2, type: "hold", pointer: r2, event: r2 }, e2);
          }, a2));
        }
      } }) }, Kn = Hn;
      var $n = { id: "pointer-events/interactableTargets", install: function(t2) {
        var e2 = t2.Interactable;
        e2.prototype.pointerEvents = function(t3) {
          return V(this.events.options, t3), this;
        };
        var n2 = e2.prototype._backCompatOption;
        e2.prototype._backCompatOption = function(t3, e3) {
          var r2 = n2.call(this, t3, e3);
          return r2 === this && (this.events.options[t3] = e3), r2;
        };
      }, listeners: { "pointerEvents:collect-targets": function(t2, e2) {
        var n2 = t2.targets, r2 = t2.node, i2 = t2.type, o2 = t2.eventTarget;
        e2.interactables.forEachMatch(r2, function(t3) {
          var e3 = t3.events, a2 = e3.options;
          e3.types[i2] && e3.types[i2].length && t3.testIgnoreAllow(a2, r2, o2) && n2.push({ node: r2, eventable: e3, props: { interactable: t3 } });
        });
      }, "interactable:new": function(t2) {
        var e2 = t2.interactable;
        e2.events.getRect = function(t3) {
          return e2.getRect(t3);
        };
      }, "interactable:set": function(t2, e2) {
        var n2 = t2.interactable, r2 = t2.options;
        V(n2.events.options, e2.pointerEvents.defaults), V(n2.events.options, r2.pointerEvents || {});
      } } }, Jn = $n, Qn = { id: "pointer-events", install: function(t2) {
        t2.usePlugin(Nn), t2.usePlugin(Kn), t2.usePlugin(Jn);
      } }, Zn = Qn;
      var tr = { id: "reflow", install: function(t2) {
        var e2 = t2.Interactable;
        t2.actions.phases.reflow = true, e2.prototype.reflow = function(e3) {
          return function(t3, e4, n2) {
            for (var r2 = t3.getAllElements(), i2 = n2.window.Promise, o2 = i2 ? [] : null, a2 = function() {
              var a3 = r2[s2], c2 = t3.getRect(a3);
              if (!c2) return 1;
              var l2, u2 = bt(n2.interactions.list, function(n3) {
                return n3.interacting() && n3.interactable === t3 && n3.element === a3 && n3.prepared.name === e4.name;
              });
              if (u2) u2.move(), o2 && (l2 = u2._reflowPromise || new i2(function(t4) {
                u2._reflowResolve = t4;
              }));
              else {
                var p2 = U(c2), f2 = /* @__PURE__ */ function(t4) {
                  return { coords: t4, get page() {
                    return this.coords.page;
                  }, get client() {
                    return this.coords.client;
                  }, get timeStamp() {
                    return this.coords.timeStamp;
                  }, get pageX() {
                    return this.coords.page.x;
                  }, get pageY() {
                    return this.coords.page.y;
                  }, get clientX() {
                    return this.coords.client.x;
                  }, get clientY() {
                    return this.coords.client.y;
                  }, get pointerId() {
                    return this.coords.pointerId;
                  }, get target() {
                    return this.coords.target;
                  }, get type() {
                    return this.coords.type;
                  }, get pointerType() {
                    return this.coords.pointerType;
                  }, get buttons() {
                    return this.coords.buttons;
                  }, preventDefault: function() {
                  } };
                }({ page: { x: p2.x, y: p2.y }, client: { x: p2.x, y: p2.y }, timeStamp: n2.now() });
                l2 = function(t4, e5, n3, r3, i3) {
                  var o3 = t4.interactions.new({ pointerType: "reflow" }), a4 = { interaction: o3, event: i3, pointer: i3, eventTarget: n3, phase: "reflow" };
                  o3.interactable = e5, o3.element = n3, o3.prevEvent = i3, o3.updatePointer(i3, i3, n3, true), nt(o3.coords.delta), Ut(o3.prepared, r3), o3._doPhase(a4);
                  var s3 = t4.window, c3 = s3.Promise, l3 = c3 ? new c3(function(t5) {
                    o3._reflowResolve = t5;
                  }) : void 0;
                  o3._reflowPromise = l3, o3.start(r3, e5, n3), o3._interacting ? (o3.move(a4), o3.end(i3)) : (o3.stop(), o3._reflowResolve());
                  return o3.removePointer(i3, i3), l3;
                }(n2, t3, a3, e4, f2);
              }
              o2 && o2.push(l2);
            }, s2 = 0; s2 < r2.length && !a2(); s2++) ;
            return o2 && i2.all(o2).then(function() {
              return t3;
            });
          }(this, e3, t2);
        };
      }, listeners: { "interactions:stop": function(t2, e2) {
        var n2 = t2.interaction;
        "reflow" === n2.pointerType && (n2._reflowResolve && n2._reflowResolve(), function(t3, e3) {
          t3.splice(t3.indexOf(e3), 1);
        }(e2.interactions.list, n2));
      } } }, er = tr;
      if (un.use(he), un.use(Ce), un.use(Zn), un.use(qe), un.use(Ln), un.use(pe), un.use(Xt), un.use(Gt), un.use(er), un.default = un, "object" === n(module) && module) try {
        module.exports = un;
      } catch (t2) {
      }
      return un.default = un, un;
    });
  })(interact_min$1, interact_min$1.exports);
  return interact_min$1.exports;
}
var interact_minExports = /* @__PURE__ */ requireInteract_min();
const interact = /* @__PURE__ */ getDefaultExportFromCjs(interact_minExports);



/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/chunks/usePreventDocumentScroll.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/chunks/usePreventDocumentScroll.js ***!
  \***************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   u: () => (/* binding */ usePreventDocumentScroll)
/* harmony export */ });
/* harmony import */ var _arcgis_lumina_controllers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @arcgis/lumina/controllers */ "./node_modules/@arcgis/lumina/dist/controllers/index.js");
/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */

let openedComponentCount = 0;
let initialDocumentOverflowStyle = "";
const usePreventDocumentScroll = () => {
  function addOpenedComponent() {
    openedComponentCount++;
    if (openedComponentCount === 1) {
      initialDocumentOverflowStyle = document.documentElement.style.overflow;
      document.documentElement.style.overflow = "hidden";
    }
  }
  function removeOpenedComponent() {
    openedComponentCount--;
    if (openedComponentCount === 0) {
      document.documentElement.style.overflow = initialDocumentOverflowStyle;
    }
  }
  return (0,_arcgis_lumina_controllers__WEBPACK_IMPORTED_MODULE_0__.makeGenericController)((component, controller) => {
    controller.onConnected(() => {
      if (component.opened && component.preventDocumentScroll) {
        addOpenedComponent();
      }
    });
    controller.onUpdate((changes) => {
      if (!component.hasUpdated) {
        return;
      }
      if (changes.has("opened") && component.preventDocumentScroll) {
        if (component.opened) {
          addOpenedComponent();
        } else {
          removeOpenedComponent();
        }
      } else if (changes.has("preventDocumentScroll") && component.opened) {
        if (component.preventDocumentScroll) {
          addOpenedComponent();
        } else {
          removeOpenedComponent();
        }
      }
    });
    controller.onDisconnected(() => {
      if (component.opened && component.preventDocumentScroll) {
        removeOpenedComponent();
      }
    });
  });
};



/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/components/calcite-dialog/customElement.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/components/calcite-dialog/customElement.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Dialog: () => (/* binding */ Dialog)
/* harmony export */ });
/* harmony import */ var _chunks_runtime_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../chunks/runtime.js */ "./node_modules/@esri/calcite-components/dist/chunks/runtime.js");
/* harmony import */ var lit_directives_keyed_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lit/directives/keyed.js */ "./node_modules/lit/directives/keyed.js");
/* harmony import */ var _chunks_interact_min_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../chunks/interact.min.js */ "./node_modules/@esri/calcite-components/dist/chunks/interact.min.js");
/* harmony import */ var lit__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lit */ "./node_modules/lit/index.js");
/* harmony import */ var lit_html_directives_ref_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! lit-html/directives/ref.js */ "./node_modules/lit-html/development/directives/ref.js");
/* harmony import */ var _arcgis_lumina__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @arcgis/lumina */ "./node_modules/@arcgis/lumina/dist/index.js");
/* harmony import */ var _chunks_dom_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../chunks/dom.js */ "./node_modules/@esri/calcite-components/dist/chunks/dom.js");
/* harmony import */ var _chunks_observers_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../chunks/observers.js */ "./node_modules/@esri/calcite-components/dist/chunks/observers.js");
/* harmony import */ var _chunks_dynamicClasses_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../chunks/dynamicClasses.js */ "./node_modules/@esri/calcite-components/dist/chunks/dynamicClasses.js");
/* harmony import */ var _chunks_openCloseComponent_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../chunks/openCloseComponent.js */ "./node_modules/@esri/calcite-components/dist/chunks/openCloseComponent.js");
/* harmony import */ var _chunks_resources3_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../chunks/resources3.js */ "./node_modules/@esri/calcite-components/dist/chunks/resources3.js");
/* harmony import */ var _chunks_useT9n_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../chunks/useT9n.js */ "./node_modules/@esri/calcite-components/dist/chunks/useT9n.js");
/* harmony import */ var _chunks_useFocusTrap_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../chunks/useFocusTrap.js */ "./node_modules/@esri/calcite-components/dist/chunks/useFocusTrap.js");
/* harmony import */ var _chunks_usePreventDocumentScroll_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../chunks/usePreventDocumentScroll.js */ "./node_modules/@esri/calcite-components/dist/chunks/usePreventDocumentScroll.js");
/* harmony import */ var _chunks_useSetFocus_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../chunks/useSetFocus.js */ "./node_modules/@esri/calcite-components/dist/chunks/useSetFocus.js");
/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */















const CSS = {
  dialog: "dialog",
  panel: "panel",
  scrim: "scrim",
  container: "container",
  containerOpen: "container--open",
  containerEmbedded: "container--embedded",
  assistiveText: "assistive-text",
  openingActive: "dialog--opening-active"
};
const SLOTS = {
  actionBar: "action-bar",
  alerts: "alerts",
  content: "content",
  customContent: "custom-content",
  contentTop: "content-top",
  contentBottom: "content-bottom",
  headerActionsStart: "header-actions-start",
  headerActionsEnd: "header-actions-end",
  headerMenuActions: "header-menu-actions",
  headerContent: "header-content",
  fab: "fab",
  footer: "footer",
  footerStart: "footer-start",
  footerEnd: "footer-end"
};
const initialDragPosition = { x: null, y: null };
const initialResizePosition = { top: null, right: null, bottom: null, left: null };
const styles = (0,lit__WEBPACK_IMPORTED_MODULE_3__.css)`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{--calcite-dialog-scrim-background-color: rgba(0, 0, 0, .85);pointer-events:none;inset:0;z-index:var(--calcite-z-index-overlay);display:flex;--calcite-internal-dialog-animation-offset: 20px}:host([modal]){position:absolute}.container{pointer-events:auto;position:fixed;inset:0;z-index:var(--calcite-z-index-overlay);display:flex;align-items:center;justify-content:center;overflow:hidden;color:var(--calcite-color-text-2);opacity:0;visibility:hidden;transition:visibility 0ms linear var(--calcite-internal-animation-timing-slow),opacity var(--calcite-internal-animation-timing-slow) cubic-bezier(.215,.44,.42,.88)}:host([placement=top]) .container{align-items:flex-start;justify-content:center}:host([placement=top-start]) .container{align-items:flex-start;justify-content:flex-start}:host([placement=top-end]) .container{align-items:flex-start;justify-content:flex-end}:host([placement=bottom]) .container{align-items:flex-end;justify-content:center}:host([placement=bottom-start]) .container{align-items:flex-end;justify-content:flex-start}:host([placement=bottom-end]) .container{align-items:flex-end;justify-content:flex-end}:host(:not([modal])) .container{pointer-events:none}:host([scale=s]){--calcite-internal-dialog-content-padding: var(--calcite-dialog-content-space, var(--calcite-spacing-sm));--calcite-internal-dialog-min-size-x: 198px;--calcite-internal-dialog-min-size-y: 140px}:host([scale=m]){--calcite-internal-dialog-content-padding: var(--calcite-dialog-content-space, var(--calcite-spacing-md));--calcite-internal-dialog-min-size-x: 288px;--calcite-internal-dialog-min-size-y: 180px}:host([scale=l]){--calcite-internal-dialog-content-padding: var(--calcite-dialog-content-space, var(--calcite-spacing-md-plus));--calcite-internal-dialog-min-size-x: 388px;--calcite-internal-dialog-min-size-y: 220px}.scrim{--calcite-scrim-background: var(--calcite-dialog-scrim-background-color, var(--calcite-color-transparent-scrim));--calcite-scrim-background-color: var( --calcite-dialog-scrim-background-color, var(--calcite-color-transparent-scrim) );position:fixed;inset:0;display:flex;overflow-y:hidden}calcite-panel{--calcite-panel-content-space: var(--calcite-dialog-content-space, var(--calcite-internal-dialog-content-padding));--calcite-panel-border-color: var(--calcite-dialog-border-color);--calcite-panel-background-color: var(--calcite-dialog-background-color, var(--calcite-color-foreground-1));--calcite-panel-icon-color: var(--calcite-dialog-icon-color);--calcite-panel-heading-text-color: var(--calcite-dialog-heading-text-color);--calcite-panel-description-text-color: var(--calcite-dialog-description-text-color);--calcite-panel-header-background-color: var(--calcite-dialog-header-background-color);--calcite-panel-header-action-background-color: var(--calcite-dialog-header-action-background-color);--calcite-panel-header-action-background-color-hover: var(--calcite-dialog-header-action-background-color-hover);--calcite-panel-header-action-background-color-press: var(--calcite-dialog-header-action-background-color-press);--calcite-panel-header-action-text-color: var(--calcite-dialog-header-action-text-color);--calcite-panel-header-action-text-color-press: var(--calcite-dialog-header-action-text-color-press);--calcite-panel-footer-background-color: var(--calcite-dialog-footer-background-color);--calcite-panel-space: var(--calcite-dialog-space, var(--calcite-internal-dialog-content-padding));--calcite-panel-header-content-space: var(--calcite-dialog-header-content-space, var(--calcite-dialog-content-space));--calcite-panel-footer-space: var(--calcite-dialog-footer-space);--calcite-popover-border-color: var(--calcite-dialog-action-menu-border-color, var(--calcite-color-border-1));--calcite-panel-corner-radius: var(--calcite-dialog-corner-radius)}:host([kind=brand]) calcite-panel{--calcite-panel-icon-color: var(--calcite-dialog-icon-color, var(--calcite-color-brand))}:host([kind=danger]) calcite-panel{--calcite-panel-icon-color: var(--calcite-dialog-icon-color, var(--calcite-color-status-danger))}:host([kind=info]) calcite-panel{--calcite-panel-icon-color: var(--calcite-dialog-icon-color, var(--calcite-color-status-info))}:host([kind=success]) calcite-panel{--calcite-panel-icon-color: var(--calcite-dialog-icon-color, var(--calcite-color-status-success))}:host([kind=warning]) calcite-panel{--calcite-panel-icon-color: var(--calcite-dialog-icon-color, var(--calcite-color-status-warning))}::slotted(*){--calcite-panel-background-color: initial}.dialog{pointer-events:none;position:relative;z-index:var(--calcite-z-index-modal);margin:1.5rem;box-sizing:border-box;display:flex;inline-size:100%;flex-direction:column;opacity:0;--tw-shadow: 0 2px 12px -4px rgba(0, 0, 0, .2), 0 2px 4px -2px rgba(0, 0, 0, .16);--tw-shadow-colored: 0 2px 12px -4px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow);-webkit-overflow-scrolling:touch;visibility:hidden;transition:inset-block var(--calcite-internal-animation-timing-slow) cubic-bezier(.215,.44,.42,.88),opacity var(--calcite-internal-animation-timing-slow) cubic-bezier(.215,.44,.42,.88);border-radius:var(--calcite-dialog-corner-radius, var(--calcite-corner-radius-sm));min-inline-size:var(--calcite-dialog-min-size-x, var(--calcite-internal-dialog-min-size-x));max-inline-size:var(--calcite-dialog-max-size-x, 100%);min-block-size:var(--calcite-dialog-min-size-y, var(--calcite-internal-dialog-min-size-y));max-block-size:var(--calcite-dialog-max-size-y, 100%);--calcite-internal-dialog-hidden-position: calc( var(--calcite-dialog-offset-y, 0px) + var(--calcite-internal-dialog-animation-offset) );--calcite-internal-dialog-shown-position: var(--calcite-dialog-offset-y, 0);inset-inline-start:var(--calcite-dialog-offset-x, 0);inset-block-start:var(--calcite-internal-dialog-hidden-position)}.dialog--opening-active{inset-block-start:var(--calcite-internal-dialog-shown-position)}:host([menu-open]) .dialog{transition:visibility 0ms linear var(--calcite-internal-animation-timing-slow),opacity var(--calcite-internal-animation-timing-slow) cubic-bezier(.215,.44,.42,.88)}.panel{visibility:hidden;opacity:0;border-radius:var(--calcite-dialog-corner-radius, var(--calcite-corner-radius-sm));transition:visibility 0ms linear var(--calcite-internal-animation-timing-slow),opacity var(--calcite-internal-animation-timing-slow) cubic-bezier(.215,.44,.42,.88)}.container--open .panel{visibility:visible;opacity:1;transition:visibility 0ms linear,opacity var(--calcite-internal-animation-timing-slow) cubic-bezier(.215,.44,.42,.88)}.container--open{opacity:1;visibility:visible;transition-delay:0ms}.container--open .dialog{pointer-events:auto;visibility:visible;opacity:1;transition:inset-block var(--calcite-internal-animation-timing-slow) cubic-bezier(.215,.44,.42,.88),opacity var(--calcite-internal-animation-timing-slow) cubic-bezier(.215,.44,.42,.88);transition-delay:0ms}.width-s{inline-size:auto;inline-size:var(--calcite-dialog-size-x, 32rem);block-size:var(--calcite-dialog-size-y, auto)}@media screen and (max-width: 35rem){.width-s{margin:0;block-size:100%;max-block-size:100%;inline-size:100%;max-inline-size:100%;inset-inline-start:0;inset-block-start:var(--calcite-internal-dialog-animation-offset)}.width-s.dialog--opening-active{inset-block-start:0}}.width-m{inline-size:var(--calcite-dialog-size-x, 48rem);block-size:var(--calcite-dialog-size-y, auto)}@media screen and (max-width: 51rem){.width-m{margin:0;block-size:100%;max-block-size:100%;inline-size:100%;max-inline-size:100%;inset-inline-start:0;inset-block-start:var(--calcite-internal-dialog-animation-offset)}.width-m.dialog--opening-active{inset-block-start:0}}.width-l{inline-size:var(--calcite-dialog-size-x, 94rem);block-size:var(--calcite-dialog-size-y, auto)}@media screen and (max-width: 97rem){.width-l{margin:0;block-size:100%;max-block-size:100%;inline-size:100%;max-inline-size:100%;inset-inline-start:0;inset-block-start:var(--calcite-internal-dialog-animation-offset)}.width-l.dialog--opening-active{inset-block-start:0}}:host([placement=cover]) .dialog{margin:0;block-size:100%;max-block-size:100%;inline-size:100%;max-inline-size:100%;border-radius:0}:host([placement=cover]) .panel{border-radius:0}:host([kind]) .panel{border-start-start-radius:0px;border-start-end-radius:0px}:host([kind]) .dialog{overflow:hidden}:host([kind=brand]) .dialog{border-color:var(--calcite-color-brand)}:host([kind=danger]) .dialog{border-color:var(--calcite-dialog-accent-color, var(--calcite-color-status-danger))}:host([kind=info]) .dialog{border-color:var(--calcite-dialog-accent-color, var(--calcite-color-status-info))}:host([kind=success]) .dialog{border-color:var(--calcite-dialog-accent-color, var(--calcite-color-status-success))}:host([kind=warning]) .dialog{border-color:var(--calcite-dialog-accent-color, var(--calcite-color-status-warning))}:host([kind=brand][open]) .dialog,:host([kind=danger][open]) .dialog,:host([kind=info][open]) .dialog,:host([kind=success][open]) .dialog,:host([kind=warning][open]) .dialog{border-width:0px;border-block-start-width:4px;border-style:solid}.container--embedded{position:absolute;pointer-events:auto}.container--embedded calcite-scrim{position:absolute}.assistive-text{position:absolute;inline-size:1px;block-size:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}:host([hidden]){display:none}[hidden]{display:none}`;
class Dialog extends _arcgis_lumina__WEBPACK_IMPORTED_MODULE_5__.LitElement {
  constructor() {
    super(...arguments);
    this.dragPosition = { ...initialDragPosition };
    this.focusTrap = (0,_chunks_useFocusTrap_js__WEBPACK_IMPORTED_MODULE_12__.u)({
      triggerProp: "open",
      focusTrapOptions: {
        // scrim closes on click, so we let it take over
        clickOutsideDeactivates: () => !this.modal || this.embedded,
        escapeDeactivates: (event) => {
          if (!event.defaultPrevented && !this.escapeDisabled) {
            this.open = false;
            event.preventDefault();
          }
          return false;
        }
      }
    })(this);
    this.usePreventDocumentScroll = (0,_chunks_usePreventDocumentScroll_js__WEBPACK_IMPORTED_MODULE_13__.u)()(this);
    this.mutationObserver = (0,_chunks_observers_js__WEBPACK_IMPORTED_MODULE_7__.c)("mutation", () => this.handleMutationObserver());
    this._open = false;
    this.openProp = "opened";
    this.transitionProp = "opacity";
    this.panelEl = (0,lit_html_directives_ref_js__WEBPACK_IMPORTED_MODULE_4__.createRef)();
    this.resizePosition = { ...initialResizePosition };
    this.messages = (0,_chunks_useT9n_js__WEBPACK_IMPORTED_MODULE_11__.u)();
    this.focusSetter = (0,_chunks_useSetFocus_js__WEBPACK_IMPORTED_MODULE_14__.u)()(this);
    this.assistiveText = null;
    this.hasContentBottom = false;
    this.hasContentTop = false;
    this.hasFooter = true;
    this.opened = false;
    this.closeDisabled = false;
    this.dragEnabled = false;
    this.embedded = false;
    this.escapeDisabled = false;
    this.iconFlipRtl = false;
    this.loading = false;
    this.menuOpen = false;
    this.modal = false;
    this.focusTrapDisabled = false;
    this.outsideCloseDisabled = false;
    this.overlayPositioning = "absolute";
    this.placement = "center";
    this.resizable = false;
    this.scale = "m";
    this.widthScale = "m";
    this.calciteDialogBeforeClose = (0,_arcgis_lumina__WEBPACK_IMPORTED_MODULE_5__.createEvent)({ cancelable: false });
    this.calciteDialogBeforeOpen = (0,_arcgis_lumina__WEBPACK_IMPORTED_MODULE_5__.createEvent)({ cancelable: false });
    this.calciteDialogClose = (0,_arcgis_lumina__WEBPACK_IMPORTED_MODULE_5__.createEvent)({ cancelable: false });
    this.calciteDialogOpen = (0,_arcgis_lumina__WEBPACK_IMPORTED_MODULE_5__.createEvent)({ cancelable: false });
    this.calciteDialogScroll = (0,_arcgis_lumina__WEBPACK_IMPORTED_MODULE_5__.createEvent)({ cancelable: false });
  }
  static {
    this.properties = { assistiveText: [16, {}, { state: true }], hasContentBottom: [16, {}, { state: true }], hasContentTop: [16, {}, { state: true }], hasFooter: [16, {}, { state: true }], opened: [16, {}, { state: true }], beforeClose: [0, {}, { attribute: false }], closeDisabled: [7, {}, { reflect: true, type: Boolean }], description: 1, dragEnabled: [7, {}, { reflect: true, type: Boolean }], embedded: [5, {}, { type: Boolean }], escapeDisabled: [7, {}, { reflect: true, type: Boolean }], focusTrapOptions: [0, {}, { attribute: false }], heading: 1, headingLevel: [11, {}, { type: Number, reflect: true }], kind: [3, {}, { reflect: true }], icon: [3, {}, { reflect: true }], iconFlipRtl: [7, {}, { reflect: true, type: Boolean }], loading: [7, {}, { reflect: true, type: Boolean }], menuOpen: [7, {}, { reflect: true, type: Boolean }], messageOverrides: [0, {}, { attribute: false }], modal: [7, {}, { reflect: true, type: Boolean }], focusTrapDisabled: [7, {}, { reflect: true, type: Boolean }], open: [7, {}, { reflect: true, type: Boolean }], outsideCloseDisabled: [7, {}, { reflect: true, type: Boolean }], overlayPositioning: [3, {}, { reflect: true }], placement: [3, {}, { reflect: true }], resizable: [7, {}, { reflect: true, type: Boolean }], scale: [3, {}, { reflect: true }], widthScale: [3, {}, { reflect: true }], width: [3, {}, { reflect: true }] };
  }
  static {
    this.styles = styles;
  }
  get preventDocumentScroll() {
    return !this.embedded && this.modal;
  }
  get open() {
    return this._open;
  }
  set open(value) {
    const oldValue = this._open;
    if (value !== oldValue) {
      this.setOpenState(value);
    }
  }
  async scrollContentTo(options) {
    await this.panelEl.value?.scrollContentTo(options);
  }
  async setFocus(options) {
    return this.focusSetter(() => {
      return this.panelEl.value ?? this.el;
    }, options);
  }
  async updateFocusTrapElements(extraContainers) {
    this.focusTrap.setExtraContainers(extraContainers);
    this.focusTrap.updateContainerElements();
  }
  connectedCallback() {
    super.connectedCallback();
    this.mutationObserver?.observe(this.el, { childList: true, subtree: true });
    this.setupInteractions();
  }
  willUpdate(changes) {
    if (changes.has("open") && (this.hasUpdated || this.open !== false) || changes.has("placement") && (this.hasUpdated || this.placement !== "center") || changes.has("resizable") && (this.hasUpdated || this.resizable !== false) || changes.has("dragEnabled") && (this.hasUpdated || this.dragEnabled !== false)) {
      this.setupInteractions();
    }
    if (changes.has("messages") || changes.has("dragEnabled") && (this.hasUpdated || this.dragEnabled !== false) || changes.has("resizable") && (this.hasUpdated || this.resizable !== false)) {
      this.updateAssistiveText();
    }
    if (changes.has("opened") && (this.hasUpdated || this.opened !== false)) {
      this.handleOpenedChange(this.opened);
    }
  }
  disconnectedCallback() {
    super.disconnectedCallback();
    this.mutationObserver?.disconnect();
    this.embedded = false;
    this.cleanupInteractions();
  }
  focusTrapDisabledOverride() {
    return !this.modal && this.focusTrapDisabled;
  }
  updateAssistiveText() {
    const { messages } = this;
    this.assistiveText = messages && (this.dragEnabled || this.resizable) ? `${this.dragEnabled ? messages.dragEnabled : ""} ${this.resizable ? messages.resizeEnabled : ""}` : null;
  }
  onBeforeOpen() {
    this.calciteDialogBeforeOpen.emit();
  }
  onOpen() {
    if (this.focusTrapDisabled) {
      this.setFocus();
    }
    this.focusTrap.activate();
    this.calciteDialogOpen.emit();
  }
  onBeforeClose() {
    this.calciteDialogBeforeClose.emit();
  }
  onClose() {
    this.focusTrap.deactivate();
    this.calciteDialogClose.emit();
  }
  async setOpenState(value) {
    if (this.beforeClose && !value) {
      try {
        await this.beforeClose?.();
      } catch {
        return;
      }
    }
    this._open = value;
    if (value) {
      await this.componentOnReady();
    }
    this.opened = value;
  }
  handleOpenedChange(value) {
    const { transitionEl } = this;
    if (!transitionEl) {
      return;
    }
    transitionEl.classList.toggle(CSS.openingActive, value);
    (0,_chunks_openCloseComponent_js__WEBPACK_IMPORTED_MODULE_9__.t)(this);
  }
  async triggerInteractModifiers() {
    const { interaction } = this;
    if (!interaction) {
      return;
    }
    await interaction.reflow({
      name: "drag"
    });
    await interaction.reflow({
      name: "resize"
    });
  }
  getTransitionElDOMRect() {
    return this.transitionEl.getBoundingClientRect();
  }
  handleKeyDown(event) {
    const { key, shiftKey, defaultPrevented } = event;
    const { dragEnabled, resizable, resizePosition, dragPosition, transitionEl } = this;
    const keys = ["ArrowUp", "ArrowDown", "ArrowLeft", "ArrowRight"];
    if (defaultPrevented || !keys.includes(key)) {
      return;
    }
    switch (key) {
      case "ArrowUp":
        if (shiftKey && resizable && transitionEl) {
          const { minBlockSize } = window.getComputedStyle(transitionEl);
          const minHeight = (0,_chunks_dom_js__WEBPACK_IMPORTED_MODULE_6__.o)(minBlockSize);
          const height = this.getTransitionElDOMRect().height;
          if (height <= minHeight) {
            return;
          }
          this.updateSize({
            size: height - _chunks_runtime_js__WEBPACK_IMPORTED_MODULE_0__.a,
            type: "blockSize"
          });
          resizePosition.bottom -= _chunks_runtime_js__WEBPACK_IMPORTED_MODULE_0__.a;
          this.updateTransform();
          this.triggerInteractModifiers();
          event.preventDefault();
        } else if (dragEnabled) {
          dragPosition.y -= _chunks_runtime_js__WEBPACK_IMPORTED_MODULE_0__.a;
          this.updateTransform();
          this.triggerInteractModifiers();
          event.preventDefault();
        }
        break;
      case "ArrowDown":
        if (shiftKey && resizable && transitionEl) {
          this.updateSize({
            size: this.getTransitionElDOMRect().height + _chunks_runtime_js__WEBPACK_IMPORTED_MODULE_0__.a,
            type: "blockSize"
          });
          resizePosition.bottom += _chunks_runtime_js__WEBPACK_IMPORTED_MODULE_0__.a;
          this.updateTransform();
          this.triggerInteractModifiers();
          event.preventDefault();
        } else if (dragEnabled) {
          dragPosition.y += _chunks_runtime_js__WEBPACK_IMPORTED_MODULE_0__.a;
          this.updateTransform();
          this.triggerInteractModifiers();
          event.preventDefault();
        }
        break;
      case "ArrowLeft":
        if (shiftKey && resizable && transitionEl) {
          const { minInlineSize } = window.getComputedStyle(transitionEl);
          const minWidth = (0,_chunks_dom_js__WEBPACK_IMPORTED_MODULE_6__.o)(minInlineSize);
          const width = this.getTransitionElDOMRect().width;
          if (width <= minWidth) {
            return;
          }
          this.updateSize({
            size: width - _chunks_runtime_js__WEBPACK_IMPORTED_MODULE_0__.a,
            type: "inlineSize"
          });
          resizePosition.right -= _chunks_runtime_js__WEBPACK_IMPORTED_MODULE_0__.a;
          this.updateTransform();
          this.triggerInteractModifiers();
          event.preventDefault();
        } else if (dragEnabled) {
          dragPosition.x -= _chunks_runtime_js__WEBPACK_IMPORTED_MODULE_0__.a;
          this.updateTransform();
          this.triggerInteractModifiers();
          event.preventDefault();
        }
        break;
      case "ArrowRight":
        if (shiftKey && resizable && transitionEl) {
          this.updateSize({
            size: this.getTransitionElDOMRect().width + _chunks_runtime_js__WEBPACK_IMPORTED_MODULE_0__.a,
            type: "inlineSize"
          });
          resizePosition.right += _chunks_runtime_js__WEBPACK_IMPORTED_MODULE_0__.a;
          this.updateTransform();
          this.triggerInteractModifiers();
          event.preventDefault();
        } else if (dragEnabled) {
          dragPosition.x += _chunks_runtime_js__WEBPACK_IMPORTED_MODULE_0__.a;
          this.updateTransform();
          this.triggerInteractModifiers();
          event.preventDefault();
        }
        break;
    }
  }
  updateTransform() {
    const { dragPosition: { x, y }, resizePosition, transitionEl, dragEnabled, resizable } = this;
    if (!transitionEl) {
      return;
    }
    if (!dragEnabled && !resizable) {
      transitionEl.style.transform = null;
      return;
    }
    const { top, right, bottom, left } = this.getAdjustedResizePosition(resizePosition);
    const translateX = Math.round(x + left + right);
    const translateY = Math.round(y + top + bottom);
    transitionEl.style.transform = translateX || translateY ? `translate(${translateX}px, ${translateY}px)` : null;
  }
  updateSize({ type, size }) {
    const { transitionEl } = this;
    if (!transitionEl) {
      return;
    }
    transitionEl.style[type] = size !== null ? `${Math.round(size)}px` : null;
  }
  cleanupInteractions() {
    this.interaction?.unset();
    this.updateSize({ size: null, type: "inlineSize" });
    this.updateSize({ size: null, type: "blockSize" });
    this.dragPosition = { ...initialDragPosition };
    this.resizePosition = { ...initialResizePosition };
    this.updateTransform();
  }
  async setupInteractions() {
    this.cleanupInteractions();
    const { el, transitionEl, resizable, dragEnabled, resizePosition, dragPosition } = this;
    if (!transitionEl || !this.open) {
      return;
    }
    if (resizable || dragEnabled) {
      this.interaction = (0,_chunks_interact_min_js__WEBPACK_IMPORTED_MODULE_2__.i)(transitionEl, { context: el.ownerDocument });
    }
    if (resizable) {
      await this.el.componentOnReady();
      const { minInlineSize, minBlockSize, maxInlineSize, maxBlockSize } = window.getComputedStyle(transitionEl);
      this.interaction.resizable({
        edges: {
          top: true,
          right: true,
          bottom: true,
          left: true
        },
        modifiers: [
          _chunks_interact_min_js__WEBPACK_IMPORTED_MODULE_2__.i.modifiers.restrictSize({
            min: {
              width: (0,_chunks_dom_js__WEBPACK_IMPORTED_MODULE_6__.o)(minInlineSize),
              height: (0,_chunks_dom_js__WEBPACK_IMPORTED_MODULE_6__.o)(minBlockSize)
            },
            max: {
              width: (0,_chunks_dom_js__WEBPACK_IMPORTED_MODULE_6__.o)(maxInlineSize) || window.innerWidth,
              height: (0,_chunks_dom_js__WEBPACK_IMPORTED_MODULE_6__.o)(maxBlockSize) || window.innerHeight
            }
          }),
          _chunks_interact_min_js__WEBPACK_IMPORTED_MODULE_2__.i.modifiers.restrict({
            restriction: "parent"
          })
        ],
        listeners: {
          move: ({ rect, deltaRect }) => {
            if (deltaRect) {
              resizePosition.top += deltaRect.top;
              resizePosition.right += deltaRect.right;
              resizePosition.bottom += deltaRect.bottom;
              resizePosition.left += deltaRect.left;
            }
            this.updateSize({ size: rect.width, type: "inlineSize" });
            this.updateSize({ size: rect.height, type: "blockSize" });
            this.updateTransform();
          }
        }
      });
    }
    if (dragEnabled) {
      this.interaction.draggable({
        modifiers: [
          _chunks_interact_min_js__WEBPACK_IMPORTED_MODULE_2__.i.modifiers.restrictRect({
            restriction: "parent"
          })
        ],
        listeners: {
          move: ({ dx, dy }) => {
            dragPosition.x += dx;
            dragPosition.y += dy;
            this.updateTransform();
          }
        }
      });
    }
  }
  getAdjustedResizePosition({ top, right, bottom, left }) {
    const halfTop = top / 2;
    const halfRight = right / 2;
    const halfBottom = bottom / 2;
    const halfLeft = left / 2;
    switch (this.placement) {
      case "top":
        return { top, right: halfRight, bottom: 0, left: halfLeft };
      case "top-start":
        return { top, right: 0, bottom: 0, left };
      case "top-end":
        return { top, right, bottom: 0, left: 0 };
      case "bottom":
        return { top: 0, right: halfRight, bottom, left: halfLeft };
      case "bottom-start":
        return { top: 0, right: 0, bottom, left };
      case "bottom-end":
        return { top: 0, right, bottom, left: 0 };
      case "cover":
      case "center":
      default:
        return {
          top: halfTop,
          right: halfRight,
          bottom: halfBottom,
          left: halfLeft
        };
    }
  }
  setTransitionEl(el) {
    if (!el) {
      return;
    }
    this.transitionEl = el;
    this.setupInteractions();
  }
  handleInternalPanelScroll(event) {
    if (event.target !== this.panelEl.value) {
      return;
    }
    event.stopPropagation();
    this.calciteDialogScroll.emit();
  }
  handleInternalPanelCloseClick(event) {
    if (event.target !== this.panelEl.value) {
      return;
    }
    event.preventDefault();
    event.stopPropagation();
    this.open = false;
  }
  handlePanelKeyDown(event) {
    if (this.escapeDisabled && event.key === "Escape") {
      event.preventDefault();
    }
  }
  handleOutsideClose() {
    if (this.outsideCloseDisabled) {
      return;
    }
    this.open = false;
  }
  handleMutationObserver() {
    this.focusTrap.updateContainerElements();
  }
  render() {
    const { assistiveText, description, heading, opened, icon, iconFlipRtl } = this;
    return (0,lit__WEBPACK_IMPORTED_MODULE_3__.html)`<div class=${(0,_arcgis_lumina__WEBPACK_IMPORTED_MODULE_5__.safeClassMap)({
      [CSS.container]: true,
      [CSS.containerOpen]: opened,
      [CSS.containerEmbedded]: this.embedded
    })}>${this.modal ? (0,lit__WEBPACK_IMPORTED_MODULE_3__.html)`<calcite-scrim class=${(0,_arcgis_lumina__WEBPACK_IMPORTED_MODULE_5__.safeClassMap)(CSS.scrim)} @click=${this.handleOutsideClose}></calcite-scrim>` : null}<div .ariaDescription=${description} .ariaLabel=${heading} .ariaModal=${this.modal} class=${(0,_arcgis_lumina__WEBPACK_IMPORTED_MODULE_5__.safeClassMap)({
      [CSS.dialog]: true,
      [(0,_chunks_dynamicClasses_js__WEBPACK_IMPORTED_MODULE_8__.g)("width", this.width, this.widthScale)]: !!(this.width || this.widthScale)
    })} @keydown=${this.handleKeyDown} role=dialog ${(0,lit_html_directives_ref_js__WEBPACK_IMPORTED_MODULE_4__.ref)(this.setTransitionEl)}>${assistiveText ? (0,lit_directives_keyed_js__WEBPACK_IMPORTED_MODULE_1__.keyed)("assistive-text", (0,lit__WEBPACK_IMPORTED_MODULE_3__.html)`<div aria-live=polite class=${(0,_arcgis_lumina__WEBPACK_IMPORTED_MODULE_5__.safeClassMap)(CSS.assistiveText)}>${assistiveText}</div>`) : null}<slot name=${SLOTS.customContent}><slot name=${SLOTS.content}><calcite-panel class=${(0,_arcgis_lumina__WEBPACK_IMPORTED_MODULE_5__.safeClassMap)(CSS.panel)} .closable=${!this.closeDisabled} .description=${description} .heading=${heading} .headingLevel=${this.headingLevel} .hidden=${!this.opened} .icon=${icon} .iconFlipRtl=${iconFlipRtl} .loading=${this.loading} .menuOpen=${this.menuOpen} .messageOverrides=${this.messageOverrides} @keydown=${this.handlePanelKeyDown} @calcitePanelClose=${this.handleInternalPanelCloseClick} @calcitePanelScroll=${this.handleInternalPanelScroll} .overlayPositioning=${this.overlayPositioning} .scale=${this.scale} ${(0,lit_html_directives_ref_js__WEBPACK_IMPORTED_MODULE_4__.ref)(this.panelEl)}><slot name=${SLOTS.actionBar} slot=${_chunks_resources3_js__WEBPACK_IMPORTED_MODULE_10__.S.actionBar}></slot><slot name=${SLOTS.alerts} slot=${_chunks_resources3_js__WEBPACK_IMPORTED_MODULE_10__.S.alerts}></slot><slot name=${SLOTS.headerActionsStart} slot=${_chunks_resources3_js__WEBPACK_IMPORTED_MODULE_10__.S.headerActionsStart}></slot><slot name=${SLOTS.headerActionsEnd} slot=${_chunks_resources3_js__WEBPACK_IMPORTED_MODULE_10__.S.headerActionsEnd}></slot><slot name=${SLOTS.headerContent} slot=${_chunks_resources3_js__WEBPACK_IMPORTED_MODULE_10__.S.headerContent}></slot><slot name=${SLOTS.headerMenuActions} slot=${_chunks_resources3_js__WEBPACK_IMPORTED_MODULE_10__.S.headerMenuActions}></slot><slot name=${SLOTS.fab} slot=${_chunks_resources3_js__WEBPACK_IMPORTED_MODULE_10__.S.fab}></slot><slot name=${SLOTS.contentTop} slot=${_chunks_resources3_js__WEBPACK_IMPORTED_MODULE_10__.S.contentTop}></slot><slot name=${SLOTS.contentBottom} slot=${_chunks_resources3_js__WEBPACK_IMPORTED_MODULE_10__.S.contentBottom}></slot><slot name=${SLOTS.footerStart} slot=${_chunks_resources3_js__WEBPACK_IMPORTED_MODULE_10__.S.footerStart}></slot><slot name=${SLOTS.footer} slot=${_chunks_resources3_js__WEBPACK_IMPORTED_MODULE_10__.S.footer}></slot><slot name=${SLOTS.footerEnd} slot=${_chunks_resources3_js__WEBPACK_IMPORTED_MODULE_10__.S.footerEnd}></slot><slot></slot></calcite-panel></slot></slot></div></div>`;
  }
}
(0,_chunks_runtime_js__WEBPACK_IMPORTED_MODULE_0__.c)("calcite-dialog", Dialog);



/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/components/calcite-dialog/index.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/components/calcite-dialog/index.js ***!
  \***************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Dialog: () => (/* reexport safe */ _customElement_js__WEBPACK_IMPORTED_MODULE_2__.Dialog)
/* harmony export */ });
/* harmony import */ var _calcite_scrim_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../calcite-scrim/index.js */ "./node_modules/@esri/calcite-components/dist/components/calcite-scrim/index.js");
/* harmony import */ var _calcite_panel_index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../calcite-panel/index.js */ "./node_modules/@esri/calcite-components/dist/components/calcite-panel/index.js");
/* harmony import */ var _customElement_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./customElement.js */ "./node_modules/@esri/calcite-components/dist/components/calcite-dialog/customElement.js");




/***/ })

};

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVuZG9ycy1ub2RlX21vZHVsZXNfZXNyaV9jYWxjaXRlLWNvbXBvbmVudHNfZGlzdF9jb21wb25lbnRzX2NhbGNpdGUtZGlhbG9nX2luZGV4X2pzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsS0FBSyxHQUFHLEtBQUssZUFBZSxLQUFLLEdBQUcsTUFBTSxPQUFPLEtBQUs7QUFDekU7QUFHRTs7Ozs7Ozs7Ozs7Ozs7O0FDUkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHVCQUF1QjtBQUNoRDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsZ0JBQWdCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtRkFBbUYsaUJBQWlCO0FBQ3BHO0FBQ0E7QUFDQSxvRUFBb0UsaUVBQWlFO0FBQ3JJO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRCxlQUFlLGlEQUFpRCw0Q0FBNEMsaUJBQWlCO0FBQ3hMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixZQUFZO0FBQ1o7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0Es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LGVBQWUsYUFBYSxXQUFXLGNBQWMsWUFBWSxlQUFlLG9CQUFvQix1QkFBdUIsV0FBVyx5QkFBeUIscUJBQXFCLG9DQUFvQyxzQkFBc0IsZ0NBQWdDLHNCQUFzQix5QkFBeUIsU0FBUyxZQUFZLEVBQUUsK0RBQUcsZUFBZSxjQUFjLGlCQUFpQixPQUFPLHFEQUFPLFdBQVcscUJBQXFCLGNBQWMsT0FBTyxxREFBTyxRQUFRLHFCQUFxQiwwQkFBMEIsT0FBTyxxREFBTyxvQkFBb0IscUJBQXFCLHdCQUF3QixPQUFPLHFEQUFPLGtCQUFrQixxQkFBcUIscUJBQXFCLE9BQU8scURBQU8sZUFBZSxxQkFBcUIseUJBQXlCLE9BQU8scURBQU8sbUJBQW1CLHFCQUFxQixXQUFXLE9BQU8scURBQU8sS0FBSyxxQkFBcUIsa0JBQWtCLE9BQU8scURBQU8sWUFBWSxxQkFBcUIscUJBQXFCLE9BQU8scURBQU8sZUFBZSxxQkFBcUIsbUJBQW1CLE9BQU8scURBQU8sYUFBYSxxQkFBcUIsY0FBYyxPQUFPLHFEQUFPLFFBQVEscUJBQXFCLGlCQUFpQixPQUFPLHFEQUFPLFdBQVc7QUFDdm1EO0FBQ0E7QUFDQSxxREFBYTtBQUdYOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM5ZGlDO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmVjaXNpb25mYXJtcy8uL25vZGVfbW9kdWxlcy9AZXNyaS9jYWxjaXRlLWNvbXBvbmVudHMvZGlzdC9jaHVua3MvZHluYW1pY0NsYXNzZXMuanMiLCJ3ZWJwYWNrOi8vcHJlY2lzaW9uZmFybXMvLi9ub2RlX21vZHVsZXMvQGVzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Rpc3QvY2h1bmtzL2ludGVyYWN0Lm1pbi5qcyIsIndlYnBhY2s6Ly9wcmVjaXNpb25mYXJtcy8uL25vZGVfbW9kdWxlcy9AZXNyaS9jYWxjaXRlLWNvbXBvbmVudHMvZGlzdC9jaHVua3MvdXNlUHJldmVudERvY3VtZW50U2Nyb2xsLmpzIiwid2VicGFjazovL3ByZWNpc2lvbmZhcm1zLy4vbm9kZV9tb2R1bGVzL0Blc3JpL2NhbGNpdGUtY29tcG9uZW50cy9kaXN0L2NvbXBvbmVudHMvY2FsY2l0ZS1kaWFsb2cvY3VzdG9tRWxlbWVudC5qcyIsIndlYnBhY2s6Ly9wcmVjaXNpb25mYXJtcy8uL25vZGVfbW9kdWxlcy9AZXNyaS9jYWxjaXRlLWNvbXBvbmVudHMvZGlzdC9jb21wb25lbnRzL2NhbGNpdGUtZGlhbG9nL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qISBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtZGVzaWduLXN5c3RlbS9ibG9iL2Rldi9MSUNFTlNFLm1kIGZvciBkZXRhaWxzLlxudjMuMy4zICovXG5mdW5jdGlvbiBnZXREaW1lbnNpb25DbGFzcyh0eXBlLCBzaXplLCBzY2FsZSkge1xuICByZXR1cm4gc2l6ZSA/IGAke3R5cGV9LSR7c2l6ZX1gIDogc2NhbGUgPyBgJHt0eXBlfS0ke3NjYWxlfWAgOiBgJHt0eXBlfS1tYDtcbn1cbmV4cG9ydCB7XG4gIGdldERpbWVuc2lvbkNsYXNzIGFzIGdcbn07XG4iLCIvKiEgQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cblNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWRlc2lnbi1zeXN0ZW0vYmxvYi9kZXYvTElDRU5TRS5tZCBmb3IgZGV0YWlscy5cbnYzLjMuMyAqL1xuZnVuY3Rpb24gZ2V0RGVmYXVsdEV4cG9ydEZyb21DanMoeCkge1xuICByZXR1cm4geCAmJiB4Ll9fZXNNb2R1bGUgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHgsIFwiZGVmYXVsdFwiKSA/IHhbXCJkZWZhdWx0XCJdIDogeDtcbn1cbnZhciBpbnRlcmFjdF9taW4kMSA9IHsgZXhwb3J0czoge30gfTtcbnZhciBpbnRlcmFjdF9taW4gPSBpbnRlcmFjdF9taW4kMS5leHBvcnRzO1xudmFyIGhhc1JlcXVpcmVkSW50ZXJhY3RfbWluO1xuZnVuY3Rpb24gcmVxdWlyZUludGVyYWN0X21pbigpIHtcbiAgaWYgKGhhc1JlcXVpcmVkSW50ZXJhY3RfbWluKSByZXR1cm4gaW50ZXJhY3RfbWluJDEuZXhwb3J0cztcbiAgaGFzUmVxdWlyZWRJbnRlcmFjdF9taW4gPSAxO1xuICAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG4gICAgIWZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgIG1vZHVsZS5leHBvcnRzID0gZSgpO1xuICAgIH0oaW50ZXJhY3RfbWluLCBmdW5jdGlvbigpIHtcbiAgICAgIGZ1bmN0aW9uIHQodDIsIGUyKSB7XG4gICAgICAgIHZhciBuMiA9IE9iamVjdC5rZXlzKHQyKTtcbiAgICAgICAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHtcbiAgICAgICAgICB2YXIgcjIgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHQyKTtcbiAgICAgICAgICBlMiAmJiAocjIgPSByMi5maWx0ZXIoZnVuY3Rpb24oZTMpIHtcbiAgICAgICAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHQyLCBlMykuZW51bWVyYWJsZTtcbiAgICAgICAgICB9KSksIG4yLnB1c2guYXBwbHkobjIsIHIyKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbjI7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBlKGUyKSB7XG4gICAgICAgIGZvciAodmFyIG4yID0gMTsgbjIgPCBhcmd1bWVudHMubGVuZ3RoOyBuMisrKSB7XG4gICAgICAgICAgdmFyIHIyID0gbnVsbCAhPSBhcmd1bWVudHNbbjJdID8gYXJndW1lbnRzW24yXSA6IHt9O1xuICAgICAgICAgIG4yICUgMiA/IHQoT2JqZWN0KHIyKSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbih0Mikge1xuICAgICAgICAgICAgYShlMiwgdDIsIHIyW3QyXSk7XG4gICAgICAgICAgfSkgOiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUyLCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhyMikpIDogdChPYmplY3QocjIpKS5mb3JFYWNoKGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZTIsIHQyLCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHIyLCB0MikpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlMjtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIG4odDIpIHtcbiAgICAgICAgcmV0dXJuIG4gPSBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIFN5bWJvbCAmJiBcInN5bWJvbFwiID09IHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPyBmdW5jdGlvbih0Mykge1xuICAgICAgICAgIHJldHVybiB0eXBlb2YgdDM7XG4gICAgICAgIH0gOiBmdW5jdGlvbih0Mykge1xuICAgICAgICAgIHJldHVybiB0MyAmJiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIFN5bWJvbCAmJiB0My5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIHQzICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiB0MztcbiAgICAgICAgfSwgbih0Mik7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiByKHQyLCBlMikge1xuICAgICAgICBpZiAoISh0MiBpbnN0YW5jZW9mIGUyKSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIGkodDIsIGUyKSB7XG4gICAgICAgIGZvciAodmFyIG4yID0gMDsgbjIgPCBlMi5sZW5ndGg7IG4yKyspIHtcbiAgICAgICAgICB2YXIgcjIgPSBlMltuMl07XG4gICAgICAgICAgcjIuZW51bWVyYWJsZSA9IHIyLmVudW1lcmFibGUgfHwgZmFsc2UsIHIyLmNvbmZpZ3VyYWJsZSA9IHRydWUsIFwidmFsdWVcIiBpbiByMiAmJiAocjIud3JpdGFibGUgPSB0cnVlKSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHQyLCBkKHIyLmtleSksIHIyKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZnVuY3Rpb24gbyh0MiwgZTIsIG4yKSB7XG4gICAgICAgIHJldHVybiBlMiAmJiBpKHQyLnByb3RvdHlwZSwgZTIpLCBPYmplY3QuZGVmaW5lUHJvcGVydHkodDIsIFwicHJvdG90eXBlXCIsIHsgd3JpdGFibGU6IGZhbHNlIH0pLCB0MjtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIGEodDIsIGUyLCBuMikge1xuICAgICAgICByZXR1cm4gKGUyID0gZChlMikpIGluIHQyID8gT2JqZWN0LmRlZmluZVByb3BlcnR5KHQyLCBlMiwgeyB2YWx1ZTogbjIsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSkgOiB0MltlMl0gPSBuMiwgdDI7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBzKHQyLCBlMikge1xuICAgICAgICBpZiAoXCJmdW5jdGlvblwiICE9IHR5cGVvZiBlMiAmJiBudWxsICE9PSBlMikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uXCIpO1xuICAgICAgICB0Mi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKGUyICYmIGUyLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogdDIsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHQyLCBcInByb3RvdHlwZVwiLCB7IHdyaXRhYmxlOiBmYWxzZSB9KSwgZTIgJiYgbCh0MiwgZTIpO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gYyh0Mikge1xuICAgICAgICByZXR1cm4gYyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZi5iaW5kKCkgOiBmdW5jdGlvbih0Mykge1xuICAgICAgICAgIHJldHVybiB0My5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKHQzKTtcbiAgICAgICAgfSwgYyh0Mik7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBsKHQyLCBlMikge1xuICAgICAgICByZXR1cm4gbCA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZi5iaW5kKCkgOiBmdW5jdGlvbih0MywgZTMpIHtcbiAgICAgICAgICByZXR1cm4gdDMuX19wcm90b19fID0gZTMsIHQzO1xuICAgICAgICB9LCBsKHQyLCBlMik7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiB1KHQyKSB7XG4gICAgICAgIGlmICh2b2lkIDAgPT09IHQyKSB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7XG4gICAgICAgIHJldHVybiB0MjtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIHAodDIpIHtcbiAgICAgICAgdmFyIGUyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKFwidW5kZWZpbmVkXCIgPT0gdHlwZW9mIFJlZmxlY3QgfHwgIVJlZmxlY3QuY29uc3RydWN0KSByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgaWYgKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pIHJldHVybiBmYWxzZTtcbiAgICAgICAgICBpZiAoXCJmdW5jdGlvblwiID09IHR5cGVvZiBQcm94eSkgcmV0dXJuIHRydWU7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoQm9vbGVhbiwgW10sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgfSkpLCB0cnVlO1xuICAgICAgICAgIH0gY2F0Y2ggKHQzKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9KCk7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgbjIsIHIyID0gYyh0Mik7XG4gICAgICAgICAgaWYgKGUyKSB7XG4gICAgICAgICAgICB2YXIgaTIgPSBjKHRoaXMpLmNvbnN0cnVjdG9yO1xuICAgICAgICAgICAgbjIgPSBSZWZsZWN0LmNvbnN0cnVjdChyMiwgYXJndW1lbnRzLCBpMik7XG4gICAgICAgICAgfSBlbHNlIG4yID0gcjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24odDMsIGUzKSB7XG4gICAgICAgICAgICBpZiAoZTMgJiYgKFwib2JqZWN0XCIgPT0gdHlwZW9mIGUzIHx8IFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgZTMpKSByZXR1cm4gZTM7XG4gICAgICAgICAgICBpZiAodm9pZCAwICE9PSBlMykgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkRlcml2ZWQgY29uc3RydWN0b3JzIG1heSBvbmx5IHJldHVybiBvYmplY3Qgb3IgdW5kZWZpbmVkXCIpO1xuICAgICAgICAgICAgcmV0dXJuIHUodDMpO1xuICAgICAgICAgIH0odGhpcywgbjIpO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gZigpIHtcbiAgICAgICAgcmV0dXJuIGYgPSBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBSZWZsZWN0ICYmIFJlZmxlY3QuZ2V0ID8gUmVmbGVjdC5nZXQuYmluZCgpIDogZnVuY3Rpb24odDIsIGUyLCBuMikge1xuICAgICAgICAgIHZhciByMiA9IGZ1bmN0aW9uKHQzLCBlMykge1xuICAgICAgICAgICAgZm9yICg7ICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodDMsIGUzKSAmJiBudWxsICE9PSAodDMgPSBjKHQzKSk7ICkgO1xuICAgICAgICAgICAgcmV0dXJuIHQzO1xuICAgICAgICAgIH0odDIsIGUyKTtcbiAgICAgICAgICBpZiAocjIpIHtcbiAgICAgICAgICAgIHZhciBpMiA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocjIsIGUyKTtcbiAgICAgICAgICAgIHJldHVybiBpMi5nZXQgPyBpMi5nZXQuY2FsbChhcmd1bWVudHMubGVuZ3RoIDwgMyA/IHQyIDogbjIpIDogaTIudmFsdWU7XG4gICAgICAgICAgfVxuICAgICAgICB9LCBmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBkKHQyKSB7XG4gICAgICAgIHZhciBlMiA9IGZ1bmN0aW9uKHQzLCBlMykge1xuICAgICAgICAgIGlmIChcIm9iamVjdFwiICE9IHR5cGVvZiB0MyB8fCBudWxsID09PSB0MykgcmV0dXJuIHQzO1xuICAgICAgICAgIHZhciBuMiA9IHQzW1N5bWJvbC50b1ByaW1pdGl2ZV07XG4gICAgICAgICAgaWYgKHZvaWQgMCAhPT0gbjIpIHtcbiAgICAgICAgICAgIHZhciByMiA9IG4yLmNhbGwodDMsIGUzKTtcbiAgICAgICAgICAgIGlmIChcIm9iamVjdFwiICE9IHR5cGVvZiByMikgcmV0dXJuIHIyO1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkBAdG9QcmltaXRpdmUgbXVzdCByZXR1cm4gYSBwcmltaXRpdmUgdmFsdWUuXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gU3RyaW5nKHQzKTtcbiAgICAgICAgfSh0MiwgXCJzdHJpbmdcIik7XG4gICAgICAgIHJldHVybiBcInN5bWJvbFwiID09IHR5cGVvZiBlMiA/IGUyIDogZTIgKyBcIlwiO1xuICAgICAgfVxuICAgICAgdmFyIGggPSBmdW5jdGlvbih0Mikge1xuICAgICAgICByZXR1cm4gISghdDIgfHwgIXQyLldpbmRvdykgJiYgdDIgaW5zdGFuY2VvZiB0Mi5XaW5kb3c7XG4gICAgICB9LCB2ID0gdm9pZCAwLCBnID0gdm9pZCAwO1xuICAgICAgZnVuY3Rpb24gbSh0Mikge1xuICAgICAgICB2ID0gdDI7XG4gICAgICAgIHZhciBlMiA9IHQyLmRvY3VtZW50LmNyZWF0ZVRleHROb2RlKFwiXCIpO1xuICAgICAgICBlMi5vd25lckRvY3VtZW50ICE9PSB0Mi5kb2N1bWVudCAmJiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIHQyLndyYXAgJiYgdDIud3JhcChlMikgPT09IGUyICYmICh0MiA9IHQyLndyYXAodDIpKSwgZyA9IHQyO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24geSh0Mikge1xuICAgICAgICByZXR1cm4gaCh0MikgPyB0MiA6ICh0Mi5vd25lckRvY3VtZW50IHx8IHQyKS5kZWZhdWx0VmlldyB8fCBnLndpbmRvdztcbiAgICAgIH1cbiAgICAgIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIHdpbmRvdyAmJiB3aW5kb3cgJiYgbSh3aW5kb3cpO1xuICAgICAgdmFyIGIgPSBmdW5jdGlvbih0Mikge1xuICAgICAgICByZXR1cm4gISF0MiAmJiBcIm9iamVjdFwiID09PSBuKHQyKTtcbiAgICAgIH0sIHggPSBmdW5jdGlvbih0Mikge1xuICAgICAgICByZXR1cm4gXCJmdW5jdGlvblwiID09IHR5cGVvZiB0MjtcbiAgICAgIH0sIHcgPSB7IHdpbmRvdzogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgcmV0dXJuIHQyID09PSBnIHx8IGgodDIpO1xuICAgICAgfSwgZG9jRnJhZzogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgcmV0dXJuIGIodDIpICYmIDExID09PSB0Mi5ub2RlVHlwZTtcbiAgICAgIH0sIG9iamVjdDogYiwgZnVuYzogeCwgbnVtYmVyOiBmdW5jdGlvbih0Mikge1xuICAgICAgICByZXR1cm4gXCJudW1iZXJcIiA9PSB0eXBlb2YgdDI7XG4gICAgICB9LCBib29sOiBmdW5jdGlvbih0Mikge1xuICAgICAgICByZXR1cm4gXCJib29sZWFuXCIgPT0gdHlwZW9mIHQyO1xuICAgICAgfSwgc3RyaW5nOiBmdW5jdGlvbih0Mikge1xuICAgICAgICByZXR1cm4gXCJzdHJpbmdcIiA9PSB0eXBlb2YgdDI7XG4gICAgICB9LCBlbGVtZW50OiBmdW5jdGlvbih0Mikge1xuICAgICAgICBpZiAoIXQyIHx8IFwib2JqZWN0XCIgIT09IG4odDIpKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIHZhciBlMiA9IHkodDIpIHx8IGc7XG4gICAgICAgIHJldHVybiAvb2JqZWN0fGZ1bmN0aW9uLy50ZXN0KFwidW5kZWZpbmVkXCIgPT0gdHlwZW9mIEVsZW1lbnQgPyBcInVuZGVmaW5lZFwiIDogbihFbGVtZW50KSkgPyB0MiBpbnN0YW5jZW9mIEVsZW1lbnQgfHwgdDIgaW5zdGFuY2VvZiBlMi5FbGVtZW50IDogMSA9PT0gdDIubm9kZVR5cGUgJiYgXCJzdHJpbmdcIiA9PSB0eXBlb2YgdDIubm9kZU5hbWU7XG4gICAgICB9LCBwbGFpbk9iamVjdDogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgcmV0dXJuIGIodDIpICYmICEhdDIuY29uc3RydWN0b3IgJiYgL2Z1bmN0aW9uIE9iamVjdFxcYi8udGVzdCh0Mi5jb25zdHJ1Y3Rvci50b1N0cmluZygpKTtcbiAgICAgIH0sIGFycmF5OiBmdW5jdGlvbih0Mikge1xuICAgICAgICByZXR1cm4gYih0MikgJiYgdm9pZCAwICE9PSB0Mi5sZW5ndGggJiYgeCh0Mi5zcGxpY2UpO1xuICAgICAgfSB9O1xuICAgICAgZnVuY3Rpb24gRSh0Mikge1xuICAgICAgICB2YXIgZTIgPSB0Mi5pbnRlcmFjdGlvbjtcbiAgICAgICAgaWYgKFwiZHJhZ1wiID09PSBlMi5wcmVwYXJlZC5uYW1lKSB7XG4gICAgICAgICAgdmFyIG4yID0gZTIucHJlcGFyZWQuYXhpcztcbiAgICAgICAgICBcInhcIiA9PT0gbjIgPyAoZTIuY29vcmRzLmN1ci5wYWdlLnkgPSBlMi5jb29yZHMuc3RhcnQucGFnZS55LCBlMi5jb29yZHMuY3VyLmNsaWVudC55ID0gZTIuY29vcmRzLnN0YXJ0LmNsaWVudC55LCBlMi5jb29yZHMudmVsb2NpdHkuY2xpZW50LnkgPSAwLCBlMi5jb29yZHMudmVsb2NpdHkucGFnZS55ID0gMCkgOiBcInlcIiA9PT0gbjIgJiYgKGUyLmNvb3Jkcy5jdXIucGFnZS54ID0gZTIuY29vcmRzLnN0YXJ0LnBhZ2UueCwgZTIuY29vcmRzLmN1ci5jbGllbnQueCA9IGUyLmNvb3Jkcy5zdGFydC5jbGllbnQueCwgZTIuY29vcmRzLnZlbG9jaXR5LmNsaWVudC54ID0gMCwgZTIuY29vcmRzLnZlbG9jaXR5LnBhZ2UueCA9IDApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBUKHQyKSB7XG4gICAgICAgIHZhciBlMiA9IHQyLmlFdmVudCwgbjIgPSB0Mi5pbnRlcmFjdGlvbjtcbiAgICAgICAgaWYgKFwiZHJhZ1wiID09PSBuMi5wcmVwYXJlZC5uYW1lKSB7XG4gICAgICAgICAgdmFyIHIyID0gbjIucHJlcGFyZWQuYXhpcztcbiAgICAgICAgICBpZiAoXCJ4XCIgPT09IHIyIHx8IFwieVwiID09PSByMikge1xuICAgICAgICAgICAgdmFyIGkyID0gXCJ4XCIgPT09IHIyID8gXCJ5XCIgOiBcInhcIjtcbiAgICAgICAgICAgIGUyLnBhZ2VbaTJdID0gbjIuY29vcmRzLnN0YXJ0LnBhZ2VbaTJdLCBlMi5jbGllbnRbaTJdID0gbjIuY29vcmRzLnN0YXJ0LmNsaWVudFtpMl0sIGUyLmRlbHRhW2kyXSA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICB2YXIgUyA9IHsgaWQ6IFwiYWN0aW9ucy9kcmFnXCIsIGluc3RhbGw6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHZhciBlMiA9IHQyLmFjdGlvbnMsIG4yID0gdDIuSW50ZXJhY3RhYmxlLCByMiA9IHQyLmRlZmF1bHRzO1xuICAgICAgICBuMi5wcm90b3R5cGUuZHJhZ2dhYmxlID0gUy5kcmFnZ2FibGUsIGUyLm1hcC5kcmFnID0gUywgZTIubWV0aG9kRGljdC5kcmFnID0gXCJkcmFnZ2FibGVcIiwgcjIuYWN0aW9ucy5kcmFnID0gUy5kZWZhdWx0cztcbiAgICAgIH0sIGxpc3RlbmVyczogeyBcImludGVyYWN0aW9uczpiZWZvcmUtYWN0aW9uLW1vdmVcIjogRSwgXCJpbnRlcmFjdGlvbnM6YWN0aW9uLXJlc3VtZVwiOiBFLCBcImludGVyYWN0aW9uczphY3Rpb24tbW92ZVwiOiBULCBcImF1dG8tc3RhcnQ6Y2hlY2tcIjogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuaW50ZXJhY3Rpb24sIG4yID0gdDIuaW50ZXJhY3RhYmxlLCByMiA9IHQyLmJ1dHRvbnMsIGkyID0gbjIub3B0aW9ucy5kcmFnO1xuICAgICAgICBpZiAoaTIgJiYgaTIuZW5hYmxlZCAmJiAoIWUyLnBvaW50ZXJJc0Rvd24gfHwgIS9tb3VzZXxwb2ludGVyLy50ZXN0KGUyLnBvaW50ZXJUeXBlKSB8fCAwICE9IChyMiAmIG4yLm9wdGlvbnMuZHJhZy5tb3VzZUJ1dHRvbnMpKSkgcmV0dXJuIHQyLmFjdGlvbiA9IHsgbmFtZTogXCJkcmFnXCIsIGF4aXM6IFwic3RhcnRcIiA9PT0gaTIubG9ja0F4aXMgPyBpMi5zdGFydEF4aXMgOiBpMi5sb2NrQXhpcyB9LCBmYWxzZTtcbiAgICAgIH0gfSwgZHJhZ2dhYmxlOiBmdW5jdGlvbih0Mikge1xuICAgICAgICByZXR1cm4gdy5vYmplY3QodDIpID8gKHRoaXMub3B0aW9ucy5kcmFnLmVuYWJsZWQgPSBmYWxzZSAhPT0gdDIuZW5hYmxlZCwgdGhpcy5zZXRQZXJBY3Rpb24oXCJkcmFnXCIsIHQyKSwgdGhpcy5zZXRPbkV2ZW50cyhcImRyYWdcIiwgdDIpLCAvXih4eXx4fHl8c3RhcnQpJC8udGVzdCh0Mi5sb2NrQXhpcykgJiYgKHRoaXMub3B0aW9ucy5kcmFnLmxvY2tBeGlzID0gdDIubG9ja0F4aXMpLCAvXih4eXx4fHkpJC8udGVzdCh0Mi5zdGFydEF4aXMpICYmICh0aGlzLm9wdGlvbnMuZHJhZy5zdGFydEF4aXMgPSB0Mi5zdGFydEF4aXMpLCB0aGlzKSA6IHcuYm9vbCh0MikgPyAodGhpcy5vcHRpb25zLmRyYWcuZW5hYmxlZCA9IHQyLCB0aGlzKSA6IHRoaXMub3B0aW9ucy5kcmFnO1xuICAgICAgfSwgYmVmb3JlTW92ZTogRSwgbW92ZTogVCwgZGVmYXVsdHM6IHsgc3RhcnRBeGlzOiBcInh5XCIsIGxvY2tBeGlzOiBcInh5XCIgfSwgZ2V0Q3Vyc29yOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIFwibW92ZVwiO1xuICAgICAgfSwgZmlsdGVyRXZlbnRUeXBlOiBmdW5jdGlvbih0Mikge1xuICAgICAgICByZXR1cm4gMCA9PT0gdDIuc2VhcmNoKFwiZHJhZ1wiKTtcbiAgICAgIH0gfSwgXyA9IFMsIFAgPSB7IGluaXQ6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHZhciBlMiA9IHQyO1xuICAgICAgICBQLmRvY3VtZW50ID0gZTIuZG9jdW1lbnQsIFAuRG9jdW1lbnRGcmFnbWVudCA9IGUyLkRvY3VtZW50RnJhZ21lbnQgfHwgTywgUC5TVkdFbGVtZW50ID0gZTIuU1ZHRWxlbWVudCB8fCBPLCBQLlNWR1NWR0VsZW1lbnQgPSBlMi5TVkdTVkdFbGVtZW50IHx8IE8sIFAuU1ZHRWxlbWVudEluc3RhbmNlID0gZTIuU1ZHRWxlbWVudEluc3RhbmNlIHx8IE8sIFAuRWxlbWVudCA9IGUyLkVsZW1lbnQgfHwgTywgUC5IVE1MRWxlbWVudCA9IGUyLkhUTUxFbGVtZW50IHx8IFAuRWxlbWVudCwgUC5FdmVudCA9IGUyLkV2ZW50LCBQLlRvdWNoID0gZTIuVG91Y2ggfHwgTywgUC5Qb2ludGVyRXZlbnQgPSBlMi5Qb2ludGVyRXZlbnQgfHwgZTIuTVNQb2ludGVyRXZlbnQ7XG4gICAgICB9LCBkb2N1bWVudDogbnVsbCwgRG9jdW1lbnRGcmFnbWVudDogbnVsbCwgU1ZHRWxlbWVudDogbnVsbCwgU1ZHU1ZHRWxlbWVudDogbnVsbCwgU1ZHRWxlbWVudEluc3RhbmNlOiBudWxsLCBFbGVtZW50OiBudWxsLCBIVE1MRWxlbWVudDogbnVsbCwgRXZlbnQ6IG51bGwsIFRvdWNoOiBudWxsLCBQb2ludGVyRXZlbnQ6IG51bGwgfTtcbiAgICAgIGZ1bmN0aW9uIE8oKSB7XG4gICAgICB9XG4gICAgICB2YXIgayA9IFA7XG4gICAgICB2YXIgRCA9IHsgaW5pdDogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyID0gay5FbGVtZW50LCBuMiA9IHQyLm5hdmlnYXRvciB8fCB7fTtcbiAgICAgICAgRC5zdXBwb3J0c1RvdWNoID0gXCJvbnRvdWNoc3RhcnRcIiBpbiB0MiB8fCB3LmZ1bmModDIuRG9jdW1lbnRUb3VjaCkgJiYgay5kb2N1bWVudCBpbnN0YW5jZW9mIHQyLkRvY3VtZW50VG91Y2gsIEQuc3VwcG9ydHNQb2ludGVyRXZlbnQgPSBmYWxzZSAhPT0gbjIucG9pbnRlckVuYWJsZWQgJiYgISFrLlBvaW50ZXJFdmVudCwgRC5pc0lPUyA9IC9pUChob25lfG9kfGFkKS8udGVzdChuMi5wbGF0Zm9ybSksIEQuaXNJT1M3ID0gL2lQKGhvbmV8b2R8YWQpLy50ZXN0KG4yLnBsYXRmb3JtKSAmJiAvT1MgN1teXFxkXS8udGVzdChuMi5hcHBWZXJzaW9uKSwgRC5pc0llOSA9IC9NU0lFIDkvLnRlc3QobjIudXNlckFnZW50KSwgRC5pc09wZXJhTW9iaWxlID0gXCJPcGVyYVwiID09PSBuMi5hcHBOYW1lICYmIEQuc3VwcG9ydHNUb3VjaCAmJiAvUHJlc3RvLy50ZXN0KG4yLnVzZXJBZ2VudCksIEQucHJlZml4ZWRNYXRjaGVzU2VsZWN0b3IgPSBcIm1hdGNoZXNcIiBpbiBlMi5wcm90b3R5cGUgPyBcIm1hdGNoZXNcIiA6IFwid2Via2l0TWF0Y2hlc1NlbGVjdG9yXCIgaW4gZTIucHJvdG90eXBlID8gXCJ3ZWJraXRNYXRjaGVzU2VsZWN0b3JcIiA6IFwibW96TWF0Y2hlc1NlbGVjdG9yXCIgaW4gZTIucHJvdG90eXBlID8gXCJtb3pNYXRjaGVzU2VsZWN0b3JcIiA6IFwib01hdGNoZXNTZWxlY3RvclwiIGluIGUyLnByb3RvdHlwZSA/IFwib01hdGNoZXNTZWxlY3RvclwiIDogXCJtc01hdGNoZXNTZWxlY3RvclwiLCBELnBFdmVudFR5cGVzID0gRC5zdXBwb3J0c1BvaW50ZXJFdmVudCA/IGsuUG9pbnRlckV2ZW50ID09PSB0Mi5NU1BvaW50ZXJFdmVudCA/IHsgdXA6IFwiTVNQb2ludGVyVXBcIiwgZG93bjogXCJNU1BvaW50ZXJEb3duXCIsIG92ZXI6IFwibW91c2VvdmVyXCIsIG91dDogXCJtb3VzZW91dFwiLCBtb3ZlOiBcIk1TUG9pbnRlck1vdmVcIiwgY2FuY2VsOiBcIk1TUG9pbnRlckNhbmNlbFwiIH0gOiB7IHVwOiBcInBvaW50ZXJ1cFwiLCBkb3duOiBcInBvaW50ZXJkb3duXCIsIG92ZXI6IFwicG9pbnRlcm92ZXJcIiwgb3V0OiBcInBvaW50ZXJvdXRcIiwgbW92ZTogXCJwb2ludGVybW92ZVwiLCBjYW5jZWw6IFwicG9pbnRlcmNhbmNlbFwiIH0gOiBudWxsLCBELndoZWVsRXZlbnQgPSBrLmRvY3VtZW50ICYmIFwib25tb3VzZXdoZWVsXCIgaW4gay5kb2N1bWVudCA/IFwibW91c2V3aGVlbFwiIDogXCJ3aGVlbFwiO1xuICAgICAgfSwgc3VwcG9ydHNUb3VjaDogbnVsbCwgc3VwcG9ydHNQb2ludGVyRXZlbnQ6IG51bGwsIGlzSU9TNzogbnVsbCwgaXNJT1M6IG51bGwsIGlzSWU5OiBudWxsLCBpc09wZXJhTW9iaWxlOiBudWxsLCBwcmVmaXhlZE1hdGNoZXNTZWxlY3RvcjogbnVsbCwgcEV2ZW50VHlwZXM6IG51bGwsIHdoZWVsRXZlbnQ6IG51bGwgfTtcbiAgICAgIHZhciBJID0gRDtcbiAgICAgIGZ1bmN0aW9uIE0odDIsIGUyKSB7XG4gICAgICAgIGlmICh0Mi5jb250YWlucykgcmV0dXJuIHQyLmNvbnRhaW5zKGUyKTtcbiAgICAgICAgZm9yICg7IGUyOyApIHtcbiAgICAgICAgICBpZiAoZTIgPT09IHQyKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICBlMiA9IGUyLnBhcmVudE5vZGU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24geih0MiwgZTIpIHtcbiAgICAgICAgZm9yICg7IHcuZWxlbWVudCh0Mik7ICkge1xuICAgICAgICAgIGlmIChSKHQyLCBlMikpIHJldHVybiB0MjtcbiAgICAgICAgICB0MiA9IEEodDIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gQSh0Mikge1xuICAgICAgICB2YXIgZTIgPSB0Mi5wYXJlbnROb2RlO1xuICAgICAgICBpZiAody5kb2NGcmFnKGUyKSkge1xuICAgICAgICAgIGZvciAoOyAoZTIgPSBlMi5ob3N0KSAmJiB3LmRvY0ZyYWcoZTIpOyApIDtcbiAgICAgICAgICByZXR1cm4gZTI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGUyO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gUih0MiwgZTIpIHtcbiAgICAgICAgcmV0dXJuIGcgIT09IHYgJiYgKGUyID0gZTIucmVwbGFjZSgvXFwvZGVlcFxcLy9nLCBcIiBcIikpLCB0MltJLnByZWZpeGVkTWF0Y2hlc1NlbGVjdG9yXShlMik7XG4gICAgICB9XG4gICAgICB2YXIgQyA9IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHJldHVybiB0Mi5wYXJlbnROb2RlIHx8IHQyLmhvc3Q7XG4gICAgICB9O1xuICAgICAgZnVuY3Rpb24gaih0MiwgZTIpIHtcbiAgICAgICAgZm9yICh2YXIgbjIsIHIyID0gW10sIGkyID0gdDI7IChuMiA9IEMoaTIpKSAmJiBpMiAhPT0gZTIgJiYgbjIgIT09IGkyLm93bmVyRG9jdW1lbnQ7ICkgcjIudW5zaGlmdChpMiksIGkyID0gbjI7XG4gICAgICAgIHJldHVybiByMjtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIEYodDIsIGUyLCBuMikge1xuICAgICAgICBmb3IgKDsgdy5lbGVtZW50KHQyKTsgKSB7XG4gICAgICAgICAgaWYgKFIodDIsIGUyKSkgcmV0dXJuIHRydWU7XG4gICAgICAgICAgaWYgKCh0MiA9IEEodDIpKSA9PT0gbjIpIHJldHVybiBSKHQyLCBlMik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gWCh0Mikge1xuICAgICAgICByZXR1cm4gdDIuY29ycmVzcG9uZGluZ1VzZUVsZW1lbnQgfHwgdDI7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBZKHQyKSB7XG4gICAgICAgIHZhciBlMiA9IHQyIGluc3RhbmNlb2Ygay5TVkdFbGVtZW50ID8gdDIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgOiB0Mi5nZXRDbGllbnRSZWN0cygpWzBdO1xuICAgICAgICByZXR1cm4gZTIgJiYgeyBsZWZ0OiBlMi5sZWZ0LCByaWdodDogZTIucmlnaHQsIHRvcDogZTIudG9wLCBib3R0b206IGUyLmJvdHRvbSwgd2lkdGg6IGUyLndpZHRoIHx8IGUyLnJpZ2h0IC0gZTIubGVmdCwgaGVpZ2h0OiBlMi5oZWlnaHQgfHwgZTIuYm90dG9tIC0gZTIudG9wIH07XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBMKHQyKSB7XG4gICAgICAgIHZhciBlMiwgbjIgPSBZKHQyKTtcbiAgICAgICAgaWYgKCFJLmlzSU9TNyAmJiBuMikge1xuICAgICAgICAgIHZhciByMiA9IHsgeDogKGUyID0gKGUyID0geSh0MikpIHx8IGcpLnNjcm9sbFggfHwgZTIuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQsIHk6IGUyLnNjcm9sbFkgfHwgZTIuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCB9O1xuICAgICAgICAgIG4yLmxlZnQgKz0gcjIueCwgbjIucmlnaHQgKz0gcjIueCwgbjIudG9wICs9IHIyLnksIG4yLmJvdHRvbSArPSByMi55O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuMjtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIHEodDIpIHtcbiAgICAgICAgZm9yICh2YXIgZTIgPSBbXTsgdDI7ICkgZTIucHVzaCh0MiksIHQyID0gQSh0Mik7XG4gICAgICAgIHJldHVybiBlMjtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIEIodDIpIHtcbiAgICAgICAgcmV0dXJuICEhdy5zdHJpbmcodDIpICYmIChrLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodDIpLCB0cnVlKTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIFYodDIsIGUyKSB7XG4gICAgICAgIGZvciAodmFyIG4yIGluIGUyKSB0MltuMl0gPSBlMltuMl07XG4gICAgICAgIHJldHVybiB0MjtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIFcodDIsIGUyLCBuMikge1xuICAgICAgICByZXR1cm4gXCJwYXJlbnRcIiA9PT0gdDIgPyBBKG4yKSA6IFwic2VsZlwiID09PSB0MiA/IGUyLmdldFJlY3QobjIpIDogeihuMiwgdDIpO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gRyh0MiwgZTIsIG4yLCByMikge1xuICAgICAgICB2YXIgaTIgPSB0MjtcbiAgICAgICAgcmV0dXJuIHcuc3RyaW5nKGkyKSA/IGkyID0gVyhpMiwgZTIsIG4yKSA6IHcuZnVuYyhpMikgJiYgKGkyID0gaTIuYXBwbHkodm9pZCAwLCByMikpLCB3LmVsZW1lbnQoaTIpICYmIChpMiA9IEwoaTIpKSwgaTI7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBOKHQyKSB7XG4gICAgICAgIHJldHVybiB0MiAmJiB7IHg6IFwieFwiIGluIHQyID8gdDIueCA6IHQyLmxlZnQsIHk6IFwieVwiIGluIHQyID8gdDIueSA6IHQyLnRvcCB9O1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gVSh0Mikge1xuICAgICAgICByZXR1cm4gIXQyIHx8IFwieFwiIGluIHQyICYmIFwieVwiIGluIHQyIHx8ICgodDIgPSBWKHt9LCB0MikpLnggPSB0Mi5sZWZ0IHx8IDAsIHQyLnkgPSB0Mi50b3AgfHwgMCwgdDIud2lkdGggPSB0Mi53aWR0aCB8fCAodDIucmlnaHQgfHwgMCkgLSB0Mi54LCB0Mi5oZWlnaHQgPSB0Mi5oZWlnaHQgfHwgKHQyLmJvdHRvbSB8fCAwKSAtIHQyLnkpLCB0MjtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIEgodDIsIGUyLCBuMikge1xuICAgICAgICB0Mi5sZWZ0ICYmIChlMi5sZWZ0ICs9IG4yLngpLCB0Mi5yaWdodCAmJiAoZTIucmlnaHQgKz0gbjIueCksIHQyLnRvcCAmJiAoZTIudG9wICs9IG4yLnkpLCB0Mi5ib3R0b20gJiYgKGUyLmJvdHRvbSArPSBuMi55KSwgZTIud2lkdGggPSBlMi5yaWdodCAtIGUyLmxlZnQsIGUyLmhlaWdodCA9IGUyLmJvdHRvbSAtIGUyLnRvcDtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIEsodDIsIGUyLCBuMikge1xuICAgICAgICB2YXIgcjIgPSBuMiAmJiB0Mi5vcHRpb25zW24yXTtcbiAgICAgICAgcmV0dXJuIE4oRyhyMiAmJiByMi5vcmlnaW4gfHwgdDIub3B0aW9ucy5vcmlnaW4sIHQyLCBlMiwgW3QyICYmIGUyXSkpIHx8IHsgeDogMCwgeTogMCB9O1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gJCh0MiwgZTIpIHtcbiAgICAgICAgdmFyIG4yID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgdm9pZCAwICE9PSBhcmd1bWVudHNbMl0gPyBhcmd1bWVudHNbMl0gOiBmdW5jdGlvbih0Mykge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LCByMiA9IGFyZ3VtZW50cy5sZW5ndGggPiAzID8gYXJndW1lbnRzWzNdIDogdm9pZCAwO1xuICAgICAgICBpZiAocjIgPSByMiB8fCB7fSwgdy5zdHJpbmcodDIpICYmIC0xICE9PSB0Mi5zZWFyY2goXCIgXCIpICYmICh0MiA9IEoodDIpKSwgdy5hcnJheSh0MikpIHJldHVybiB0Mi5mb3JFYWNoKGZ1bmN0aW9uKHQzKSB7XG4gICAgICAgICAgcmV0dXJuICQodDMsIGUyLCBuMiwgcjIpO1xuICAgICAgICB9KSwgcjI7XG4gICAgICAgIGlmICh3Lm9iamVjdCh0MikgJiYgKGUyID0gdDIsIHQyID0gXCJcIiksIHcuZnVuYyhlMikgJiYgbjIodDIpKSByMlt0Ml0gPSByMlt0Ml0gfHwgW10sIHIyW3QyXS5wdXNoKGUyKTtcbiAgICAgICAgZWxzZSBpZiAody5hcnJheShlMikpIGZvciAodmFyIGkyID0gMCwgbzIgPSBlMjsgaTIgPCBvMi5sZW5ndGg7IGkyKyspIHtcbiAgICAgICAgICB2YXIgYTIgPSBvMltpMl07XG4gICAgICAgICAgJCh0MiwgYTIsIG4yLCByMik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAody5vYmplY3QoZTIpKSBmb3IgKHZhciBzMiBpbiBlMikge1xuICAgICAgICAgICQoSihzMikubWFwKGZ1bmN0aW9uKGUzKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJcIi5jb25jYXQodDIpLmNvbmNhdChlMyk7XG4gICAgICAgICAgfSksIGUyW3MyXSwgbjIsIHIyKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcjI7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBKKHQyKSB7XG4gICAgICAgIHJldHVybiB0Mi50cmltKCkuc3BsaXQoLyArLyk7XG4gICAgICB9XG4gICAgICB2YXIgUSA9IGZ1bmN0aW9uKHQyLCBlMikge1xuICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KHQyICogdDIgKyBlMiAqIGUyKTtcbiAgICAgIH0sIFogPSBbXCJ3ZWJraXRcIiwgXCJtb3pcIl07XG4gICAgICBmdW5jdGlvbiB0dCh0MiwgZTIpIHtcbiAgICAgICAgdDIuX19zZXQgfHwgKHQyLl9fc2V0ID0ge30pO1xuICAgICAgICB2YXIgbjIgPSBmdW5jdGlvbihuMykge1xuICAgICAgICAgIGlmIChaLnNvbWUoZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICAgIHJldHVybiAwID09PSBuMy5pbmRleE9mKHQzKTtcbiAgICAgICAgICB9KSkgcmV0dXJuIDE7XG4gICAgICAgICAgXCJmdW5jdGlvblwiICE9IHR5cGVvZiB0MltuM10gJiYgXCJfX3NldFwiICE9PSBuMyAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodDIsIG4zLCB7IGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gbjMgaW4gdDIuX19zZXQgPyB0Mi5fX3NldFtuM10gOiB0Mi5fX3NldFtuM10gPSBlMltuM107XG4gICAgICAgICAgfSwgc2V0OiBmdW5jdGlvbihlMykge1xuICAgICAgICAgICAgdDIuX19zZXRbbjNdID0gZTM7XG4gICAgICAgICAgfSwgY29uZmlndXJhYmxlOiB0cnVlIH0pO1xuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciByMiBpbiBlMikgbjIocjIpO1xuICAgICAgICByZXR1cm4gdDI7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBldCh0MiwgZTIpIHtcbiAgICAgICAgdDIucGFnZSA9IHQyLnBhZ2UgfHwge30sIHQyLnBhZ2UueCA9IGUyLnBhZ2UueCwgdDIucGFnZS55ID0gZTIucGFnZS55LCB0Mi5jbGllbnQgPSB0Mi5jbGllbnQgfHwge30sIHQyLmNsaWVudC54ID0gZTIuY2xpZW50LngsIHQyLmNsaWVudC55ID0gZTIuY2xpZW50LnksIHQyLnRpbWVTdGFtcCA9IGUyLnRpbWVTdGFtcDtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIG50KHQyKSB7XG4gICAgICAgIHQyLnBhZ2UueCA9IDAsIHQyLnBhZ2UueSA9IDAsIHQyLmNsaWVudC54ID0gMCwgdDIuY2xpZW50LnkgPSAwO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gcnQodDIpIHtcbiAgICAgICAgcmV0dXJuIHQyIGluc3RhbmNlb2Ygay5FdmVudCB8fCB0MiBpbnN0YW5jZW9mIGsuVG91Y2g7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBpdCh0MiwgZTIsIG4yKSB7XG4gICAgICAgIHJldHVybiB0MiA9IHQyIHx8IFwicGFnZVwiLCAobjIgPSBuMiB8fCB7fSkueCA9IGUyW3QyICsgXCJYXCJdLCBuMi55ID0gZTJbdDIgKyBcIllcIl0sIG4yO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gb3QodDIsIGUyKSB7XG4gICAgICAgIHJldHVybiBlMiA9IGUyIHx8IHsgeDogMCwgeTogMCB9LCBJLmlzT3BlcmFNb2JpbGUgJiYgcnQodDIpID8gKGl0KFwic2NyZWVuXCIsIHQyLCBlMiksIGUyLnggKz0gd2luZG93LnNjcm9sbFgsIGUyLnkgKz0gd2luZG93LnNjcm9sbFkpIDogaXQoXCJwYWdlXCIsIHQyLCBlMiksIGUyO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gYXQodDIpIHtcbiAgICAgICAgcmV0dXJuIHcubnVtYmVyKHQyLnBvaW50ZXJJZCkgPyB0Mi5wb2ludGVySWQgOiB0Mi5pZGVudGlmaWVyO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gc3QodDIsIGUyLCBuMikge1xuICAgICAgICB2YXIgcjIgPSBlMi5sZW5ndGggPiAxID8gbHQoZTIpIDogZTJbMF07XG4gICAgICAgIG90KHIyLCB0Mi5wYWdlKSwgZnVuY3Rpb24odDMsIGUzKSB7XG4gICAgICAgICAgZTMgPSBlMyB8fCB7fSwgSS5pc09wZXJhTW9iaWxlICYmIHJ0KHQzKSA/IGl0KFwic2NyZWVuXCIsIHQzLCBlMykgOiBpdChcImNsaWVudFwiLCB0MywgZTMpO1xuICAgICAgICB9KHIyLCB0Mi5jbGllbnQpLCB0Mi50aW1lU3RhbXAgPSBuMjtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIGN0KHQyKSB7XG4gICAgICAgIHZhciBlMiA9IFtdO1xuICAgICAgICByZXR1cm4gdy5hcnJheSh0MikgPyAoZTJbMF0gPSB0MlswXSwgZTJbMV0gPSB0MlsxXSkgOiBcInRvdWNoZW5kXCIgPT09IHQyLnR5cGUgPyAxID09PSB0Mi50b3VjaGVzLmxlbmd0aCA/IChlMlswXSA9IHQyLnRvdWNoZXNbMF0sIGUyWzFdID0gdDIuY2hhbmdlZFRvdWNoZXNbMF0pIDogMCA9PT0gdDIudG91Y2hlcy5sZW5ndGggJiYgKGUyWzBdID0gdDIuY2hhbmdlZFRvdWNoZXNbMF0sIGUyWzFdID0gdDIuY2hhbmdlZFRvdWNoZXNbMV0pIDogKGUyWzBdID0gdDIudG91Y2hlc1swXSwgZTJbMV0gPSB0Mi50b3VjaGVzWzFdKSwgZTI7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBsdCh0Mikge1xuICAgICAgICBmb3IgKHZhciBlMiA9IHsgcGFnZVg6IDAsIHBhZ2VZOiAwLCBjbGllbnRYOiAwLCBjbGllbnRZOiAwLCBzY3JlZW5YOiAwLCBzY3JlZW5ZOiAwIH0sIG4yID0gMDsgbjIgPCB0Mi5sZW5ndGg7IG4yKyspIHtcbiAgICAgICAgICB2YXIgcjIgPSB0MltuMl07XG4gICAgICAgICAgZm9yICh2YXIgaTIgaW4gZTIpIGUyW2kyXSArPSByMltpMl07XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgbzIgaW4gZTIpIGUyW28yXSAvPSB0Mi5sZW5ndGg7XG4gICAgICAgIHJldHVybiBlMjtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIHV0KHQyKSB7XG4gICAgICAgIGlmICghdDIubGVuZ3RoKSByZXR1cm4gbnVsbDtcbiAgICAgICAgdmFyIGUyID0gY3QodDIpLCBuMiA9IE1hdGgubWluKGUyWzBdLnBhZ2VYLCBlMlsxXS5wYWdlWCksIHIyID0gTWF0aC5taW4oZTJbMF0ucGFnZVksIGUyWzFdLnBhZ2VZKSwgaTIgPSBNYXRoLm1heChlMlswXS5wYWdlWCwgZTJbMV0ucGFnZVgpLCBvMiA9IE1hdGgubWF4KGUyWzBdLnBhZ2VZLCBlMlsxXS5wYWdlWSk7XG4gICAgICAgIHJldHVybiB7IHg6IG4yLCB5OiByMiwgbGVmdDogbjIsIHRvcDogcjIsIHJpZ2h0OiBpMiwgYm90dG9tOiBvMiwgd2lkdGg6IGkyIC0gbjIsIGhlaWdodDogbzIgLSByMiB9O1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gcHQodDIsIGUyKSB7XG4gICAgICAgIHZhciBuMiA9IGUyICsgXCJYXCIsIHIyID0gZTIgKyBcIllcIiwgaTIgPSBjdCh0MiksIG8yID0gaTJbMF1bbjJdIC0gaTJbMV1bbjJdLCBhMiA9IGkyWzBdW3IyXSAtIGkyWzFdW3IyXTtcbiAgICAgICAgcmV0dXJuIFEobzIsIGEyKTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIGZ0KHQyLCBlMikge1xuICAgICAgICB2YXIgbjIgPSBlMiArIFwiWFwiLCByMiA9IGUyICsgXCJZXCIsIGkyID0gY3QodDIpLCBvMiA9IGkyWzFdW24yXSAtIGkyWzBdW24yXSwgYTIgPSBpMlsxXVtyMl0gLSBpMlswXVtyMl07XG4gICAgICAgIHJldHVybiAxODAgKiBNYXRoLmF0YW4yKGEyLCBvMikgLyBNYXRoLlBJO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gZHQodDIpIHtcbiAgICAgICAgcmV0dXJuIHcuc3RyaW5nKHQyLnBvaW50ZXJUeXBlKSA/IHQyLnBvaW50ZXJUeXBlIDogdy5udW1iZXIodDIucG9pbnRlclR5cGUpID8gW3ZvaWQgMCwgdm9pZCAwLCBcInRvdWNoXCIsIFwicGVuXCIsIFwibW91c2VcIl1bdDIucG9pbnRlclR5cGVdIDogL3RvdWNoLy50ZXN0KHQyLnR5cGUgfHwgXCJcIikgfHwgdDIgaW5zdGFuY2VvZiBrLlRvdWNoID8gXCJ0b3VjaFwiIDogXCJtb3VzZVwiO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gaHQodDIpIHtcbiAgICAgICAgdmFyIGUyID0gdy5mdW5jKHQyLmNvbXBvc2VkUGF0aCkgPyB0Mi5jb21wb3NlZFBhdGgoKSA6IHQyLnBhdGg7XG4gICAgICAgIHJldHVybiBbWChlMiA/IGUyWzBdIDogdDIudGFyZ2V0KSwgWCh0Mi5jdXJyZW50VGFyZ2V0KV07XG4gICAgICB9XG4gICAgICB2YXIgdnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgZnVuY3Rpb24gdDIoZTIpIHtcbiAgICAgICAgICByKHRoaXMsIHQyKSwgdGhpcy5pbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQgPSBmYWxzZSwgdGhpcy5wcm9wYWdhdGlvblN0b3BwZWQgPSBmYWxzZSwgdGhpcy5faW50ZXJhY3Rpb24gPSBlMjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbyh0MiwgW3sga2V5OiBcInByZXZlbnREZWZhdWx0XCIsIHZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgfSB9LCB7IGtleTogXCJzdG9wUHJvcGFnYXRpb25cIiwgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMucHJvcGFnYXRpb25TdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgfSB9LCB7IGtleTogXCJzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb25cIiwgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMuaW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkID0gdGhpcy5wcm9wYWdhdGlvblN0b3BwZWQgPSB0cnVlO1xuICAgICAgICB9IH1dKSwgdDI7XG4gICAgICB9KCk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodnQucHJvdG90eXBlLCBcImludGVyYWN0aW9uXCIsIHsgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ludGVyYWN0aW9uLl9wcm94eTtcbiAgICAgIH0sIHNldDogZnVuY3Rpb24oKSB7XG4gICAgICB9IH0pO1xuICAgICAgdmFyIGd0ID0gZnVuY3Rpb24odDIsIGUyKSB7XG4gICAgICAgIGZvciAodmFyIG4yID0gMDsgbjIgPCBlMi5sZW5ndGg7IG4yKyspIHtcbiAgICAgICAgICB2YXIgcjIgPSBlMltuMl07XG4gICAgICAgICAgdDIucHVzaChyMik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHQyO1xuICAgICAgfSwgbXQgPSBmdW5jdGlvbih0Mikge1xuICAgICAgICByZXR1cm4gZ3QoW10sIHQyKTtcbiAgICAgIH0sIHl0ID0gZnVuY3Rpb24odDIsIGUyKSB7XG4gICAgICAgIGZvciAodmFyIG4yID0gMDsgbjIgPCB0Mi5sZW5ndGg7IG4yKyspIGlmIChlMih0MltuMl0sIG4yLCB0MikpIHJldHVybiBuMjtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgfSwgYnQgPSBmdW5jdGlvbih0MiwgZTIpIHtcbiAgICAgICAgcmV0dXJuIHQyW3l0KHQyLCBlMildO1xuICAgICAgfSwgeHQgPSBmdW5jdGlvbih0Mikge1xuICAgICAgICBzKG4yLCB0Mik7XG4gICAgICAgIHZhciBlMiA9IHAobjIpO1xuICAgICAgICBmdW5jdGlvbiBuMih0MywgaTIsIG8yKSB7XG4gICAgICAgICAgdmFyIGEyO1xuICAgICAgICAgIHIodGhpcywgbjIpLCAoYTIgPSBlMi5jYWxsKHRoaXMsIGkyLl9pbnRlcmFjdGlvbikpLmRyb3B6b25lID0gdm9pZCAwLCBhMi5kcmFnRXZlbnQgPSB2b2lkIDAsIGEyLnJlbGF0ZWRUYXJnZXQgPSB2b2lkIDAsIGEyLmRyYWdnYWJsZSA9IHZvaWQgMCwgYTIucHJvcGFnYXRpb25TdG9wcGVkID0gZmFsc2UsIGEyLmltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCA9IGZhbHNlO1xuICAgICAgICAgIHZhciBzMiA9IFwiZHJhZ2xlYXZlXCIgPT09IG8yID8gdDMucHJldiA6IHQzLmN1ciwgYzIgPSBzMi5lbGVtZW50LCBsMiA9IHMyLmRyb3B6b25lO1xuICAgICAgICAgIHJldHVybiBhMi50eXBlID0gbzIsIGEyLnRhcmdldCA9IGMyLCBhMi5jdXJyZW50VGFyZ2V0ID0gYzIsIGEyLmRyb3B6b25lID0gbDIsIGEyLmRyYWdFdmVudCA9IGkyLCBhMi5yZWxhdGVkVGFyZ2V0ID0gaTIudGFyZ2V0LCBhMi5kcmFnZ2FibGUgPSBpMi5pbnRlcmFjdGFibGUsIGEyLnRpbWVTdGFtcCA9IGkyLnRpbWVTdGFtcCwgYTI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG8objIsIFt7IGtleTogXCJyZWplY3RcIiwgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciB0MyA9IHRoaXMsIGUzID0gdGhpcy5faW50ZXJhY3Rpb24uZHJvcFN0YXRlO1xuICAgICAgICAgIGlmIChcImRyb3BhY3RpdmF0ZVwiID09PSB0aGlzLnR5cGUgfHwgdGhpcy5kcm9wem9uZSAmJiBlMy5jdXIuZHJvcHpvbmUgPT09IHRoaXMuZHJvcHpvbmUgJiYgZTMuY3VyLmVsZW1lbnQgPT09IHRoaXMudGFyZ2V0KSBpZiAoZTMucHJldi5kcm9wem9uZSA9IHRoaXMuZHJvcHpvbmUsIGUzLnByZXYuZWxlbWVudCA9IHRoaXMudGFyZ2V0LCBlMy5yZWplY3RlZCA9IHRydWUsIGUzLmV2ZW50cy5lbnRlciA9IG51bGwsIHRoaXMuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksIFwiZHJvcGFjdGl2YXRlXCIgPT09IHRoaXMudHlwZSkge1xuICAgICAgICAgICAgdmFyIHIyID0gZTMuYWN0aXZlRHJvcHMsIGkyID0geXQocjIsIGZ1bmN0aW9uKGU0KSB7XG4gICAgICAgICAgICAgIHZhciBuMyA9IGU0LmRyb3B6b25lLCByMyA9IGU0LmVsZW1lbnQ7XG4gICAgICAgICAgICAgIHJldHVybiBuMyA9PT0gdDMuZHJvcHpvbmUgJiYgcjMgPT09IHQzLnRhcmdldDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZTMuYWN0aXZlRHJvcHMuc3BsaWNlKGkyLCAxKTtcbiAgICAgICAgICAgIHZhciBvMiA9IG5ldyBuMihlMywgdGhpcy5kcmFnRXZlbnQsIFwiZHJvcGRlYWN0aXZhdGVcIik7XG4gICAgICAgICAgICBvMi5kcm9wem9uZSA9IHRoaXMuZHJvcHpvbmUsIG8yLnRhcmdldCA9IHRoaXMudGFyZ2V0LCB0aGlzLmRyb3B6b25lLmZpcmUobzIpO1xuICAgICAgICAgIH0gZWxzZSB0aGlzLmRyb3B6b25lLmZpcmUobmV3IG4yKGUzLCB0aGlzLmRyYWdFdmVudCwgXCJkcmFnbGVhdmVcIikpO1xuICAgICAgICB9IH0sIHsga2V5OiBcInByZXZlbnREZWZhdWx0XCIsIHZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgfSB9LCB7IGtleTogXCJzdG9wUHJvcGFnYXRpb25cIiwgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMucHJvcGFnYXRpb25TdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgfSB9LCB7IGtleTogXCJzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb25cIiwgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMuaW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkID0gdGhpcy5wcm9wYWdhdGlvblN0b3BwZWQgPSB0cnVlO1xuICAgICAgICB9IH1dKSwgbjI7XG4gICAgICB9KHZ0KTtcbiAgICAgIGZ1bmN0aW9uIHd0KHQyLCBlMikge1xuICAgICAgICBmb3IgKHZhciBuMiA9IDAsIHIyID0gdDIuc2xpY2UoKTsgbjIgPCByMi5sZW5ndGg7IG4yKyspIHtcbiAgICAgICAgICB2YXIgaTIgPSByMltuMl0sIG8yID0gaTIuZHJvcHpvbmUsIGEyID0gaTIuZWxlbWVudDtcbiAgICAgICAgICBlMi5kcm9wem9uZSA9IG8yLCBlMi50YXJnZXQgPSBhMiwgbzIuZmlyZShlMiksIGUyLnByb3BhZ2F0aW9uU3RvcHBlZCA9IGUyLmltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBFdCh0MiwgZTIpIHtcbiAgICAgICAgZm9yICh2YXIgbjIgPSBmdW5jdGlvbih0MywgZTMpIHtcbiAgICAgICAgICBmb3IgKHZhciBuMyA9IFtdLCByMyA9IDAsIGkzID0gdDMuaW50ZXJhY3RhYmxlcy5saXN0OyByMyA8IGkzLmxlbmd0aDsgcjMrKykge1xuICAgICAgICAgICAgdmFyIG8yID0gaTNbcjNdO1xuICAgICAgICAgICAgaWYgKG8yLm9wdGlvbnMuZHJvcC5lbmFibGVkKSB7XG4gICAgICAgICAgICAgIHZhciBhMiA9IG8yLm9wdGlvbnMuZHJvcC5hY2NlcHQ7XG4gICAgICAgICAgICAgIGlmICghKHcuZWxlbWVudChhMikgJiYgYTIgIT09IGUzIHx8IHcuc3RyaW5nKGEyKSAmJiAhUihlMywgYTIpIHx8IHcuZnVuYyhhMikgJiYgIWEyKHsgZHJvcHpvbmU6IG8yLCBkcmFnZ2FibGVFbGVtZW50OiBlMyB9KSkpIGZvciAodmFyIHMyID0gMCwgYzIgPSBvMi5nZXRBbGxFbGVtZW50cygpOyBzMiA8IGMyLmxlbmd0aDsgczIrKykge1xuICAgICAgICAgICAgICAgIHZhciBsMiA9IGMyW3MyXTtcbiAgICAgICAgICAgICAgICBsMiAhPT0gZTMgJiYgbjMucHVzaCh7IGRyb3B6b25lOiBvMiwgZWxlbWVudDogbDIsIHJlY3Q6IG8yLmdldFJlY3QobDIpIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBuMztcbiAgICAgICAgfSh0MiwgZTIpLCByMiA9IDA7IHIyIDwgbjIubGVuZ3RoOyByMisrKSB7XG4gICAgICAgICAgdmFyIGkyID0gbjJbcjJdO1xuICAgICAgICAgIGkyLnJlY3QgPSBpMi5kcm9wem9uZS5nZXRSZWN0KGkyLmVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuMjtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIFR0KHQyLCBlMiwgbjIpIHtcbiAgICAgICAgZm9yICh2YXIgcjIgPSB0Mi5kcm9wU3RhdGUsIGkyID0gdDIuaW50ZXJhY3RhYmxlLCBvMiA9IHQyLmVsZW1lbnQsIGEyID0gW10sIHMyID0gMCwgYzIgPSByMi5hY3RpdmVEcm9wczsgczIgPCBjMi5sZW5ndGg7IHMyKyspIHtcbiAgICAgICAgICB2YXIgbDIgPSBjMltzMl0sIHUyID0gbDIuZHJvcHpvbmUsIHAyID0gbDIuZWxlbWVudCwgZjIgPSBsMi5yZWN0LCBkMiA9IHUyLmRyb3BDaGVjayhlMiwgbjIsIGkyLCBvMiwgcDIsIGYyKTtcbiAgICAgICAgICBhMi5wdXNoKGQyID8gcDIgOiBudWxsKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaDIgPSBmdW5jdGlvbih0Mykge1xuICAgICAgICAgIGZvciAodmFyIGUzLCBuMywgcjMsIGkzID0gW10sIG8zID0gMDsgbzMgPCB0My5sZW5ndGg7IG8zKyspIHtcbiAgICAgICAgICAgIHZhciBhMyA9IHQzW28zXSwgczMgPSB0M1tlM107XG4gICAgICAgICAgICBpZiAoYTMgJiYgbzMgIT09IGUzKSBpZiAoczMpIHtcbiAgICAgICAgICAgICAgdmFyIGMzID0gQyhhMyksIGwzID0gQyhzMyk7XG4gICAgICAgICAgICAgIGlmIChjMyAhPT0gYTMub3duZXJEb2N1bWVudCkgaWYgKGwzICE9PSBhMy5vd25lckRvY3VtZW50KSBpZiAoYzMgIT09IGwzKSB7XG4gICAgICAgICAgICAgICAgaTMgPSBpMy5sZW5ndGggPyBpMyA6IGooczMpO1xuICAgICAgICAgICAgICAgIHZhciB1MyA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICBpZiAoczMgaW5zdGFuY2VvZiBrLkhUTUxFbGVtZW50ICYmIGEzIGluc3RhbmNlb2Ygay5TVkdFbGVtZW50ICYmICEoYTMgaW5zdGFuY2VvZiBrLlNWR1NWR0VsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoYTMgPT09IGwzKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgIHUzID0gYTMub3duZXJTVkdFbGVtZW50O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB1MyA9IGEzO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIHAzID0gaih1MywgczMub3duZXJEb2N1bWVudCksIGYzID0gMDsgcDNbZjNdICYmIHAzW2YzXSA9PT0gaTNbZjNdOyApIGYzKys7XG4gICAgICAgICAgICAgICAgdmFyIGQzID0gW3AzW2YzIC0gMV0sIHAzW2YzXSwgaTNbZjNdXTtcbiAgICAgICAgICAgICAgICBpZiAoZDNbMF0pIGZvciAodmFyIGgzID0gZDNbMF0ubGFzdENoaWxkOyBoMzsgKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoaDMgPT09IGQzWzFdKSB7XG4gICAgICAgICAgICAgICAgICAgIGUzID0gbzMsIGkzID0gcDM7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgaWYgKGgzID09PSBkM1syXSkgYnJlYWs7XG4gICAgICAgICAgICAgICAgICBoMyA9IGgzLnByZXZpb3VzU2libGluZztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gZWxzZSByMyA9IHMzLCAocGFyc2VJbnQoeShuMyA9IGEzKS5nZXRDb21wdXRlZFN0eWxlKG4zKS56SW5kZXgsIDEwKSB8fCAwKSA+PSAocGFyc2VJbnQoeShyMykuZ2V0Q29tcHV0ZWRTdHlsZShyMykuekluZGV4LCAxMCkgfHwgMCkgJiYgKGUzID0gbzMpO1xuICAgICAgICAgICAgICBlbHNlIGUzID0gbzM7XG4gICAgICAgICAgICB9IGVsc2UgZTMgPSBvMztcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGUzO1xuICAgICAgICB9KGEyKTtcbiAgICAgICAgcmV0dXJuIHIyLmFjdGl2ZURyb3BzW2gyXSB8fCBudWxsO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gU3QodDIsIGUyLCBuMikge1xuICAgICAgICB2YXIgcjIgPSB0Mi5kcm9wU3RhdGUsIGkyID0geyBlbnRlcjogbnVsbCwgbGVhdmU6IG51bGwsIGFjdGl2YXRlOiBudWxsLCBkZWFjdGl2YXRlOiBudWxsLCBtb3ZlOiBudWxsLCBkcm9wOiBudWxsIH07XG4gICAgICAgIHJldHVybiBcImRyYWdzdGFydFwiID09PSBuMi50eXBlICYmIChpMi5hY3RpdmF0ZSA9IG5ldyB4dChyMiwgbjIsIFwiZHJvcGFjdGl2YXRlXCIpLCBpMi5hY3RpdmF0ZS50YXJnZXQgPSBudWxsLCBpMi5hY3RpdmF0ZS5kcm9wem9uZSA9IG51bGwpLCBcImRyYWdlbmRcIiA9PT0gbjIudHlwZSAmJiAoaTIuZGVhY3RpdmF0ZSA9IG5ldyB4dChyMiwgbjIsIFwiZHJvcGRlYWN0aXZhdGVcIiksIGkyLmRlYWN0aXZhdGUudGFyZ2V0ID0gbnVsbCwgaTIuZGVhY3RpdmF0ZS5kcm9wem9uZSA9IG51bGwpLCByMi5yZWplY3RlZCB8fCAocjIuY3VyLmVsZW1lbnQgIT09IHIyLnByZXYuZWxlbWVudCAmJiAocjIucHJldi5kcm9wem9uZSAmJiAoaTIubGVhdmUgPSBuZXcgeHQocjIsIG4yLCBcImRyYWdsZWF2ZVwiKSwgbjIuZHJhZ0xlYXZlID0gaTIubGVhdmUudGFyZ2V0ID0gcjIucHJldi5lbGVtZW50LCBuMi5wcmV2RHJvcHpvbmUgPSBpMi5sZWF2ZS5kcm9wem9uZSA9IHIyLnByZXYuZHJvcHpvbmUpLCByMi5jdXIuZHJvcHpvbmUgJiYgKGkyLmVudGVyID0gbmV3IHh0KHIyLCBuMiwgXCJkcmFnZW50ZXJcIiksIG4yLmRyYWdFbnRlciA9IHIyLmN1ci5lbGVtZW50LCBuMi5kcm9wem9uZSA9IHIyLmN1ci5kcm9wem9uZSkpLCBcImRyYWdlbmRcIiA9PT0gbjIudHlwZSAmJiByMi5jdXIuZHJvcHpvbmUgJiYgKGkyLmRyb3AgPSBuZXcgeHQocjIsIG4yLCBcImRyb3BcIiksIG4yLmRyb3B6b25lID0gcjIuY3VyLmRyb3B6b25lLCBuMi5yZWxhdGVkVGFyZ2V0ID0gcjIuY3VyLmVsZW1lbnQpLCBcImRyYWdtb3ZlXCIgPT09IG4yLnR5cGUgJiYgcjIuY3VyLmRyb3B6b25lICYmIChpMi5tb3ZlID0gbmV3IHh0KHIyLCBuMiwgXCJkcm9wbW92ZVwiKSwgbjIuZHJvcHpvbmUgPSByMi5jdXIuZHJvcHpvbmUpKSwgaTI7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBfdCh0MiwgZTIpIHtcbiAgICAgICAgdmFyIG4yID0gdDIuZHJvcFN0YXRlLCByMiA9IG4yLmFjdGl2ZURyb3BzLCBpMiA9IG4yLmN1ciwgbzIgPSBuMi5wcmV2O1xuICAgICAgICBlMi5sZWF2ZSAmJiBvMi5kcm9wem9uZS5maXJlKGUyLmxlYXZlKSwgZTIuZW50ZXIgJiYgaTIuZHJvcHpvbmUuZmlyZShlMi5lbnRlciksIGUyLm1vdmUgJiYgaTIuZHJvcHpvbmUuZmlyZShlMi5tb3ZlKSwgZTIuZHJvcCAmJiBpMi5kcm9wem9uZS5maXJlKGUyLmRyb3ApLCBlMi5kZWFjdGl2YXRlICYmIHd0KHIyLCBlMi5kZWFjdGl2YXRlKSwgbjIucHJldi5kcm9wem9uZSA9IGkyLmRyb3B6b25lLCBuMi5wcmV2LmVsZW1lbnQgPSBpMi5lbGVtZW50O1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gUHQodDIsIGUyKSB7XG4gICAgICAgIHZhciBuMiA9IHQyLmludGVyYWN0aW9uLCByMiA9IHQyLmlFdmVudCwgaTIgPSB0Mi5ldmVudDtcbiAgICAgICAgaWYgKFwiZHJhZ21vdmVcIiA9PT0gcjIudHlwZSB8fCBcImRyYWdlbmRcIiA9PT0gcjIudHlwZSkge1xuICAgICAgICAgIHZhciBvMiA9IG4yLmRyb3BTdGF0ZTtcbiAgICAgICAgICBlMi5keW5hbWljRHJvcCAmJiAobzIuYWN0aXZlRHJvcHMgPSBFdChlMiwgbjIuZWxlbWVudCkpO1xuICAgICAgICAgIHZhciBhMiA9IHIyLCBzMiA9IFR0KG4yLCBhMiwgaTIpO1xuICAgICAgICAgIG8yLnJlamVjdGVkID0gbzIucmVqZWN0ZWQgJiYgISFzMiAmJiBzMi5kcm9wem9uZSA9PT0gbzIuY3VyLmRyb3B6b25lICYmIHMyLmVsZW1lbnQgPT09IG8yLmN1ci5lbGVtZW50LCBvMi5jdXIuZHJvcHpvbmUgPSBzMiAmJiBzMi5kcm9wem9uZSwgbzIuY3VyLmVsZW1lbnQgPSBzMiAmJiBzMi5lbGVtZW50LCBvMi5ldmVudHMgPSBTdChuMiwgMCwgYTIpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB2YXIgT3QgPSB7IGlkOiBcImFjdGlvbnMvZHJvcFwiLCBpbnN0YWxsOiBmdW5jdGlvbih0Mikge1xuICAgICAgICB2YXIgZTIgPSB0Mi5hY3Rpb25zLCBuMiA9IHQyLmludGVyYWN0U3RhdGljLCByMiA9IHQyLkludGVyYWN0YWJsZSwgaTIgPSB0Mi5kZWZhdWx0cztcbiAgICAgICAgdDIudXNlUGx1Z2luKF8pLCByMi5wcm90b3R5cGUuZHJvcHpvbmUgPSBmdW5jdGlvbih0Mykge1xuICAgICAgICAgIHJldHVybiBmdW5jdGlvbih0NCwgZTMpIHtcbiAgICAgICAgICAgIGlmICh3Lm9iamVjdChlMykpIHtcbiAgICAgICAgICAgICAgaWYgKHQ0Lm9wdGlvbnMuZHJvcC5lbmFibGVkID0gZmFsc2UgIT09IGUzLmVuYWJsZWQsIGUzLmxpc3RlbmVycykge1xuICAgICAgICAgICAgICAgIHZhciBuMyA9ICQoZTMubGlzdGVuZXJzKSwgcjMgPSBPYmplY3Qua2V5cyhuMykucmVkdWNlKGZ1bmN0aW9uKHQ1LCBlNCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHQ1Wy9eKGVudGVyfGxlYXZlKS8udGVzdChlNCkgPyBcImRyYWdcIi5jb25jYXQoZTQpIDogL14oYWN0aXZhdGV8ZGVhY3RpdmF0ZXxtb3ZlKS8udGVzdChlNCkgPyBcImRyb3BcIi5jb25jYXQoZTQpIDogZTRdID0gbjNbZTRdLCB0NTtcbiAgICAgICAgICAgICAgICB9LCB7fSksIGkzID0gdDQub3B0aW9ucy5kcm9wLmxpc3RlbmVycztcbiAgICAgICAgICAgICAgICBpMyAmJiB0NC5vZmYoaTMpLCB0NC5vbihyMyksIHQ0Lm9wdGlvbnMuZHJvcC5saXN0ZW5lcnMgPSByMztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICByZXR1cm4gdy5mdW5jKGUzLm9uZHJvcCkgJiYgdDQub24oXCJkcm9wXCIsIGUzLm9uZHJvcCksIHcuZnVuYyhlMy5vbmRyb3BhY3RpdmF0ZSkgJiYgdDQub24oXCJkcm9wYWN0aXZhdGVcIiwgZTMub25kcm9wYWN0aXZhdGUpLCB3LmZ1bmMoZTMub25kcm9wZGVhY3RpdmF0ZSkgJiYgdDQub24oXCJkcm9wZGVhY3RpdmF0ZVwiLCBlMy5vbmRyb3BkZWFjdGl2YXRlKSwgdy5mdW5jKGUzLm9uZHJhZ2VudGVyKSAmJiB0NC5vbihcImRyYWdlbnRlclwiLCBlMy5vbmRyYWdlbnRlciksIHcuZnVuYyhlMy5vbmRyYWdsZWF2ZSkgJiYgdDQub24oXCJkcmFnbGVhdmVcIiwgZTMub25kcmFnbGVhdmUpLCB3LmZ1bmMoZTMub25kcm9wbW92ZSkgJiYgdDQub24oXCJkcm9wbW92ZVwiLCBlMy5vbmRyb3Btb3ZlKSwgL14ocG9pbnRlcnxjZW50ZXIpJC8udGVzdChlMy5vdmVybGFwKSA/IHQ0Lm9wdGlvbnMuZHJvcC5vdmVybGFwID0gZTMub3ZlcmxhcCA6IHcubnVtYmVyKGUzLm92ZXJsYXApICYmICh0NC5vcHRpb25zLmRyb3Aub3ZlcmxhcCA9IE1hdGgubWF4KE1hdGgubWluKDEsIGUzLm92ZXJsYXApLCAwKSksIFwiYWNjZXB0XCIgaW4gZTMgJiYgKHQ0Lm9wdGlvbnMuZHJvcC5hY2NlcHQgPSBlMy5hY2NlcHQpLCBcImNoZWNrZXJcIiBpbiBlMyAmJiAodDQub3B0aW9ucy5kcm9wLmNoZWNrZXIgPSBlMy5jaGVja2VyKSwgdDQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAody5ib29sKGUzKSkgcmV0dXJuIHQ0Lm9wdGlvbnMuZHJvcC5lbmFibGVkID0gZTMsIHQ0O1xuICAgICAgICAgICAgcmV0dXJuIHQ0Lm9wdGlvbnMuZHJvcDtcbiAgICAgICAgICB9KHRoaXMsIHQzKTtcbiAgICAgICAgfSwgcjIucHJvdG90eXBlLmRyb3BDaGVjayA9IGZ1bmN0aW9uKHQzLCBlMywgbjMsIHIzLCBpMywgbzIpIHtcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24odDQsIGU0LCBuNCwgcjQsIGk0LCBvMywgYTIpIHtcbiAgICAgICAgICAgIHZhciBzMiA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCEoYTIgPSBhMiB8fCB0NC5nZXRSZWN0KG8zKSkpIHJldHVybiAhIXQ0Lm9wdGlvbnMuZHJvcC5jaGVja2VyICYmIHQ0Lm9wdGlvbnMuZHJvcC5jaGVja2VyKGU0LCBuNCwgczIsIHQ0LCBvMywgcjQsIGk0KTtcbiAgICAgICAgICAgIHZhciBjMiA9IHQ0Lm9wdGlvbnMuZHJvcC5vdmVybGFwO1xuICAgICAgICAgICAgaWYgKFwicG9pbnRlclwiID09PSBjMikge1xuICAgICAgICAgICAgICB2YXIgbDIgPSBLKHI0LCBpNCwgXCJkcmFnXCIpLCB1MiA9IG90KGU0KTtcbiAgICAgICAgICAgICAgdTIueCArPSBsMi54LCB1Mi55ICs9IGwyLnk7XG4gICAgICAgICAgICAgIHZhciBwMiA9IHUyLnggPiBhMi5sZWZ0ICYmIHUyLnggPCBhMi5yaWdodCwgZjIgPSB1Mi55ID4gYTIudG9wICYmIHUyLnkgPCBhMi5ib3R0b207XG4gICAgICAgICAgICAgIHMyID0gcDIgJiYgZjI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZDIgPSByNC5nZXRSZWN0KGk0KTtcbiAgICAgICAgICAgIGlmIChkMiAmJiBcImNlbnRlclwiID09PSBjMikge1xuICAgICAgICAgICAgICB2YXIgaDIgPSBkMi5sZWZ0ICsgZDIud2lkdGggLyAyLCB2MiA9IGQyLnRvcCArIGQyLmhlaWdodCAvIDI7XG4gICAgICAgICAgICAgIHMyID0gaDIgPj0gYTIubGVmdCAmJiBoMiA8PSBhMi5yaWdodCAmJiB2MiA+PSBhMi50b3AgJiYgdjIgPD0gYTIuYm90dG9tO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGQyICYmIHcubnVtYmVyKGMyKSkge1xuICAgICAgICAgICAgICBzMiA9IE1hdGgubWF4KDAsIE1hdGgubWluKGEyLnJpZ2h0LCBkMi5yaWdodCkgLSBNYXRoLm1heChhMi5sZWZ0LCBkMi5sZWZ0KSkgKiBNYXRoLm1heCgwLCBNYXRoLm1pbihhMi5ib3R0b20sIGQyLmJvdHRvbSkgLSBNYXRoLm1heChhMi50b3AsIGQyLnRvcCkpIC8gKGQyLndpZHRoICogZDIuaGVpZ2h0KSA+PSBjMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHQ0Lm9wdGlvbnMuZHJvcC5jaGVja2VyICYmIChzMiA9IHQ0Lm9wdGlvbnMuZHJvcC5jaGVja2VyKGU0LCBuNCwgczIsIHQ0LCBvMywgcjQsIGk0KSk7XG4gICAgICAgICAgICByZXR1cm4gczI7XG4gICAgICAgICAgfSh0aGlzLCB0MywgZTMsIG4zLCByMywgaTMsIG8yKTtcbiAgICAgICAgfSwgbjIuZHluYW1pY0Ryb3AgPSBmdW5jdGlvbihlMykge1xuICAgICAgICAgIHJldHVybiB3LmJvb2woZTMpID8gKHQyLmR5bmFtaWNEcm9wID0gZTMsIG4yKSA6IHQyLmR5bmFtaWNEcm9wO1xuICAgICAgICB9LCBWKGUyLnBoYXNlbGVzc1R5cGVzLCB7IGRyYWdlbnRlcjogdHJ1ZSwgZHJhZ2xlYXZlOiB0cnVlLCBkcm9wYWN0aXZhdGU6IHRydWUsIGRyb3BkZWFjdGl2YXRlOiB0cnVlLCBkcm9wbW92ZTogdHJ1ZSwgZHJvcDogdHJ1ZSB9KSwgZTIubWV0aG9kRGljdC5kcm9wID0gXCJkcm9wem9uZVwiLCB0Mi5keW5hbWljRHJvcCA9IGZhbHNlLCBpMi5hY3Rpb25zLmRyb3AgPSBPdC5kZWZhdWx0cztcbiAgICAgIH0sIGxpc3RlbmVyczogeyBcImludGVyYWN0aW9uczpiZWZvcmUtYWN0aW9uLXN0YXJ0XCI6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHZhciBlMiA9IHQyLmludGVyYWN0aW9uO1xuICAgICAgICBcImRyYWdcIiA9PT0gZTIucHJlcGFyZWQubmFtZSAmJiAoZTIuZHJvcFN0YXRlID0geyBjdXI6IHsgZHJvcHpvbmU6IG51bGwsIGVsZW1lbnQ6IG51bGwgfSwgcHJldjogeyBkcm9wem9uZTogbnVsbCwgZWxlbWVudDogbnVsbCB9LCByZWplY3RlZDogbnVsbCwgZXZlbnRzOiBudWxsLCBhY3RpdmVEcm9wczogW10gfSk7XG4gICAgICB9LCBcImludGVyYWN0aW9uczphZnRlci1hY3Rpb24tc3RhcnRcIjogZnVuY3Rpb24odDIsIGUyKSB7XG4gICAgICAgIHZhciBuMiA9IHQyLmludGVyYWN0aW9uLCByMiA9ICh0Mi5ldmVudCwgdDIuaUV2ZW50KTtcbiAgICAgICAgaWYgKFwiZHJhZ1wiID09PSBuMi5wcmVwYXJlZC5uYW1lKSB7XG4gICAgICAgICAgdmFyIGkyID0gbjIuZHJvcFN0YXRlO1xuICAgICAgICAgIGkyLmFjdGl2ZURyb3BzID0gW10sIGkyLmV2ZW50cyA9IHt9LCBpMi5hY3RpdmVEcm9wcyA9IEV0KGUyLCBuMi5lbGVtZW50KSwgaTIuZXZlbnRzID0gU3QobjIsIDAsIHIyKSwgaTIuZXZlbnRzLmFjdGl2YXRlICYmICh3dChpMi5hY3RpdmVEcm9wcywgaTIuZXZlbnRzLmFjdGl2YXRlKSwgZTIuZmlyZShcImFjdGlvbnMvZHJvcDpzdGFydFwiLCB7IGludGVyYWN0aW9uOiBuMiwgZHJhZ0V2ZW50OiByMiB9KSk7XG4gICAgICAgIH1cbiAgICAgIH0sIFwiaW50ZXJhY3Rpb25zOmFjdGlvbi1tb3ZlXCI6IFB0LCBcImludGVyYWN0aW9uczphZnRlci1hY3Rpb24tbW92ZVwiOiBmdW5jdGlvbih0MiwgZTIpIHtcbiAgICAgICAgdmFyIG4yID0gdDIuaW50ZXJhY3Rpb24sIHIyID0gdDIuaUV2ZW50O1xuICAgICAgICBpZiAoXCJkcmFnXCIgPT09IG4yLnByZXBhcmVkLm5hbWUpIHtcbiAgICAgICAgICB2YXIgaTIgPSBuMi5kcm9wU3RhdGU7XG4gICAgICAgICAgX3QobjIsIGkyLmV2ZW50cyksIGUyLmZpcmUoXCJhY3Rpb25zL2Ryb3A6bW92ZVwiLCB7IGludGVyYWN0aW9uOiBuMiwgZHJhZ0V2ZW50OiByMiB9KSwgaTIuZXZlbnRzID0ge307XG4gICAgICAgIH1cbiAgICAgIH0sIFwiaW50ZXJhY3Rpb25zOmFjdGlvbi1lbmRcIjogZnVuY3Rpb24odDIsIGUyKSB7XG4gICAgICAgIGlmIChcImRyYWdcIiA9PT0gdDIuaW50ZXJhY3Rpb24ucHJlcGFyZWQubmFtZSkge1xuICAgICAgICAgIHZhciBuMiA9IHQyLmludGVyYWN0aW9uLCByMiA9IHQyLmlFdmVudDtcbiAgICAgICAgICBQdCh0MiwgZTIpLCBfdChuMiwgbjIuZHJvcFN0YXRlLmV2ZW50cyksIGUyLmZpcmUoXCJhY3Rpb25zL2Ryb3A6ZW5kXCIsIHsgaW50ZXJhY3Rpb246IG4yLCBkcmFnRXZlbnQ6IHIyIH0pO1xuICAgICAgICB9XG4gICAgICB9LCBcImludGVyYWN0aW9uczpzdG9wXCI6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHZhciBlMiA9IHQyLmludGVyYWN0aW9uO1xuICAgICAgICBpZiAoXCJkcmFnXCIgPT09IGUyLnByZXBhcmVkLm5hbWUpIHtcbiAgICAgICAgICB2YXIgbjIgPSBlMi5kcm9wU3RhdGU7XG4gICAgICAgICAgbjIgJiYgKG4yLmFjdGl2ZURyb3BzID0gbnVsbCwgbjIuZXZlbnRzID0gbnVsbCwgbjIuY3VyLmRyb3B6b25lID0gbnVsbCwgbjIuY3VyLmVsZW1lbnQgPSBudWxsLCBuMi5wcmV2LmRyb3B6b25lID0gbnVsbCwgbjIucHJldi5lbGVtZW50ID0gbnVsbCwgbjIucmVqZWN0ZWQgPSBmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgIH0gfSwgZ2V0QWN0aXZlRHJvcHM6IEV0LCBnZXREcm9wOiBUdCwgZ2V0RHJvcEV2ZW50czogU3QsIGZpcmVEcm9wRXZlbnRzOiBfdCwgZmlsdGVyRXZlbnRUeXBlOiBmdW5jdGlvbih0Mikge1xuICAgICAgICByZXR1cm4gMCA9PT0gdDIuc2VhcmNoKFwiZHJhZ1wiKSB8fCAwID09PSB0Mi5zZWFyY2goXCJkcm9wXCIpO1xuICAgICAgfSwgZGVmYXVsdHM6IHsgZW5hYmxlZDogZmFsc2UsIGFjY2VwdDogbnVsbCwgb3ZlcmxhcDogXCJwb2ludGVyXCIgfSB9LCBrdCA9IE90O1xuICAgICAgZnVuY3Rpb24gRHQodDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuaW50ZXJhY3Rpb24sIG4yID0gdDIuaUV2ZW50LCByMiA9IHQyLnBoYXNlO1xuICAgICAgICBpZiAoXCJnZXN0dXJlXCIgPT09IGUyLnByZXBhcmVkLm5hbWUpIHtcbiAgICAgICAgICB2YXIgaTIgPSBlMi5wb2ludGVycy5tYXAoZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICAgIHJldHVybiB0My5wb2ludGVyO1xuICAgICAgICAgIH0pLCBvMiA9IFwic3RhcnRcIiA9PT0gcjIsIGEyID0gXCJlbmRcIiA9PT0gcjIsIHMyID0gZTIuaW50ZXJhY3RhYmxlLm9wdGlvbnMuZGVsdGFTb3VyY2U7XG4gICAgICAgICAgaWYgKG4yLnRvdWNoZXMgPSBbaTJbMF0sIGkyWzFdXSwgbzIpIG4yLmRpc3RhbmNlID0gcHQoaTIsIHMyKSwgbjIuYm94ID0gdXQoaTIpLCBuMi5zY2FsZSA9IDEsIG4yLmRzID0gMCwgbjIuYW5nbGUgPSBmdChpMiwgczIpLCBuMi5kYSA9IDAsIGUyLmdlc3R1cmUuc3RhcnREaXN0YW5jZSA9IG4yLmRpc3RhbmNlLCBlMi5nZXN0dXJlLnN0YXJ0QW5nbGUgPSBuMi5hbmdsZTtcbiAgICAgICAgICBlbHNlIGlmIChhMiB8fCBlMi5wb2ludGVycy5sZW5ndGggPCAyKSB7XG4gICAgICAgICAgICB2YXIgYzIgPSBlMi5wcmV2RXZlbnQ7XG4gICAgICAgICAgICBuMi5kaXN0YW5jZSA9IGMyLmRpc3RhbmNlLCBuMi5ib3ggPSBjMi5ib3gsIG4yLnNjYWxlID0gYzIuc2NhbGUsIG4yLmRzID0gMCwgbjIuYW5nbGUgPSBjMi5hbmdsZSwgbjIuZGEgPSAwO1xuICAgICAgICAgIH0gZWxzZSBuMi5kaXN0YW5jZSA9IHB0KGkyLCBzMiksIG4yLmJveCA9IHV0KGkyKSwgbjIuc2NhbGUgPSBuMi5kaXN0YW5jZSAvIGUyLmdlc3R1cmUuc3RhcnREaXN0YW5jZSwgbjIuYW5nbGUgPSBmdChpMiwgczIpLCBuMi5kcyA9IG4yLnNjYWxlIC0gZTIuZ2VzdHVyZS5zY2FsZSwgbjIuZGEgPSBuMi5hbmdsZSAtIGUyLmdlc3R1cmUuYW5nbGU7XG4gICAgICAgICAgZTIuZ2VzdHVyZS5kaXN0YW5jZSA9IG4yLmRpc3RhbmNlLCBlMi5nZXN0dXJlLmFuZ2xlID0gbjIuYW5nbGUsIHcubnVtYmVyKG4yLnNjYWxlKSAmJiBuMi5zY2FsZSAhPT0gMSAvIDAgJiYgIWlzTmFOKG4yLnNjYWxlKSAmJiAoZTIuZ2VzdHVyZS5zY2FsZSA9IG4yLnNjYWxlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdmFyIEl0ID0geyBpZDogXCJhY3Rpb25zL2dlc3R1cmVcIiwgYmVmb3JlOiBbXCJhY3Rpb25zL2RyYWdcIiwgXCJhY3Rpb25zL3Jlc2l6ZVwiXSwgaW5zdGFsbDogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuYWN0aW9ucywgbjIgPSB0Mi5JbnRlcmFjdGFibGUsIHIyID0gdDIuZGVmYXVsdHM7XG4gICAgICAgIG4yLnByb3RvdHlwZS5nZXN0dXJhYmxlID0gZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICByZXR1cm4gdy5vYmplY3QodDMpID8gKHRoaXMub3B0aW9ucy5nZXN0dXJlLmVuYWJsZWQgPSBmYWxzZSAhPT0gdDMuZW5hYmxlZCwgdGhpcy5zZXRQZXJBY3Rpb24oXCJnZXN0dXJlXCIsIHQzKSwgdGhpcy5zZXRPbkV2ZW50cyhcImdlc3R1cmVcIiwgdDMpLCB0aGlzKSA6IHcuYm9vbCh0MykgPyAodGhpcy5vcHRpb25zLmdlc3R1cmUuZW5hYmxlZCA9IHQzLCB0aGlzKSA6IHRoaXMub3B0aW9ucy5nZXN0dXJlO1xuICAgICAgICB9LCBlMi5tYXAuZ2VzdHVyZSA9IEl0LCBlMi5tZXRob2REaWN0Lmdlc3R1cmUgPSBcImdlc3R1cmFibGVcIiwgcjIuYWN0aW9ucy5nZXN0dXJlID0gSXQuZGVmYXVsdHM7XG4gICAgICB9LCBsaXN0ZW5lcnM6IHsgXCJpbnRlcmFjdGlvbnM6YWN0aW9uLXN0YXJ0XCI6IER0LCBcImludGVyYWN0aW9uczphY3Rpb24tbW92ZVwiOiBEdCwgXCJpbnRlcmFjdGlvbnM6YWN0aW9uLWVuZFwiOiBEdCwgXCJpbnRlcmFjdGlvbnM6bmV3XCI6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHQyLmludGVyYWN0aW9uLmdlc3R1cmUgPSB7IGFuZ2xlOiAwLCBkaXN0YW5jZTogMCwgc2NhbGU6IDEsIHN0YXJ0QW5nbGU6IDAsIHN0YXJ0RGlzdGFuY2U6IDAgfTtcbiAgICAgIH0sIFwiYXV0by1zdGFydDpjaGVja1wiOiBmdW5jdGlvbih0Mikge1xuICAgICAgICBpZiAoISh0Mi5pbnRlcmFjdGlvbi5wb2ludGVycy5sZW5ndGggPCAyKSkge1xuICAgICAgICAgIHZhciBlMiA9IHQyLmludGVyYWN0YWJsZS5vcHRpb25zLmdlc3R1cmU7XG4gICAgICAgICAgaWYgKGUyICYmIGUyLmVuYWJsZWQpIHJldHVybiB0Mi5hY3Rpb24gPSB7IG5hbWU6IFwiZ2VzdHVyZVwiIH0sIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9IH0sIGRlZmF1bHRzOiB7fSwgZ2V0Q3Vyc29yOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICB9LCBmaWx0ZXJFdmVudFR5cGU6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHJldHVybiAwID09PSB0Mi5zZWFyY2goXCJnZXN0dXJlXCIpO1xuICAgICAgfSB9LCBNdCA9IEl0O1xuICAgICAgZnVuY3Rpb24genQodDIsIGUyLCBuMiwgcjIsIGkyLCBvMiwgYTIpIHtcbiAgICAgICAgaWYgKCFlMikgcmV0dXJuIGZhbHNlO1xuICAgICAgICBpZiAodHJ1ZSA9PT0gZTIpIHtcbiAgICAgICAgICB2YXIgczIgPSB3Lm51bWJlcihvMi53aWR0aCkgPyBvMi53aWR0aCA6IG8yLnJpZ2h0IC0gbzIubGVmdCwgYzIgPSB3Lm51bWJlcihvMi5oZWlnaHQpID8gbzIuaGVpZ2h0IDogbzIuYm90dG9tIC0gbzIudG9wO1xuICAgICAgICAgIGlmIChhMiA9IE1hdGgubWluKGEyLCBNYXRoLmFicygoXCJsZWZ0XCIgPT09IHQyIHx8IFwicmlnaHRcIiA9PT0gdDIgPyBzMiA6IGMyKSAvIDIpKSwgczIgPCAwICYmIChcImxlZnRcIiA9PT0gdDIgPyB0MiA9IFwicmlnaHRcIiA6IFwicmlnaHRcIiA9PT0gdDIgJiYgKHQyID0gXCJsZWZ0XCIpKSwgYzIgPCAwICYmIChcInRvcFwiID09PSB0MiA/IHQyID0gXCJib3R0b21cIiA6IFwiYm90dG9tXCIgPT09IHQyICYmICh0MiA9IFwidG9wXCIpKSwgXCJsZWZ0XCIgPT09IHQyKSB7XG4gICAgICAgICAgICB2YXIgbDIgPSBzMiA+PSAwID8gbzIubGVmdCA6IG8yLnJpZ2h0O1xuICAgICAgICAgICAgcmV0dXJuIG4yLnggPCBsMiArIGEyO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoXCJ0b3BcIiA9PT0gdDIpIHtcbiAgICAgICAgICAgIHZhciB1MiA9IGMyID49IDAgPyBvMi50b3AgOiBvMi5ib3R0b207XG4gICAgICAgICAgICByZXR1cm4gbjIueSA8IHUyICsgYTI7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChcInJpZ2h0XCIgPT09IHQyKSByZXR1cm4gbjIueCA+IChzMiA+PSAwID8gbzIucmlnaHQgOiBvMi5sZWZ0KSAtIGEyO1xuICAgICAgICAgIGlmIChcImJvdHRvbVwiID09PSB0MikgcmV0dXJuIG4yLnkgPiAoYzIgPj0gMCA/IG8yLmJvdHRvbSA6IG8yLnRvcCkgLSBhMjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gISF3LmVsZW1lbnQocjIpICYmICh3LmVsZW1lbnQoZTIpID8gZTIgPT09IHIyIDogRihyMiwgZTIsIGkyKSk7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBBdCh0Mikge1xuICAgICAgICB2YXIgZTIgPSB0Mi5pRXZlbnQsIG4yID0gdDIuaW50ZXJhY3Rpb247XG4gICAgICAgIGlmIChcInJlc2l6ZVwiID09PSBuMi5wcmVwYXJlZC5uYW1lICYmIG4yLnJlc2l6ZUF4ZXMpIHtcbiAgICAgICAgICB2YXIgcjIgPSBlMjtcbiAgICAgICAgICBuMi5pbnRlcmFjdGFibGUub3B0aW9ucy5yZXNpemUuc3F1YXJlID8gKFwieVwiID09PSBuMi5yZXNpemVBeGVzID8gcjIuZGVsdGEueCA9IHIyLmRlbHRhLnkgOiByMi5kZWx0YS55ID0gcjIuZGVsdGEueCwgcjIuYXhlcyA9IFwieHlcIikgOiAocjIuYXhlcyA9IG4yLnJlc2l6ZUF4ZXMsIFwieFwiID09PSBuMi5yZXNpemVBeGVzID8gcjIuZGVsdGEueSA9IDAgOiBcInlcIiA9PT0gbjIucmVzaXplQXhlcyAmJiAocjIuZGVsdGEueCA9IDApKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdmFyIFJ0LCBDdCwganQgPSB7IGlkOiBcImFjdGlvbnMvcmVzaXplXCIsIGJlZm9yZTogW1wiYWN0aW9ucy9kcmFnXCJdLCBpbnN0YWxsOiBmdW5jdGlvbih0Mikge1xuICAgICAgICB2YXIgZTIgPSB0Mi5hY3Rpb25zLCBuMiA9IHQyLmJyb3dzZXIsIHIyID0gdDIuSW50ZXJhY3RhYmxlLCBpMiA9IHQyLmRlZmF1bHRzO1xuICAgICAgICBqdC5jdXJzb3JzID0gZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICByZXR1cm4gdDMuaXNJZTkgPyB7IHg6IFwiZS1yZXNpemVcIiwgeTogXCJzLXJlc2l6ZVwiLCB4eTogXCJzZS1yZXNpemVcIiwgdG9wOiBcIm4tcmVzaXplXCIsIGxlZnQ6IFwidy1yZXNpemVcIiwgYm90dG9tOiBcInMtcmVzaXplXCIsIHJpZ2h0OiBcImUtcmVzaXplXCIsIHRvcGxlZnQ6IFwic2UtcmVzaXplXCIsIGJvdHRvbXJpZ2h0OiBcInNlLXJlc2l6ZVwiLCB0b3ByaWdodDogXCJuZS1yZXNpemVcIiwgYm90dG9tbGVmdDogXCJuZS1yZXNpemVcIiB9IDogeyB4OiBcImV3LXJlc2l6ZVwiLCB5OiBcIm5zLXJlc2l6ZVwiLCB4eTogXCJud3NlLXJlc2l6ZVwiLCB0b3A6IFwibnMtcmVzaXplXCIsIGxlZnQ6IFwiZXctcmVzaXplXCIsIGJvdHRvbTogXCJucy1yZXNpemVcIiwgcmlnaHQ6IFwiZXctcmVzaXplXCIsIHRvcGxlZnQ6IFwibndzZS1yZXNpemVcIiwgYm90dG9tcmlnaHQ6IFwibndzZS1yZXNpemVcIiwgdG9wcmlnaHQ6IFwibmVzdy1yZXNpemVcIiwgYm90dG9tbGVmdDogXCJuZXN3LXJlc2l6ZVwiIH07XG4gICAgICAgIH0objIpLCBqdC5kZWZhdWx0TWFyZ2luID0gbjIuc3VwcG9ydHNUb3VjaCB8fCBuMi5zdXBwb3J0c1BvaW50ZXJFdmVudCA/IDIwIDogMTAsIHIyLnByb3RvdHlwZS5yZXNpemFibGUgPSBmdW5jdGlvbihlMykge1xuICAgICAgICAgIHJldHVybiBmdW5jdGlvbih0MywgZTQsIG4zKSB7XG4gICAgICAgICAgICBpZiAody5vYmplY3QoZTQpKSByZXR1cm4gdDMub3B0aW9ucy5yZXNpemUuZW5hYmxlZCA9IGZhbHNlICE9PSBlNC5lbmFibGVkLCB0My5zZXRQZXJBY3Rpb24oXCJyZXNpemVcIiwgZTQpLCB0My5zZXRPbkV2ZW50cyhcInJlc2l6ZVwiLCBlNCksIHcuc3RyaW5nKGU0LmF4aXMpICYmIC9eeCR8XnkkfF54eSQvLnRlc3QoZTQuYXhpcykgPyB0My5vcHRpb25zLnJlc2l6ZS5heGlzID0gZTQuYXhpcyA6IG51bGwgPT09IGU0LmF4aXMgJiYgKHQzLm9wdGlvbnMucmVzaXplLmF4aXMgPSBuMy5kZWZhdWx0cy5hY3Rpb25zLnJlc2l6ZS5heGlzKSwgdy5ib29sKGU0LnByZXNlcnZlQXNwZWN0UmF0aW8pID8gdDMub3B0aW9ucy5yZXNpemUucHJlc2VydmVBc3BlY3RSYXRpbyA9IGU0LnByZXNlcnZlQXNwZWN0UmF0aW8gOiB3LmJvb2woZTQuc3F1YXJlKSAmJiAodDMub3B0aW9ucy5yZXNpemUuc3F1YXJlID0gZTQuc3F1YXJlKSwgdDM7XG4gICAgICAgICAgICBpZiAody5ib29sKGU0KSkgcmV0dXJuIHQzLm9wdGlvbnMucmVzaXplLmVuYWJsZWQgPSBlNCwgdDM7XG4gICAgICAgICAgICByZXR1cm4gdDMub3B0aW9ucy5yZXNpemU7XG4gICAgICAgICAgfSh0aGlzLCBlMywgdDIpO1xuICAgICAgICB9LCBlMi5tYXAucmVzaXplID0ganQsIGUyLm1ldGhvZERpY3QucmVzaXplID0gXCJyZXNpemFibGVcIiwgaTIuYWN0aW9ucy5yZXNpemUgPSBqdC5kZWZhdWx0cztcbiAgICAgIH0sIGxpc3RlbmVyczogeyBcImludGVyYWN0aW9uczpuZXdcIjogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdDIuaW50ZXJhY3Rpb24ucmVzaXplQXhlcyA9IFwieHlcIjtcbiAgICAgIH0sIFwiaW50ZXJhY3Rpb25zOmFjdGlvbi1zdGFydFwiOiBmdW5jdGlvbih0Mikge1xuICAgICAgICAhZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICB2YXIgZTIgPSB0My5pRXZlbnQsIG4yID0gdDMuaW50ZXJhY3Rpb247XG4gICAgICAgICAgaWYgKFwicmVzaXplXCIgPT09IG4yLnByZXBhcmVkLm5hbWUgJiYgbjIucHJlcGFyZWQuZWRnZXMpIHtcbiAgICAgICAgICAgIHZhciByMiA9IGUyLCBpMiA9IG4yLnJlY3Q7XG4gICAgICAgICAgICBuMi5fcmVjdHMgPSB7IHN0YXJ0OiBWKHt9LCBpMiksIGNvcnJlY3RlZDogVih7fSwgaTIpLCBwcmV2aW91czogVih7fSwgaTIpLCBkZWx0YTogeyBsZWZ0OiAwLCByaWdodDogMCwgd2lkdGg6IDAsIHRvcDogMCwgYm90dG9tOiAwLCBoZWlnaHQ6IDAgfSB9LCByMi5lZGdlcyA9IG4yLnByZXBhcmVkLmVkZ2VzLCByMi5yZWN0ID0gbjIuX3JlY3RzLmNvcnJlY3RlZCwgcjIuZGVsdGFSZWN0ID0gbjIuX3JlY3RzLmRlbHRhO1xuICAgICAgICAgIH1cbiAgICAgICAgfSh0MiksIEF0KHQyKTtcbiAgICAgIH0sIFwiaW50ZXJhY3Rpb25zOmFjdGlvbi1tb3ZlXCI6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgICFmdW5jdGlvbih0Mykge1xuICAgICAgICAgIHZhciBlMiA9IHQzLmlFdmVudCwgbjIgPSB0My5pbnRlcmFjdGlvbjtcbiAgICAgICAgICBpZiAoXCJyZXNpemVcIiA9PT0gbjIucHJlcGFyZWQubmFtZSAmJiBuMi5wcmVwYXJlZC5lZGdlcykge1xuICAgICAgICAgICAgdmFyIHIyID0gZTIsIGkyID0gbjIuaW50ZXJhY3RhYmxlLm9wdGlvbnMucmVzaXplLmludmVydCwgbzIgPSBcInJlcG9zaXRpb25cIiA9PT0gaTIgfHwgXCJuZWdhdGVcIiA9PT0gaTIsIGEyID0gbjIucmVjdCwgczIgPSBuMi5fcmVjdHMsIGMyID0gczIuc3RhcnQsIGwyID0gczIuY29ycmVjdGVkLCB1MiA9IHMyLmRlbHRhLCBwMiA9IHMyLnByZXZpb3VzO1xuICAgICAgICAgICAgaWYgKFYocDIsIGwyKSwgbzIpIHtcbiAgICAgICAgICAgICAgaWYgKFYobDIsIGEyKSwgXCJyZXBvc2l0aW9uXCIgPT09IGkyKSB7XG4gICAgICAgICAgICAgICAgaWYgKGwyLnRvcCA+IGwyLmJvdHRvbSkge1xuICAgICAgICAgICAgICAgICAgdmFyIGYyID0gbDIudG9wO1xuICAgICAgICAgICAgICAgICAgbDIudG9wID0gbDIuYm90dG9tLCBsMi5ib3R0b20gPSBmMjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGwyLmxlZnQgPiBsMi5yaWdodCkge1xuICAgICAgICAgICAgICAgICAgdmFyIGQyID0gbDIubGVmdDtcbiAgICAgICAgICAgICAgICAgIGwyLmxlZnQgPSBsMi5yaWdodCwgbDIucmlnaHQgPSBkMjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBsMi50b3AgPSBNYXRoLm1pbihhMi50b3AsIGMyLmJvdHRvbSksIGwyLmJvdHRvbSA9IE1hdGgubWF4KGEyLmJvdHRvbSwgYzIudG9wKSwgbDIubGVmdCA9IE1hdGgubWluKGEyLmxlZnQsIGMyLnJpZ2h0KSwgbDIucmlnaHQgPSBNYXRoLm1heChhMi5yaWdodCwgYzIubGVmdCk7XG4gICAgICAgICAgICBmb3IgKHZhciBoMiBpbiBsMi53aWR0aCA9IGwyLnJpZ2h0IC0gbDIubGVmdCwgbDIuaGVpZ2h0ID0gbDIuYm90dG9tIC0gbDIudG9wLCBsMikgdTJbaDJdID0gbDJbaDJdIC0gcDJbaDJdO1xuICAgICAgICAgICAgcjIuZWRnZXMgPSBuMi5wcmVwYXJlZC5lZGdlcywgcjIucmVjdCA9IGwyLCByMi5kZWx0YVJlY3QgPSB1MjtcbiAgICAgICAgICB9XG4gICAgICAgIH0odDIpLCBBdCh0Mik7XG4gICAgICB9LCBcImludGVyYWN0aW9uczphY3Rpb24tZW5kXCI6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHZhciBlMiA9IHQyLmlFdmVudCwgbjIgPSB0Mi5pbnRlcmFjdGlvbjtcbiAgICAgICAgaWYgKFwicmVzaXplXCIgPT09IG4yLnByZXBhcmVkLm5hbWUgJiYgbjIucHJlcGFyZWQuZWRnZXMpIHtcbiAgICAgICAgICB2YXIgcjIgPSBlMjtcbiAgICAgICAgICByMi5lZGdlcyA9IG4yLnByZXBhcmVkLmVkZ2VzLCByMi5yZWN0ID0gbjIuX3JlY3RzLmNvcnJlY3RlZCwgcjIuZGVsdGFSZWN0ID0gbjIuX3JlY3RzLmRlbHRhO1xuICAgICAgICB9XG4gICAgICB9LCBcImF1dG8tc3RhcnQ6Y2hlY2tcIjogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuaW50ZXJhY3Rpb24sIG4yID0gdDIuaW50ZXJhY3RhYmxlLCByMiA9IHQyLmVsZW1lbnQsIGkyID0gdDIucmVjdCwgbzIgPSB0Mi5idXR0b25zO1xuICAgICAgICBpZiAoaTIpIHtcbiAgICAgICAgICB2YXIgYTIgPSBWKHt9LCBlMi5jb29yZHMuY3VyLnBhZ2UpLCBzMiA9IG4yLm9wdGlvbnMucmVzaXplO1xuICAgICAgICAgIGlmIChzMiAmJiBzMi5lbmFibGVkICYmICghZTIucG9pbnRlcklzRG93biB8fCAhL21vdXNlfHBvaW50ZXIvLnRlc3QoZTIucG9pbnRlclR5cGUpIHx8IDAgIT0gKG8yICYgczIubW91c2VCdXR0b25zKSkpIHtcbiAgICAgICAgICAgIGlmICh3Lm9iamVjdChzMi5lZGdlcykpIHtcbiAgICAgICAgICAgICAgdmFyIGMyID0geyBsZWZ0OiBmYWxzZSwgcmlnaHQ6IGZhbHNlLCB0b3A6IGZhbHNlLCBib3R0b206IGZhbHNlIH07XG4gICAgICAgICAgICAgIGZvciAodmFyIGwyIGluIGMyKSBjMltsMl0gPSB6dChsMiwgczIuZWRnZXNbbDJdLCBhMiwgZTIuX2xhdGVzdFBvaW50ZXIuZXZlbnRUYXJnZXQsIHIyLCBpMiwgczIubWFyZ2luIHx8IGp0LmRlZmF1bHRNYXJnaW4pO1xuICAgICAgICAgICAgICBjMi5sZWZ0ID0gYzIubGVmdCAmJiAhYzIucmlnaHQsIGMyLnRvcCA9IGMyLnRvcCAmJiAhYzIuYm90dG9tLCAoYzIubGVmdCB8fCBjMi5yaWdodCB8fCBjMi50b3AgfHwgYzIuYm90dG9tKSAmJiAodDIuYWN0aW9uID0geyBuYW1lOiBcInJlc2l6ZVwiLCBlZGdlczogYzIgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB2YXIgdTIgPSBcInlcIiAhPT0gczIuYXhpcyAmJiBhMi54ID4gaTIucmlnaHQgLSBqdC5kZWZhdWx0TWFyZ2luLCBwMiA9IFwieFwiICE9PSBzMi5heGlzICYmIGEyLnkgPiBpMi5ib3R0b20gLSBqdC5kZWZhdWx0TWFyZ2luO1xuICAgICAgICAgICAgICAodTIgfHwgcDIpICYmICh0Mi5hY3Rpb24gPSB7IG5hbWU6IFwicmVzaXplXCIsIGF4ZXM6ICh1MiA/IFwieFwiIDogXCJcIikgKyAocDIgPyBcInlcIiA6IFwiXCIpIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICF0Mi5hY3Rpb24gJiYgdm9pZCAwO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSB9LCBkZWZhdWx0czogeyBzcXVhcmU6IGZhbHNlLCBwcmVzZXJ2ZUFzcGVjdFJhdGlvOiBmYWxzZSwgYXhpczogXCJ4eVwiLCBtYXJnaW46IE5hTiwgZWRnZXM6IG51bGwsIGludmVydDogXCJub25lXCIgfSwgY3Vyc29yczogbnVsbCwgZ2V0Q3Vyc29yOiBmdW5jdGlvbih0Mikge1xuICAgICAgICB2YXIgZTIgPSB0Mi5lZGdlcywgbjIgPSB0Mi5heGlzLCByMiA9IHQyLm5hbWUsIGkyID0ganQuY3Vyc29ycywgbzIgPSBudWxsO1xuICAgICAgICBpZiAobjIpIG8yID0gaTJbcjIgKyBuMl07XG4gICAgICAgIGVsc2UgaWYgKGUyKSB7XG4gICAgICAgICAgZm9yICh2YXIgYTIgPSBcIlwiLCBzMiA9IDAsIGMyID0gW1widG9wXCIsIFwiYm90dG9tXCIsIFwibGVmdFwiLCBcInJpZ2h0XCJdOyBzMiA8IGMyLmxlbmd0aDsgczIrKykge1xuICAgICAgICAgICAgdmFyIGwyID0gYzJbczJdO1xuICAgICAgICAgICAgZTJbbDJdICYmIChhMiArPSBsMik7XG4gICAgICAgICAgfVxuICAgICAgICAgIG8yID0gaTJbYTJdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvMjtcbiAgICAgIH0sIGZpbHRlckV2ZW50VHlwZTogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgcmV0dXJuIDAgPT09IHQyLnNlYXJjaChcInJlc2l6ZVwiKTtcbiAgICAgIH0sIGRlZmF1bHRNYXJnaW46IG51bGwgfSwgRnQgPSBqdCwgWHQgPSB7IGlkOiBcImFjdGlvbnNcIiwgaW5zdGFsbDogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdDIudXNlUGx1Z2luKE10KSwgdDIudXNlUGx1Z2luKEZ0KSwgdDIudXNlUGx1Z2luKF8pLCB0Mi51c2VQbHVnaW4oa3QpO1xuICAgICAgfSB9LCBZdCA9IDA7XG4gICAgICB2YXIgTHQgPSB7IHJlcXVlc3Q6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHJldHVybiBSdCh0Mik7XG4gICAgICB9LCBjYW5jZWw6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHJldHVybiBDdCh0Mik7XG4gICAgICB9LCBpbml0OiBmdW5jdGlvbih0Mikge1xuICAgICAgICBpZiAoUnQgPSB0Mi5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUsIEN0ID0gdDIuY2FuY2VsQW5pbWF0aW9uRnJhbWUsICFSdCkgZm9yICh2YXIgZTIgPSBbXCJtc1wiLCBcIm1velwiLCBcIndlYmtpdFwiLCBcIm9cIl0sIG4yID0gMDsgbjIgPCBlMi5sZW5ndGg7IG4yKyspIHtcbiAgICAgICAgICB2YXIgcjIgPSBlMltuMl07XG4gICAgICAgICAgUnQgPSB0MltcIlwiLmNvbmNhdChyMiwgXCJSZXF1ZXN0QW5pbWF0aW9uRnJhbWVcIildLCBDdCA9IHQyW1wiXCIuY29uY2F0KHIyLCBcIkNhbmNlbEFuaW1hdGlvbkZyYW1lXCIpXSB8fCB0MltcIlwiLmNvbmNhdChyMiwgXCJDYW5jZWxSZXF1ZXN0QW5pbWF0aW9uRnJhbWVcIildO1xuICAgICAgICB9XG4gICAgICAgIFJ0ID0gUnQgJiYgUnQuYmluZCh0MiksIEN0ID0gQ3QgJiYgQ3QuYmluZCh0MiksIFJ0IHx8IChSdCA9IGZ1bmN0aW9uKGUzKSB7XG4gICAgICAgICAgdmFyIG4zID0gRGF0ZS5ub3coKSwgcjMgPSBNYXRoLm1heCgwLCAxNiAtIChuMyAtIFl0KSksIGkyID0gdDIuc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGUzKG4zICsgcjMpO1xuICAgICAgICAgIH0sIHIzKTtcbiAgICAgICAgICByZXR1cm4gWXQgPSBuMyArIHIzLCBpMjtcbiAgICAgICAgfSwgQ3QgPSBmdW5jdGlvbih0Mykge1xuICAgICAgICAgIHJldHVybiBjbGVhclRpbWVvdXQodDMpO1xuICAgICAgICB9KTtcbiAgICAgIH0gfTtcbiAgICAgIHZhciBxdCA9IHsgZGVmYXVsdHM6IHsgZW5hYmxlZDogZmFsc2UsIG1hcmdpbjogNjAsIGNvbnRhaW5lcjogbnVsbCwgc3BlZWQ6IDMwMCB9LCBub3c6IERhdGUubm93LCBpbnRlcmFjdGlvbjogbnVsbCwgaTogMCwgeDogMCwgeTogMCwgaXNTY3JvbGxpbmc6IGZhbHNlLCBwcmV2VGltZTogMCwgbWFyZ2luOiAwLCBzcGVlZDogMCwgc3RhcnQ6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHF0LmlzU2Nyb2xsaW5nID0gdHJ1ZSwgTHQuY2FuY2VsKHF0LmkpLCB0Mi5hdXRvU2Nyb2xsID0gcXQsIHF0LmludGVyYWN0aW9uID0gdDIsIHF0LnByZXZUaW1lID0gcXQubm93KCksIHF0LmkgPSBMdC5yZXF1ZXN0KHF0LnNjcm9sbCk7XG4gICAgICB9LCBzdG9wOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcXQuaXNTY3JvbGxpbmcgPSBmYWxzZSwgcXQuaW50ZXJhY3Rpb24gJiYgKHF0LmludGVyYWN0aW9uLmF1dG9TY3JvbGwgPSBudWxsKSwgTHQuY2FuY2VsKHF0LmkpO1xuICAgICAgfSwgc2Nyb2xsOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHQyID0gcXQuaW50ZXJhY3Rpb24sIGUyID0gdDIuaW50ZXJhY3RhYmxlLCBuMiA9IHQyLmVsZW1lbnQsIHIyID0gdDIucHJlcGFyZWQubmFtZSwgaTIgPSBlMi5vcHRpb25zW3IyXS5hdXRvU2Nyb2xsLCBvMiA9IEJ0KGkyLmNvbnRhaW5lciwgZTIsIG4yKSwgYTIgPSBxdC5ub3coKSwgczIgPSAoYTIgLSBxdC5wcmV2VGltZSkgLyAxZTMsIGMyID0gaTIuc3BlZWQgKiBzMjtcbiAgICAgICAgaWYgKGMyID49IDEpIHtcbiAgICAgICAgICB2YXIgbDIgPSB7IHg6IHF0LnggKiBjMiwgeTogcXQueSAqIGMyIH07XG4gICAgICAgICAgaWYgKGwyLnggfHwgbDIueSkge1xuICAgICAgICAgICAgdmFyIHUyID0gVnQobzIpO1xuICAgICAgICAgICAgdy53aW5kb3cobzIpID8gbzIuc2Nyb2xsQnkobDIueCwgbDIueSkgOiBvMiAmJiAobzIuc2Nyb2xsTGVmdCArPSBsMi54LCBvMi5zY3JvbGxUb3AgKz0gbDIueSk7XG4gICAgICAgICAgICB2YXIgcDIgPSBWdChvMiksIGYyID0geyB4OiBwMi54IC0gdTIueCwgeTogcDIueSAtIHUyLnkgfTtcbiAgICAgICAgICAgIChmMi54IHx8IGYyLnkpICYmIGUyLmZpcmUoeyB0eXBlOiBcImF1dG9zY3JvbGxcIiwgdGFyZ2V0OiBuMiwgaW50ZXJhY3RhYmxlOiBlMiwgZGVsdGE6IGYyLCBpbnRlcmFjdGlvbjogdDIsIGNvbnRhaW5lcjogbzIgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHF0LnByZXZUaW1lID0gYTI7XG4gICAgICAgIH1cbiAgICAgICAgcXQuaXNTY3JvbGxpbmcgJiYgKEx0LmNhbmNlbChxdC5pKSwgcXQuaSA9IEx0LnJlcXVlc3QocXQuc2Nyb2xsKSk7XG4gICAgICB9LCBjaGVjazogZnVuY3Rpb24odDIsIGUyKSB7XG4gICAgICAgIHZhciBuMjtcbiAgICAgICAgcmV0dXJuIG51bGwgPT0gKG4yID0gdDIub3B0aW9uc1tlMl0uYXV0b1Njcm9sbCkgPyB2b2lkIDAgOiBuMi5lbmFibGVkO1xuICAgICAgfSwgb25JbnRlcmFjdGlvbk1vdmU6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHZhciBlMiA9IHQyLmludGVyYWN0aW9uLCBuMiA9IHQyLnBvaW50ZXI7XG4gICAgICAgIGlmIChlMi5pbnRlcmFjdGluZygpICYmIHF0LmNoZWNrKGUyLmludGVyYWN0YWJsZSwgZTIucHJlcGFyZWQubmFtZSkpIGlmIChlMi5zaW11bGF0aW9uKSBxdC54ID0gcXQueSA9IDA7XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHZhciByMiwgaTIsIG8yLCBhMiwgczIgPSBlMi5pbnRlcmFjdGFibGUsIGMyID0gZTIuZWxlbWVudCwgbDIgPSBlMi5wcmVwYXJlZC5uYW1lLCB1MiA9IHMyLm9wdGlvbnNbbDJdLmF1dG9TY3JvbGwsIHAyID0gQnQodTIuY29udGFpbmVyLCBzMiwgYzIpO1xuICAgICAgICAgIGlmICh3LndpbmRvdyhwMikpIGEyID0gbjIuY2xpZW50WCA8IHF0Lm1hcmdpbiwgcjIgPSBuMi5jbGllbnRZIDwgcXQubWFyZ2luLCBpMiA9IG4yLmNsaWVudFggPiBwMi5pbm5lcldpZHRoIC0gcXQubWFyZ2luLCBvMiA9IG4yLmNsaWVudFkgPiBwMi5pbm5lckhlaWdodCAtIHF0Lm1hcmdpbjtcbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBmMiA9IFkocDIpO1xuICAgICAgICAgICAgYTIgPSBuMi5jbGllbnRYIDwgZjIubGVmdCArIHF0Lm1hcmdpbiwgcjIgPSBuMi5jbGllbnRZIDwgZjIudG9wICsgcXQubWFyZ2luLCBpMiA9IG4yLmNsaWVudFggPiBmMi5yaWdodCAtIHF0Lm1hcmdpbiwgbzIgPSBuMi5jbGllbnRZID4gZjIuYm90dG9tIC0gcXQubWFyZ2luO1xuICAgICAgICAgIH1cbiAgICAgICAgICBxdC54ID0gaTIgPyAxIDogYTIgPyAtMSA6IDAsIHF0LnkgPSBvMiA/IDEgOiByMiA/IC0xIDogMCwgcXQuaXNTY3JvbGxpbmcgfHwgKHF0Lm1hcmdpbiA9IHUyLm1hcmdpbiwgcXQuc3BlZWQgPSB1Mi5zcGVlZCwgcXQuc3RhcnQoZTIpKTtcbiAgICAgICAgfVxuICAgICAgfSB9O1xuICAgICAgZnVuY3Rpb24gQnQodDIsIGUyLCBuMikge1xuICAgICAgICByZXR1cm4gKHcuc3RyaW5nKHQyKSA/IFcodDIsIGUyLCBuMikgOiB0MikgfHwgeShuMik7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBWdCh0Mikge1xuICAgICAgICByZXR1cm4gdy53aW5kb3codDIpICYmICh0MiA9IHdpbmRvdy5kb2N1bWVudC5ib2R5KSwgeyB4OiB0Mi5zY3JvbGxMZWZ0LCB5OiB0Mi5zY3JvbGxUb3AgfTtcbiAgICAgIH1cbiAgICAgIHZhciBXdCA9IHsgaWQ6IFwiYXV0by1zY3JvbGxcIiwgaW5zdGFsbDogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuZGVmYXVsdHMsIG4yID0gdDIuYWN0aW9ucztcbiAgICAgICAgdDIuYXV0b1Njcm9sbCA9IHF0LCBxdC5ub3cgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdDIubm93KCk7XG4gICAgICAgIH0sIG4yLnBoYXNlbGVzc1R5cGVzLmF1dG9zY3JvbGwgPSB0cnVlLCBlMi5wZXJBY3Rpb24uYXV0b1Njcm9sbCA9IHF0LmRlZmF1bHRzO1xuICAgICAgfSwgbGlzdGVuZXJzOiB7IFwiaW50ZXJhY3Rpb25zOm5ld1wiOiBmdW5jdGlvbih0Mikge1xuICAgICAgICB0Mi5pbnRlcmFjdGlvbi5hdXRvU2Nyb2xsID0gbnVsbDtcbiAgICAgIH0sIFwiaW50ZXJhY3Rpb25zOmRlc3Ryb3lcIjogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdDIuaW50ZXJhY3Rpb24uYXV0b1Njcm9sbCA9IG51bGwsIHF0LnN0b3AoKSwgcXQuaW50ZXJhY3Rpb24gJiYgKHF0LmludGVyYWN0aW9uID0gbnVsbCk7XG4gICAgICB9LCBcImludGVyYWN0aW9uczpzdG9wXCI6IHF0LnN0b3AsIFwiaW50ZXJhY3Rpb25zOmFjdGlvbi1tb3ZlXCI6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHJldHVybiBxdC5vbkludGVyYWN0aW9uTW92ZSh0Mik7XG4gICAgICB9IH0gfSwgR3QgPSBXdDtcbiAgICAgIGZ1bmN0aW9uIE50KHQyLCBlMikge1xuICAgICAgICB2YXIgbjIgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBuMiB8fCAoZy5jb25zb2xlLndhcm4oZTIpLCBuMiA9IHRydWUpLCB0Mi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gVXQodDIsIGUyKSB7XG4gICAgICAgIHJldHVybiB0Mi5uYW1lID0gZTIubmFtZSwgdDIuYXhpcyA9IGUyLmF4aXMsIHQyLmVkZ2VzID0gZTIuZWRnZXMsIHQyO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gSHQodDIpIHtcbiAgICAgICAgcmV0dXJuIHcuYm9vbCh0MikgPyAodGhpcy5vcHRpb25zLnN0eWxlQ3Vyc29yID0gdDIsIHRoaXMpIDogbnVsbCA9PT0gdDIgPyAoZGVsZXRlIHRoaXMub3B0aW9ucy5zdHlsZUN1cnNvciwgdGhpcykgOiB0aGlzLm9wdGlvbnMuc3R5bGVDdXJzb3I7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBLdCh0Mikge1xuICAgICAgICByZXR1cm4gdy5mdW5jKHQyKSA/ICh0aGlzLm9wdGlvbnMuYWN0aW9uQ2hlY2tlciA9IHQyLCB0aGlzKSA6IG51bGwgPT09IHQyID8gKGRlbGV0ZSB0aGlzLm9wdGlvbnMuYWN0aW9uQ2hlY2tlciwgdGhpcykgOiB0aGlzLm9wdGlvbnMuYWN0aW9uQ2hlY2tlcjtcbiAgICAgIH1cbiAgICAgIHZhciAkdCA9IHsgaWQ6IFwiYXV0by1zdGFydC9pbnRlcmFjdGFibGVNZXRob2RzXCIsIGluc3RhbGw6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHZhciBlMiA9IHQyLkludGVyYWN0YWJsZTtcbiAgICAgICAgZTIucHJvdG90eXBlLmdldEFjdGlvbiA9IGZ1bmN0aW9uKGUzLCBuMiwgcjIsIGkyKSB7XG4gICAgICAgICAgdmFyIG8yID0gZnVuY3Rpb24odDMsIGU0LCBuMywgcjMsIGkzKSB7XG4gICAgICAgICAgICB2YXIgbzMgPSB0My5nZXRSZWN0KHIzKSwgYTIgPSBlNC5idXR0b25zIHx8IHsgMDogMSwgMTogNCwgMzogOCwgNDogMTYgfVtlNC5idXR0b25dLCBzMiA9IHsgYWN0aW9uOiBudWxsLCBpbnRlcmFjdGFibGU6IHQzLCBpbnRlcmFjdGlvbjogbjMsIGVsZW1lbnQ6IHIzLCByZWN0OiBvMywgYnV0dG9uczogYTIgfTtcbiAgICAgICAgICAgIHJldHVybiBpMy5maXJlKFwiYXV0by1zdGFydDpjaGVja1wiLCBzMiksIHMyLmFjdGlvbjtcbiAgICAgICAgICB9KHRoaXMsIG4yLCByMiwgaTIsIHQyKTtcbiAgICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zLmFjdGlvbkNoZWNrZXIgPyB0aGlzLm9wdGlvbnMuYWN0aW9uQ2hlY2tlcihlMywgbjIsIG8yLCB0aGlzLCBpMiwgcjIpIDogbzI7XG4gICAgICAgIH0sIGUyLnByb3RvdHlwZS5pZ25vcmVGcm9tID0gTnQoZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fYmFja0NvbXBhdE9wdGlvbihcImlnbm9yZUZyb21cIiwgdDMpO1xuICAgICAgICB9LCBcIkludGVyYWN0YWJsZS5pZ25vcmVGcm9tKCkgaGFzIGJlZW4gZGVwcmVjYXRlZC4gVXNlIEludGVyYWN0YmxlLmRyYWdnYWJsZSh7aWdub3JlRnJvbTogbmV3VmFsdWV9KS5cIiksIGUyLnByb3RvdHlwZS5hbGxvd0Zyb20gPSBOdChmdW5jdGlvbih0Mykge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9iYWNrQ29tcGF0T3B0aW9uKFwiYWxsb3dGcm9tXCIsIHQzKTtcbiAgICAgICAgfSwgXCJJbnRlcmFjdGFibGUuYWxsb3dGcm9tKCkgaGFzIGJlZW4gZGVwcmVjYXRlZC4gVXNlIEludGVyYWN0YmxlLmRyYWdnYWJsZSh7YWxsb3dGcm9tOiBuZXdWYWx1ZX0pLlwiKSwgZTIucHJvdG90eXBlLmFjdGlvbkNoZWNrZXIgPSBLdCwgZTIucHJvdG90eXBlLnN0eWxlQ3Vyc29yID0gSHQ7XG4gICAgICB9IH07XG4gICAgICBmdW5jdGlvbiBKdCh0MiwgZTIsIG4yLCByMiwgaTIpIHtcbiAgICAgICAgcmV0dXJuIGUyLnRlc3RJZ25vcmVBbGxvdyhlMi5vcHRpb25zW3QyLm5hbWVdLCBuMiwgcjIpICYmIGUyLm9wdGlvbnNbdDIubmFtZV0uZW5hYmxlZCAmJiBlZShlMiwgbjIsIHQyLCBpMikgPyB0MiA6IG51bGw7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBRdCh0MiwgZTIsIG4yLCByMiwgaTIsIG8yLCBhMikge1xuICAgICAgICBmb3IgKHZhciBzMiA9IDAsIGMyID0gcjIubGVuZ3RoOyBzMiA8IGMyOyBzMisrKSB7XG4gICAgICAgICAgdmFyIGwyID0gcjJbczJdLCB1MiA9IGkyW3MyXSwgcDIgPSBsMi5nZXRBY3Rpb24oZTIsIG4yLCB0MiwgdTIpO1xuICAgICAgICAgIGlmIChwMikge1xuICAgICAgICAgICAgdmFyIGYyID0gSnQocDIsIGwyLCB1MiwgbzIsIGEyKTtcbiAgICAgICAgICAgIGlmIChmMikgcmV0dXJuIHsgYWN0aW9uOiBmMiwgaW50ZXJhY3RhYmxlOiBsMiwgZWxlbWVudDogdTIgfTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgYWN0aW9uOiBudWxsLCBpbnRlcmFjdGFibGU6IG51bGwsIGVsZW1lbnQ6IG51bGwgfTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIFp0KHQyLCBlMiwgbjIsIHIyLCBpMikge1xuICAgICAgICB2YXIgbzIgPSBbXSwgYTIgPSBbXSwgczIgPSByMjtcbiAgICAgICAgZnVuY3Rpb24gYzIodDMpIHtcbiAgICAgICAgICBvMi5wdXNoKHQzKSwgYTIucHVzaChzMik7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICg7IHcuZWxlbWVudChzMik7ICkge1xuICAgICAgICAgIG8yID0gW10sIGEyID0gW10sIGkyLmludGVyYWN0YWJsZXMuZm9yRWFjaE1hdGNoKHMyLCBjMik7XG4gICAgICAgICAgdmFyIGwyID0gUXQodDIsIGUyLCBuMiwgbzIsIGEyLCByMiwgaTIpO1xuICAgICAgICAgIGlmIChsMi5hY3Rpb24gJiYgIWwyLmludGVyYWN0YWJsZS5vcHRpb25zW2wyLmFjdGlvbi5uYW1lXS5tYW51YWxTdGFydCkgcmV0dXJuIGwyO1xuICAgICAgICAgIHMyID0gQShzMik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgYWN0aW9uOiBudWxsLCBpbnRlcmFjdGFibGU6IG51bGwsIGVsZW1lbnQ6IG51bGwgfTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIHRlKHQyLCBlMiwgbjIpIHtcbiAgICAgICAgdmFyIHIyID0gZTIuYWN0aW9uLCBpMiA9IGUyLmludGVyYWN0YWJsZSwgbzIgPSBlMi5lbGVtZW50O1xuICAgICAgICByMiA9IHIyIHx8IHsgbmFtZTogbnVsbCB9LCB0Mi5pbnRlcmFjdGFibGUgPSBpMiwgdDIuZWxlbWVudCA9IG8yLCBVdCh0Mi5wcmVwYXJlZCwgcjIpLCB0Mi5yZWN0ID0gaTIgJiYgcjIubmFtZSA/IGkyLmdldFJlY3QobzIpIDogbnVsbCwgaWUodDIsIG4yKSwgbjIuZmlyZShcImF1dG9TdGFydDpwcmVwYXJlZFwiLCB7IGludGVyYWN0aW9uOiB0MiB9KTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIGVlKHQyLCBlMiwgbjIsIHIyKSB7XG4gICAgICAgIHZhciBpMiA9IHQyLm9wdGlvbnMsIG8yID0gaTJbbjIubmFtZV0ubWF4LCBhMiA9IGkyW24yLm5hbWVdLm1heFBlckVsZW1lbnQsIHMyID0gcjIuYXV0b1N0YXJ0Lm1heEludGVyYWN0aW9ucywgYzIgPSAwLCBsMiA9IDAsIHUyID0gMDtcbiAgICAgICAgaWYgKCEobzIgJiYgYTIgJiYgczIpKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIGZvciAodmFyIHAyID0gMCwgZjIgPSByMi5pbnRlcmFjdGlvbnMubGlzdDsgcDIgPCBmMi5sZW5ndGg7IHAyKyspIHtcbiAgICAgICAgICB2YXIgZDIgPSBmMltwMl0sIGgyID0gZDIucHJlcGFyZWQubmFtZTtcbiAgICAgICAgICBpZiAoZDIuaW50ZXJhY3RpbmcoKSkge1xuICAgICAgICAgICAgaWYgKCsrYzIgPj0gczIpIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIGlmIChkMi5pbnRlcmFjdGFibGUgPT09IHQyKSB7XG4gICAgICAgICAgICAgIGlmICgobDIgKz0gaDIgPT09IG4yLm5hbWUgPyAxIDogMCkgPj0gbzIpIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgaWYgKGQyLmVsZW1lbnQgPT09IGUyICYmICh1MisrLCBoMiA9PT0gbjIubmFtZSAmJiB1MiA+PSBhMikpIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHMyID4gMDtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIG5lKHQyLCBlMikge1xuICAgICAgICByZXR1cm4gdy5udW1iZXIodDIpID8gKGUyLmF1dG9TdGFydC5tYXhJbnRlcmFjdGlvbnMgPSB0MiwgdGhpcykgOiBlMi5hdXRvU3RhcnQubWF4SW50ZXJhY3Rpb25zO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gcmUodDIsIGUyLCBuMikge1xuICAgICAgICB2YXIgcjIgPSBuMi5hdXRvU3RhcnQuY3Vyc29yRWxlbWVudDtcbiAgICAgICAgcjIgJiYgcjIgIT09IHQyICYmIChyMi5zdHlsZS5jdXJzb3IgPSBcIlwiKSwgdDIub3duZXJEb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuY3Vyc29yID0gZTIsIHQyLnN0eWxlLmN1cnNvciA9IGUyLCBuMi5hdXRvU3RhcnQuY3Vyc29yRWxlbWVudCA9IGUyID8gdDIgOiBudWxsO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gaWUodDIsIGUyKSB7XG4gICAgICAgIHZhciBuMiA9IHQyLmludGVyYWN0YWJsZSwgcjIgPSB0Mi5lbGVtZW50LCBpMiA9IHQyLnByZXBhcmVkO1xuICAgICAgICBpZiAoXCJtb3VzZVwiID09PSB0Mi5wb2ludGVyVHlwZSAmJiBuMiAmJiBuMi5vcHRpb25zLnN0eWxlQ3Vyc29yKSB7XG4gICAgICAgICAgdmFyIG8yID0gXCJcIjtcbiAgICAgICAgICBpZiAoaTIubmFtZSkge1xuICAgICAgICAgICAgdmFyIGEyID0gbjIub3B0aW9uc1tpMi5uYW1lXS5jdXJzb3JDaGVja2VyO1xuICAgICAgICAgICAgbzIgPSB3LmZ1bmMoYTIpID8gYTIoaTIsIG4yLCByMiwgdDIuX2ludGVyYWN0aW5nKSA6IGUyLmFjdGlvbnMubWFwW2kyLm5hbWVdLmdldEN1cnNvcihpMik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJlKHQyLmVsZW1lbnQsIG8yIHx8IFwiXCIsIGUyKTtcbiAgICAgICAgfSBlbHNlIGUyLmF1dG9TdGFydC5jdXJzb3JFbGVtZW50ICYmIHJlKGUyLmF1dG9TdGFydC5jdXJzb3JFbGVtZW50LCBcIlwiLCBlMik7XG4gICAgICB9XG4gICAgICB2YXIgb2UgPSB7IGlkOiBcImF1dG8tc3RhcnQvYmFzZVwiLCBiZWZvcmU6IFtcImFjdGlvbnNcIl0sIGluc3RhbGw6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHZhciBlMiA9IHQyLmludGVyYWN0U3RhdGljLCBuMiA9IHQyLmRlZmF1bHRzO1xuICAgICAgICB0Mi51c2VQbHVnaW4oJHQpLCBuMi5iYXNlLmFjdGlvbkNoZWNrZXIgPSBudWxsLCBuMi5iYXNlLnN0eWxlQ3Vyc29yID0gdHJ1ZSwgVihuMi5wZXJBY3Rpb24sIHsgbWFudWFsU3RhcnQ6IGZhbHNlLCBtYXg6IDEgLyAwLCBtYXhQZXJFbGVtZW50OiAxLCBhbGxvd0Zyb206IG51bGwsIGlnbm9yZUZyb206IG51bGwsIG1vdXNlQnV0dG9uczogMSB9KSwgZTIubWF4SW50ZXJhY3Rpb25zID0gZnVuY3Rpb24oZTMpIHtcbiAgICAgICAgICByZXR1cm4gbmUoZTMsIHQyKTtcbiAgICAgICAgfSwgdDIuYXV0b1N0YXJ0ID0geyBtYXhJbnRlcmFjdGlvbnM6IDEgLyAwLCB3aXRoaW5JbnRlcmFjdGlvbkxpbWl0OiBlZSwgY3Vyc29yRWxlbWVudDogbnVsbCB9O1xuICAgICAgfSwgbGlzdGVuZXJzOiB7IFwiaW50ZXJhY3Rpb25zOmRvd25cIjogZnVuY3Rpb24odDIsIGUyKSB7XG4gICAgICAgIHZhciBuMiA9IHQyLmludGVyYWN0aW9uLCByMiA9IHQyLnBvaW50ZXIsIGkyID0gdDIuZXZlbnQsIG8yID0gdDIuZXZlbnRUYXJnZXQ7XG4gICAgICAgIG4yLmludGVyYWN0aW5nKCkgfHwgdGUobjIsIFp0KG4yLCByMiwgaTIsIG8yLCBlMiksIGUyKTtcbiAgICAgIH0sIFwiaW50ZXJhY3Rpb25zOm1vdmVcIjogZnVuY3Rpb24odDIsIGUyKSB7XG4gICAgICAgICFmdW5jdGlvbih0MywgZTMpIHtcbiAgICAgICAgICB2YXIgbjIgPSB0My5pbnRlcmFjdGlvbiwgcjIgPSB0My5wb2ludGVyLCBpMiA9IHQzLmV2ZW50LCBvMiA9IHQzLmV2ZW50VGFyZ2V0O1xuICAgICAgICAgIFwibW91c2VcIiAhPT0gbjIucG9pbnRlclR5cGUgfHwgbjIucG9pbnRlcklzRG93biB8fCBuMi5pbnRlcmFjdGluZygpIHx8IHRlKG4yLCBadChuMiwgcjIsIGkyLCBvMiwgZTMpLCBlMyk7XG4gICAgICAgIH0odDIsIGUyKSwgZnVuY3Rpb24odDMsIGUzKSB7XG4gICAgICAgICAgdmFyIG4yID0gdDMuaW50ZXJhY3Rpb247XG4gICAgICAgICAgaWYgKG4yLnBvaW50ZXJJc0Rvd24gJiYgIW4yLmludGVyYWN0aW5nKCkgJiYgbjIucG9pbnRlcldhc01vdmVkICYmIG4yLnByZXBhcmVkLm5hbWUpIHtcbiAgICAgICAgICAgIGUzLmZpcmUoXCJhdXRvU3RhcnQ6YmVmb3JlLXN0YXJ0XCIsIHQzKTtcbiAgICAgICAgICAgIHZhciByMiA9IG4yLmludGVyYWN0YWJsZSwgaTIgPSBuMi5wcmVwYXJlZC5uYW1lO1xuICAgICAgICAgICAgaTIgJiYgcjIgJiYgKHIyLm9wdGlvbnNbaTJdLm1hbnVhbFN0YXJ0IHx8ICFlZShyMiwgbjIuZWxlbWVudCwgbjIucHJlcGFyZWQsIGUzKSA/IG4yLnN0b3AoKSA6IChuMi5zdGFydChuMi5wcmVwYXJlZCwgcjIsIG4yLmVsZW1lbnQpLCBpZShuMiwgZTMpKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KHQyLCBlMik7XG4gICAgICB9LCBcImludGVyYWN0aW9uczpzdG9wXCI6IGZ1bmN0aW9uKHQyLCBlMikge1xuICAgICAgICB2YXIgbjIgPSB0Mi5pbnRlcmFjdGlvbiwgcjIgPSBuMi5pbnRlcmFjdGFibGU7XG4gICAgICAgIHIyICYmIHIyLm9wdGlvbnMuc3R5bGVDdXJzb3IgJiYgcmUobjIuZWxlbWVudCwgXCJcIiwgZTIpO1xuICAgICAgfSB9LCBtYXhJbnRlcmFjdGlvbnM6IG5lLCB3aXRoaW5JbnRlcmFjdGlvbkxpbWl0OiBlZSwgdmFsaWRhdGVBY3Rpb246IEp0IH0sIGFlID0gb2U7XG4gICAgICB2YXIgc2UgPSB7IGlkOiBcImF1dG8tc3RhcnQvZHJhZ0F4aXNcIiwgbGlzdGVuZXJzOiB7IFwiYXV0b1N0YXJ0OmJlZm9yZS1zdGFydFwiOiBmdW5jdGlvbih0MiwgZTIpIHtcbiAgICAgICAgdmFyIG4yID0gdDIuaW50ZXJhY3Rpb24sIHIyID0gdDIuZXZlbnRUYXJnZXQsIGkyID0gdDIuZHgsIG8yID0gdDIuZHk7XG4gICAgICAgIGlmIChcImRyYWdcIiA9PT0gbjIucHJlcGFyZWQubmFtZSkge1xuICAgICAgICAgIHZhciBhMiA9IE1hdGguYWJzKGkyKSwgczIgPSBNYXRoLmFicyhvMiksIGMyID0gbjIuaW50ZXJhY3RhYmxlLm9wdGlvbnMuZHJhZywgbDIgPSBjMi5zdGFydEF4aXMsIHUyID0gYTIgPiBzMiA/IFwieFwiIDogYTIgPCBzMiA/IFwieVwiIDogXCJ4eVwiO1xuICAgICAgICAgIGlmIChuMi5wcmVwYXJlZC5heGlzID0gXCJzdGFydFwiID09PSBjMi5sb2NrQXhpcyA/IHUyWzBdIDogYzIubG9ja0F4aXMsIFwieHlcIiAhPT0gdTIgJiYgXCJ4eVwiICE9PSBsMiAmJiBsMiAhPT0gdTIpIHtcbiAgICAgICAgICAgIG4yLnByZXBhcmVkLm5hbWUgPSBudWxsO1xuICAgICAgICAgICAgZm9yICh2YXIgcDIgPSByMiwgZjIgPSBmdW5jdGlvbih0Mykge1xuICAgICAgICAgICAgICBpZiAodDMgIT09IG4yLmludGVyYWN0YWJsZSkge1xuICAgICAgICAgICAgICAgIHZhciBpMyA9IG4yLmludGVyYWN0YWJsZS5vcHRpb25zLmRyYWc7XG4gICAgICAgICAgICAgICAgaWYgKCFpMy5tYW51YWxTdGFydCAmJiB0My50ZXN0SWdub3JlQWxsb3coaTMsIHAyLCByMikpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBvMyA9IHQzLmdldEFjdGlvbihuMi5kb3duUG9pbnRlciwgbjIuZG93bkV2ZW50LCBuMiwgcDIpO1xuICAgICAgICAgICAgICAgICAgaWYgKG8zICYmIFwiZHJhZ1wiID09PSBvMy5uYW1lICYmIGZ1bmN0aW9uKHQ0LCBlMykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWUzKSByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuMyA9IGUzLm9wdGlvbnMuZHJhZy5zdGFydEF4aXM7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcInh5XCIgPT09IHQ0IHx8IFwieHlcIiA9PT0gbjMgfHwgbjMgPT09IHQ0O1xuICAgICAgICAgICAgICAgICAgfSh1MiwgdDMpICYmIGFlLnZhbGlkYXRlQWN0aW9uKG8zLCB0MywgcDIsIHIyLCBlMikpIHJldHVybiB0MztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07IHcuZWxlbWVudChwMik7ICkge1xuICAgICAgICAgICAgICB2YXIgZDIgPSBlMi5pbnRlcmFjdGFibGVzLmZvckVhY2hNYXRjaChwMiwgZjIpO1xuICAgICAgICAgICAgICBpZiAoZDIpIHtcbiAgICAgICAgICAgICAgICBuMi5wcmVwYXJlZC5uYW1lID0gXCJkcmFnXCIsIG4yLmludGVyYWN0YWJsZSA9IGQyLCBuMi5lbGVtZW50ID0gcDI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcDIgPSBBKHAyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gfSB9O1xuICAgICAgZnVuY3Rpb24gY2UodDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIucHJlcGFyZWQgJiYgdDIucHJlcGFyZWQubmFtZTtcbiAgICAgICAgaWYgKCFlMikgcmV0dXJuIG51bGw7XG4gICAgICAgIHZhciBuMiA9IHQyLmludGVyYWN0YWJsZS5vcHRpb25zO1xuICAgICAgICByZXR1cm4gbjJbZTJdLmhvbGQgfHwgbjJbZTJdLmRlbGF5O1xuICAgICAgfVxuICAgICAgdmFyIGxlID0geyBpZDogXCJhdXRvLXN0YXJ0L2hvbGRcIiwgaW5zdGFsbDogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuZGVmYXVsdHM7XG4gICAgICAgIHQyLnVzZVBsdWdpbihhZSksIGUyLnBlckFjdGlvbi5ob2xkID0gMCwgZTIucGVyQWN0aW9uLmRlbGF5ID0gMDtcbiAgICAgIH0sIGxpc3RlbmVyczogeyBcImludGVyYWN0aW9uczpuZXdcIjogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdDIuaW50ZXJhY3Rpb24uYXV0b1N0YXJ0SG9sZFRpbWVyID0gbnVsbDtcbiAgICAgIH0sIFwiYXV0b1N0YXJ0OnByZXBhcmVkXCI6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHZhciBlMiA9IHQyLmludGVyYWN0aW9uLCBuMiA9IGNlKGUyKTtcbiAgICAgICAgbjIgPiAwICYmIChlMi5hdXRvU3RhcnRIb2xkVGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGUyLnN0YXJ0KGUyLnByZXBhcmVkLCBlMi5pbnRlcmFjdGFibGUsIGUyLmVsZW1lbnQpO1xuICAgICAgICB9LCBuMikpO1xuICAgICAgfSwgXCJpbnRlcmFjdGlvbnM6bW92ZVwiOiBmdW5jdGlvbih0Mikge1xuICAgICAgICB2YXIgZTIgPSB0Mi5pbnRlcmFjdGlvbiwgbjIgPSB0Mi5kdXBsaWNhdGU7XG4gICAgICAgIGUyLmF1dG9TdGFydEhvbGRUaW1lciAmJiBlMi5wb2ludGVyV2FzTW92ZWQgJiYgIW4yICYmIChjbGVhclRpbWVvdXQoZTIuYXV0b1N0YXJ0SG9sZFRpbWVyKSwgZTIuYXV0b1N0YXJ0SG9sZFRpbWVyID0gbnVsbCk7XG4gICAgICB9LCBcImF1dG9TdGFydDpiZWZvcmUtc3RhcnRcIjogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuaW50ZXJhY3Rpb247XG4gICAgICAgIGNlKGUyKSA+IDAgJiYgKGUyLnByZXBhcmVkLm5hbWUgPSBudWxsKTtcbiAgICAgIH0gfSwgZ2V0SG9sZER1cmF0aW9uOiBjZSB9LCB1ZSA9IGxlLCBwZSA9IHsgaWQ6IFwiYXV0by1zdGFydFwiLCBpbnN0YWxsOiBmdW5jdGlvbih0Mikge1xuICAgICAgICB0Mi51c2VQbHVnaW4oYWUpLCB0Mi51c2VQbHVnaW4odWUpLCB0Mi51c2VQbHVnaW4oc2UpO1xuICAgICAgfSB9LCBmZSA9IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHJldHVybiAvXihhbHdheXN8bmV2ZXJ8YXV0bykkLy50ZXN0KHQyKSA/ICh0aGlzLm9wdGlvbnMucHJldmVudERlZmF1bHQgPSB0MiwgdGhpcykgOiB3LmJvb2wodDIpID8gKHRoaXMub3B0aW9ucy5wcmV2ZW50RGVmYXVsdCA9IHQyID8gXCJhbHdheXNcIiA6IFwibmV2ZXJcIiwgdGhpcykgOiB0aGlzLm9wdGlvbnMucHJldmVudERlZmF1bHQ7XG4gICAgICB9O1xuICAgICAgZnVuY3Rpb24gZGUodDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuaW50ZXJhY3Rpb24sIG4yID0gdDIuZXZlbnQ7XG4gICAgICAgIGUyLmludGVyYWN0YWJsZSAmJiBlMi5pbnRlcmFjdGFibGUuY2hlY2tBbmRQcmV2ZW50RGVmYXVsdChuMik7XG4gICAgICB9XG4gICAgICB2YXIgaGUgPSB7IGlkOiBcImNvcmUvaW50ZXJhY3RhYmxlUHJldmVudERlZmF1bHRcIiwgaW5zdGFsbDogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuSW50ZXJhY3RhYmxlO1xuICAgICAgICBlMi5wcm90b3R5cGUucHJldmVudERlZmF1bHQgPSBmZSwgZTIucHJvdG90eXBlLmNoZWNrQW5kUHJldmVudERlZmF1bHQgPSBmdW5jdGlvbihlMykge1xuICAgICAgICAgIHJldHVybiBmdW5jdGlvbih0MywgZTQsIG4yKSB7XG4gICAgICAgICAgICB2YXIgcjIgPSB0My5vcHRpb25zLnByZXZlbnREZWZhdWx0O1xuICAgICAgICAgICAgaWYgKFwibmV2ZXJcIiAhPT0gcjIpIGlmIChcImFsd2F5c1wiICE9PSByMikge1xuICAgICAgICAgICAgICBpZiAoZTQuZXZlbnRzLnN1cHBvcnRzUGFzc2l2ZSAmJiAvXnRvdWNoKHN0YXJ0fG1vdmUpJC8udGVzdChuMi50eXBlKSkge1xuICAgICAgICAgICAgICAgIHZhciBpMiA9IHkobjIudGFyZ2V0KS5kb2N1bWVudCwgbzIgPSBlNC5nZXREb2NPcHRpb25zKGkyKTtcbiAgICAgICAgICAgICAgICBpZiAoIW8yIHx8ICFvMi5ldmVudHMgfHwgZmFsc2UgIT09IG8yLmV2ZW50cy5wYXNzaXZlKSByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgL14obW91c2V8cG9pbnRlcnx0b3VjaCkqKGRvd258c3RhcnQpL2kudGVzdChuMi50eXBlKSB8fCB3LmVsZW1lbnQobjIudGFyZ2V0KSAmJiBSKG4yLnRhcmdldCwgXCJpbnB1dCxzZWxlY3QsdGV4dGFyZWEsW2NvbnRlbnRlZGl0YWJsZT10cnVlXSxbY29udGVudGVkaXRhYmxlPXRydWVdICpcIikgfHwgbjIucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIH0gZWxzZSBuMi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIH0odGhpcywgdDIsIGUzKTtcbiAgICAgICAgfSwgdDIuaW50ZXJhY3Rpb25zLmRvY0V2ZW50cy5wdXNoKHsgdHlwZTogXCJkcmFnc3RhcnRcIiwgbGlzdGVuZXI6IGZ1bmN0aW9uKGUzKSB7XG4gICAgICAgICAgZm9yICh2YXIgbjIgPSAwLCByMiA9IHQyLmludGVyYWN0aW9ucy5saXN0OyBuMiA8IHIyLmxlbmd0aDsgbjIrKykge1xuICAgICAgICAgICAgdmFyIGkyID0gcjJbbjJdO1xuICAgICAgICAgICAgaWYgKGkyLmVsZW1lbnQgJiYgKGkyLmVsZW1lbnQgPT09IGUzLnRhcmdldCB8fCBNKGkyLmVsZW1lbnQsIGUzLnRhcmdldCkpKSByZXR1cm4gdm9pZCBpMi5pbnRlcmFjdGFibGUuY2hlY2tBbmRQcmV2ZW50RGVmYXVsdChlMyk7XG4gICAgICAgICAgfVxuICAgICAgICB9IH0pO1xuICAgICAgfSwgbGlzdGVuZXJzOiBbXCJkb3duXCIsIFwibW92ZVwiLCBcInVwXCIsIFwiY2FuY2VsXCJdLnJlZHVjZShmdW5jdGlvbih0MiwgZTIpIHtcbiAgICAgICAgcmV0dXJuIHQyW1wiaW50ZXJhY3Rpb25zOlwiLmNvbmNhdChlMildID0gZGUsIHQyO1xuICAgICAgfSwge30pIH07XG4gICAgICBmdW5jdGlvbiB2ZSh0MiwgZTIpIHtcbiAgICAgICAgaWYgKGUyLnBoYXNlbGVzc1R5cGVzW3QyXSkgcmV0dXJuIHRydWU7XG4gICAgICAgIGZvciAodmFyIG4yIGluIGUyLm1hcCkgaWYgKDAgPT09IHQyLmluZGV4T2YobjIpICYmIHQyLnN1YnN0cihuMi5sZW5ndGgpIGluIGUyLnBoYXNlcykgcmV0dXJuIHRydWU7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIGdlKHQyKSB7XG4gICAgICAgIHZhciBlMiA9IHt9O1xuICAgICAgICBmb3IgKHZhciBuMiBpbiB0Mikge1xuICAgICAgICAgIHZhciByMiA9IHQyW24yXTtcbiAgICAgICAgICB3LnBsYWluT2JqZWN0KHIyKSA/IGUyW24yXSA9IGdlKHIyKSA6IHcuYXJyYXkocjIpID8gZTJbbjJdID0gbXQocjIpIDogZTJbbjJdID0gcjI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGUyO1xuICAgICAgfVxuICAgICAgdmFyIG1lID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGZ1bmN0aW9uIHQyKGUyKSB7XG4gICAgICAgICAgcih0aGlzLCB0MiksIHRoaXMuc3RhdGVzID0gW10sIHRoaXMuc3RhcnRPZmZzZXQgPSB7IGxlZnQ6IDAsIHJpZ2h0OiAwLCB0b3A6IDAsIGJvdHRvbTogMCB9LCB0aGlzLnN0YXJ0RGVsdGEgPSB2b2lkIDAsIHRoaXMucmVzdWx0ID0gdm9pZCAwLCB0aGlzLmVuZFJlc3VsdCA9IHZvaWQgMCwgdGhpcy5zdGFydEVkZ2VzID0gdm9pZCAwLCB0aGlzLmVkZ2VzID0gdm9pZCAwLCB0aGlzLmludGVyYWN0aW9uID0gdm9pZCAwLCB0aGlzLmludGVyYWN0aW9uID0gZTIsIHRoaXMucmVzdWx0ID0geWUoKSwgdGhpcy5lZGdlcyA9IHsgbGVmdDogZmFsc2UsIHJpZ2h0OiBmYWxzZSwgdG9wOiBmYWxzZSwgYm90dG9tOiBmYWxzZSB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvKHQyLCBbeyBrZXk6IFwic3RhcnRcIiwgdmFsdWU6IGZ1bmN0aW9uKHQzLCBlMikge1xuICAgICAgICAgIHZhciBuMiwgcjIsIGkyID0gdDMucGhhc2UsIG8yID0gdGhpcy5pbnRlcmFjdGlvbiwgYTIgPSBmdW5jdGlvbih0NCkge1xuICAgICAgICAgICAgdmFyIGUzID0gdDQuaW50ZXJhY3RhYmxlLm9wdGlvbnNbdDQucHJlcGFyZWQubmFtZV0sIG4zID0gZTMubW9kaWZpZXJzO1xuICAgICAgICAgICAgaWYgKG4zICYmIG4zLmxlbmd0aCkgcmV0dXJuIG4zO1xuICAgICAgICAgICAgcmV0dXJuIFtcInNuYXBcIiwgXCJzbmFwU2l6ZVwiLCBcInNuYXBFZGdlc1wiLCBcInJlc3RyaWN0XCIsIFwicmVzdHJpY3RFZGdlc1wiLCBcInJlc3RyaWN0U2l6ZVwiXS5tYXAoZnVuY3Rpb24odDUpIHtcbiAgICAgICAgICAgICAgdmFyIG40ID0gZTNbdDVdO1xuICAgICAgICAgICAgICByZXR1cm4gbjQgJiYgbjQuZW5hYmxlZCAmJiB7IG9wdGlvbnM6IG40LCBtZXRob2RzOiBuNC5fbWV0aG9kcyB9O1xuICAgICAgICAgICAgfSkuZmlsdGVyKGZ1bmN0aW9uKHQ1KSB7XG4gICAgICAgICAgICAgIHJldHVybiAhIXQ1O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfShvMik7XG4gICAgICAgICAgdGhpcy5wcmVwYXJlU3RhdGVzKGEyKSwgdGhpcy5zdGFydEVkZ2VzID0gVih7fSwgbzIuZWRnZXMpLCB0aGlzLmVkZ2VzID0gVih7fSwgdGhpcy5zdGFydEVkZ2VzKSwgdGhpcy5zdGFydE9mZnNldCA9IChuMiA9IG8yLnJlY3QsIHIyID0gZTIsIG4yID8geyBsZWZ0OiByMi54IC0gbjIubGVmdCwgdG9wOiByMi55IC0gbjIudG9wLCByaWdodDogbjIucmlnaHQgLSByMi54LCBib3R0b206IG4yLmJvdHRvbSAtIHIyLnkgfSA6IHsgbGVmdDogMCwgdG9wOiAwLCByaWdodDogMCwgYm90dG9tOiAwIH0pLCB0aGlzLnN0YXJ0RGVsdGEgPSB7IHg6IDAsIHk6IDAgfTtcbiAgICAgICAgICB2YXIgczIgPSB0aGlzLmZpbGxBcmcoeyBwaGFzZTogaTIsIHBhZ2VDb29yZHM6IGUyLCBwcmVFbmQ6IGZhbHNlIH0pO1xuICAgICAgICAgIHJldHVybiB0aGlzLnJlc3VsdCA9IHllKCksIHRoaXMuc3RhcnRBbGwoczIpLCB0aGlzLnJlc3VsdCA9IHRoaXMuc2V0QWxsKHMyKTtcbiAgICAgICAgfSB9LCB7IGtleTogXCJmaWxsQXJnXCIsIHZhbHVlOiBmdW5jdGlvbih0Mykge1xuICAgICAgICAgIHZhciBlMiA9IHRoaXMuaW50ZXJhY3Rpb247XG4gICAgICAgICAgcmV0dXJuIHQzLmludGVyYWN0aW9uID0gZTIsIHQzLmludGVyYWN0YWJsZSA9IGUyLmludGVyYWN0YWJsZSwgdDMuZWxlbWVudCA9IGUyLmVsZW1lbnQsIHQzLnJlY3QgfHwgKHQzLnJlY3QgPSBlMi5yZWN0KSwgdDMuZWRnZXMgfHwgKHQzLmVkZ2VzID0gdGhpcy5zdGFydEVkZ2VzKSwgdDMuc3RhcnRPZmZzZXQgPSB0aGlzLnN0YXJ0T2Zmc2V0LCB0MztcbiAgICAgICAgfSB9LCB7IGtleTogXCJzdGFydEFsbFwiLCB2YWx1ZTogZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICBmb3IgKHZhciBlMiA9IDAsIG4yID0gdGhpcy5zdGF0ZXM7IGUyIDwgbjIubGVuZ3RoOyBlMisrKSB7XG4gICAgICAgICAgICB2YXIgcjIgPSBuMltlMl07XG4gICAgICAgICAgICByMi5tZXRob2RzLnN0YXJ0ICYmICh0My5zdGF0ZSA9IHIyLCByMi5tZXRob2RzLnN0YXJ0KHQzKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IH0sIHsga2V5OiBcInNldEFsbFwiLCB2YWx1ZTogZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICB2YXIgZTIgPSB0My5waGFzZSwgbjIgPSB0My5wcmVFbmQsIHIyID0gdDMuc2tpcE1vZGlmaWVycywgaTIgPSB0My5yZWN0LCBvMiA9IHQzLmVkZ2VzO1xuICAgICAgICAgIHQzLmNvb3JkcyA9IFYoe30sIHQzLnBhZ2VDb29yZHMpLCB0My5yZWN0ID0gVih7fSwgaTIpLCB0My5lZGdlcyA9IFYoe30sIG8yKTtcbiAgICAgICAgICBmb3IgKHZhciBhMiA9IHIyID8gdGhpcy5zdGF0ZXMuc2xpY2UocjIpIDogdGhpcy5zdGF0ZXMsIHMyID0geWUodDMuY29vcmRzLCB0My5yZWN0KSwgYzIgPSAwOyBjMiA8IGEyLmxlbmd0aDsgYzIrKykge1xuICAgICAgICAgICAgdmFyIGwyLCB1MiA9IGEyW2MyXSwgcDIgPSB1Mi5vcHRpb25zLCBmMiA9IFYoe30sIHQzLmNvb3JkcyksIGQyID0gbnVsbDtcbiAgICAgICAgICAgIG51bGwgIT0gKGwyID0gdTIubWV0aG9kcykgJiYgbDIuc2V0ICYmIHRoaXMuc2hvdWxkRG8ocDIsIG4yLCBlMikgJiYgKHQzLnN0YXRlID0gdTIsIGQyID0gdTIubWV0aG9kcy5zZXQodDMpLCBIKHQzLmVkZ2VzLCB0My5yZWN0LCB7IHg6IHQzLmNvb3Jkcy54IC0gZjIueCwgeTogdDMuY29vcmRzLnkgLSBmMi55IH0pKSwgczIuZXZlbnRQcm9wcy5wdXNoKGQyKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgVih0aGlzLmVkZ2VzLCB0My5lZGdlcyksIHMyLmRlbHRhLnggPSB0My5jb29yZHMueCAtIHQzLnBhZ2VDb29yZHMueCwgczIuZGVsdGEueSA9IHQzLmNvb3Jkcy55IC0gdDMucGFnZUNvb3Jkcy55LCBzMi5yZWN0RGVsdGEubGVmdCA9IHQzLnJlY3QubGVmdCAtIGkyLmxlZnQsIHMyLnJlY3REZWx0YS5yaWdodCA9IHQzLnJlY3QucmlnaHQgLSBpMi5yaWdodCwgczIucmVjdERlbHRhLnRvcCA9IHQzLnJlY3QudG9wIC0gaTIudG9wLCBzMi5yZWN0RGVsdGEuYm90dG9tID0gdDMucmVjdC5ib3R0b20gLSBpMi5ib3R0b207XG4gICAgICAgICAgdmFyIGgyID0gdGhpcy5yZXN1bHQuY29vcmRzLCB2MiA9IHRoaXMucmVzdWx0LnJlY3Q7XG4gICAgICAgICAgaWYgKGgyICYmIHYyKSB7XG4gICAgICAgICAgICB2YXIgZzIgPSBzMi5yZWN0LmxlZnQgIT09IHYyLmxlZnQgfHwgczIucmVjdC5yaWdodCAhPT0gdjIucmlnaHQgfHwgczIucmVjdC50b3AgIT09IHYyLnRvcCB8fCBzMi5yZWN0LmJvdHRvbSAhPT0gdjIuYm90dG9tO1xuICAgICAgICAgICAgczIuY2hhbmdlZCA9IGcyIHx8IGgyLnggIT09IHMyLmNvb3Jkcy54IHx8IGgyLnkgIT09IHMyLmNvb3Jkcy55O1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gczI7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwiYXBwbHlUb0ludGVyYWN0aW9uXCIsIHZhbHVlOiBmdW5jdGlvbih0Mykge1xuICAgICAgICAgIHZhciBlMiA9IHRoaXMuaW50ZXJhY3Rpb24sIG4yID0gdDMucGhhc2UsIHIyID0gZTIuY29vcmRzLmN1ciwgaTIgPSBlMi5jb29yZHMuc3RhcnQsIG8yID0gdGhpcy5yZXN1bHQsIGEyID0gdGhpcy5zdGFydERlbHRhLCBzMiA9IG8yLmRlbHRhO1xuICAgICAgICAgIFwic3RhcnRcIiA9PT0gbjIgJiYgVih0aGlzLnN0YXJ0RGVsdGEsIG8yLmRlbHRhKTtcbiAgICAgICAgICBmb3IgKHZhciBjMiA9IDAsIGwyID0gW1tpMiwgYTJdLCBbcjIsIHMyXV07IGMyIDwgbDIubGVuZ3RoOyBjMisrKSB7XG4gICAgICAgICAgICB2YXIgdTIgPSBsMltjMl0sIHAyID0gdTJbMF0sIGYyID0gdTJbMV07XG4gICAgICAgICAgICBwMi5wYWdlLnggKz0gZjIueCwgcDIucGFnZS55ICs9IGYyLnksIHAyLmNsaWVudC54ICs9IGYyLngsIHAyLmNsaWVudC55ICs9IGYyLnk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBkMiA9IHRoaXMucmVzdWx0LnJlY3REZWx0YSwgaDIgPSB0My5yZWN0IHx8IGUyLnJlY3Q7XG4gICAgICAgICAgaDIubGVmdCArPSBkMi5sZWZ0LCBoMi5yaWdodCArPSBkMi5yaWdodCwgaDIudG9wICs9IGQyLnRvcCwgaDIuYm90dG9tICs9IGQyLmJvdHRvbSwgaDIud2lkdGggPSBoMi5yaWdodCAtIGgyLmxlZnQsIGgyLmhlaWdodCA9IGgyLmJvdHRvbSAtIGgyLnRvcDtcbiAgICAgICAgfSB9LCB7IGtleTogXCJzZXRBbmRBcHBseVwiLCB2YWx1ZTogZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICB2YXIgZTIgPSB0aGlzLmludGVyYWN0aW9uLCBuMiA9IHQzLnBoYXNlLCByMiA9IHQzLnByZUVuZCwgaTIgPSB0My5za2lwTW9kaWZpZXJzLCBvMiA9IHRoaXMuc2V0QWxsKHRoaXMuZmlsbEFyZyh7IHByZUVuZDogcjIsIHBoYXNlOiBuMiwgcGFnZUNvb3JkczogdDMubW9kaWZpZWRDb29yZHMgfHwgZTIuY29vcmRzLmN1ci5wYWdlIH0pKTtcbiAgICAgICAgICBpZiAodGhpcy5yZXN1bHQgPSBvMiwgIW8yLmNoYW5nZWQgJiYgKCFpMiB8fCBpMiA8IHRoaXMuc3RhdGVzLmxlbmd0aCkgJiYgZTIuaW50ZXJhY3RpbmcoKSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIGlmICh0My5tb2RpZmllZENvb3Jkcykge1xuICAgICAgICAgICAgdmFyIGEyID0gZTIuY29vcmRzLmN1ci5wYWdlLCBzMiA9IHsgeDogdDMubW9kaWZpZWRDb29yZHMueCAtIGEyLngsIHk6IHQzLm1vZGlmaWVkQ29vcmRzLnkgLSBhMi55IH07XG4gICAgICAgICAgICBvMi5jb29yZHMueCArPSBzMi54LCBvMi5jb29yZHMueSArPSBzMi55LCBvMi5kZWx0YS54ICs9IHMyLngsIG8yLmRlbHRhLnkgKz0gczIueTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5hcHBseVRvSW50ZXJhY3Rpb24odDMpO1xuICAgICAgICB9IH0sIHsga2V5OiBcImJlZm9yZUVuZFwiLCB2YWx1ZTogZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICB2YXIgZTIgPSB0My5pbnRlcmFjdGlvbiwgbjIgPSB0My5ldmVudCwgcjIgPSB0aGlzLnN0YXRlcztcbiAgICAgICAgICBpZiAocjIgJiYgcjIubGVuZ3RoKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpMiA9IGZhbHNlLCBvMiA9IDA7IG8yIDwgcjIubGVuZ3RoOyBvMisrKSB7XG4gICAgICAgICAgICAgIHZhciBhMiA9IHIyW28yXTtcbiAgICAgICAgICAgICAgdDMuc3RhdGUgPSBhMjtcbiAgICAgICAgICAgICAgdmFyIHMyID0gYTIub3B0aW9ucywgYzIgPSBhMi5tZXRob2RzLCBsMiA9IGMyLmJlZm9yZUVuZCAmJiBjMi5iZWZvcmVFbmQodDMpO1xuICAgICAgICAgICAgICBpZiAobDIpIHJldHVybiB0aGlzLmVuZFJlc3VsdCA9IGwyLCBmYWxzZTtcbiAgICAgICAgICAgICAgaTIgPSBpMiB8fCAhaTIgJiYgdGhpcy5zaG91bGREbyhzMiwgdHJ1ZSwgdDMucGhhc2UsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaTIgJiYgZTIubW92ZSh7IGV2ZW50OiBuMiwgcHJlRW5kOiB0cnVlIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSB9LCB7IGtleTogXCJzdG9wXCIsIHZhbHVlOiBmdW5jdGlvbih0Mykge1xuICAgICAgICAgIHZhciBlMiA9IHQzLmludGVyYWN0aW9uO1xuICAgICAgICAgIGlmICh0aGlzLnN0YXRlcyAmJiB0aGlzLnN0YXRlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHZhciBuMiA9IFYoeyBzdGF0ZXM6IHRoaXMuc3RhdGVzLCBpbnRlcmFjdGFibGU6IGUyLmludGVyYWN0YWJsZSwgZWxlbWVudDogZTIuZWxlbWVudCwgcmVjdDogbnVsbCB9LCB0Myk7XG4gICAgICAgICAgICB0aGlzLmZpbGxBcmcobjIpO1xuICAgICAgICAgICAgZm9yICh2YXIgcjIgPSAwLCBpMiA9IHRoaXMuc3RhdGVzOyByMiA8IGkyLmxlbmd0aDsgcjIrKykge1xuICAgICAgICAgICAgICB2YXIgbzIgPSBpMltyMl07XG4gICAgICAgICAgICAgIG4yLnN0YXRlID0gbzIsIG8yLm1ldGhvZHMuc3RvcCAmJiBvMi5tZXRob2RzLnN0b3AobjIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zdGF0ZXMgPSBudWxsLCB0aGlzLmVuZFJlc3VsdCA9IG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICB9IH0sIHsga2V5OiBcInByZXBhcmVTdGF0ZXNcIiwgdmFsdWU6IGZ1bmN0aW9uKHQzKSB7XG4gICAgICAgICAgdGhpcy5zdGF0ZXMgPSBbXTtcbiAgICAgICAgICBmb3IgKHZhciBlMiA9IDA7IGUyIDwgdDMubGVuZ3RoOyBlMisrKSB7XG4gICAgICAgICAgICB2YXIgbjIgPSB0M1tlMl0sIHIyID0gbjIub3B0aW9ucywgaTIgPSBuMi5tZXRob2RzLCBvMiA9IG4yLm5hbWU7XG4gICAgICAgICAgICB0aGlzLnN0YXRlcy5wdXNoKHsgb3B0aW9uczogcjIsIG1ldGhvZHM6IGkyLCBpbmRleDogZTIsIG5hbWU6IG8yIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdGhpcy5zdGF0ZXM7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwicmVzdG9yZUludGVyYWN0aW9uQ29vcmRzXCIsIHZhbHVlOiBmdW5jdGlvbih0Mykge1xuICAgICAgICAgIHZhciBlMiA9IHQzLmludGVyYWN0aW9uLCBuMiA9IGUyLmNvb3JkcywgcjIgPSBlMi5yZWN0LCBpMiA9IGUyLm1vZGlmaWNhdGlvbjtcbiAgICAgICAgICBpZiAoaTIucmVzdWx0KSB7XG4gICAgICAgICAgICBmb3IgKHZhciBvMiA9IGkyLnN0YXJ0RGVsdGEsIGEyID0gaTIucmVzdWx0LCBzMiA9IGEyLmRlbHRhLCBjMiA9IGEyLnJlY3REZWx0YSwgbDIgPSAwLCB1MiA9IFtbbjIuc3RhcnQsIG8yXSwgW24yLmN1ciwgczJdXTsgbDIgPCB1Mi5sZW5ndGg7IGwyKyspIHtcbiAgICAgICAgICAgICAgdmFyIHAyID0gdTJbbDJdLCBmMiA9IHAyWzBdLCBkMiA9IHAyWzFdO1xuICAgICAgICAgICAgICBmMi5wYWdlLnggLT0gZDIueCwgZjIucGFnZS55IC09IGQyLnksIGYyLmNsaWVudC54IC09IGQyLngsIGYyLmNsaWVudC55IC09IGQyLnk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByMi5sZWZ0IC09IGMyLmxlZnQsIHIyLnJpZ2h0IC09IGMyLnJpZ2h0LCByMi50b3AgLT0gYzIudG9wLCByMi5ib3R0b20gLT0gYzIuYm90dG9tO1xuICAgICAgICAgIH1cbiAgICAgICAgfSB9LCB7IGtleTogXCJzaG91bGREb1wiLCB2YWx1ZTogZnVuY3Rpb24odDMsIGUyLCBuMiwgcjIpIHtcbiAgICAgICAgICByZXR1cm4gISghdDMgfHwgZmFsc2UgPT09IHQzLmVuYWJsZWQgfHwgcjIgJiYgIXQzLmVuZE9ubHkgfHwgdDMuZW5kT25seSAmJiAhZTIgfHwgXCJzdGFydFwiID09PSBuMiAmJiAhdDMuc2V0U3RhcnQpO1xuICAgICAgICB9IH0sIHsga2V5OiBcImNvcHlGcm9tXCIsIHZhbHVlOiBmdW5jdGlvbih0Mykge1xuICAgICAgICAgIHRoaXMuc3RhcnRPZmZzZXQgPSB0My5zdGFydE9mZnNldCwgdGhpcy5zdGFydERlbHRhID0gdDMuc3RhcnREZWx0YSwgdGhpcy5zdGFydEVkZ2VzID0gdDMuc3RhcnRFZGdlcywgdGhpcy5lZGdlcyA9IHQzLmVkZ2VzLCB0aGlzLnN0YXRlcyA9IHQzLnN0YXRlcy5tYXAoZnVuY3Rpb24odDQpIHtcbiAgICAgICAgICAgIHJldHVybiBnZSh0NCk7XG4gICAgICAgICAgfSksIHRoaXMucmVzdWx0ID0geWUoVih7fSwgdDMucmVzdWx0LmNvb3JkcyksIFYoe30sIHQzLnJlc3VsdC5yZWN0KSk7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwiZGVzdHJveVwiLCB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgZm9yICh2YXIgdDMgaW4gdGhpcykgdGhpc1t0M10gPSBudWxsO1xuICAgICAgICB9IH1dKSwgdDI7XG4gICAgICB9KCk7XG4gICAgICBmdW5jdGlvbiB5ZSh0MiwgZTIpIHtcbiAgICAgICAgcmV0dXJuIHsgcmVjdDogZTIsIGNvb3JkczogdDIsIGRlbHRhOiB7IHg6IDAsIHk6IDAgfSwgcmVjdERlbHRhOiB7IGxlZnQ6IDAsIHJpZ2h0OiAwLCB0b3A6IDAsIGJvdHRvbTogMCB9LCBldmVudFByb3BzOiBbXSwgY2hhbmdlZDogdHJ1ZSB9O1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gYmUodDIsIGUyKSB7XG4gICAgICAgIHZhciBuMiA9IHQyLmRlZmF1bHRzLCByMiA9IHsgc3RhcnQ6IHQyLnN0YXJ0LCBzZXQ6IHQyLnNldCwgYmVmb3JlRW5kOiB0Mi5iZWZvcmVFbmQsIHN0b3A6IHQyLnN0b3AgfSwgaTIgPSBmdW5jdGlvbih0Mykge1xuICAgICAgICAgIHZhciBpMyA9IHQzIHx8IHt9O1xuICAgICAgICAgIGZvciAodmFyIG8yIGluIGkzLmVuYWJsZWQgPSBmYWxzZSAhPT0gaTMuZW5hYmxlZCwgbjIpIG8yIGluIGkzIHx8IChpM1tvMl0gPSBuMltvMl0pO1xuICAgICAgICAgIHZhciBhMiA9IHsgb3B0aW9uczogaTMsIG1ldGhvZHM6IHIyLCBuYW1lOiBlMiwgZW5hYmxlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBpMy5lbmFibGVkID0gdHJ1ZSwgYTI7XG4gICAgICAgICAgfSwgZGlzYWJsZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gaTMuZW5hYmxlZCA9IGZhbHNlLCBhMjtcbiAgICAgICAgICB9IH07XG4gICAgICAgICAgcmV0dXJuIGEyO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZTIgJiYgXCJzdHJpbmdcIiA9PSB0eXBlb2YgZTIgJiYgKGkyLl9kZWZhdWx0cyA9IG4yLCBpMi5fbWV0aG9kcyA9IHIyKSwgaTI7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiB4ZSh0Mikge1xuICAgICAgICB2YXIgZTIgPSB0Mi5pRXZlbnQsIG4yID0gdDIuaW50ZXJhY3Rpb24ubW9kaWZpY2F0aW9uLnJlc3VsdDtcbiAgICAgICAgbjIgJiYgKGUyLm1vZGlmaWVycyA9IG4yLmV2ZW50UHJvcHMpO1xuICAgICAgfVxuICAgICAgdmFyIHdlID0geyBpZDogXCJtb2RpZmllcnMvYmFzZVwiLCBiZWZvcmU6IFtcImFjdGlvbnNcIl0sIGluc3RhbGw6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHQyLmRlZmF1bHRzLnBlckFjdGlvbi5tb2RpZmllcnMgPSBbXTtcbiAgICAgIH0sIGxpc3RlbmVyczogeyBcImludGVyYWN0aW9uczpuZXdcIjogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuaW50ZXJhY3Rpb247XG4gICAgICAgIGUyLm1vZGlmaWNhdGlvbiA9IG5ldyBtZShlMik7XG4gICAgICB9LCBcImludGVyYWN0aW9uczpiZWZvcmUtYWN0aW9uLXN0YXJ0XCI6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHZhciBlMiA9IHQyLmludGVyYWN0aW9uLCBuMiA9IHQyLmludGVyYWN0aW9uLm1vZGlmaWNhdGlvbjtcbiAgICAgICAgbjIuc3RhcnQodDIsIGUyLmNvb3Jkcy5zdGFydC5wYWdlKSwgZTIuZWRnZXMgPSBuMi5lZGdlcywgbjIuYXBwbHlUb0ludGVyYWN0aW9uKHQyKTtcbiAgICAgIH0sIFwiaW50ZXJhY3Rpb25zOmJlZm9yZS1hY3Rpb24tbW92ZVwiOiBmdW5jdGlvbih0Mikge1xuICAgICAgICB2YXIgZTIgPSB0Mi5pbnRlcmFjdGlvbiwgbjIgPSBlMi5tb2RpZmljYXRpb24sIHIyID0gbjIuc2V0QW5kQXBwbHkodDIpO1xuICAgICAgICByZXR1cm4gZTIuZWRnZXMgPSBuMi5lZGdlcywgcjI7XG4gICAgICB9LCBcImludGVyYWN0aW9uczpiZWZvcmUtYWN0aW9uLWVuZFwiOiBmdW5jdGlvbih0Mikge1xuICAgICAgICB2YXIgZTIgPSB0Mi5pbnRlcmFjdGlvbiwgbjIgPSBlMi5tb2RpZmljYXRpb24sIHIyID0gbjIuYmVmb3JlRW5kKHQyKTtcbiAgICAgICAgcmV0dXJuIGUyLmVkZ2VzID0gbjIuc3RhcnRFZGdlcywgcjI7XG4gICAgICB9LCBcImludGVyYWN0aW9uczphY3Rpb24tc3RhcnRcIjogeGUsIFwiaW50ZXJhY3Rpb25zOmFjdGlvbi1tb3ZlXCI6IHhlLCBcImludGVyYWN0aW9uczphY3Rpb24tZW5kXCI6IHhlLCBcImludGVyYWN0aW9uczphZnRlci1hY3Rpb24tc3RhcnRcIjogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgcmV0dXJuIHQyLmludGVyYWN0aW9uLm1vZGlmaWNhdGlvbi5yZXN0b3JlSW50ZXJhY3Rpb25Db29yZHModDIpO1xuICAgICAgfSwgXCJpbnRlcmFjdGlvbnM6YWZ0ZXItYWN0aW9uLW1vdmVcIjogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgcmV0dXJuIHQyLmludGVyYWN0aW9uLm1vZGlmaWNhdGlvbi5yZXN0b3JlSW50ZXJhY3Rpb25Db29yZHModDIpO1xuICAgICAgfSwgXCJpbnRlcmFjdGlvbnM6c3RvcFwiOiBmdW5jdGlvbih0Mikge1xuICAgICAgICByZXR1cm4gdDIuaW50ZXJhY3Rpb24ubW9kaWZpY2F0aW9uLnN0b3AodDIpO1xuICAgICAgfSB9IH0sIEVlID0gd2UsIFRlID0geyBiYXNlOiB7IHByZXZlbnREZWZhdWx0OiBcImF1dG9cIiwgZGVsdGFTb3VyY2U6IFwicGFnZVwiIH0sIHBlckFjdGlvbjogeyBlbmFibGVkOiBmYWxzZSwgb3JpZ2luOiB7IHg6IDAsIHk6IDAgfSB9LCBhY3Rpb25zOiB7fSB9LCBTZSA9IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHMobjIsIHQyKTtcbiAgICAgICAgdmFyIGUyID0gcChuMik7XG4gICAgICAgIGZ1bmN0aW9uIG4yKHQzLCBpMiwgbzIsIGEyLCBzMiwgYzIsIGwyKSB7XG4gICAgICAgICAgdmFyIHAyO1xuICAgICAgICAgIHIodGhpcywgbjIpLCAocDIgPSBlMi5jYWxsKHRoaXMsIHQzKSkucmVsYXRlZFRhcmdldCA9IG51bGwsIHAyLnNjcmVlblggPSB2b2lkIDAsIHAyLnNjcmVlblkgPSB2b2lkIDAsIHAyLmJ1dHRvbiA9IHZvaWQgMCwgcDIuYnV0dG9ucyA9IHZvaWQgMCwgcDIuY3RybEtleSA9IHZvaWQgMCwgcDIuc2hpZnRLZXkgPSB2b2lkIDAsIHAyLmFsdEtleSA9IHZvaWQgMCwgcDIubWV0YUtleSA9IHZvaWQgMCwgcDIucGFnZSA9IHZvaWQgMCwgcDIuY2xpZW50ID0gdm9pZCAwLCBwMi5kZWx0YSA9IHZvaWQgMCwgcDIucmVjdCA9IHZvaWQgMCwgcDIueDAgPSB2b2lkIDAsIHAyLnkwID0gdm9pZCAwLCBwMi50MCA9IHZvaWQgMCwgcDIuZHQgPSB2b2lkIDAsIHAyLmR1cmF0aW9uID0gdm9pZCAwLCBwMi5jbGllbnRYMCA9IHZvaWQgMCwgcDIuY2xpZW50WTAgPSB2b2lkIDAsIHAyLnZlbG9jaXR5ID0gdm9pZCAwLCBwMi5zcGVlZCA9IHZvaWQgMCwgcDIuc3dpcGUgPSB2b2lkIDAsIHAyLmF4ZXMgPSB2b2lkIDAsIHAyLnByZUVuZCA9IHZvaWQgMCwgczIgPSBzMiB8fCB0My5lbGVtZW50O1xuICAgICAgICAgIHZhciBmMiA9IHQzLmludGVyYWN0YWJsZSwgZDIgPSAoZjIgJiYgZjIub3B0aW9ucyB8fCBUZSkuZGVsdGFTb3VyY2UsIGgyID0gSyhmMiwgczIsIG8yKSwgdjIgPSBcInN0YXJ0XCIgPT09IGEyLCBnMiA9IFwiZW5kXCIgPT09IGEyLCBtMiA9IHYyID8gdShwMikgOiB0My5wcmV2RXZlbnQsIHkyID0gdjIgPyB0My5jb29yZHMuc3RhcnQgOiBnMiA/IHsgcGFnZTogbTIucGFnZSwgY2xpZW50OiBtMi5jbGllbnQsIHRpbWVTdGFtcDogdDMuY29vcmRzLmN1ci50aW1lU3RhbXAgfSA6IHQzLmNvb3Jkcy5jdXI7XG4gICAgICAgICAgcmV0dXJuIHAyLnBhZ2UgPSBWKHt9LCB5Mi5wYWdlKSwgcDIuY2xpZW50ID0gVih7fSwgeTIuY2xpZW50KSwgcDIucmVjdCA9IFYoe30sIHQzLnJlY3QpLCBwMi50aW1lU3RhbXAgPSB5Mi50aW1lU3RhbXAsIGcyIHx8IChwMi5wYWdlLnggLT0gaDIueCwgcDIucGFnZS55IC09IGgyLnksIHAyLmNsaWVudC54IC09IGgyLngsIHAyLmNsaWVudC55IC09IGgyLnkpLCBwMi5jdHJsS2V5ID0gaTIuY3RybEtleSwgcDIuYWx0S2V5ID0gaTIuYWx0S2V5LCBwMi5zaGlmdEtleSA9IGkyLnNoaWZ0S2V5LCBwMi5tZXRhS2V5ID0gaTIubWV0YUtleSwgcDIuYnV0dG9uID0gaTIuYnV0dG9uLCBwMi5idXR0b25zID0gaTIuYnV0dG9ucywgcDIudGFyZ2V0ID0gczIsIHAyLmN1cnJlbnRUYXJnZXQgPSBzMiwgcDIucHJlRW5kID0gYzIsIHAyLnR5cGUgPSBsMiB8fCBvMiArIChhMiB8fCBcIlwiKSwgcDIuaW50ZXJhY3RhYmxlID0gZjIsIHAyLnQwID0gdjIgPyB0My5wb2ludGVyc1t0My5wb2ludGVycy5sZW5ndGggLSAxXS5kb3duVGltZSA6IG0yLnQwLCBwMi54MCA9IHQzLmNvb3Jkcy5zdGFydC5wYWdlLnggLSBoMi54LCBwMi55MCA9IHQzLmNvb3Jkcy5zdGFydC5wYWdlLnkgLSBoMi55LCBwMi5jbGllbnRYMCA9IHQzLmNvb3Jkcy5zdGFydC5jbGllbnQueCAtIGgyLngsIHAyLmNsaWVudFkwID0gdDMuY29vcmRzLnN0YXJ0LmNsaWVudC55IC0gaDIueSwgcDIuZGVsdGEgPSB2MiB8fCBnMiA/IHsgeDogMCwgeTogMCB9IDogeyB4OiBwMltkMl0ueCAtIG0yW2QyXS54LCB5OiBwMltkMl0ueSAtIG0yW2QyXS55IH0sIHAyLmR0ID0gdDMuY29vcmRzLmRlbHRhLnRpbWVTdGFtcCwgcDIuZHVyYXRpb24gPSBwMi50aW1lU3RhbXAgLSBwMi50MCwgcDIudmVsb2NpdHkgPSBWKHt9LCB0My5jb29yZHMudmVsb2NpdHlbZDJdKSwgcDIuc3BlZWQgPSBRKHAyLnZlbG9jaXR5LngsIHAyLnZlbG9jaXR5LnkpLCBwMi5zd2lwZSA9IGcyIHx8IFwiaW5lcnRpYXN0YXJ0XCIgPT09IGEyID8gcDIuZ2V0U3dpcGUoKSA6IG51bGwsIHAyO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvKG4yLCBbeyBrZXk6IFwiZ2V0U3dpcGVcIiwgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciB0MyA9IHRoaXMuX2ludGVyYWN0aW9uO1xuICAgICAgICAgIGlmICh0My5wcmV2RXZlbnQuc3BlZWQgPCA2MDAgfHwgdGhpcy50aW1lU3RhbXAgLSB0My5wcmV2RXZlbnQudGltZVN0YW1wID4gMTUwKSByZXR1cm4gbnVsbDtcbiAgICAgICAgICB2YXIgZTMgPSAxODAgKiBNYXRoLmF0YW4yKHQzLnByZXZFdmVudC52ZWxvY2l0eVksIHQzLnByZXZFdmVudC52ZWxvY2l0eVgpIC8gTWF0aC5QSTtcbiAgICAgICAgICBlMyA8IDAgJiYgKGUzICs9IDM2MCk7XG4gICAgICAgICAgdmFyIG4zID0gMTEyLjUgPD0gZTMgJiYgZTMgPCAyNDcuNSwgcjIgPSAyMDIuNSA8PSBlMyAmJiBlMyA8IDMzNy41O1xuICAgICAgICAgIHJldHVybiB7IHVwOiByMiwgZG93bjogIXIyICYmIDIyLjUgPD0gZTMgJiYgZTMgPCAxNTcuNSwgbGVmdDogbjMsIHJpZ2h0OiAhbjMgJiYgKDI5Mi41IDw9IGUzIHx8IGUzIDwgNjcuNSksIGFuZ2xlOiBlMywgc3BlZWQ6IHQzLnByZXZFdmVudC5zcGVlZCwgdmVsb2NpdHk6IHsgeDogdDMucHJldkV2ZW50LnZlbG9jaXR5WCwgeTogdDMucHJldkV2ZW50LnZlbG9jaXR5WSB9IH07XG4gICAgICAgIH0gfSwgeyBrZXk6IFwicHJldmVudERlZmF1bHRcIiwgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB9IH0sIHsga2V5OiBcInN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvblwiLCB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdGhpcy5pbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQgPSB0aGlzLnByb3BhZ2F0aW9uU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwic3RvcFByb3BhZ2F0aW9uXCIsIHZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aGlzLnByb3BhZ2F0aW9uU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIH0gfV0pLCBuMjtcbiAgICAgIH0odnQpO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoU2UucHJvdG90eXBlLCB7IHBhZ2VYOiB7IGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhZ2UueDtcbiAgICAgIH0sIHNldDogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdGhpcy5wYWdlLnggPSB0MjtcbiAgICAgIH0gfSwgcGFnZVk6IHsgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFnZS55O1xuICAgICAgfSwgc2V0OiBmdW5jdGlvbih0Mikge1xuICAgICAgICB0aGlzLnBhZ2UueSA9IHQyO1xuICAgICAgfSB9LCBjbGllbnRYOiB7IGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNsaWVudC54O1xuICAgICAgfSwgc2V0OiBmdW5jdGlvbih0Mikge1xuICAgICAgICB0aGlzLmNsaWVudC54ID0gdDI7XG4gICAgICB9IH0sIGNsaWVudFk6IHsgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2xpZW50Lnk7XG4gICAgICB9LCBzZXQ6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHRoaXMuY2xpZW50LnkgPSB0MjtcbiAgICAgIH0gfSwgZHg6IHsgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVsdGEueDtcbiAgICAgIH0sIHNldDogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdGhpcy5kZWx0YS54ID0gdDI7XG4gICAgICB9IH0sIGR5OiB7IGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRlbHRhLnk7XG4gICAgICB9LCBzZXQ6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHRoaXMuZGVsdGEueSA9IHQyO1xuICAgICAgfSB9LCB2ZWxvY2l0eVg6IHsgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmVsb2NpdHkueDtcbiAgICAgIH0sIHNldDogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdGhpcy52ZWxvY2l0eS54ID0gdDI7XG4gICAgICB9IH0sIHZlbG9jaXR5WTogeyBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy52ZWxvY2l0eS55O1xuICAgICAgfSwgc2V0OiBmdW5jdGlvbih0Mikge1xuICAgICAgICB0aGlzLnZlbG9jaXR5LnkgPSB0MjtcbiAgICAgIH0gfSB9KTtcbiAgICAgIHZhciBfZSA9IG8oZnVuY3Rpb24gdDIoZTIsIG4yLCBpMiwgbzIsIGEyKSB7XG4gICAgICAgIHIodGhpcywgdDIpLCB0aGlzLmlkID0gdm9pZCAwLCB0aGlzLnBvaW50ZXIgPSB2b2lkIDAsIHRoaXMuZXZlbnQgPSB2b2lkIDAsIHRoaXMuZG93blRpbWUgPSB2b2lkIDAsIHRoaXMuZG93blRhcmdldCA9IHZvaWQgMCwgdGhpcy5pZCA9IGUyLCB0aGlzLnBvaW50ZXIgPSBuMiwgdGhpcy5ldmVudCA9IGkyLCB0aGlzLmRvd25UaW1lID0gbzIsIHRoaXMuZG93blRhcmdldCA9IGEyO1xuICAgICAgfSksIFBlID0gZnVuY3Rpb24odDIpIHtcbiAgICAgICAgcmV0dXJuIHQyLmludGVyYWN0YWJsZSA9IFwiXCIsIHQyLmVsZW1lbnQgPSBcIlwiLCB0Mi5wcmVwYXJlZCA9IFwiXCIsIHQyLnBvaW50ZXJJc0Rvd24gPSBcIlwiLCB0Mi5wb2ludGVyV2FzTW92ZWQgPSBcIlwiLCB0Mi5fcHJveHkgPSBcIlwiLCB0MjtcbiAgICAgIH0oe30pLCBPZSA9IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHJldHVybiB0Mi5zdGFydCA9IFwiXCIsIHQyLm1vdmUgPSBcIlwiLCB0Mi5lbmQgPSBcIlwiLCB0Mi5zdG9wID0gXCJcIiwgdDIuaW50ZXJhY3RpbmcgPSBcIlwiLCB0MjtcbiAgICAgIH0oe30pLCBrZSA9IDAsIERlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGZ1bmN0aW9uIHQyKGUyKSB7XG4gICAgICAgICAgdmFyIG4yID0gdGhpcywgaTIgPSBlMi5wb2ludGVyVHlwZSwgbzIgPSBlMi5zY29wZUZpcmU7XG4gICAgICAgICAgcih0aGlzLCB0MiksIHRoaXMuaW50ZXJhY3RhYmxlID0gbnVsbCwgdGhpcy5lbGVtZW50ID0gbnVsbCwgdGhpcy5yZWN0ID0gbnVsbCwgdGhpcy5fcmVjdHMgPSB2b2lkIDAsIHRoaXMuZWRnZXMgPSBudWxsLCB0aGlzLl9zY29wZUZpcmUgPSB2b2lkIDAsIHRoaXMucHJlcGFyZWQgPSB7IG5hbWU6IG51bGwsIGF4aXM6IG51bGwsIGVkZ2VzOiBudWxsIH0sIHRoaXMucG9pbnRlclR5cGUgPSB2b2lkIDAsIHRoaXMucG9pbnRlcnMgPSBbXSwgdGhpcy5kb3duRXZlbnQgPSBudWxsLCB0aGlzLmRvd25Qb2ludGVyID0ge30sIHRoaXMuX2xhdGVzdFBvaW50ZXIgPSB7IHBvaW50ZXI6IG51bGwsIGV2ZW50OiBudWxsLCBldmVudFRhcmdldDogbnVsbCB9LCB0aGlzLnByZXZFdmVudCA9IG51bGwsIHRoaXMucG9pbnRlcklzRG93biA9IGZhbHNlLCB0aGlzLnBvaW50ZXJXYXNNb3ZlZCA9IGZhbHNlLCB0aGlzLl9pbnRlcmFjdGluZyA9IGZhbHNlLCB0aGlzLl9lbmRpbmcgPSBmYWxzZSwgdGhpcy5fc3RvcHBlZCA9IHRydWUsIHRoaXMuX3Byb3h5ID0gdm9pZCAwLCB0aGlzLnNpbXVsYXRpb24gPSBudWxsLCB0aGlzLmRvTW92ZSA9IE50KGZ1bmN0aW9uKHQzKSB7XG4gICAgICAgICAgICB0aGlzLm1vdmUodDMpO1xuICAgICAgICAgIH0sIFwiVGhlIGludGVyYWN0aW9uLmRvTW92ZSgpIG1ldGhvZCBoYXMgYmVlbiByZW5hbWVkIHRvIGludGVyYWN0aW9uLm1vdmUoKVwiKSwgdGhpcy5jb29yZHMgPSB7IHN0YXJ0OiB7IHBhZ2U6IHsgeDogMCwgeTogMCB9LCBjbGllbnQ6IHsgeDogMCwgeTogMCB9LCB0aW1lU3RhbXA6IDAgfSwgcHJldjogeyBwYWdlOiB7IHg6IDAsIHk6IDAgfSwgY2xpZW50OiB7IHg6IDAsIHk6IDAgfSwgdGltZVN0YW1wOiAwIH0sIGN1cjogeyBwYWdlOiB7IHg6IDAsIHk6IDAgfSwgY2xpZW50OiB7IHg6IDAsIHk6IDAgfSwgdGltZVN0YW1wOiAwIH0sIGRlbHRhOiB7IHBhZ2U6IHsgeDogMCwgeTogMCB9LCBjbGllbnQ6IHsgeDogMCwgeTogMCB9LCB0aW1lU3RhbXA6IDAgfSwgdmVsb2NpdHk6IHsgcGFnZTogeyB4OiAwLCB5OiAwIH0sIGNsaWVudDogeyB4OiAwLCB5OiAwIH0sIHRpbWVTdGFtcDogMCB9IH0sIHRoaXMuX2lkID0ga2UrKywgdGhpcy5fc2NvcGVGaXJlID0gbzIsIHRoaXMucG9pbnRlclR5cGUgPSBpMjtcbiAgICAgICAgICB2YXIgYTIgPSB0aGlzO1xuICAgICAgICAgIHRoaXMuX3Byb3h5ID0ge307XG4gICAgICAgICAgdmFyIHMyID0gZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuMi5fcHJveHksIHQzLCB7IGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHJldHVybiBhMlt0M107XG4gICAgICAgICAgICB9IH0pO1xuICAgICAgICAgIH07XG4gICAgICAgICAgZm9yICh2YXIgYzIgaW4gUGUpIHMyKGMyKTtcbiAgICAgICAgICB2YXIgbDIgPSBmdW5jdGlvbih0Mykge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG4yLl9wcm94eSwgdDMsIHsgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICByZXR1cm4gYTJbdDNdLmFwcGx5KGEyLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfSB9KTtcbiAgICAgICAgICB9O1xuICAgICAgICAgIGZvciAodmFyIHUyIGluIE9lKSBsMih1Mik7XG4gICAgICAgICAgdGhpcy5fc2NvcGVGaXJlKFwiaW50ZXJhY3Rpb25zOm5ld1wiLCB7IGludGVyYWN0aW9uOiB0aGlzIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvKHQyLCBbeyBrZXk6IFwicG9pbnRlck1vdmVUb2xlcmFuY2VcIiwgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfSB9LCB7IGtleTogXCJwb2ludGVyRG93blwiLCB2YWx1ZTogZnVuY3Rpb24odDMsIGUyLCBuMikge1xuICAgICAgICAgIHZhciByMiA9IHRoaXMudXBkYXRlUG9pbnRlcih0MywgZTIsIG4yLCB0cnVlKSwgaTIgPSB0aGlzLnBvaW50ZXJzW3IyXTtcbiAgICAgICAgICB0aGlzLl9zY29wZUZpcmUoXCJpbnRlcmFjdGlvbnM6ZG93blwiLCB7IHBvaW50ZXI6IHQzLCBldmVudDogZTIsIGV2ZW50VGFyZ2V0OiBuMiwgcG9pbnRlckluZGV4OiByMiwgcG9pbnRlckluZm86IGkyLCB0eXBlOiBcImRvd25cIiwgaW50ZXJhY3Rpb246IHRoaXMgfSk7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwic3RhcnRcIiwgdmFsdWU6IGZ1bmN0aW9uKHQzLCBlMiwgbjIpIHtcbiAgICAgICAgICByZXR1cm4gISh0aGlzLmludGVyYWN0aW5nKCkgfHwgIXRoaXMucG9pbnRlcklzRG93biB8fCB0aGlzLnBvaW50ZXJzLmxlbmd0aCA8IChcImdlc3R1cmVcIiA9PT0gdDMubmFtZSA/IDIgOiAxKSB8fCAhZTIub3B0aW9uc1t0My5uYW1lXS5lbmFibGVkKSAmJiAoVXQodGhpcy5wcmVwYXJlZCwgdDMpLCB0aGlzLmludGVyYWN0YWJsZSA9IGUyLCB0aGlzLmVsZW1lbnQgPSBuMiwgdGhpcy5yZWN0ID0gZTIuZ2V0UmVjdChuMiksIHRoaXMuZWRnZXMgPSB0aGlzLnByZXBhcmVkLmVkZ2VzID8gVih7fSwgdGhpcy5wcmVwYXJlZC5lZGdlcykgOiB7IGxlZnQ6IHRydWUsIHJpZ2h0OiB0cnVlLCB0b3A6IHRydWUsIGJvdHRvbTogdHJ1ZSB9LCB0aGlzLl9zdG9wcGVkID0gZmFsc2UsIHRoaXMuX2ludGVyYWN0aW5nID0gdGhpcy5fZG9QaGFzZSh7IGludGVyYWN0aW9uOiB0aGlzLCBldmVudDogdGhpcy5kb3duRXZlbnQsIHBoYXNlOiBcInN0YXJ0XCIgfSkgJiYgIXRoaXMuX3N0b3BwZWQsIHRoaXMuX2ludGVyYWN0aW5nKTtcbiAgICAgICAgfSB9LCB7IGtleTogXCJwb2ludGVyTW92ZVwiLCB2YWx1ZTogZnVuY3Rpb24odDMsIGUyLCBuMikge1xuICAgICAgICAgIHRoaXMuc2ltdWxhdGlvbiB8fCB0aGlzLm1vZGlmaWNhdGlvbiAmJiB0aGlzLm1vZGlmaWNhdGlvbi5lbmRSZXN1bHQgfHwgdGhpcy51cGRhdGVQb2ludGVyKHQzLCBlMiwgbjIsIGZhbHNlKTtcbiAgICAgICAgICB2YXIgcjIsIGkyLCBvMiA9IHRoaXMuY29vcmRzLmN1ci5wYWdlLnggPT09IHRoaXMuY29vcmRzLnByZXYucGFnZS54ICYmIHRoaXMuY29vcmRzLmN1ci5wYWdlLnkgPT09IHRoaXMuY29vcmRzLnByZXYucGFnZS55ICYmIHRoaXMuY29vcmRzLmN1ci5jbGllbnQueCA9PT0gdGhpcy5jb29yZHMucHJldi5jbGllbnQueCAmJiB0aGlzLmNvb3Jkcy5jdXIuY2xpZW50LnkgPT09IHRoaXMuY29vcmRzLnByZXYuY2xpZW50Lnk7XG4gICAgICAgICAgdGhpcy5wb2ludGVySXNEb3duICYmICF0aGlzLnBvaW50ZXJXYXNNb3ZlZCAmJiAocjIgPSB0aGlzLmNvb3Jkcy5jdXIuY2xpZW50LnggLSB0aGlzLmNvb3Jkcy5zdGFydC5jbGllbnQueCwgaTIgPSB0aGlzLmNvb3Jkcy5jdXIuY2xpZW50LnkgLSB0aGlzLmNvb3Jkcy5zdGFydC5jbGllbnQueSwgdGhpcy5wb2ludGVyV2FzTW92ZWQgPSBRKHIyLCBpMikgPiB0aGlzLnBvaW50ZXJNb3ZlVG9sZXJhbmNlKTtcbiAgICAgICAgICB2YXIgYTIsIHMyLCBjMiwgbDIgPSB0aGlzLmdldFBvaW50ZXJJbmRleCh0MyksIHUyID0geyBwb2ludGVyOiB0MywgcG9pbnRlckluZGV4OiBsMiwgcG9pbnRlckluZm86IHRoaXMucG9pbnRlcnNbbDJdLCBldmVudDogZTIsIHR5cGU6IFwibW92ZVwiLCBldmVudFRhcmdldDogbjIsIGR4OiByMiwgZHk6IGkyLCBkdXBsaWNhdGU6IG8yLCBpbnRlcmFjdGlvbjogdGhpcyB9O1xuICAgICAgICAgIG8yIHx8IChhMiA9IHRoaXMuY29vcmRzLnZlbG9jaXR5LCBzMiA9IHRoaXMuY29vcmRzLmRlbHRhLCBjMiA9IE1hdGgubWF4KHMyLnRpbWVTdGFtcCAvIDFlMywgMWUtMyksIGEyLnBhZ2UueCA9IHMyLnBhZ2UueCAvIGMyLCBhMi5wYWdlLnkgPSBzMi5wYWdlLnkgLyBjMiwgYTIuY2xpZW50LnggPSBzMi5jbGllbnQueCAvIGMyLCBhMi5jbGllbnQueSA9IHMyLmNsaWVudC55IC8gYzIsIGEyLnRpbWVTdGFtcCA9IGMyKSwgdGhpcy5fc2NvcGVGaXJlKFwiaW50ZXJhY3Rpb25zOm1vdmVcIiwgdTIpLCBvMiB8fCB0aGlzLnNpbXVsYXRpb24gfHwgKHRoaXMuaW50ZXJhY3RpbmcoKSAmJiAodTIudHlwZSA9IG51bGwsIHRoaXMubW92ZSh1MikpLCB0aGlzLnBvaW50ZXJXYXNNb3ZlZCAmJiBldCh0aGlzLmNvb3Jkcy5wcmV2LCB0aGlzLmNvb3Jkcy5jdXIpKTtcbiAgICAgICAgfSB9LCB7IGtleTogXCJtb3ZlXCIsIHZhbHVlOiBmdW5jdGlvbih0Mykge1xuICAgICAgICAgIHQzICYmIHQzLmV2ZW50IHx8IG50KHRoaXMuY29vcmRzLmRlbHRhKSwgKHQzID0gVih7IHBvaW50ZXI6IHRoaXMuX2xhdGVzdFBvaW50ZXIucG9pbnRlciwgZXZlbnQ6IHRoaXMuX2xhdGVzdFBvaW50ZXIuZXZlbnQsIGV2ZW50VGFyZ2V0OiB0aGlzLl9sYXRlc3RQb2ludGVyLmV2ZW50VGFyZ2V0LCBpbnRlcmFjdGlvbjogdGhpcyB9LCB0MyB8fCB7fSkpLnBoYXNlID0gXCJtb3ZlXCIsIHRoaXMuX2RvUGhhc2UodDMpO1xuICAgICAgICB9IH0sIHsga2V5OiBcInBvaW50ZXJVcFwiLCB2YWx1ZTogZnVuY3Rpb24odDMsIGUyLCBuMiwgcjIpIHtcbiAgICAgICAgICB2YXIgaTIgPSB0aGlzLmdldFBvaW50ZXJJbmRleCh0Myk7XG4gICAgICAgICAgLTEgPT09IGkyICYmIChpMiA9IHRoaXMudXBkYXRlUG9pbnRlcih0MywgZTIsIG4yLCBmYWxzZSkpO1xuICAgICAgICAgIHZhciBvMiA9IC9jYW5jZWwkL2kudGVzdChlMi50eXBlKSA/IFwiY2FuY2VsXCIgOiBcInVwXCI7XG4gICAgICAgICAgdGhpcy5fc2NvcGVGaXJlKFwiaW50ZXJhY3Rpb25zOlwiLmNvbmNhdChvMiksIHsgcG9pbnRlcjogdDMsIHBvaW50ZXJJbmRleDogaTIsIHBvaW50ZXJJbmZvOiB0aGlzLnBvaW50ZXJzW2kyXSwgZXZlbnQ6IGUyLCBldmVudFRhcmdldDogbjIsIHR5cGU6IG8yLCBjdXJFdmVudFRhcmdldDogcjIsIGludGVyYWN0aW9uOiB0aGlzIH0pLCB0aGlzLnNpbXVsYXRpb24gfHwgdGhpcy5lbmQoZTIpLCB0aGlzLnJlbW92ZVBvaW50ZXIodDMsIGUyKTtcbiAgICAgICAgfSB9LCB7IGtleTogXCJkb2N1bWVudEJsdXJcIiwgdmFsdWU6IGZ1bmN0aW9uKHQzKSB7XG4gICAgICAgICAgdGhpcy5lbmQodDMpLCB0aGlzLl9zY29wZUZpcmUoXCJpbnRlcmFjdGlvbnM6Ymx1clwiLCB7IGV2ZW50OiB0MywgdHlwZTogXCJibHVyXCIsIGludGVyYWN0aW9uOiB0aGlzIH0pO1xuICAgICAgICB9IH0sIHsga2V5OiBcImVuZFwiLCB2YWx1ZTogZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICB2YXIgZTI7XG4gICAgICAgICAgdGhpcy5fZW5kaW5nID0gdHJ1ZSwgdDMgPSB0MyB8fCB0aGlzLl9sYXRlc3RQb2ludGVyLmV2ZW50LCB0aGlzLmludGVyYWN0aW5nKCkgJiYgKGUyID0gdGhpcy5fZG9QaGFzZSh7IGV2ZW50OiB0MywgaW50ZXJhY3Rpb246IHRoaXMsIHBoYXNlOiBcImVuZFwiIH0pKSwgdGhpcy5fZW5kaW5nID0gZmFsc2UsIHRydWUgPT09IGUyICYmIHRoaXMuc3RvcCgpO1xuICAgICAgICB9IH0sIHsga2V5OiBcImN1cnJlbnRBY3Rpb25cIiwgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9pbnRlcmFjdGluZyA/IHRoaXMucHJlcGFyZWQubmFtZSA6IG51bGw7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwiaW50ZXJhY3RpbmdcIiwgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9pbnRlcmFjdGluZztcbiAgICAgICAgfSB9LCB7IGtleTogXCJzdG9wXCIsIHZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aGlzLl9zY29wZUZpcmUoXCJpbnRlcmFjdGlvbnM6c3RvcFwiLCB7IGludGVyYWN0aW9uOiB0aGlzIH0pLCB0aGlzLmludGVyYWN0YWJsZSA9IHRoaXMuZWxlbWVudCA9IG51bGwsIHRoaXMuX2ludGVyYWN0aW5nID0gZmFsc2UsIHRoaXMuX3N0b3BwZWQgPSB0cnVlLCB0aGlzLnByZXBhcmVkLm5hbWUgPSB0aGlzLnByZXZFdmVudCA9IG51bGw7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwiZ2V0UG9pbnRlckluZGV4XCIsIHZhbHVlOiBmdW5jdGlvbih0Mykge1xuICAgICAgICAgIHZhciBlMiA9IGF0KHQzKTtcbiAgICAgICAgICByZXR1cm4gXCJtb3VzZVwiID09PSB0aGlzLnBvaW50ZXJUeXBlIHx8IFwicGVuXCIgPT09IHRoaXMucG9pbnRlclR5cGUgPyB0aGlzLnBvaW50ZXJzLmxlbmd0aCAtIDEgOiB5dCh0aGlzLnBvaW50ZXJzLCBmdW5jdGlvbih0NCkge1xuICAgICAgICAgICAgcmV0dXJuIHQ0LmlkID09PSBlMjtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSB9LCB7IGtleTogXCJnZXRQb2ludGVySW5mb1wiLCB2YWx1ZTogZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5wb2ludGVyc1t0aGlzLmdldFBvaW50ZXJJbmRleCh0MyldO1xuICAgICAgICB9IH0sIHsga2V5OiBcInVwZGF0ZVBvaW50ZXJcIiwgdmFsdWU6IGZ1bmN0aW9uKHQzLCBlMiwgbjIsIHIyKSB7XG4gICAgICAgICAgdmFyIGkyLCBvMiwgYTIsIHMyID0gYXQodDMpLCBjMiA9IHRoaXMuZ2V0UG9pbnRlckluZGV4KHQzKSwgbDIgPSB0aGlzLnBvaW50ZXJzW2MyXTtcbiAgICAgICAgICByZXR1cm4gcjIgPSBmYWxzZSAhPT0gcjIgJiYgKHIyIHx8IC8oZG93bnxzdGFydCkkL2kudGVzdChlMi50eXBlKSksIGwyID8gbDIucG9pbnRlciA9IHQzIDogKGwyID0gbmV3IF9lKHMyLCB0MywgZTIsIG51bGwsIG51bGwpLCBjMiA9IHRoaXMucG9pbnRlcnMubGVuZ3RoLCB0aGlzLnBvaW50ZXJzLnB1c2gobDIpKSwgc3QodGhpcy5jb29yZHMuY3VyLCB0aGlzLnBvaW50ZXJzLm1hcChmdW5jdGlvbih0NCkge1xuICAgICAgICAgICAgcmV0dXJuIHQ0LnBvaW50ZXI7XG4gICAgICAgICAgfSksIHRoaXMuX25vdygpKSwgaTIgPSB0aGlzLmNvb3Jkcy5kZWx0YSwgbzIgPSB0aGlzLmNvb3Jkcy5wcmV2LCBhMiA9IHRoaXMuY29vcmRzLmN1ciwgaTIucGFnZS54ID0gYTIucGFnZS54IC0gbzIucGFnZS54LCBpMi5wYWdlLnkgPSBhMi5wYWdlLnkgLSBvMi5wYWdlLnksIGkyLmNsaWVudC54ID0gYTIuY2xpZW50LnggLSBvMi5jbGllbnQueCwgaTIuY2xpZW50LnkgPSBhMi5jbGllbnQueSAtIG8yLmNsaWVudC55LCBpMi50aW1lU3RhbXAgPSBhMi50aW1lU3RhbXAgLSBvMi50aW1lU3RhbXAsIHIyICYmICh0aGlzLnBvaW50ZXJJc0Rvd24gPSB0cnVlLCBsMi5kb3duVGltZSA9IHRoaXMuY29vcmRzLmN1ci50aW1lU3RhbXAsIGwyLmRvd25UYXJnZXQgPSBuMiwgdHQodGhpcy5kb3duUG9pbnRlciwgdDMpLCB0aGlzLmludGVyYWN0aW5nKCkgfHwgKGV0KHRoaXMuY29vcmRzLnN0YXJ0LCB0aGlzLmNvb3Jkcy5jdXIpLCBldCh0aGlzLmNvb3Jkcy5wcmV2LCB0aGlzLmNvb3Jkcy5jdXIpLCB0aGlzLmRvd25FdmVudCA9IGUyLCB0aGlzLnBvaW50ZXJXYXNNb3ZlZCA9IGZhbHNlKSksIHRoaXMuX3VwZGF0ZUxhdGVzdFBvaW50ZXIodDMsIGUyLCBuMiksIHRoaXMuX3Njb3BlRmlyZShcImludGVyYWN0aW9uczp1cGRhdGUtcG9pbnRlclwiLCB7IHBvaW50ZXI6IHQzLCBldmVudDogZTIsIGV2ZW50VGFyZ2V0OiBuMiwgZG93bjogcjIsIHBvaW50ZXJJbmZvOiBsMiwgcG9pbnRlckluZGV4OiBjMiwgaW50ZXJhY3Rpb246IHRoaXMgfSksIGMyO1xuICAgICAgICB9IH0sIHsga2V5OiBcInJlbW92ZVBvaW50ZXJcIiwgdmFsdWU6IGZ1bmN0aW9uKHQzLCBlMikge1xuICAgICAgICAgIHZhciBuMiA9IHRoaXMuZ2V0UG9pbnRlckluZGV4KHQzKTtcbiAgICAgICAgICBpZiAoLTEgIT09IG4yKSB7XG4gICAgICAgICAgICB2YXIgcjIgPSB0aGlzLnBvaW50ZXJzW24yXTtcbiAgICAgICAgICAgIHRoaXMuX3Njb3BlRmlyZShcImludGVyYWN0aW9uczpyZW1vdmUtcG9pbnRlclwiLCB7IHBvaW50ZXI6IHQzLCBldmVudDogZTIsIGV2ZW50VGFyZ2V0OiBudWxsLCBwb2ludGVySW5kZXg6IG4yLCBwb2ludGVySW5mbzogcjIsIGludGVyYWN0aW9uOiB0aGlzIH0pLCB0aGlzLnBvaW50ZXJzLnNwbGljZShuMiwgMSksIHRoaXMucG9pbnRlcklzRG93biA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSB9LCB7IGtleTogXCJfdXBkYXRlTGF0ZXN0UG9pbnRlclwiLCB2YWx1ZTogZnVuY3Rpb24odDMsIGUyLCBuMikge1xuICAgICAgICAgIHRoaXMuX2xhdGVzdFBvaW50ZXIucG9pbnRlciA9IHQzLCB0aGlzLl9sYXRlc3RQb2ludGVyLmV2ZW50ID0gZTIsIHRoaXMuX2xhdGVzdFBvaW50ZXIuZXZlbnRUYXJnZXQgPSBuMjtcbiAgICAgICAgfSB9LCB7IGtleTogXCJkZXN0cm95XCIsIHZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aGlzLl9sYXRlc3RQb2ludGVyLnBvaW50ZXIgPSBudWxsLCB0aGlzLl9sYXRlc3RQb2ludGVyLmV2ZW50ID0gbnVsbCwgdGhpcy5fbGF0ZXN0UG9pbnRlci5ldmVudFRhcmdldCA9IG51bGw7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwiX2NyZWF0ZVByZXBhcmVkRXZlbnRcIiwgdmFsdWU6IGZ1bmN0aW9uKHQzLCBlMiwgbjIsIHIyKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBTZSh0aGlzLCB0MywgdGhpcy5wcmVwYXJlZC5uYW1lLCBlMiwgdGhpcy5lbGVtZW50LCBuMiwgcjIpO1xuICAgICAgICB9IH0sIHsga2V5OiBcIl9maXJlRXZlbnRcIiwgdmFsdWU6IGZ1bmN0aW9uKHQzKSB7XG4gICAgICAgICAgdmFyIGUyO1xuICAgICAgICAgIG51bGwgPT0gKGUyID0gdGhpcy5pbnRlcmFjdGFibGUpIHx8IGUyLmZpcmUodDMpLCAoIXRoaXMucHJldkV2ZW50IHx8IHQzLnRpbWVTdGFtcCA+PSB0aGlzLnByZXZFdmVudC50aW1lU3RhbXApICYmICh0aGlzLnByZXZFdmVudCA9IHQzKTtcbiAgICAgICAgfSB9LCB7IGtleTogXCJfZG9QaGFzZVwiLCB2YWx1ZTogZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICB2YXIgZTIgPSB0My5ldmVudCwgbjIgPSB0My5waGFzZSwgcjIgPSB0My5wcmVFbmQsIGkyID0gdDMudHlwZSwgbzIgPSB0aGlzLnJlY3Q7XG4gICAgICAgICAgaWYgKG8yICYmIFwibW92ZVwiID09PSBuMiAmJiAoSCh0aGlzLmVkZ2VzLCBvMiwgdGhpcy5jb29yZHMuZGVsdGFbdGhpcy5pbnRlcmFjdGFibGUub3B0aW9ucy5kZWx0YVNvdXJjZV0pLCBvMi53aWR0aCA9IG8yLnJpZ2h0IC0gbzIubGVmdCwgbzIuaGVpZ2h0ID0gbzIuYm90dG9tIC0gbzIudG9wKSwgZmFsc2UgPT09IHRoaXMuX3Njb3BlRmlyZShcImludGVyYWN0aW9uczpiZWZvcmUtYWN0aW9uLVwiLmNvbmNhdChuMiksIHQzKSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIHZhciBhMiA9IHQzLmlFdmVudCA9IHRoaXMuX2NyZWF0ZVByZXBhcmVkRXZlbnQoZTIsIG4yLCByMiwgaTIpO1xuICAgICAgICAgIHJldHVybiB0aGlzLl9zY29wZUZpcmUoXCJpbnRlcmFjdGlvbnM6YWN0aW9uLVwiLmNvbmNhdChuMiksIHQzKSwgXCJzdGFydFwiID09PSBuMiAmJiAodGhpcy5wcmV2RXZlbnQgPSBhMiksIHRoaXMuX2ZpcmVFdmVudChhMiksIHRoaXMuX3Njb3BlRmlyZShcImludGVyYWN0aW9uczphZnRlci1hY3Rpb24tXCIuY29uY2F0KG4yKSwgdDMpLCB0cnVlO1xuICAgICAgICB9IH0sIHsga2V5OiBcIl9ub3dcIiwgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBEYXRlLm5vdygpO1xuICAgICAgICB9IH1dKSwgdDI7XG4gICAgICB9KCk7XG4gICAgICBmdW5jdGlvbiBJZSh0Mikge1xuICAgICAgICBNZSh0Mi5pbnRlcmFjdGlvbik7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBNZSh0Mikge1xuICAgICAgICBpZiAoIWZ1bmN0aW9uKHQzKSB7XG4gICAgICAgICAgcmV0dXJuICEoIXQzLm9mZnNldC5wZW5kaW5nLnggJiYgIXQzLm9mZnNldC5wZW5kaW5nLnkpO1xuICAgICAgICB9KHQyKSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICB2YXIgZTIgPSB0Mi5vZmZzZXQucGVuZGluZztcbiAgICAgICAgcmV0dXJuIEFlKHQyLmNvb3Jkcy5jdXIsIGUyKSwgQWUodDIuY29vcmRzLmRlbHRhLCBlMiksIEgodDIuZWRnZXMsIHQyLnJlY3QsIGUyKSwgZTIueCA9IDAsIGUyLnkgPSAwLCB0cnVlO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gemUodDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIueCwgbjIgPSB0Mi55O1xuICAgICAgICB0aGlzLm9mZnNldC5wZW5kaW5nLnggKz0gZTIsIHRoaXMub2Zmc2V0LnBlbmRpbmcueSArPSBuMiwgdGhpcy5vZmZzZXQudG90YWwueCArPSBlMiwgdGhpcy5vZmZzZXQudG90YWwueSArPSBuMjtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIEFlKHQyLCBlMikge1xuICAgICAgICB2YXIgbjIgPSB0Mi5wYWdlLCByMiA9IHQyLmNsaWVudCwgaTIgPSBlMi54LCBvMiA9IGUyLnk7XG4gICAgICAgIG4yLnggKz0gaTIsIG4yLnkgKz0gbzIsIHIyLnggKz0gaTIsIHIyLnkgKz0gbzI7XG4gICAgICB9XG4gICAgICBPZS5vZmZzZXRCeSA9IFwiXCI7XG4gICAgICB2YXIgUmUgPSB7IGlkOiBcIm9mZnNldFwiLCBiZWZvcmU6IFtcIm1vZGlmaWVyc1wiLCBcInBvaW50ZXItZXZlbnRzXCIsIFwiYWN0aW9uc1wiLCBcImluZXJ0aWFcIl0sIGluc3RhbGw6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHQyLkludGVyYWN0aW9uLnByb3RvdHlwZS5vZmZzZXRCeSA9IHplO1xuICAgICAgfSwgbGlzdGVuZXJzOiB7IFwiaW50ZXJhY3Rpb25zOm5ld1wiOiBmdW5jdGlvbih0Mikge1xuICAgICAgICB0Mi5pbnRlcmFjdGlvbi5vZmZzZXQgPSB7IHRvdGFsOiB7IHg6IDAsIHk6IDAgfSwgcGVuZGluZzogeyB4OiAwLCB5OiAwIH0gfTtcbiAgICAgIH0sIFwiaW50ZXJhY3Rpb25zOnVwZGF0ZS1wb2ludGVyXCI6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0Mykge1xuICAgICAgICAgIHQzLnBvaW50ZXJJc0Rvd24gJiYgKEFlKHQzLmNvb3Jkcy5jdXIsIHQzLm9mZnNldC50b3RhbCksIHQzLm9mZnNldC5wZW5kaW5nLnggPSAwLCB0My5vZmZzZXQucGVuZGluZy55ID0gMCk7XG4gICAgICAgIH0odDIuaW50ZXJhY3Rpb24pO1xuICAgICAgfSwgXCJpbnRlcmFjdGlvbnM6YmVmb3JlLWFjdGlvbi1zdGFydFwiOiBJZSwgXCJpbnRlcmFjdGlvbnM6YmVmb3JlLWFjdGlvbi1tb3ZlXCI6IEllLCBcImludGVyYWN0aW9uczpiZWZvcmUtYWN0aW9uLWVuZFwiOiBmdW5jdGlvbih0Mikge1xuICAgICAgICB2YXIgZTIgPSB0Mi5pbnRlcmFjdGlvbjtcbiAgICAgICAgaWYgKE1lKGUyKSkgcmV0dXJuIGUyLm1vdmUoeyBvZmZzZXQ6IHRydWUgfSksIGUyLmVuZCgpLCBmYWxzZTtcbiAgICAgIH0sIFwiaW50ZXJhY3Rpb25zOnN0b3BcIjogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuaW50ZXJhY3Rpb247XG4gICAgICAgIGUyLm9mZnNldC50b3RhbC54ID0gMCwgZTIub2Zmc2V0LnRvdGFsLnkgPSAwLCBlMi5vZmZzZXQucGVuZGluZy54ID0gMCwgZTIub2Zmc2V0LnBlbmRpbmcueSA9IDA7XG4gICAgICB9IH0gfSwgQ2UgPSBSZTtcbiAgICAgIHZhciBqZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBmdW5jdGlvbiB0MihlMikge1xuICAgICAgICAgIHIodGhpcywgdDIpLCB0aGlzLmFjdGl2ZSA9IGZhbHNlLCB0aGlzLmlzTW9kaWZpZWQgPSBmYWxzZSwgdGhpcy5zbW9vdGhFbmQgPSBmYWxzZSwgdGhpcy5hbGxvd1Jlc3VtZSA9IGZhbHNlLCB0aGlzLm1vZGlmaWNhdGlvbiA9IHZvaWQgMCwgdGhpcy5tb2RpZmllckNvdW50ID0gMCwgdGhpcy5tb2RpZmllckFyZyA9IHZvaWQgMCwgdGhpcy5zdGFydENvb3JkcyA9IHZvaWQgMCwgdGhpcy50MCA9IDAsIHRoaXMudjAgPSAwLCB0aGlzLnRlID0gMCwgdGhpcy50YXJnZXRPZmZzZXQgPSB2b2lkIDAsIHRoaXMubW9kaWZpZWRPZmZzZXQgPSB2b2lkIDAsIHRoaXMuY3VycmVudE9mZnNldCA9IHZvaWQgMCwgdGhpcy5sYW1iZGFfdjAgPSAwLCB0aGlzLm9uZV92ZV92MCA9IDAsIHRoaXMudGltZW91dCA9IHZvaWQgMCwgdGhpcy5pbnRlcmFjdGlvbiA9IHZvaWQgMCwgdGhpcy5pbnRlcmFjdGlvbiA9IGUyO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvKHQyLCBbeyBrZXk6IFwic3RhcnRcIiwgdmFsdWU6IGZ1bmN0aW9uKHQzKSB7XG4gICAgICAgICAgdmFyIGUyID0gdGhpcy5pbnRlcmFjdGlvbiwgbjIgPSBGZShlMik7XG4gICAgICAgICAgaWYgKCFuMiB8fCAhbjIuZW5hYmxlZCkgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIHZhciByMiA9IGUyLmNvb3Jkcy52ZWxvY2l0eS5jbGllbnQsIGkyID0gUShyMi54LCByMi55KSwgbzIgPSB0aGlzLm1vZGlmaWNhdGlvbiB8fCAodGhpcy5tb2RpZmljYXRpb24gPSBuZXcgbWUoZTIpKTtcbiAgICAgICAgICBpZiAobzIuY29weUZyb20oZTIubW9kaWZpY2F0aW9uKSwgdGhpcy50MCA9IGUyLl9ub3coKSwgdGhpcy5hbGxvd1Jlc3VtZSA9IG4yLmFsbG93UmVzdW1lLCB0aGlzLnYwID0gaTIsIHRoaXMuY3VycmVudE9mZnNldCA9IHsgeDogMCwgeTogMCB9LCB0aGlzLnN0YXJ0Q29vcmRzID0gZTIuY29vcmRzLmN1ci5wYWdlLCB0aGlzLm1vZGlmaWVyQXJnID0gbzIuZmlsbEFyZyh7IHBhZ2VDb29yZHM6IHRoaXMuc3RhcnRDb29yZHMsIHByZUVuZDogdHJ1ZSwgcGhhc2U6IFwiaW5lcnRpYXN0YXJ0XCIgfSksIHRoaXMudDAgLSBlMi5jb29yZHMuY3VyLnRpbWVTdGFtcCA8IDUwICYmIGkyID4gbjIubWluU3BlZWQgJiYgaTIgPiBuMi5lbmRTcGVlZCkgdGhpcy5zdGFydEluZXJ0aWEoKTtcbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChvMi5yZXN1bHQgPSBvMi5zZXRBbGwodGhpcy5tb2RpZmllckFyZyksICFvMi5yZXN1bHQuY2hhbmdlZCkgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5zdGFydFNtb290aEVuZCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZTIubW9kaWZpY2F0aW9uLnJlc3VsdC5yZWN0ID0gbnVsbCwgZTIub2Zmc2V0QnkodGhpcy50YXJnZXRPZmZzZXQpLCBlMi5fZG9QaGFzZSh7IGludGVyYWN0aW9uOiBlMiwgZXZlbnQ6IHQzLCBwaGFzZTogXCJpbmVydGlhc3RhcnRcIiB9KSwgZTIub2Zmc2V0QnkoeyB4OiAtdGhpcy50YXJnZXRPZmZzZXQueCwgeTogLXRoaXMudGFyZ2V0T2Zmc2V0LnkgfSksIGUyLm1vZGlmaWNhdGlvbi5yZXN1bHQucmVjdCA9IG51bGwsIHRoaXMuYWN0aXZlID0gdHJ1ZSwgZTIuc2ltdWxhdGlvbiA9IHRoaXMsIHRydWU7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwic3RhcnRJbmVydGlhXCIsIHZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgdDMgPSB0aGlzLCBlMiA9IHRoaXMuaW50ZXJhY3Rpb24uY29vcmRzLnZlbG9jaXR5LmNsaWVudCwgbjIgPSBGZSh0aGlzLmludGVyYWN0aW9uKSwgcjIgPSBuMi5yZXNpc3RhbmNlLCBpMiA9IC1NYXRoLmxvZyhuMi5lbmRTcGVlZCAvIHRoaXMudjApIC8gcjI7XG4gICAgICAgICAgdGhpcy50YXJnZXRPZmZzZXQgPSB7IHg6IChlMi54IC0gaTIpIC8gcjIsIHk6IChlMi55IC0gaTIpIC8gcjIgfSwgdGhpcy50ZSA9IGkyLCB0aGlzLmxhbWJkYV92MCA9IHIyIC8gdGhpcy52MCwgdGhpcy5vbmVfdmVfdjAgPSAxIC0gbjIuZW5kU3BlZWQgLyB0aGlzLnYwO1xuICAgICAgICAgIHZhciBvMiA9IHRoaXMubW9kaWZpY2F0aW9uLCBhMiA9IHRoaXMubW9kaWZpZXJBcmc7XG4gICAgICAgICAgYTIucGFnZUNvb3JkcyA9IHsgeDogdGhpcy5zdGFydENvb3Jkcy54ICsgdGhpcy50YXJnZXRPZmZzZXQueCwgeTogdGhpcy5zdGFydENvb3Jkcy55ICsgdGhpcy50YXJnZXRPZmZzZXQueSB9LCBvMi5yZXN1bHQgPSBvMi5zZXRBbGwoYTIpLCBvMi5yZXN1bHQuY2hhbmdlZCAmJiAodGhpcy5pc01vZGlmaWVkID0gdHJ1ZSwgdGhpcy5tb2RpZmllZE9mZnNldCA9IHsgeDogdGhpcy50YXJnZXRPZmZzZXQueCArIG8yLnJlc3VsdC5kZWx0YS54LCB5OiB0aGlzLnRhcmdldE9mZnNldC55ICsgbzIucmVzdWx0LmRlbHRhLnkgfSksIHRoaXMub25OZXh0RnJhbWUoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdDMuaW5lcnRpYVRpY2soKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSB9LCB7IGtleTogXCJzdGFydFNtb290aEVuZFwiLCB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIHQzID0gdGhpcztcbiAgICAgICAgICB0aGlzLnNtb290aEVuZCA9IHRydWUsIHRoaXMuaXNNb2RpZmllZCA9IHRydWUsIHRoaXMudGFyZ2V0T2Zmc2V0ID0geyB4OiB0aGlzLm1vZGlmaWNhdGlvbi5yZXN1bHQuZGVsdGEueCwgeTogdGhpcy5tb2RpZmljYXRpb24ucmVzdWx0LmRlbHRhLnkgfSwgdGhpcy5vbk5leHRGcmFtZShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0My5zbW9vdGhFbmRUaWNrKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwib25OZXh0RnJhbWVcIiwgdmFsdWU6IGZ1bmN0aW9uKHQzKSB7XG4gICAgICAgICAgdmFyIGUyID0gdGhpcztcbiAgICAgICAgICB0aGlzLnRpbWVvdXQgPSBMdC5yZXF1ZXN0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgZTIuYWN0aXZlICYmIHQzKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwiaW5lcnRpYVRpY2tcIiwgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciB0MywgZTIsIG4yLCByMiwgaTIsIG8yLCBhMiwgczIgPSB0aGlzLCBjMiA9IHRoaXMuaW50ZXJhY3Rpb24sIGwyID0gRmUoYzIpLnJlc2lzdGFuY2UsIHUyID0gKGMyLl9ub3coKSAtIHRoaXMudDApIC8gMWUzO1xuICAgICAgICAgIGlmICh1MiA8IHRoaXMudGUpIHtcbiAgICAgICAgICAgIHZhciBwMiwgZjIgPSAxIC0gKE1hdGguZXhwKC1sMiAqIHUyKSAtIHRoaXMubGFtYmRhX3YwKSAvIHRoaXMub25lX3ZlX3YwO1xuICAgICAgICAgICAgdGhpcy5pc01vZGlmaWVkID8gKHQzID0gMCwgZTIgPSAwLCBuMiA9IHRoaXMudGFyZ2V0T2Zmc2V0LngsIHIyID0gdGhpcy50YXJnZXRPZmZzZXQueSwgaTIgPSB0aGlzLm1vZGlmaWVkT2Zmc2V0LngsIG8yID0gdGhpcy5tb2RpZmllZE9mZnNldC55LCBwMiA9IHsgeDogWWUoYTIgPSBmMiwgdDMsIG4yLCBpMiksIHk6IFllKGEyLCBlMiwgcjIsIG8yKSB9KSA6IHAyID0geyB4OiB0aGlzLnRhcmdldE9mZnNldC54ICogZjIsIHk6IHRoaXMudGFyZ2V0T2Zmc2V0LnkgKiBmMiB9O1xuICAgICAgICAgICAgdmFyIGQyID0geyB4OiBwMi54IC0gdGhpcy5jdXJyZW50T2Zmc2V0LngsIHk6IHAyLnkgLSB0aGlzLmN1cnJlbnRPZmZzZXQueSB9O1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50T2Zmc2V0LnggKz0gZDIueCwgdGhpcy5jdXJyZW50T2Zmc2V0LnkgKz0gZDIueSwgYzIub2Zmc2V0QnkoZDIpLCBjMi5tb3ZlKCksIHRoaXMub25OZXh0RnJhbWUoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHJldHVybiBzMi5pbmVydGlhVGljaygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIGMyLm9mZnNldEJ5KHsgeDogdGhpcy5tb2RpZmllZE9mZnNldC54IC0gdGhpcy5jdXJyZW50T2Zmc2V0LngsIHk6IHRoaXMubW9kaWZpZWRPZmZzZXQueSAtIHRoaXMuY3VycmVudE9mZnNldC55IH0pLCB0aGlzLmVuZCgpO1xuICAgICAgICB9IH0sIHsga2V5OiBcInNtb290aEVuZFRpY2tcIiwgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciB0MyA9IHRoaXMsIGUyID0gdGhpcy5pbnRlcmFjdGlvbiwgbjIgPSBlMi5fbm93KCkgLSB0aGlzLnQwLCByMiA9IEZlKGUyKS5zbW9vdGhFbmREdXJhdGlvbjtcbiAgICAgICAgICBpZiAobjIgPCByMikge1xuICAgICAgICAgICAgdmFyIGkyID0geyB4OiBMZShuMiwgMCwgdGhpcy50YXJnZXRPZmZzZXQueCwgcjIpLCB5OiBMZShuMiwgMCwgdGhpcy50YXJnZXRPZmZzZXQueSwgcjIpIH0sIG8yID0geyB4OiBpMi54IC0gdGhpcy5jdXJyZW50T2Zmc2V0LngsIHk6IGkyLnkgLSB0aGlzLmN1cnJlbnRPZmZzZXQueSB9O1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50T2Zmc2V0LnggKz0gbzIueCwgdGhpcy5jdXJyZW50T2Zmc2V0LnkgKz0gbzIueSwgZTIub2Zmc2V0QnkobzIpLCBlMi5tb3ZlKHsgc2tpcE1vZGlmaWVyczogdGhpcy5tb2RpZmllckNvdW50IH0pLCB0aGlzLm9uTmV4dEZyYW1lKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICByZXR1cm4gdDMuc21vb3RoRW5kVGljaygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIGUyLm9mZnNldEJ5KHsgeDogdGhpcy50YXJnZXRPZmZzZXQueCAtIHRoaXMuY3VycmVudE9mZnNldC54LCB5OiB0aGlzLnRhcmdldE9mZnNldC55IC0gdGhpcy5jdXJyZW50T2Zmc2V0LnkgfSksIHRoaXMuZW5kKCk7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwicmVzdW1lXCIsIHZhbHVlOiBmdW5jdGlvbih0Mykge1xuICAgICAgICAgIHZhciBlMiA9IHQzLnBvaW50ZXIsIG4yID0gdDMuZXZlbnQsIHIyID0gdDMuZXZlbnRUYXJnZXQsIGkyID0gdGhpcy5pbnRlcmFjdGlvbjtcbiAgICAgICAgICBpMi5vZmZzZXRCeSh7IHg6IC10aGlzLmN1cnJlbnRPZmZzZXQueCwgeTogLXRoaXMuY3VycmVudE9mZnNldC55IH0pLCBpMi51cGRhdGVQb2ludGVyKGUyLCBuMiwgcjIsIHRydWUpLCBpMi5fZG9QaGFzZSh7IGludGVyYWN0aW9uOiBpMiwgZXZlbnQ6IG4yLCBwaGFzZTogXCJyZXN1bWVcIiB9KSwgZXQoaTIuY29vcmRzLnByZXYsIGkyLmNvb3Jkcy5jdXIpLCB0aGlzLnN0b3AoKTtcbiAgICAgICAgfSB9LCB7IGtleTogXCJlbmRcIiwgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMuaW50ZXJhY3Rpb24ubW92ZSgpLCB0aGlzLmludGVyYWN0aW9uLmVuZCgpLCB0aGlzLnN0b3AoKTtcbiAgICAgICAgfSB9LCB7IGtleTogXCJzdG9wXCIsIHZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aGlzLmFjdGl2ZSA9IHRoaXMuc21vb3RoRW5kID0gZmFsc2UsIHRoaXMuaW50ZXJhY3Rpb24uc2ltdWxhdGlvbiA9IG51bGwsIEx0LmNhbmNlbCh0aGlzLnRpbWVvdXQpO1xuICAgICAgICB9IH1dKSwgdDI7XG4gICAgICB9KCk7XG4gICAgICBmdW5jdGlvbiBGZSh0Mikge1xuICAgICAgICB2YXIgZTIgPSB0Mi5pbnRlcmFjdGFibGUsIG4yID0gdDIucHJlcGFyZWQ7XG4gICAgICAgIHJldHVybiBlMiAmJiBlMi5vcHRpb25zICYmIG4yLm5hbWUgJiYgZTIub3B0aW9uc1tuMi5uYW1lXS5pbmVydGlhO1xuICAgICAgfVxuICAgICAgdmFyIFhlID0geyBpZDogXCJpbmVydGlhXCIsIGJlZm9yZTogW1wibW9kaWZpZXJzXCIsIFwiYWN0aW9uc1wiXSwgaW5zdGFsbDogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuZGVmYXVsdHM7XG4gICAgICAgIHQyLnVzZVBsdWdpbihDZSksIHQyLnVzZVBsdWdpbihFZSksIHQyLmFjdGlvbnMucGhhc2VzLmluZXJ0aWFzdGFydCA9IHRydWUsIHQyLmFjdGlvbnMucGhhc2VzLnJlc3VtZSA9IHRydWUsIGUyLnBlckFjdGlvbi5pbmVydGlhID0geyBlbmFibGVkOiBmYWxzZSwgcmVzaXN0YW5jZTogMTAsIG1pblNwZWVkOiAxMDAsIGVuZFNwZWVkOiAxMCwgYWxsb3dSZXN1bWU6IHRydWUsIHNtb290aEVuZER1cmF0aW9uOiAzMDAgfTtcbiAgICAgIH0sIGxpc3RlbmVyczogeyBcImludGVyYWN0aW9uczpuZXdcIjogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuaW50ZXJhY3Rpb247XG4gICAgICAgIGUyLmluZXJ0aWEgPSBuZXcgamUoZTIpO1xuICAgICAgfSwgXCJpbnRlcmFjdGlvbnM6YmVmb3JlLWFjdGlvbi1lbmRcIjogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuaW50ZXJhY3Rpb24sIG4yID0gdDIuZXZlbnQ7XG4gICAgICAgIHJldHVybiAoIWUyLl9pbnRlcmFjdGluZyB8fCBlMi5zaW11bGF0aW9uIHx8ICFlMi5pbmVydGlhLnN0YXJ0KG4yKSkgJiYgbnVsbDtcbiAgICAgIH0sIFwiaW50ZXJhY3Rpb25zOmRvd25cIjogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuaW50ZXJhY3Rpb24sIG4yID0gdDIuZXZlbnRUYXJnZXQsIHIyID0gZTIuaW5lcnRpYTtcbiAgICAgICAgaWYgKHIyLmFjdGl2ZSkgZm9yICh2YXIgaTIgPSBuMjsgdy5lbGVtZW50KGkyKTsgKSB7XG4gICAgICAgICAgaWYgKGkyID09PSBlMi5lbGVtZW50KSB7XG4gICAgICAgICAgICByMi5yZXN1bWUodDIpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIGkyID0gQShpMik7XG4gICAgICAgIH1cbiAgICAgIH0sIFwiaW50ZXJhY3Rpb25zOnN0b3BcIjogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuaW50ZXJhY3Rpb24uaW5lcnRpYTtcbiAgICAgICAgZTIuYWN0aXZlICYmIGUyLnN0b3AoKTtcbiAgICAgIH0sIFwiaW50ZXJhY3Rpb25zOmJlZm9yZS1hY3Rpb24tcmVzdW1lXCI6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHZhciBlMiA9IHQyLmludGVyYWN0aW9uLm1vZGlmaWNhdGlvbjtcbiAgICAgICAgZTIuc3RvcCh0MiksIGUyLnN0YXJ0KHQyLCB0Mi5pbnRlcmFjdGlvbi5jb29yZHMuY3VyLnBhZ2UpLCBlMi5hcHBseVRvSW50ZXJhY3Rpb24odDIpO1xuICAgICAgfSwgXCJpbnRlcmFjdGlvbnM6YmVmb3JlLWFjdGlvbi1pbmVydGlhc3RhcnRcIjogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgcmV0dXJuIHQyLmludGVyYWN0aW9uLm1vZGlmaWNhdGlvbi5zZXRBbmRBcHBseSh0Mik7XG4gICAgICB9LCBcImludGVyYWN0aW9uczphY3Rpb24tcmVzdW1lXCI6IHhlLCBcImludGVyYWN0aW9uczphY3Rpb24taW5lcnRpYXN0YXJ0XCI6IHhlLCBcImludGVyYWN0aW9uczphZnRlci1hY3Rpb24taW5lcnRpYXN0YXJ0XCI6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHJldHVybiB0Mi5pbnRlcmFjdGlvbi5tb2RpZmljYXRpb24ucmVzdG9yZUludGVyYWN0aW9uQ29vcmRzKHQyKTtcbiAgICAgIH0sIFwiaW50ZXJhY3Rpb25zOmFmdGVyLWFjdGlvbi1yZXN1bWVcIjogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgcmV0dXJuIHQyLmludGVyYWN0aW9uLm1vZGlmaWNhdGlvbi5yZXN0b3JlSW50ZXJhY3Rpb25Db29yZHModDIpO1xuICAgICAgfSB9IH07XG4gICAgICBmdW5jdGlvbiBZZSh0MiwgZTIsIG4yLCByMikge1xuICAgICAgICB2YXIgaTIgPSAxIC0gdDI7XG4gICAgICAgIHJldHVybiBpMiAqIGkyICogZTIgKyAyICogaTIgKiB0MiAqIG4yICsgdDIgKiB0MiAqIHIyO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gTGUodDIsIGUyLCBuMiwgcjIpIHtcbiAgICAgICAgcmV0dXJuIC1uMiAqICh0MiAvPSByMikgKiAodDIgLSAyKSArIGUyO1xuICAgICAgfVxuICAgICAgdmFyIHFlID0gWGU7XG4gICAgICBmdW5jdGlvbiBCZSh0MiwgZTIpIHtcbiAgICAgICAgZm9yICh2YXIgbjIgPSAwOyBuMiA8IGUyLmxlbmd0aDsgbjIrKykge1xuICAgICAgICAgIHZhciByMiA9IGUyW24yXTtcbiAgICAgICAgICBpZiAodDIuaW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKSBicmVhaztcbiAgICAgICAgICByMih0Mik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHZhciBWZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBmdW5jdGlvbiB0MihlMikge1xuICAgICAgICAgIHIodGhpcywgdDIpLCB0aGlzLm9wdGlvbnMgPSB2b2lkIDAsIHRoaXMudHlwZXMgPSB7fSwgdGhpcy5wcm9wYWdhdGlvblN0b3BwZWQgPSBmYWxzZSwgdGhpcy5pbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQgPSBmYWxzZSwgdGhpcy5nbG9iYWwgPSB2b2lkIDAsIHRoaXMub3B0aW9ucyA9IFYoe30sIGUyIHx8IHt9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbyh0MiwgW3sga2V5OiBcImZpcmVcIiwgdmFsdWU6IGZ1bmN0aW9uKHQzKSB7XG4gICAgICAgICAgdmFyIGUyLCBuMiA9IHRoaXMuZ2xvYmFsO1xuICAgICAgICAgIChlMiA9IHRoaXMudHlwZXNbdDMudHlwZV0pICYmIEJlKHQzLCBlMiksICF0My5wcm9wYWdhdGlvblN0b3BwZWQgJiYgbjIgJiYgKGUyID0gbjJbdDMudHlwZV0pICYmIEJlKHQzLCBlMik7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwib25cIiwgdmFsdWU6IGZ1bmN0aW9uKHQzLCBlMikge1xuICAgICAgICAgIHZhciBuMiA9ICQodDMsIGUyKTtcbiAgICAgICAgICBmb3IgKHQzIGluIG4yKSB0aGlzLnR5cGVzW3QzXSA9IGd0KHRoaXMudHlwZXNbdDNdIHx8IFtdLCBuMlt0M10pO1xuICAgICAgICB9IH0sIHsga2V5OiBcIm9mZlwiLCB2YWx1ZTogZnVuY3Rpb24odDMsIGUyKSB7XG4gICAgICAgICAgdmFyIG4yID0gJCh0MywgZTIpO1xuICAgICAgICAgIGZvciAodDMgaW4gbjIpIHtcbiAgICAgICAgICAgIHZhciByMiA9IHRoaXMudHlwZXNbdDNdO1xuICAgICAgICAgICAgaWYgKHIyICYmIHIyLmxlbmd0aCkgZm9yICh2YXIgaTIgPSAwLCBvMiA9IG4yW3QzXTsgaTIgPCBvMi5sZW5ndGg7IGkyKyspIHtcbiAgICAgICAgICAgICAgdmFyIGEyID0gbzJbaTJdLCBzMiA9IHIyLmluZGV4T2YoYTIpO1xuICAgICAgICAgICAgICAtMSAhPT0gczIgJiYgcjIuc3BsaWNlKHMyLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gfSwgeyBrZXk6IFwiZ2V0UmVjdFwiLCB2YWx1ZTogZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfSB9XSksIHQyO1xuICAgICAgfSgpO1xuICAgICAgdmFyIFdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGZ1bmN0aW9uIHQyKGUyKSB7XG4gICAgICAgICAgcih0aGlzLCB0MiksIHRoaXMuY3VycmVudFRhcmdldCA9IHZvaWQgMCwgdGhpcy5vcmlnaW5hbEV2ZW50ID0gdm9pZCAwLCB0aGlzLnR5cGUgPSB2b2lkIDAsIHRoaXMub3JpZ2luYWxFdmVudCA9IGUyLCB0dCh0aGlzLCBlMik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG8odDIsIFt7IGtleTogXCJwcmV2ZW50T3JpZ2luYWxEZWZhdWx0XCIsIHZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aGlzLm9yaWdpbmFsRXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfSB9LCB7IGtleTogXCJzdG9wUHJvcGFnYXRpb25cIiwgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMub3JpZ2luYWxFdmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgfSB9LCB7IGtleTogXCJzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb25cIiwgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMub3JpZ2luYWxFdmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgfSB9XSksIHQyO1xuICAgICAgfSgpO1xuICAgICAgZnVuY3Rpb24gR2UodDIpIHtcbiAgICAgICAgcmV0dXJuIHcub2JqZWN0KHQyKSA/IHsgY2FwdHVyZTogISF0Mi5jYXB0dXJlLCBwYXNzaXZlOiAhIXQyLnBhc3NpdmUgfSA6IHsgY2FwdHVyZTogISF0MiwgcGFzc2l2ZTogZmFsc2UgfTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIE5lKHQyLCBlMikge1xuICAgICAgICByZXR1cm4gdDIgPT09IGUyIHx8IChcImJvb2xlYW5cIiA9PSB0eXBlb2YgdDIgPyAhIWUyLmNhcHR1cmUgPT09IHQyICYmIGZhbHNlID09ICEhZTIucGFzc2l2ZSA6ICEhdDIuY2FwdHVyZSA9PSAhIWUyLmNhcHR1cmUgJiYgISF0Mi5wYXNzaXZlID09ICEhZTIucGFzc2l2ZSk7XG4gICAgICB9XG4gICAgICB2YXIgVWUgPSB7IGlkOiBcImV2ZW50c1wiLCBpbnN0YWxsOiBmdW5jdGlvbih0Mikge1xuICAgICAgICB2YXIgZTIsIG4yID0gW10sIHIyID0ge30sIGkyID0gW10sIG8yID0geyBhZGQ6IGEyLCByZW1vdmU6IHMyLCBhZGREZWxlZ2F0ZTogZnVuY3Rpb24odDMsIGUzLCBuMywgbzMsIHMzKSB7XG4gICAgICAgICAgdmFyIHUyID0gR2UoczMpO1xuICAgICAgICAgIGlmICghcjJbbjNdKSB7XG4gICAgICAgICAgICByMltuM10gPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIHAyID0gMDsgcDIgPCBpMi5sZW5ndGg7IHAyKyspIHtcbiAgICAgICAgICAgICAgdmFyIGYyID0gaTJbcDJdO1xuICAgICAgICAgICAgICBhMihmMiwgbjMsIGMyKSwgYTIoZjIsIG4zLCBsMiwgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBkMiA9IHIyW24zXSwgaDIgPSBidChkMiwgZnVuY3Rpb24objQpIHtcbiAgICAgICAgICAgIHJldHVybiBuNC5zZWxlY3RvciA9PT0gdDMgJiYgbjQuY29udGV4dCA9PT0gZTM7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaDIgfHwgKGgyID0geyBzZWxlY3RvcjogdDMsIGNvbnRleHQ6IGUzLCBsaXN0ZW5lcnM6IFtdIH0sIGQyLnB1c2goaDIpKTtcbiAgICAgICAgICBoMi5saXN0ZW5lcnMucHVzaCh7IGZ1bmM6IG8zLCBvcHRpb25zOiB1MiB9KTtcbiAgICAgICAgfSwgcmVtb3ZlRGVsZWdhdGU6IGZ1bmN0aW9uKHQzLCBlMywgbjMsIGkzLCBvMykge1xuICAgICAgICAgIHZhciBhMywgdTIgPSBHZShvMyksIHAyID0gcjJbbjNdLCBmMiA9IGZhbHNlO1xuICAgICAgICAgIGlmICghcDIpIHJldHVybjtcbiAgICAgICAgICBmb3IgKGEzID0gcDIubGVuZ3RoIC0gMTsgYTMgPj0gMDsgYTMtLSkge1xuICAgICAgICAgICAgdmFyIGQyID0gcDJbYTNdO1xuICAgICAgICAgICAgaWYgKGQyLnNlbGVjdG9yID09PSB0MyAmJiBkMi5jb250ZXh0ID09PSBlMykge1xuICAgICAgICAgICAgICBmb3IgKHZhciBoMiA9IGQyLmxpc3RlbmVycywgdjIgPSBoMi5sZW5ndGggLSAxOyB2MiA+PSAwOyB2Mi0tKSB7XG4gICAgICAgICAgICAgICAgdmFyIGcyID0gaDJbdjJdO1xuICAgICAgICAgICAgICAgIGlmIChnMi5mdW5jID09PSBpMyAmJiBOZShnMi5vcHRpb25zLCB1MikpIHtcbiAgICAgICAgICAgICAgICAgIGgyLnNwbGljZSh2MiwgMSksIGgyLmxlbmd0aCB8fCAocDIuc3BsaWNlKGEzLCAxKSwgczIoZTMsIG4zLCBjMiksIHMyKGUzLCBuMywgbDIsIHRydWUpKSwgZjIgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGlmIChmMikgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBkZWxlZ2F0ZUxpc3RlbmVyOiBjMiwgZGVsZWdhdGVVc2VDYXB0dXJlOiBsMiwgZGVsZWdhdGVkRXZlbnRzOiByMiwgZG9jdW1lbnRzOiBpMiwgdGFyZ2V0czogbjIsIHN1cHBvcnRzT3B0aW9uczogZmFsc2UsIHN1cHBvcnRzUGFzc2l2ZTogZmFsc2UgfTtcbiAgICAgICAgZnVuY3Rpb24gYTIodDMsIGUzLCByMywgaTMpIHtcbiAgICAgICAgICBpZiAodDMuYWRkRXZlbnRMaXN0ZW5lcikge1xuICAgICAgICAgICAgdmFyIGEzID0gR2UoaTMpLCBzMyA9IGJ0KG4yLCBmdW5jdGlvbihlNCkge1xuICAgICAgICAgICAgICByZXR1cm4gZTQuZXZlbnRUYXJnZXQgPT09IHQzO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzMyB8fCAoczMgPSB7IGV2ZW50VGFyZ2V0OiB0MywgZXZlbnRzOiB7fSB9LCBuMi5wdXNoKHMzKSksIHMzLmV2ZW50c1tlM10gfHwgKHMzLmV2ZW50c1tlM10gPSBbXSksIGJ0KHMzLmV2ZW50c1tlM10sIGZ1bmN0aW9uKHQ0KSB7XG4gICAgICAgICAgICAgIHJldHVybiB0NC5mdW5jID09PSByMyAmJiBOZSh0NC5vcHRpb25zLCBhMyk7XG4gICAgICAgICAgICB9KSB8fCAodDMuYWRkRXZlbnRMaXN0ZW5lcihlMywgcjMsIG8yLnN1cHBvcnRzT3B0aW9ucyA/IGEzIDogYTMuY2FwdHVyZSksIHMzLmV2ZW50c1tlM10ucHVzaCh7IGZ1bmM6IHIzLCBvcHRpb25zOiBhMyB9KSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHMyKHQzLCBlMywgcjMsIGkzKSB7XG4gICAgICAgICAgaWYgKHQzLmFkZEV2ZW50TGlzdGVuZXIgJiYgdDMucmVtb3ZlRXZlbnRMaXN0ZW5lcikge1xuICAgICAgICAgICAgdmFyIGEzID0geXQobjIsIGZ1bmN0aW9uKGU0KSB7XG4gICAgICAgICAgICAgIHJldHVybiBlNC5ldmVudFRhcmdldCA9PT0gdDM7XG4gICAgICAgICAgICB9KSwgYzMgPSBuMlthM107XG4gICAgICAgICAgICBpZiAoYzMgJiYgYzMuZXZlbnRzKSBpZiAoXCJhbGxcIiAhPT0gZTMpIHtcbiAgICAgICAgICAgICAgdmFyIGwzID0gZmFsc2UsIHUyID0gYzMuZXZlbnRzW2UzXTtcbiAgICAgICAgICAgICAgaWYgKHUyKSB7XG4gICAgICAgICAgICAgICAgaWYgKFwiYWxsXCIgPT09IHIzKSB7XG4gICAgICAgICAgICAgICAgICBmb3IgKHZhciBwMiA9IHUyLmxlbmd0aCAtIDE7IHAyID49IDA7IHAyLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGYyID0gdTJbcDJdO1xuICAgICAgICAgICAgICAgICAgICBzMih0MywgZTMsIGYyLmZ1bmMsIGYyLm9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBkMiA9IEdlKGkzKSwgaDIgPSAwOyBoMiA8IHUyLmxlbmd0aDsgaDIrKykge1xuICAgICAgICAgICAgICAgICAgdmFyIHYyID0gdTJbaDJdO1xuICAgICAgICAgICAgICAgICAgaWYgKHYyLmZ1bmMgPT09IHIzICYmIE5lKHYyLm9wdGlvbnMsIGQyKSkge1xuICAgICAgICAgICAgICAgICAgICB0My5yZW1vdmVFdmVudExpc3RlbmVyKGUzLCByMywgbzIuc3VwcG9ydHNPcHRpb25zID8gZDIgOiBkMi5jYXB0dXJlKSwgdTIuc3BsaWNlKGgyLCAxKSwgMCA9PT0gdTIubGVuZ3RoICYmIChkZWxldGUgYzMuZXZlbnRzW2UzXSwgbDMgPSB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGwzICYmICFPYmplY3Qua2V5cyhjMy5ldmVudHMpLmxlbmd0aCAmJiBuMi5zcGxpY2UoYTMsIDEpO1xuICAgICAgICAgICAgfSBlbHNlIGZvciAoZTMgaW4gYzMuZXZlbnRzKSBjMy5ldmVudHMuaGFzT3duUHJvcGVydHkoZTMpICYmIHMyKHQzLCBlMywgXCJhbGxcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGMyKHQzLCBlMykge1xuICAgICAgICAgIGZvciAodmFyIG4zID0gR2UoZTMpLCBpMyA9IG5ldyBXZSh0MyksIG8zID0gcjJbdDMudHlwZV0sIGEzID0gaHQodDMpWzBdLCBzMyA9IGEzOyB3LmVsZW1lbnQoczMpOyApIHtcbiAgICAgICAgICAgIGZvciAodmFyIGMzID0gMDsgYzMgPCBvMy5sZW5ndGg7IGMzKyspIHtcbiAgICAgICAgICAgICAgdmFyIGwzID0gbzNbYzNdLCB1MiA9IGwzLnNlbGVjdG9yLCBwMiA9IGwzLmNvbnRleHQ7XG4gICAgICAgICAgICAgIGlmIChSKHMzLCB1MikgJiYgTShwMiwgYTMpICYmIE0ocDIsIHMzKSkge1xuICAgICAgICAgICAgICAgIHZhciBmMiA9IGwzLmxpc3RlbmVycztcbiAgICAgICAgICAgICAgICBpMy5jdXJyZW50VGFyZ2V0ID0gczM7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgZDIgPSAwOyBkMiA8IGYyLmxlbmd0aDsgZDIrKykge1xuICAgICAgICAgICAgICAgICAgdmFyIGgyID0gZjJbZDJdO1xuICAgICAgICAgICAgICAgICAgTmUoaDIub3B0aW9ucywgbjMpICYmIGgyLmZ1bmMoaTMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgczMgPSBBKHMzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gbDIodDMpIHtcbiAgICAgICAgICByZXR1cm4gYzIodDMsIHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsID09IChlMiA9IHQyLmRvY3VtZW50KSB8fCBlMi5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJ0ZXN0XCIsIG51bGwsIHsgZ2V0IGNhcHR1cmUoKSB7XG4gICAgICAgICAgcmV0dXJuIG8yLnN1cHBvcnRzT3B0aW9ucyA9IHRydWU7XG4gICAgICAgIH0sIGdldCBwYXNzaXZlKCkge1xuICAgICAgICAgIHJldHVybiBvMi5zdXBwb3J0c1Bhc3NpdmUgPSB0cnVlO1xuICAgICAgICB9IH0pLCB0Mi5ldmVudHMgPSBvMiwgbzI7XG4gICAgICB9IH0sIEhlID0geyBtZXRob2RPcmRlcjogW1wic2ltdWxhdGlvblJlc3VtZVwiLCBcIm1vdXNlT3JQZW5cIiwgXCJoYXNQb2ludGVyXCIsIFwiaWRsZVwiXSwgc2VhcmNoOiBmdW5jdGlvbih0Mikge1xuICAgICAgICBmb3IgKHZhciBlMiA9IDAsIG4yID0gSGUubWV0aG9kT3JkZXI7IGUyIDwgbjIubGVuZ3RoOyBlMisrKSB7XG4gICAgICAgICAgdmFyIHIyID0gbjJbZTJdLCBpMiA9IEhlW3IyXSh0Mik7XG4gICAgICAgICAgaWYgKGkyKSByZXR1cm4gaTI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9LCBzaW11bGF0aW9uUmVzdW1lOiBmdW5jdGlvbih0Mikge1xuICAgICAgICB2YXIgZTIgPSB0Mi5wb2ludGVyVHlwZSwgbjIgPSB0Mi5ldmVudFR5cGUsIHIyID0gdDIuZXZlbnRUYXJnZXQsIGkyID0gdDIuc2NvcGU7XG4gICAgICAgIGlmICghL2Rvd258c3RhcnQvaS50ZXN0KG4yKSkgcmV0dXJuIG51bGw7XG4gICAgICAgIGZvciAodmFyIG8yID0gMCwgYTIgPSBpMi5pbnRlcmFjdGlvbnMubGlzdDsgbzIgPCBhMi5sZW5ndGg7IG8yKyspIHtcbiAgICAgICAgICB2YXIgczIgPSBhMltvMl0sIGMyID0gcjI7XG4gICAgICAgICAgaWYgKHMyLnNpbXVsYXRpb24gJiYgczIuc2ltdWxhdGlvbi5hbGxvd1Jlc3VtZSAmJiBzMi5wb2ludGVyVHlwZSA9PT0gZTIpIGZvciAoOyBjMjsgKSB7XG4gICAgICAgICAgICBpZiAoYzIgPT09IHMyLmVsZW1lbnQpIHJldHVybiBzMjtcbiAgICAgICAgICAgIGMyID0gQShjMik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfSwgbW91c2VPclBlbjogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyLCBuMiA9IHQyLnBvaW50ZXJJZCwgcjIgPSB0Mi5wb2ludGVyVHlwZSwgaTIgPSB0Mi5ldmVudFR5cGUsIG8yID0gdDIuc2NvcGU7XG4gICAgICAgIGlmIChcIm1vdXNlXCIgIT09IHIyICYmIFwicGVuXCIgIT09IHIyKSByZXR1cm4gbnVsbDtcbiAgICAgICAgZm9yICh2YXIgYTIgPSAwLCBzMiA9IG8yLmludGVyYWN0aW9ucy5saXN0OyBhMiA8IHMyLmxlbmd0aDsgYTIrKykge1xuICAgICAgICAgIHZhciBjMiA9IHMyW2EyXTtcbiAgICAgICAgICBpZiAoYzIucG9pbnRlclR5cGUgPT09IHIyKSB7XG4gICAgICAgICAgICBpZiAoYzIuc2ltdWxhdGlvbiAmJiAhS2UoYzIsIG4yKSkgY29udGludWU7XG4gICAgICAgICAgICBpZiAoYzIuaW50ZXJhY3RpbmcoKSkgcmV0dXJuIGMyO1xuICAgICAgICAgICAgZTIgfHwgKGUyID0gYzIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZTIpIHJldHVybiBlMjtcbiAgICAgICAgZm9yICh2YXIgbDIgPSAwLCB1MiA9IG8yLmludGVyYWN0aW9ucy5saXN0OyBsMiA8IHUyLmxlbmd0aDsgbDIrKykge1xuICAgICAgICAgIHZhciBwMiA9IHUyW2wyXTtcbiAgICAgICAgICBpZiAoIShwMi5wb2ludGVyVHlwZSAhPT0gcjIgfHwgL2Rvd24vaS50ZXN0KGkyKSAmJiBwMi5zaW11bGF0aW9uKSkgcmV0dXJuIHAyO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfSwgaGFzUG9pbnRlcjogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgZm9yICh2YXIgZTIgPSB0Mi5wb2ludGVySWQsIG4yID0gMCwgcjIgPSB0Mi5zY29wZS5pbnRlcmFjdGlvbnMubGlzdDsgbjIgPCByMi5sZW5ndGg7IG4yKyspIHtcbiAgICAgICAgICB2YXIgaTIgPSByMltuMl07XG4gICAgICAgICAgaWYgKEtlKGkyLCBlMikpIHJldHVybiBpMjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH0sIGlkbGU6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIGZvciAodmFyIGUyID0gdDIucG9pbnRlclR5cGUsIG4yID0gMCwgcjIgPSB0Mi5zY29wZS5pbnRlcmFjdGlvbnMubGlzdDsgbjIgPCByMi5sZW5ndGg7IG4yKyspIHtcbiAgICAgICAgICB2YXIgaTIgPSByMltuMl07XG4gICAgICAgICAgaWYgKDEgPT09IGkyLnBvaW50ZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIG8yID0gaTIuaW50ZXJhY3RhYmxlO1xuICAgICAgICAgICAgaWYgKG8yICYmICghbzIub3B0aW9ucy5nZXN0dXJlIHx8ICFvMi5vcHRpb25zLmdlc3R1cmUuZW5hYmxlZCkpIGNvbnRpbnVlO1xuICAgICAgICAgIH0gZWxzZSBpZiAoaTIucG9pbnRlcnMubGVuZ3RoID49IDIpIGNvbnRpbnVlO1xuICAgICAgICAgIGlmICghaTIuaW50ZXJhY3RpbmcoKSAmJiBlMiA9PT0gaTIucG9pbnRlclR5cGUpIHJldHVybiBpMjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH0gfTtcbiAgICAgIGZ1bmN0aW9uIEtlKHQyLCBlMikge1xuICAgICAgICByZXR1cm4gdDIucG9pbnRlcnMuc29tZShmdW5jdGlvbih0Mykge1xuICAgICAgICAgIHJldHVybiB0My5pZCA9PT0gZTI7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgdmFyICRlID0gSGUsIEplID0gW1wicG9pbnRlckRvd25cIiwgXCJwb2ludGVyTW92ZVwiLCBcInBvaW50ZXJVcFwiLCBcInVwZGF0ZVBvaW50ZXJcIiwgXCJyZW1vdmVQb2ludGVyXCIsIFwid2luZG93Qmx1clwiXTtcbiAgICAgIGZ1bmN0aW9uIFFlKHQyLCBlMikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24objIpIHtcbiAgICAgICAgICB2YXIgcjIgPSBlMi5pbnRlcmFjdGlvbnMubGlzdCwgaTIgPSBkdChuMiksIG8yID0gaHQobjIpLCBhMiA9IG8yWzBdLCBzMiA9IG8yWzFdLCBjMiA9IFtdO1xuICAgICAgICAgIGlmICgvXnRvdWNoLy50ZXN0KG4yLnR5cGUpKSB7XG4gICAgICAgICAgICBlMi5wcmV2VG91Y2hUaW1lID0gZTIubm93KCk7XG4gICAgICAgICAgICBmb3IgKHZhciBsMiA9IDAsIHUyID0gbjIuY2hhbmdlZFRvdWNoZXM7IGwyIDwgdTIubGVuZ3RoOyBsMisrKSB7XG4gICAgICAgICAgICAgIHZhciBwMiA9IHUyW2wyXSwgZjIgPSB7IHBvaW50ZXI6IHAyLCBwb2ludGVySWQ6IGF0KHAyKSwgcG9pbnRlclR5cGU6IGkyLCBldmVudFR5cGU6IG4yLnR5cGUsIGV2ZW50VGFyZ2V0OiBhMiwgY3VyRXZlbnRUYXJnZXQ6IHMyLCBzY29wZTogZTIgfSwgZDIgPSBaZShmMik7XG4gICAgICAgICAgICAgIGMyLnB1c2goW2YyLnBvaW50ZXIsIGYyLmV2ZW50VGFyZ2V0LCBmMi5jdXJFdmVudFRhcmdldCwgZDJdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIGgyID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAoIUkuc3VwcG9ydHNQb2ludGVyRXZlbnQgJiYgL21vdXNlLy50ZXN0KG4yLnR5cGUpKSB7XG4gICAgICAgICAgICAgIGZvciAodmFyIHYyID0gMDsgdjIgPCByMi5sZW5ndGggJiYgIWgyOyB2MisrKSBoMiA9IFwibW91c2VcIiAhPT0gcjJbdjJdLnBvaW50ZXJUeXBlICYmIHIyW3YyXS5wb2ludGVySXNEb3duO1xuICAgICAgICAgICAgICBoMiA9IGgyIHx8IGUyLm5vdygpIC0gZTIucHJldlRvdWNoVGltZSA8IDUwMCB8fCAwID09PSBuMi50aW1lU3RhbXA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWgyKSB7XG4gICAgICAgICAgICAgIHZhciBnMiA9IHsgcG9pbnRlcjogbjIsIHBvaW50ZXJJZDogYXQobjIpLCBwb2ludGVyVHlwZTogaTIsIGV2ZW50VHlwZTogbjIudHlwZSwgY3VyRXZlbnRUYXJnZXQ6IHMyLCBldmVudFRhcmdldDogYTIsIHNjb3BlOiBlMiB9LCBtMiA9IFplKGcyKTtcbiAgICAgICAgICAgICAgYzIucHVzaChbZzIucG9pbnRlciwgZzIuZXZlbnRUYXJnZXQsIGcyLmN1ckV2ZW50VGFyZ2V0LCBtMl0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBmb3IgKHZhciB5MiA9IDA7IHkyIDwgYzIubGVuZ3RoOyB5MisrKSB7XG4gICAgICAgICAgICB2YXIgYjIgPSBjMlt5Ml0sIHgyID0gYjJbMF0sIHcyID0gYjJbMV0sIEUyID0gYjJbMl07XG4gICAgICAgICAgICBiMlszXVt0Ml0oeDIsIG4yLCB3MiwgRTIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIFplKHQyKSB7XG4gICAgICAgIHZhciBlMiA9IHQyLnBvaW50ZXJUeXBlLCBuMiA9IHQyLnNjb3BlLCByMiA9IHsgaW50ZXJhY3Rpb246ICRlLnNlYXJjaCh0MiksIHNlYXJjaERldGFpbHM6IHQyIH07XG4gICAgICAgIHJldHVybiBuMi5maXJlKFwiaW50ZXJhY3Rpb25zOmZpbmRcIiwgcjIpLCByMi5pbnRlcmFjdGlvbiB8fCBuMi5pbnRlcmFjdGlvbnMubmV3KHsgcG9pbnRlclR5cGU6IGUyIH0pO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gdG4odDIsIGUyKSB7XG4gICAgICAgIHZhciBuMiA9IHQyLmRvYywgcjIgPSB0Mi5zY29wZSwgaTIgPSB0Mi5vcHRpb25zLCBvMiA9IHIyLmludGVyYWN0aW9ucy5kb2NFdmVudHMsIGEyID0gcjIuZXZlbnRzLCBzMiA9IGEyW2UyXTtcbiAgICAgICAgZm9yICh2YXIgYzIgaW4gcjIuYnJvd3Nlci5pc0lPUyAmJiAhaTIuZXZlbnRzICYmIChpMi5ldmVudHMgPSB7IHBhc3NpdmU6IGZhbHNlIH0pLCBhMi5kZWxlZ2F0ZWRFdmVudHMpIHMyKG4yLCBjMiwgYTIuZGVsZWdhdGVMaXN0ZW5lciksIHMyKG4yLCBjMiwgYTIuZGVsZWdhdGVVc2VDYXB0dXJlLCB0cnVlKTtcbiAgICAgICAgZm9yICh2YXIgbDIgPSBpMiAmJiBpMi5ldmVudHMsIHUyID0gMDsgdTIgPCBvMi5sZW5ndGg7IHUyKyspIHtcbiAgICAgICAgICB2YXIgcDIgPSBvMlt1Ml07XG4gICAgICAgICAgczIobjIsIHAyLnR5cGUsIHAyLmxpc3RlbmVyLCBsMik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHZhciBlbiA9IHsgaWQ6IFwiY29yZS9pbnRlcmFjdGlvbnNcIiwgaW5zdGFsbDogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgZm9yICh2YXIgZTIgPSB7fSwgbjIgPSAwOyBuMiA8IEplLmxlbmd0aDsgbjIrKykge1xuICAgICAgICAgIHZhciBpMiA9IEplW24yXTtcbiAgICAgICAgICBlMltpMl0gPSBRZShpMiwgdDIpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhMiwgYzIgPSBJLnBFdmVudFR5cGVzO1xuICAgICAgICBmdW5jdGlvbiBsMigpIHtcbiAgICAgICAgICBmb3IgKHZhciBlMyA9IDAsIG4zID0gdDIuaW50ZXJhY3Rpb25zLmxpc3Q7IGUzIDwgbjMubGVuZ3RoOyBlMysrKSB7XG4gICAgICAgICAgICB2YXIgcjIgPSBuM1tlM107XG4gICAgICAgICAgICBpZiAocjIucG9pbnRlcklzRG93biAmJiBcInRvdWNoXCIgPT09IHIyLnBvaW50ZXJUeXBlICYmICFyMi5faW50ZXJhY3RpbmcpIGZvciAodmFyIGkzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHZhciBlNCA9IGEzW28yXTtcbiAgICAgICAgICAgICAgdDIuZG9jdW1lbnRzLnNvbWUoZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gTSh0My5kb2MsIGU0LmRvd25UYXJnZXQpO1xuICAgICAgICAgICAgICB9KSB8fCByMi5yZW1vdmVQb2ludGVyKGU0LnBvaW50ZXIsIGU0LmV2ZW50KTtcbiAgICAgICAgICAgIH0sIG8yID0gMCwgYTMgPSByMi5wb2ludGVyczsgbzIgPCBhMy5sZW5ndGg7IG8yKyspIGkzKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIChhMiA9IGsuUG9pbnRlckV2ZW50ID8gW3sgdHlwZTogYzIuZG93biwgbGlzdGVuZXI6IGwyIH0sIHsgdHlwZTogYzIuZG93biwgbGlzdGVuZXI6IGUyLnBvaW50ZXJEb3duIH0sIHsgdHlwZTogYzIubW92ZSwgbGlzdGVuZXI6IGUyLnBvaW50ZXJNb3ZlIH0sIHsgdHlwZTogYzIudXAsIGxpc3RlbmVyOiBlMi5wb2ludGVyVXAgfSwgeyB0eXBlOiBjMi5jYW5jZWwsIGxpc3RlbmVyOiBlMi5wb2ludGVyVXAgfV0gOiBbeyB0eXBlOiBcIm1vdXNlZG93blwiLCBsaXN0ZW5lcjogZTIucG9pbnRlckRvd24gfSwgeyB0eXBlOiBcIm1vdXNlbW92ZVwiLCBsaXN0ZW5lcjogZTIucG9pbnRlck1vdmUgfSwgeyB0eXBlOiBcIm1vdXNldXBcIiwgbGlzdGVuZXI6IGUyLnBvaW50ZXJVcCB9LCB7IHR5cGU6IFwidG91Y2hzdGFydFwiLCBsaXN0ZW5lcjogbDIgfSwgeyB0eXBlOiBcInRvdWNoc3RhcnRcIiwgbGlzdGVuZXI6IGUyLnBvaW50ZXJEb3duIH0sIHsgdHlwZTogXCJ0b3VjaG1vdmVcIiwgbGlzdGVuZXI6IGUyLnBvaW50ZXJNb3ZlIH0sIHsgdHlwZTogXCJ0b3VjaGVuZFwiLCBsaXN0ZW5lcjogZTIucG9pbnRlclVwIH0sIHsgdHlwZTogXCJ0b3VjaGNhbmNlbFwiLCBsaXN0ZW5lcjogZTIucG9pbnRlclVwIH1dKS5wdXNoKHsgdHlwZTogXCJibHVyXCIsIGxpc3RlbmVyOiBmdW5jdGlvbihlMykge1xuICAgICAgICAgIGZvciAodmFyIG4zID0gMCwgcjIgPSB0Mi5pbnRlcmFjdGlvbnMubGlzdDsgbjMgPCByMi5sZW5ndGg7IG4zKyspIHtcbiAgICAgICAgICAgIHIyW24zXS5kb2N1bWVudEJsdXIoZTMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSB9KSwgdDIucHJldlRvdWNoVGltZSA9IDAsIHQyLkludGVyYWN0aW9uID0gZnVuY3Rpb24oZTMpIHtcbiAgICAgICAgICBzKGkzLCBlMyk7XG4gICAgICAgICAgdmFyIG4zID0gcChpMyk7XG4gICAgICAgICAgZnVuY3Rpb24gaTMoKSB7XG4gICAgICAgICAgICByZXR1cm4gcih0aGlzLCBpMyksIG4zLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBvKGkzLCBbeyBrZXk6IFwicG9pbnRlck1vdmVUb2xlcmFuY2VcIiwgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0Mi5pbnRlcmFjdGlvbnMucG9pbnRlck1vdmVUb2xlcmFuY2U7XG4gICAgICAgICAgfSwgc2V0OiBmdW5jdGlvbihlNCkge1xuICAgICAgICAgICAgdDIuaW50ZXJhY3Rpb25zLnBvaW50ZXJNb3ZlVG9sZXJhbmNlID0gZTQ7XG4gICAgICAgICAgfSB9LCB7IGtleTogXCJfbm93XCIsIHZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0Mi5ub3coKTtcbiAgICAgICAgICB9IH1dKSwgaTM7XG4gICAgICAgIH0oRGUpLCB0Mi5pbnRlcmFjdGlvbnMgPSB7IGxpc3Q6IFtdLCBuZXc6IGZ1bmN0aW9uKGUzKSB7XG4gICAgICAgICAgZTMuc2NvcGVGaXJlID0gZnVuY3Rpb24oZTQsIG40KSB7XG4gICAgICAgICAgICByZXR1cm4gdDIuZmlyZShlNCwgbjQpO1xuICAgICAgICAgIH07XG4gICAgICAgICAgdmFyIG4zID0gbmV3IHQyLkludGVyYWN0aW9uKGUzKTtcbiAgICAgICAgICByZXR1cm4gdDIuaW50ZXJhY3Rpb25zLmxpc3QucHVzaChuMyksIG4zO1xuICAgICAgICB9LCBsaXN0ZW5lcnM6IGUyLCBkb2NFdmVudHM6IGEyLCBwb2ludGVyTW92ZVRvbGVyYW5jZTogMSB9LCB0Mi51c2VQbHVnaW4oaGUpO1xuICAgICAgfSwgbGlzdGVuZXJzOiB7IFwic2NvcGU6YWRkLWRvY3VtZW50XCI6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHJldHVybiB0bih0MiwgXCJhZGRcIik7XG4gICAgICB9LCBcInNjb3BlOnJlbW92ZS1kb2N1bWVudFwiOiBmdW5jdGlvbih0Mikge1xuICAgICAgICByZXR1cm4gdG4odDIsIFwicmVtb3ZlXCIpO1xuICAgICAgfSwgXCJpbnRlcmFjdGFibGU6dW5zZXRcIjogZnVuY3Rpb24odDIsIGUyKSB7XG4gICAgICAgIGZvciAodmFyIG4yID0gdDIuaW50ZXJhY3RhYmxlLCByMiA9IGUyLmludGVyYWN0aW9ucy5saXN0Lmxlbmd0aCAtIDE7IHIyID49IDA7IHIyLS0pIHtcbiAgICAgICAgICB2YXIgaTIgPSBlMi5pbnRlcmFjdGlvbnMubGlzdFtyMl07XG4gICAgICAgICAgaTIuaW50ZXJhY3RhYmxlID09PSBuMiAmJiAoaTIuc3RvcCgpLCBlMi5maXJlKFwiaW50ZXJhY3Rpb25zOmRlc3Ryb3lcIiwgeyBpbnRlcmFjdGlvbjogaTIgfSksIGkyLmRlc3Ryb3koKSwgZTIuaW50ZXJhY3Rpb25zLmxpc3QubGVuZ3RoID4gMiAmJiBlMi5pbnRlcmFjdGlvbnMubGlzdC5zcGxpY2UocjIsIDEpKTtcbiAgICAgICAgfVxuICAgICAgfSB9LCBvbkRvY1NpZ25hbDogdG4sIGRvT25JbnRlcmFjdGlvbnM6IFFlLCBtZXRob2ROYW1lczogSmUgfSwgbm4gPSBlbiwgcm4gPSBmdW5jdGlvbih0Mikge1xuICAgICAgICByZXR1cm4gdDJbdDIuT24gPSAwXSA9IFwiT25cIiwgdDJbdDIuT2ZmID0gMV0gPSBcIk9mZlwiLCB0MjtcbiAgICAgIH0ocm4gfHwge30pLCBvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBmdW5jdGlvbiB0MihlMiwgbjIsIGkyLCBvMikge1xuICAgICAgICAgIHIodGhpcywgdDIpLCB0aGlzLnRhcmdldCA9IHZvaWQgMCwgdGhpcy5vcHRpb25zID0gdm9pZCAwLCB0aGlzLl9hY3Rpb25zID0gdm9pZCAwLCB0aGlzLmV2ZW50cyA9IG5ldyBWZSgpLCB0aGlzLl9jb250ZXh0ID0gdm9pZCAwLCB0aGlzLl93aW4gPSB2b2lkIDAsIHRoaXMuX2RvYyA9IHZvaWQgMCwgdGhpcy5fc2NvcGVFdmVudHMgPSB2b2lkIDAsIHRoaXMuX2FjdGlvbnMgPSBuMi5hY3Rpb25zLCB0aGlzLnRhcmdldCA9IGUyLCB0aGlzLl9jb250ZXh0ID0gbjIuY29udGV4dCB8fCBpMiwgdGhpcy5fd2luID0geShCKGUyKSA/IHRoaXMuX2NvbnRleHQgOiBlMiksIHRoaXMuX2RvYyA9IHRoaXMuX3dpbi5kb2N1bWVudCwgdGhpcy5fc2NvcGVFdmVudHMgPSBvMiwgdGhpcy5zZXQobjIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvKHQyLCBbeyBrZXk6IFwiX2RlZmF1bHRzXCIsIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHsgYmFzZToge30sIHBlckFjdGlvbjoge30sIGFjdGlvbnM6IHt9IH07XG4gICAgICAgIH0gfSwgeyBrZXk6IFwic2V0T25FdmVudHNcIiwgdmFsdWU6IGZ1bmN0aW9uKHQzLCBlMikge1xuICAgICAgICAgIHJldHVybiB3LmZ1bmMoZTIub25zdGFydCkgJiYgdGhpcy5vbihcIlwiLmNvbmNhdCh0MywgXCJzdGFydFwiKSwgZTIub25zdGFydCksIHcuZnVuYyhlMi5vbm1vdmUpICYmIHRoaXMub24oXCJcIi5jb25jYXQodDMsIFwibW92ZVwiKSwgZTIub25tb3ZlKSwgdy5mdW5jKGUyLm9uZW5kKSAmJiB0aGlzLm9uKFwiXCIuY29uY2F0KHQzLCBcImVuZFwiKSwgZTIub25lbmQpLCB3LmZ1bmMoZTIub25pbmVydGlhc3RhcnQpICYmIHRoaXMub24oXCJcIi5jb25jYXQodDMsIFwiaW5lcnRpYXN0YXJ0XCIpLCBlMi5vbmluZXJ0aWFzdGFydCksIHRoaXM7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwidXBkYXRlUGVyQWN0aW9uTGlzdGVuZXJzXCIsIHZhbHVlOiBmdW5jdGlvbih0MywgZTIsIG4yKSB7XG4gICAgICAgICAgdmFyIHIyLCBpMiA9IHRoaXMsIG8yID0gbnVsbCA9PSAocjIgPSB0aGlzLl9hY3Rpb25zLm1hcFt0M10pID8gdm9pZCAwIDogcjIuZmlsdGVyRXZlbnRUeXBlLCBhMiA9IGZ1bmN0aW9uKHQ0KSB7XG4gICAgICAgICAgICByZXR1cm4gKG51bGwgPT0gbzIgfHwgbzIodDQpKSAmJiB2ZSh0NCwgaTIuX2FjdGlvbnMpO1xuICAgICAgICAgIH07XG4gICAgICAgICAgKHcuYXJyYXkoZTIpIHx8IHcub2JqZWN0KGUyKSkgJiYgdGhpcy5fb25PZmYocm4uT2ZmLCB0MywgZTIsIHZvaWQgMCwgYTIpLCAody5hcnJheShuMikgfHwgdy5vYmplY3QobjIpKSAmJiB0aGlzLl9vbk9mZihybi5PbiwgdDMsIG4yLCB2b2lkIDAsIGEyKTtcbiAgICAgICAgfSB9LCB7IGtleTogXCJzZXRQZXJBY3Rpb25cIiwgdmFsdWU6IGZ1bmN0aW9uKHQzLCBlMikge1xuICAgICAgICAgIHZhciBuMiA9IHRoaXMuX2RlZmF1bHRzO1xuICAgICAgICAgIGZvciAodmFyIHIyIGluIGUyKSB7XG4gICAgICAgICAgICB2YXIgaTIgPSByMiwgbzIgPSB0aGlzLm9wdGlvbnNbdDNdLCBhMiA9IGUyW2kyXTtcbiAgICAgICAgICAgIFwibGlzdGVuZXJzXCIgPT09IGkyICYmIHRoaXMudXBkYXRlUGVyQWN0aW9uTGlzdGVuZXJzKHQzLCBvMi5saXN0ZW5lcnMsIGEyKSwgdy5hcnJheShhMikgPyBvMltpMl0gPSBtdChhMikgOiB3LnBsYWluT2JqZWN0KGEyKSA/IChvMltpMl0gPSBWKG8yW2kyXSB8fCB7fSwgZ2UoYTIpKSwgdy5vYmplY3QobjIucGVyQWN0aW9uW2kyXSkgJiYgXCJlbmFibGVkXCIgaW4gbjIucGVyQWN0aW9uW2kyXSAmJiAobzJbaTJdLmVuYWJsZWQgPSBmYWxzZSAhPT0gYTIuZW5hYmxlZCkpIDogdy5ib29sKGEyKSAmJiB3Lm9iamVjdChuMi5wZXJBY3Rpb25baTJdKSA/IG8yW2kyXS5lbmFibGVkID0gYTIgOiBvMltpMl0gPSBhMjtcbiAgICAgICAgICB9XG4gICAgICAgIH0gfSwgeyBrZXk6IFwiZ2V0UmVjdFwiLCB2YWx1ZTogZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICByZXR1cm4gdDMgPSB0MyB8fCAody5lbGVtZW50KHRoaXMudGFyZ2V0KSA/IHRoaXMudGFyZ2V0IDogbnVsbCksIHcuc3RyaW5nKHRoaXMudGFyZ2V0KSAmJiAodDMgPSB0MyB8fCB0aGlzLl9jb250ZXh0LnF1ZXJ5U2VsZWN0b3IodGhpcy50YXJnZXQpKSwgTCh0Myk7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwicmVjdENoZWNrZXJcIiwgdmFsdWU6IGZ1bmN0aW9uKHQzKSB7XG4gICAgICAgICAgdmFyIGUyID0gdGhpcztcbiAgICAgICAgICByZXR1cm4gdy5mdW5jKHQzKSA/ICh0aGlzLmdldFJlY3QgPSBmdW5jdGlvbihuMikge1xuICAgICAgICAgICAgdmFyIHIyID0gVih7fSwgdDMuYXBwbHkoZTIsIG4yKSk7XG4gICAgICAgICAgICByZXR1cm4gXCJ3aWR0aFwiIGluIHIyIHx8IChyMi53aWR0aCA9IHIyLnJpZ2h0IC0gcjIubGVmdCwgcjIuaGVpZ2h0ID0gcjIuYm90dG9tIC0gcjIudG9wKSwgcjI7XG4gICAgICAgICAgfSwgdGhpcykgOiBudWxsID09PSB0MyA/IChkZWxldGUgdGhpcy5nZXRSZWN0LCB0aGlzKSA6IHRoaXMuZ2V0UmVjdDtcbiAgICAgICAgfSB9LCB7IGtleTogXCJfYmFja0NvbXBhdE9wdGlvblwiLCB2YWx1ZTogZnVuY3Rpb24odDMsIGUyKSB7XG4gICAgICAgICAgaWYgKEIoZTIpIHx8IHcub2JqZWN0KGUyKSkge1xuICAgICAgICAgICAgZm9yICh2YXIgbjIgaW4gdGhpcy5vcHRpb25zW3QzXSA9IGUyLCB0aGlzLl9hY3Rpb25zLm1hcCkgdGhpcy5vcHRpb25zW24yXVt0M10gPSBlMjtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zW3QzXTtcbiAgICAgICAgfSB9LCB7IGtleTogXCJvcmlnaW5cIiwgdmFsdWU6IGZ1bmN0aW9uKHQzKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2JhY2tDb21wYXRPcHRpb24oXCJvcmlnaW5cIiwgdDMpO1xuICAgICAgICB9IH0sIHsga2V5OiBcImRlbHRhU291cmNlXCIsIHZhbHVlOiBmdW5jdGlvbih0Mykge1xuICAgICAgICAgIHJldHVybiBcInBhZ2VcIiA9PT0gdDMgfHwgXCJjbGllbnRcIiA9PT0gdDMgPyAodGhpcy5vcHRpb25zLmRlbHRhU291cmNlID0gdDMsIHRoaXMpIDogdGhpcy5vcHRpb25zLmRlbHRhU291cmNlO1xuICAgICAgICB9IH0sIHsga2V5OiBcImdldEFsbEVsZW1lbnRzXCIsIHZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgdDMgPSB0aGlzLnRhcmdldDtcbiAgICAgICAgICByZXR1cm4gdy5zdHJpbmcodDMpID8gQXJyYXkuZnJvbSh0aGlzLl9jb250ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwodDMpKSA6IHcuZnVuYyh0MykgJiYgdDMuZ2V0QWxsRWxlbWVudHMgPyB0My5nZXRBbGxFbGVtZW50cygpIDogdy5lbGVtZW50KHQzKSA/IFt0M10gOiBbXTtcbiAgICAgICAgfSB9LCB7IGtleTogXCJjb250ZXh0XCIsIHZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fY29udGV4dDtcbiAgICAgICAgfSB9LCB7IGtleTogXCJpbkNvbnRleHRcIiwgdmFsdWU6IGZ1bmN0aW9uKHQzKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRleHQgPT09IHQzLm93bmVyRG9jdW1lbnQgfHwgTSh0aGlzLl9jb250ZXh0LCB0Myk7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwidGVzdElnbm9yZUFsbG93XCIsIHZhbHVlOiBmdW5jdGlvbih0MywgZTIsIG4yKSB7XG4gICAgICAgICAgcmV0dXJuICF0aGlzLnRlc3RJZ25vcmUodDMuaWdub3JlRnJvbSwgZTIsIG4yKSAmJiB0aGlzLnRlc3RBbGxvdyh0My5hbGxvd0Zyb20sIGUyLCBuMik7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwidGVzdEFsbG93XCIsIHZhbHVlOiBmdW5jdGlvbih0MywgZTIsIG4yKSB7XG4gICAgICAgICAgcmV0dXJuICF0MyB8fCAhIXcuZWxlbWVudChuMikgJiYgKHcuc3RyaW5nKHQzKSA/IEYobjIsIHQzLCBlMikgOiAhIXcuZWxlbWVudCh0MykgJiYgTSh0MywgbjIpKTtcbiAgICAgICAgfSB9LCB7IGtleTogXCJ0ZXN0SWdub3JlXCIsIHZhbHVlOiBmdW5jdGlvbih0MywgZTIsIG4yKSB7XG4gICAgICAgICAgcmV0dXJuICEoIXQzIHx8ICF3LmVsZW1lbnQobjIpKSAmJiAody5zdHJpbmcodDMpID8gRihuMiwgdDMsIGUyKSA6ICEhdy5lbGVtZW50KHQzKSAmJiBNKHQzLCBuMikpO1xuICAgICAgICB9IH0sIHsga2V5OiBcImZpcmVcIiwgdmFsdWU6IGZ1bmN0aW9uKHQzKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuZXZlbnRzLmZpcmUodDMpLCB0aGlzO1xuICAgICAgICB9IH0sIHsga2V5OiBcIl9vbk9mZlwiLCB2YWx1ZTogZnVuY3Rpb24odDMsIGUyLCBuMiwgcjIsIGkyKSB7XG4gICAgICAgICAgdy5vYmplY3QoZTIpICYmICF3LmFycmF5KGUyKSAmJiAocjIgPSBuMiwgbjIgPSBudWxsKTtcbiAgICAgICAgICB2YXIgbzIgPSAkKGUyLCBuMiwgaTIpO1xuICAgICAgICAgIGZvciAodmFyIGEyIGluIG8yKSB7XG4gICAgICAgICAgICBcIndoZWVsXCIgPT09IGEyICYmIChhMiA9IEkud2hlZWxFdmVudCk7XG4gICAgICAgICAgICBmb3IgKHZhciBzMiA9IDAsIGMyID0gbzJbYTJdOyBzMiA8IGMyLmxlbmd0aDsgczIrKykge1xuICAgICAgICAgICAgICB2YXIgbDIgPSBjMltzMl07XG4gICAgICAgICAgICAgIHZlKGEyLCB0aGlzLl9hY3Rpb25zKSA/IHRoaXMuZXZlbnRzW3QzID09PSBybi5PbiA/IFwib25cIiA6IFwib2ZmXCJdKGEyLCBsMikgOiB3LnN0cmluZyh0aGlzLnRhcmdldCkgPyB0aGlzLl9zY29wZUV2ZW50c1t0MyA9PT0gcm4uT24gPyBcImFkZERlbGVnYXRlXCIgOiBcInJlbW92ZURlbGVnYXRlXCJdKHRoaXMudGFyZ2V0LCB0aGlzLl9jb250ZXh0LCBhMiwgbDIsIHIyKSA6IHRoaXMuX3Njb3BlRXZlbnRzW3QzID09PSBybi5PbiA/IFwiYWRkXCIgOiBcInJlbW92ZVwiXSh0aGlzLnRhcmdldCwgYTIsIGwyLCByMik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9IH0sIHsga2V5OiBcIm9uXCIsIHZhbHVlOiBmdW5jdGlvbih0MywgZTIsIG4yKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX29uT2ZmKHJuLk9uLCB0MywgZTIsIG4yKTtcbiAgICAgICAgfSB9LCB7IGtleTogXCJvZmZcIiwgdmFsdWU6IGZ1bmN0aW9uKHQzLCBlMiwgbjIpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fb25PZmYocm4uT2ZmLCB0MywgZTIsIG4yKTtcbiAgICAgICAgfSB9LCB7IGtleTogXCJzZXRcIiwgdmFsdWU6IGZ1bmN0aW9uKHQzKSB7XG4gICAgICAgICAgdmFyIGUyID0gdGhpcy5fZGVmYXVsdHM7XG4gICAgICAgICAgZm9yICh2YXIgbjIgaW4gdy5vYmplY3QodDMpIHx8ICh0MyA9IHt9KSwgdGhpcy5vcHRpb25zID0gZ2UoZTIuYmFzZSksIHRoaXMuX2FjdGlvbnMubWV0aG9kRGljdCkge1xuICAgICAgICAgICAgdmFyIHIyID0gbjIsIGkyID0gdGhpcy5fYWN0aW9ucy5tZXRob2REaWN0W3IyXTtcbiAgICAgICAgICAgIHRoaXMub3B0aW9uc1tyMl0gPSB7fSwgdGhpcy5zZXRQZXJBY3Rpb24ocjIsIFYoVih7fSwgZTIucGVyQWN0aW9uKSwgZTIuYWN0aW9uc1tyMl0pKSwgdGhpc1tpMl0odDNbcjJdKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZm9yICh2YXIgbzIgaW4gdDMpIFwiZ2V0UmVjdFwiICE9PSBvMiA/IHcuZnVuYyh0aGlzW28yXSkgJiYgdGhpc1tvMl0odDNbbzJdKSA6IHRoaXMucmVjdENoZWNrZXIodDMuZ2V0UmVjdCk7XG4gICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwidW5zZXRcIiwgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlmICh3LnN0cmluZyh0aGlzLnRhcmdldCkpIGZvciAodmFyIHQzIGluIHRoaXMuX3Njb3BlRXZlbnRzLmRlbGVnYXRlZEV2ZW50cykgZm9yICh2YXIgZTIgPSB0aGlzLl9zY29wZUV2ZW50cy5kZWxlZ2F0ZWRFdmVudHNbdDNdLCBuMiA9IGUyLmxlbmd0aCAtIDE7IG4yID49IDA7IG4yLS0pIHtcbiAgICAgICAgICAgIHZhciByMiA9IGUyW24yXSwgaTIgPSByMi5zZWxlY3RvciwgbzIgPSByMi5jb250ZXh0LCBhMiA9IHIyLmxpc3RlbmVycztcbiAgICAgICAgICAgIGkyID09PSB0aGlzLnRhcmdldCAmJiBvMiA9PT0gdGhpcy5fY29udGV4dCAmJiBlMi5zcGxpY2UobjIsIDEpO1xuICAgICAgICAgICAgZm9yICh2YXIgczIgPSBhMi5sZW5ndGggLSAxOyBzMiA+PSAwOyBzMi0tKSB0aGlzLl9zY29wZUV2ZW50cy5yZW1vdmVEZWxlZ2F0ZSh0aGlzLnRhcmdldCwgdGhpcy5fY29udGV4dCwgdDMsIGEyW3MyXVswXSwgYTJbczJdWzFdKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB0aGlzLl9zY29wZUV2ZW50cy5yZW1vdmUodGhpcy50YXJnZXQsIFwiYWxsXCIpO1xuICAgICAgICB9IH1dKSwgdDI7XG4gICAgICB9KCksIGFuID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGZ1bmN0aW9uIHQyKGUyKSB7XG4gICAgICAgICAgdmFyIG4yID0gdGhpcztcbiAgICAgICAgICByKHRoaXMsIHQyKSwgdGhpcy5saXN0ID0gW10sIHRoaXMuc2VsZWN0b3JNYXAgPSB7fSwgdGhpcy5zY29wZSA9IHZvaWQgMCwgdGhpcy5zY29wZSA9IGUyLCBlMi5hZGRMaXN0ZW5lcnMoeyBcImludGVyYWN0YWJsZTp1bnNldFwiOiBmdW5jdGlvbih0Mykge1xuICAgICAgICAgICAgdmFyIGUzID0gdDMuaW50ZXJhY3RhYmxlLCByMiA9IGUzLnRhcmdldCwgaTIgPSB3LnN0cmluZyhyMikgPyBuMi5zZWxlY3Rvck1hcFtyMl0gOiByMltuMi5zY29wZS5pZF0sIG8yID0geXQoaTIsIGZ1bmN0aW9uKHQ0KSB7XG4gICAgICAgICAgICAgIHJldHVybiB0NCA9PT0gZTM7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGkyLnNwbGljZShvMiwgMSk7XG4gICAgICAgICAgfSB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbyh0MiwgW3sga2V5OiBcIm5ld1wiLCB2YWx1ZTogZnVuY3Rpb24odDMsIGUyKSB7XG4gICAgICAgICAgZTIgPSBWKGUyIHx8IHt9LCB7IGFjdGlvbnM6IHRoaXMuc2NvcGUuYWN0aW9ucyB9KTtcbiAgICAgICAgICB2YXIgbjIgPSBuZXcgdGhpcy5zY29wZS5JbnRlcmFjdGFibGUodDMsIGUyLCB0aGlzLnNjb3BlLmRvY3VtZW50LCB0aGlzLnNjb3BlLmV2ZW50cyk7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuYWRkRG9jdW1lbnQobjIuX2RvYyksIHRoaXMubGlzdC5wdXNoKG4yKSwgdy5zdHJpbmcodDMpID8gKHRoaXMuc2VsZWN0b3JNYXBbdDNdIHx8ICh0aGlzLnNlbGVjdG9yTWFwW3QzXSA9IFtdKSwgdGhpcy5zZWxlY3Rvck1hcFt0M10ucHVzaChuMikpIDogKG4yLnRhcmdldFt0aGlzLnNjb3BlLmlkXSB8fCBPYmplY3QuZGVmaW5lUHJvcGVydHkodDMsIHRoaXMuc2NvcGUuaWQsIHsgdmFsdWU6IFtdLCBjb25maWd1cmFibGU6IHRydWUgfSksIHQzW3RoaXMuc2NvcGUuaWRdLnB1c2gobjIpKSwgdGhpcy5zY29wZS5maXJlKFwiaW50ZXJhY3RhYmxlOm5ld1wiLCB7IHRhcmdldDogdDMsIG9wdGlvbnM6IGUyLCBpbnRlcmFjdGFibGU6IG4yLCB3aW46IHRoaXMuc2NvcGUuX3dpbiB9KSwgbjI7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwiZ2V0RXhpc3RpbmdcIiwgdmFsdWU6IGZ1bmN0aW9uKHQzLCBlMikge1xuICAgICAgICAgIHZhciBuMiA9IGUyICYmIGUyLmNvbnRleHQgfHwgdGhpcy5zY29wZS5kb2N1bWVudCwgcjIgPSB3LnN0cmluZyh0MyksIGkyID0gcjIgPyB0aGlzLnNlbGVjdG9yTWFwW3QzXSA6IHQzW3RoaXMuc2NvcGUuaWRdO1xuICAgICAgICAgIGlmIChpMikgcmV0dXJuIGJ0KGkyLCBmdW5jdGlvbihlMykge1xuICAgICAgICAgICAgcmV0dXJuIGUzLl9jb250ZXh0ID09PSBuMiAmJiAocjIgfHwgZTMuaW5Db250ZXh0KHQzKSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwiZm9yRWFjaE1hdGNoXCIsIHZhbHVlOiBmdW5jdGlvbih0MywgZTIpIHtcbiAgICAgICAgICBmb3IgKHZhciBuMiA9IDAsIHIyID0gdGhpcy5saXN0OyBuMiA8IHIyLmxlbmd0aDsgbjIrKykge1xuICAgICAgICAgICAgdmFyIGkyID0gcjJbbjJdLCBvMiA9IHZvaWQgMDtcbiAgICAgICAgICAgIGlmICgody5zdHJpbmcoaTIudGFyZ2V0KSA/IHcuZWxlbWVudCh0MykgJiYgUih0MywgaTIudGFyZ2V0KSA6IHQzID09PSBpMi50YXJnZXQpICYmIGkyLmluQ29udGV4dCh0MykgJiYgKG8yID0gZTIoaTIpKSwgdm9pZCAwICE9PSBvMikgcmV0dXJuIG8yO1xuICAgICAgICAgIH1cbiAgICAgICAgfSB9XSksIHQyO1xuICAgICAgfSgpO1xuICAgICAgdmFyIHNuID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGZ1bmN0aW9uIHQyKCkge1xuICAgICAgICAgIHZhciBlMiA9IHRoaXM7XG4gICAgICAgICAgcih0aGlzLCB0MiksIHRoaXMuaWQgPSBcIl9faW50ZXJhY3Rfc2NvcGVfXCIuY29uY2F0KE1hdGguZmxvb3IoMTAwICogTWF0aC5yYW5kb20oKSkpLCB0aGlzLmlzSW5pdGlhbGl6ZWQgPSBmYWxzZSwgdGhpcy5saXN0ZW5lck1hcHMgPSBbXSwgdGhpcy5icm93c2VyID0gSSwgdGhpcy5kZWZhdWx0cyA9IGdlKFRlKSwgdGhpcy5FdmVudGFibGUgPSBWZSwgdGhpcy5hY3Rpb25zID0geyBtYXA6IHt9LCBwaGFzZXM6IHsgc3RhcnQ6IHRydWUsIG1vdmU6IHRydWUsIGVuZDogdHJ1ZSB9LCBtZXRob2REaWN0OiB7fSwgcGhhc2VsZXNzVHlwZXM6IHt9IH0sIHRoaXMuaW50ZXJhY3RTdGF0aWMgPSBmdW5jdGlvbih0Mykge1xuICAgICAgICAgICAgdmFyIGUzID0gZnVuY3Rpb24gZTQobjMsIHIyKSB7XG4gICAgICAgICAgICAgIHZhciBpMiA9IHQzLmludGVyYWN0YWJsZXMuZ2V0RXhpc3RpbmcobjMsIHIyKTtcbiAgICAgICAgICAgICAgcmV0dXJuIGkyIHx8ICgoaTIgPSB0My5pbnRlcmFjdGFibGVzLm5ldyhuMywgcjIpKS5ldmVudHMuZ2xvYmFsID0gZTQuZ2xvYmFsRXZlbnRzKSwgaTI7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIGUzLmdldFBvaW50ZXJBdmVyYWdlID0gbHQsIGUzLmdldFRvdWNoQkJveCA9IHV0LCBlMy5nZXRUb3VjaERpc3RhbmNlID0gcHQsIGUzLmdldFRvdWNoQW5nbGUgPSBmdCwgZTMuZ2V0RWxlbWVudFJlY3QgPSBMLCBlMy5nZXRFbGVtZW50Q2xpZW50UmVjdCA9IFksIGUzLm1hdGNoZXNTZWxlY3RvciA9IFIsIGUzLmNsb3Nlc3QgPSB6LCBlMy5nbG9iYWxFdmVudHMgPSB7fSwgZTMudmVyc2lvbiA9IFwiMS4xMC4yN1wiLCBlMy5zY29wZSA9IHQzLCBlMy51c2UgPSBmdW5jdGlvbih0NCwgZTQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUudXNlUGx1Z2luKHQ0LCBlNCksIHRoaXM7XG4gICAgICAgICAgICB9LCBlMy5pc1NldCA9IGZ1bmN0aW9uKHQ0LCBlNCkge1xuICAgICAgICAgICAgICByZXR1cm4gISF0aGlzLnNjb3BlLmludGVyYWN0YWJsZXMuZ2V0KHQ0LCBlNCAmJiBlNC5jb250ZXh0KTtcbiAgICAgICAgICAgIH0sIGUzLm9uID0gTnQoZnVuY3Rpb24odDQsIGU0LCBuMykge1xuICAgICAgICAgICAgICBpZiAody5zdHJpbmcodDQpICYmIC0xICE9PSB0NC5zZWFyY2goXCIgXCIpICYmICh0NCA9IHQ0LnRyaW0oKS5zcGxpdCgvICsvKSksIHcuYXJyYXkodDQpKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgcjIgPSAwLCBpMiA9IHQ0OyByMiA8IGkyLmxlbmd0aDsgcjIrKykge1xuICAgICAgICAgICAgICAgICAgdmFyIG8yID0gaTJbcjJdO1xuICAgICAgICAgICAgICAgICAgdGhpcy5vbihvMiwgZTQsIG4zKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKHcub2JqZWN0KHQ0KSkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGEyIGluIHQ0KSB0aGlzLm9uKGEyLCB0NFthMl0sIGU0KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICByZXR1cm4gdmUodDQsIHRoaXMuc2NvcGUuYWN0aW9ucykgPyB0aGlzLmdsb2JhbEV2ZW50c1t0NF0gPyB0aGlzLmdsb2JhbEV2ZW50c1t0NF0ucHVzaChlNCkgOiB0aGlzLmdsb2JhbEV2ZW50c1t0NF0gPSBbZTRdIDogdGhpcy5zY29wZS5ldmVudHMuYWRkKHRoaXMuc2NvcGUuZG9jdW1lbnQsIHQ0LCBlNCwgeyBvcHRpb25zOiBuMyB9KSwgdGhpcztcbiAgICAgICAgICAgIH0sIFwiVGhlIGludGVyYWN0Lm9uKCkgbWV0aG9kIGlzIGJlaW5nIGRlcHJlY2F0ZWRcIiksIGUzLm9mZiA9IE50KGZ1bmN0aW9uKHQ0LCBlNCwgbjMpIHtcbiAgICAgICAgICAgICAgaWYgKHcuc3RyaW5nKHQ0KSAmJiAtMSAhPT0gdDQuc2VhcmNoKFwiIFwiKSAmJiAodDQgPSB0NC50cmltKCkuc3BsaXQoLyArLykpLCB3LmFycmF5KHQ0KSkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIHIyID0gMCwgaTIgPSB0NDsgcjIgPCBpMi5sZW5ndGg7IHIyKyspIHtcbiAgICAgICAgICAgICAgICAgIHZhciBvMiA9IGkyW3IyXTtcbiAgICAgICAgICAgICAgICAgIHRoaXMub2ZmKG8yLCBlNCwgbjMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBpZiAody5vYmplY3QodDQpKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYTIgaW4gdDQpIHRoaXMub2ZmKGEyLCB0NFthMl0sIGU0KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB2YXIgczI7XG4gICAgICAgICAgICAgIHJldHVybiB2ZSh0NCwgdGhpcy5zY29wZS5hY3Rpb25zKSA/IHQ0IGluIHRoaXMuZ2xvYmFsRXZlbnRzICYmIC0xICE9PSAoczIgPSB0aGlzLmdsb2JhbEV2ZW50c1t0NF0uaW5kZXhPZihlNCkpICYmIHRoaXMuZ2xvYmFsRXZlbnRzW3Q0XS5zcGxpY2UoczIsIDEpIDogdGhpcy5zY29wZS5ldmVudHMucmVtb3ZlKHRoaXMuc2NvcGUuZG9jdW1lbnQsIHQ0LCBlNCwgbjMpLCB0aGlzO1xuICAgICAgICAgICAgfSwgXCJUaGUgaW50ZXJhY3Qub2ZmKCkgbWV0aG9kIGlzIGJlaW5nIGRlcHJlY2F0ZWRcIiksIGUzLmRlYnVnID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLnNjb3BlO1xuICAgICAgICAgICAgfSwgZTMuc3VwcG9ydHNUb3VjaCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICByZXR1cm4gSS5zdXBwb3J0c1RvdWNoO1xuICAgICAgICAgICAgfSwgZTMuc3VwcG9ydHNQb2ludGVyRXZlbnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIEkuc3VwcG9ydHNQb2ludGVyRXZlbnQ7XG4gICAgICAgICAgICB9LCBlMy5zdG9wID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGZvciAodmFyIHQ0ID0gMCwgZTQgPSB0aGlzLnNjb3BlLmludGVyYWN0aW9ucy5saXN0OyB0NCA8IGU0Lmxlbmd0aDsgdDQrKykgZTRbdDRdLnN0b3AoKTtcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9LCBlMy5wb2ludGVyTW92ZVRvbGVyYW5jZSA9IGZ1bmN0aW9uKHQ0KSB7XG4gICAgICAgICAgICAgIHJldHVybiB3Lm51bWJlcih0NCkgPyAodGhpcy5zY29wZS5pbnRlcmFjdGlvbnMucG9pbnRlck1vdmVUb2xlcmFuY2UgPSB0NCwgdGhpcykgOiB0aGlzLnNjb3BlLmludGVyYWN0aW9ucy5wb2ludGVyTW92ZVRvbGVyYW5jZTtcbiAgICAgICAgICAgIH0sIGUzLmFkZERvY3VtZW50ID0gZnVuY3Rpb24odDQsIGU0KSB7XG4gICAgICAgICAgICAgIHRoaXMuc2NvcGUuYWRkRG9jdW1lbnQodDQsIGU0KTtcbiAgICAgICAgICAgIH0sIGUzLnJlbW92ZURvY3VtZW50ID0gZnVuY3Rpb24odDQpIHtcbiAgICAgICAgICAgICAgdGhpcy5zY29wZS5yZW1vdmVEb2N1bWVudCh0NCk7XG4gICAgICAgICAgICB9LCBlMztcbiAgICAgICAgICB9KHRoaXMpLCB0aGlzLkludGVyYWN0RXZlbnQgPSBTZSwgdGhpcy5JbnRlcmFjdGFibGUgPSB2b2lkIDAsIHRoaXMuaW50ZXJhY3RhYmxlcyA9IG5ldyBhbih0aGlzKSwgdGhpcy5fd2luID0gdm9pZCAwLCB0aGlzLmRvY3VtZW50ID0gdm9pZCAwLCB0aGlzLndpbmRvdyA9IHZvaWQgMCwgdGhpcy5kb2N1bWVudHMgPSBbXSwgdGhpcy5fcGx1Z2lucyA9IHsgbGlzdDogW10sIG1hcDoge30gfSwgdGhpcy5vbldpbmRvd1VubG9hZCA9IGZ1bmN0aW9uKHQzKSB7XG4gICAgICAgICAgICByZXR1cm4gZTIucmVtb3ZlRG9jdW1lbnQodDMudGFyZ2V0KTtcbiAgICAgICAgICB9O1xuICAgICAgICAgIHZhciBuMiA9IHRoaXM7XG4gICAgICAgICAgdGhpcy5JbnRlcmFjdGFibGUgPSBmdW5jdGlvbih0Mykge1xuICAgICAgICAgICAgcyhpMiwgdDMpO1xuICAgICAgICAgICAgdmFyIGUzID0gcChpMik7XG4gICAgICAgICAgICBmdW5jdGlvbiBpMigpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHIodGhpcywgaTIpLCBlMy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG8oaTIsIFt7IGtleTogXCJfZGVmYXVsdHNcIiwgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG4yLmRlZmF1bHRzO1xuICAgICAgICAgICAgfSB9LCB7IGtleTogXCJzZXRcIiwgdmFsdWU6IGZ1bmN0aW9uKHQ0KSB7XG4gICAgICAgICAgICAgIHJldHVybiBmKGMoaTIucHJvdG90eXBlKSwgXCJzZXRcIiwgdGhpcykuY2FsbCh0aGlzLCB0NCksIG4yLmZpcmUoXCJpbnRlcmFjdGFibGU6c2V0XCIsIHsgb3B0aW9uczogdDQsIGludGVyYWN0YWJsZTogdGhpcyB9KSwgdGhpcztcbiAgICAgICAgICAgIH0gfSwgeyBrZXk6IFwidW5zZXRcIiwgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBmKGMoaTIucHJvdG90eXBlKSwgXCJ1bnNldFwiLCB0aGlzKS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICB2YXIgdDQgPSBuMi5pbnRlcmFjdGFibGVzLmxpc3QuaW5kZXhPZih0aGlzKTtcbiAgICAgICAgICAgICAgdDQgPCAwIHx8IChuMi5pbnRlcmFjdGFibGVzLmxpc3Quc3BsaWNlKHQ0LCAxKSwgbjIuZmlyZShcImludGVyYWN0YWJsZTp1bnNldFwiLCB7IGludGVyYWN0YWJsZTogdGhpcyB9KSk7XG4gICAgICAgICAgICB9IH1dKSwgaTI7XG4gICAgICAgICAgfShvbik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG8odDIsIFt7IGtleTogXCJhZGRMaXN0ZW5lcnNcIiwgdmFsdWU6IGZ1bmN0aW9uKHQzLCBlMikge1xuICAgICAgICAgIHRoaXMubGlzdGVuZXJNYXBzLnB1c2goeyBpZDogZTIsIG1hcDogdDMgfSk7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwiZmlyZVwiLCB2YWx1ZTogZnVuY3Rpb24odDMsIGUyKSB7XG4gICAgICAgICAgZm9yICh2YXIgbjIgPSAwLCByMiA9IHRoaXMubGlzdGVuZXJNYXBzOyBuMiA8IHIyLmxlbmd0aDsgbjIrKykge1xuICAgICAgICAgICAgdmFyIGkyID0gcjJbbjJdLm1hcFt0M107XG4gICAgICAgICAgICBpZiAoaTIgJiYgZmFsc2UgPT09IGkyKGUyLCB0aGlzLCB0MykpIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gfSwgeyBrZXk6IFwiaW5pdFwiLCB2YWx1ZTogZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5pc0luaXRpYWxpemVkID8gdGhpcyA6IGZ1bmN0aW9uKHQ0LCBlMikge1xuICAgICAgICAgICAgdDQuaXNJbml0aWFsaXplZCA9IHRydWUsIHcud2luZG93KGUyKSAmJiBtKGUyKTtcbiAgICAgICAgICAgIHJldHVybiBrLmluaXQoZTIpLCBJLmluaXQoZTIpLCBMdC5pbml0KGUyKSwgdDQud2luZG93ID0gZTIsIHQ0LmRvY3VtZW50ID0gZTIuZG9jdW1lbnQsIHQ0LnVzZVBsdWdpbihubiksIHQ0LnVzZVBsdWdpbihVZSksIHQ0O1xuICAgICAgICAgIH0odGhpcywgdDMpO1xuICAgICAgICB9IH0sIHsga2V5OiBcInBsdWdpbklzSW5zdGFsbGVkXCIsIHZhbHVlOiBmdW5jdGlvbih0Mykge1xuICAgICAgICAgIHZhciBlMiA9IHQzLmlkO1xuICAgICAgICAgIHJldHVybiBlMiA/ICEhdGhpcy5fcGx1Z2lucy5tYXBbZTJdIDogLTEgIT09IHRoaXMuX3BsdWdpbnMubGlzdC5pbmRleE9mKHQzKTtcbiAgICAgICAgfSB9LCB7IGtleTogXCJ1c2VQbHVnaW5cIiwgdmFsdWU6IGZ1bmN0aW9uKHQzLCBlMikge1xuICAgICAgICAgIGlmICghdGhpcy5pc0luaXRpYWxpemVkKSByZXR1cm4gdGhpcztcbiAgICAgICAgICBpZiAodGhpcy5wbHVnaW5Jc0luc3RhbGxlZCh0MykpIHJldHVybiB0aGlzO1xuICAgICAgICAgIGlmICh0My5pZCAmJiAodGhpcy5fcGx1Z2lucy5tYXBbdDMuaWRdID0gdDMpLCB0aGlzLl9wbHVnaW5zLmxpc3QucHVzaCh0MyksIHQzLmluc3RhbGwgJiYgdDMuaW5zdGFsbCh0aGlzLCBlMiksIHQzLmxpc3RlbmVycyAmJiB0My5iZWZvcmUpIHtcbiAgICAgICAgICAgIGZvciAodmFyIG4yID0gMCwgcjIgPSB0aGlzLmxpc3RlbmVyTWFwcy5sZW5ndGgsIGkyID0gdDMuYmVmb3JlLnJlZHVjZShmdW5jdGlvbih0NCwgZTMpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHQ0W2UzXSA9IHRydWUsIHQ0W2NuKGUzKV0gPSB0cnVlLCB0NDtcbiAgICAgICAgICAgIH0sIHt9KTsgbjIgPCByMjsgbjIrKykge1xuICAgICAgICAgICAgICB2YXIgbzIgPSB0aGlzLmxpc3RlbmVyTWFwc1tuMl0uaWQ7XG4gICAgICAgICAgICAgIGlmIChvMiAmJiAoaTJbbzJdIHx8IGkyW2NuKG8yKV0pKSBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubGlzdGVuZXJNYXBzLnNwbGljZShuMiwgMCwgeyBpZDogdDMuaWQsIG1hcDogdDMubGlzdGVuZXJzIH0pO1xuICAgICAgICAgIH0gZWxzZSB0My5saXN0ZW5lcnMgJiYgdGhpcy5saXN0ZW5lck1hcHMucHVzaCh7IGlkOiB0My5pZCwgbWFwOiB0My5saXN0ZW5lcnMgfSk7XG4gICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwiYWRkRG9jdW1lbnRcIiwgdmFsdWU6IGZ1bmN0aW9uKHQzLCBlMikge1xuICAgICAgICAgIGlmICgtMSAhPT0gdGhpcy5nZXREb2NJbmRleCh0MykpIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB2YXIgbjIgPSB5KHQzKTtcbiAgICAgICAgICBlMiA9IGUyID8gVih7fSwgZTIpIDoge30sIHRoaXMuZG9jdW1lbnRzLnB1c2goeyBkb2M6IHQzLCBvcHRpb25zOiBlMiB9KSwgdGhpcy5ldmVudHMuZG9jdW1lbnRzLnB1c2godDMpLCB0MyAhPT0gdGhpcy5kb2N1bWVudCAmJiB0aGlzLmV2ZW50cy5hZGQobjIsIFwidW5sb2FkXCIsIHRoaXMub25XaW5kb3dVbmxvYWQpLCB0aGlzLmZpcmUoXCJzY29wZTphZGQtZG9jdW1lbnRcIiwgeyBkb2M6IHQzLCB3aW5kb3c6IG4yLCBzY29wZTogdGhpcywgb3B0aW9uczogZTIgfSk7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwicmVtb3ZlRG9jdW1lbnRcIiwgdmFsdWU6IGZ1bmN0aW9uKHQzKSB7XG4gICAgICAgICAgdmFyIGUyID0gdGhpcy5nZXREb2NJbmRleCh0MyksIG4yID0geSh0MyksIHIyID0gdGhpcy5kb2N1bWVudHNbZTJdLm9wdGlvbnM7XG4gICAgICAgICAgdGhpcy5ldmVudHMucmVtb3ZlKG4yLCBcInVubG9hZFwiLCB0aGlzLm9uV2luZG93VW5sb2FkKSwgdGhpcy5kb2N1bWVudHMuc3BsaWNlKGUyLCAxKSwgdGhpcy5ldmVudHMuZG9jdW1lbnRzLnNwbGljZShlMiwgMSksIHRoaXMuZmlyZShcInNjb3BlOnJlbW92ZS1kb2N1bWVudFwiLCB7IGRvYzogdDMsIHdpbmRvdzogbjIsIHNjb3BlOiB0aGlzLCBvcHRpb25zOiByMiB9KTtcbiAgICAgICAgfSB9LCB7IGtleTogXCJnZXREb2NJbmRleFwiLCB2YWx1ZTogZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICBmb3IgKHZhciBlMiA9IDA7IGUyIDwgdGhpcy5kb2N1bWVudHMubGVuZ3RoOyBlMisrKSBpZiAodGhpcy5kb2N1bWVudHNbZTJdLmRvYyA9PT0gdDMpIHJldHVybiBlMjtcbiAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwiZ2V0RG9jT3B0aW9uc1wiLCB2YWx1ZTogZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICB2YXIgZTIgPSB0aGlzLmdldERvY0luZGV4KHQzKTtcbiAgICAgICAgICByZXR1cm4gLTEgPT09IGUyID8gbnVsbCA6IHRoaXMuZG9jdW1lbnRzW2UyXS5vcHRpb25zO1xuICAgICAgICB9IH0sIHsga2V5OiBcIm5vd1wiLCB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuICh0aGlzLndpbmRvdy5EYXRlIHx8IERhdGUpLm5vdygpO1xuICAgICAgICB9IH1dKSwgdDI7XG4gICAgICB9KCk7XG4gICAgICBmdW5jdGlvbiBjbih0Mikge1xuICAgICAgICByZXR1cm4gdDIgJiYgdDIucmVwbGFjZSgvXFwvLiokLywgXCJcIik7XG4gICAgICB9XG4gICAgICB2YXIgbG4gPSBuZXcgc24oKSwgdW4gPSBsbi5pbnRlcmFjdFN0YXRpYywgcG4gPSBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBnbG9iYWxUaGlzID8gZ2xvYmFsVGhpcyA6IHdpbmRvdztcbiAgICAgIGxuLmluaXQocG4pO1xuICAgICAgdmFyIGZuID0gT2JqZWN0LmZyZWV6ZSh7IF9fcHJvdG9fXzogbnVsbCwgZWRnZVRhcmdldDogZnVuY3Rpb24oKSB7XG4gICAgICB9LCBlbGVtZW50czogZnVuY3Rpb24oKSB7XG4gICAgICB9LCBncmlkOiBmdW5jdGlvbih0Mikge1xuICAgICAgICB2YXIgZTIgPSBbW1wieFwiLCBcInlcIl0sIFtcImxlZnRcIiwgXCJ0b3BcIl0sIFtcInJpZ2h0XCIsIFwiYm90dG9tXCJdLCBbXCJ3aWR0aFwiLCBcImhlaWdodFwiXV0uZmlsdGVyKGZ1bmN0aW9uKGUzKSB7XG4gICAgICAgICAgdmFyIG4zID0gZTNbMF0sIHIyID0gZTNbMV07XG4gICAgICAgICAgcmV0dXJuIG4zIGluIHQyIHx8IHIyIGluIHQyO1xuICAgICAgICB9KSwgbjIgPSBmdW5jdGlvbihuMywgcjIpIHtcbiAgICAgICAgICBmb3IgKHZhciBpMiA9IHQyLnJhbmdlLCBvMiA9IHQyLmxpbWl0cywgYTIgPSB2b2lkIDAgPT09IG8yID8geyBsZWZ0OiAtMSAvIDAsIHJpZ2h0OiAxIC8gMCwgdG9wOiAtMSAvIDAsIGJvdHRvbTogMSAvIDAgfSA6IG8yLCBzMiA9IHQyLm9mZnNldCwgYzIgPSB2b2lkIDAgPT09IHMyID8geyB4OiAwLCB5OiAwIH0gOiBzMiwgbDIgPSB7IHJhbmdlOiBpMiwgZ3JpZDogdDIsIHg6IG51bGwsIHk6IG51bGwgfSwgdTIgPSAwOyB1MiA8IGUyLmxlbmd0aDsgdTIrKykge1xuICAgICAgICAgICAgdmFyIHAyID0gZTJbdTJdLCBmMiA9IHAyWzBdLCBkMiA9IHAyWzFdLCBoMiA9IE1hdGgucm91bmQoKG4zIC0gYzIueCkgLyB0MltmMl0pLCB2MiA9IE1hdGgucm91bmQoKHIyIC0gYzIueSkgLyB0MltkMl0pO1xuICAgICAgICAgICAgbDJbZjJdID0gTWF0aC5tYXgoYTIubGVmdCwgTWF0aC5taW4oYTIucmlnaHQsIGgyICogdDJbZjJdICsgYzIueCkpLCBsMltkMl0gPSBNYXRoLm1heChhMi50b3AsIE1hdGgubWluKGEyLmJvdHRvbSwgdjIgKiB0MltkMl0gKyBjMi55KSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBsMjtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIG4yLmdyaWQgPSB0MiwgbjIuY29vcmRGaWVsZHMgPSBlMiwgbjI7XG4gICAgICB9IH0pLCBkbiA9IHsgaWQ6IFwic25hcHBlcnNcIiwgaW5zdGFsbDogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuaW50ZXJhY3RTdGF0aWM7XG4gICAgICAgIGUyLnNuYXBwZXJzID0gVihlMi5zbmFwcGVycyB8fCB7fSwgZm4pLCBlMi5jcmVhdGVTbmFwR3JpZCA9IGUyLnNuYXBwZXJzLmdyaWQ7XG4gICAgICB9IH0sIGhuID0gZG4sIHZuID0geyBzdGFydDogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIG4yID0gdDIuc3RhdGUsIHIyID0gdDIucmVjdCwgaTIgPSB0Mi5lZGdlcywgbzIgPSB0Mi5wYWdlQ29vcmRzLCBhMiA9IG4yLm9wdGlvbnMsIHMyID0gYTIucmF0aW8sIGMyID0gYTIuZW5hYmxlZCwgbDIgPSBuMi5vcHRpb25zLCB1MiA9IGwyLmVxdWFsRGVsdGEsIHAyID0gbDIubW9kaWZpZXJzO1xuICAgICAgICBcInByZXNlcnZlXCIgPT09IHMyICYmIChzMiA9IHIyLndpZHRoIC8gcjIuaGVpZ2h0KSwgbjIuc3RhcnRDb29yZHMgPSBWKHt9LCBvMiksIG4yLnN0YXJ0UmVjdCA9IFYoe30sIHIyKSwgbjIucmF0aW8gPSBzMiwgbjIuZXF1YWxEZWx0YSA9IHUyO1xuICAgICAgICB2YXIgZjIgPSBuMi5saW5rZWRFZGdlcyA9IHsgdG9wOiBpMi50b3AgfHwgaTIubGVmdCAmJiAhaTIuYm90dG9tLCBsZWZ0OiBpMi5sZWZ0IHx8IGkyLnRvcCAmJiAhaTIucmlnaHQsIGJvdHRvbTogaTIuYm90dG9tIHx8IGkyLnJpZ2h0ICYmICFpMi50b3AsIHJpZ2h0OiBpMi5yaWdodCB8fCBpMi5ib3R0b20gJiYgIWkyLmxlZnQgfTtcbiAgICAgICAgaWYgKG4yLnhJc1ByaW1hcnlBeGlzID0gISghaTIubGVmdCAmJiAhaTIucmlnaHQpLCBuMi5lcXVhbERlbHRhKSB7XG4gICAgICAgICAgdmFyIGQyID0gKGYyLmxlZnQgPyAxIDogLTEpICogKGYyLnRvcCA/IDEgOiAtMSk7XG4gICAgICAgICAgbjIuZWRnZVNpZ24gPSB7IHg6IGQyLCB5OiBkMiB9O1xuICAgICAgICB9IGVsc2UgbjIuZWRnZVNpZ24gPSB7IHg6IGYyLmxlZnQgPyAtMSA6IDEsIHk6IGYyLnRvcCA/IC0xIDogMSB9O1xuICAgICAgICBpZiAoZmFsc2UgIT09IGMyICYmIFYoaTIsIGYyKSwgbnVsbCAhPSBwMiAmJiBwMi5sZW5ndGgpIHtcbiAgICAgICAgICB2YXIgaDIgPSBuZXcgbWUodDIuaW50ZXJhY3Rpb24pO1xuICAgICAgICAgIGgyLmNvcHlGcm9tKHQyLmludGVyYWN0aW9uLm1vZGlmaWNhdGlvbiksIGgyLnByZXBhcmVTdGF0ZXMocDIpLCBuMi5zdWJNb2RpZmljYXRpb24gPSBoMiwgaDIuc3RhcnRBbGwoZSh7fSwgdDIpKTtcbiAgICAgICAgfVxuICAgICAgfSwgc2V0OiBmdW5jdGlvbih0Mikge1xuICAgICAgICB2YXIgbjIgPSB0Mi5zdGF0ZSwgcjIgPSB0Mi5yZWN0LCBpMiA9IHQyLmNvb3JkcywgbzIgPSBuMi5saW5rZWRFZGdlcywgYTIgPSBWKHt9LCBpMiksIHMyID0gbjIuZXF1YWxEZWx0YSA/IGduIDogbW47XG4gICAgICAgIGlmIChWKHQyLmVkZ2VzLCBvMiksIHMyKG4yLCBuMi54SXNQcmltYXJ5QXhpcywgaTIsIHIyKSwgIW4yLnN1Yk1vZGlmaWNhdGlvbikgcmV0dXJuIG51bGw7XG4gICAgICAgIHZhciBjMiA9IFYoe30sIHIyKTtcbiAgICAgICAgSChvMiwgYzIsIHsgeDogaTIueCAtIGEyLngsIHk6IGkyLnkgLSBhMi55IH0pO1xuICAgICAgICB2YXIgbDIgPSBuMi5zdWJNb2RpZmljYXRpb24uc2V0QWxsKGUoZSh7fSwgdDIpLCB7fSwgeyByZWN0OiBjMiwgZWRnZXM6IG8yLCBwYWdlQ29vcmRzOiBpMiwgcHJldkNvb3JkczogaTIsIHByZXZSZWN0OiBjMiB9KSksIHUyID0gbDIuZGVsdGE7XG4gICAgICAgIGwyLmNoYW5nZWQgJiYgKHMyKG4yLCBNYXRoLmFicyh1Mi54KSA+IE1hdGguYWJzKHUyLnkpLCBsMi5jb29yZHMsIGwyLnJlY3QpLCBWKGkyLCBsMi5jb29yZHMpKTtcbiAgICAgICAgcmV0dXJuIGwyLmV2ZW50UHJvcHM7XG4gICAgICB9LCBkZWZhdWx0czogeyByYXRpbzogXCJwcmVzZXJ2ZVwiLCBlcXVhbERlbHRhOiBmYWxzZSwgbW9kaWZpZXJzOiBbXSwgZW5hYmxlZDogZmFsc2UgfSB9O1xuICAgICAgZnVuY3Rpb24gZ24odDIsIGUyLCBuMikge1xuICAgICAgICB2YXIgcjIgPSB0Mi5zdGFydENvb3JkcywgaTIgPSB0Mi5lZGdlU2lnbjtcbiAgICAgICAgZTIgPyBuMi55ID0gcjIueSArIChuMi54IC0gcjIueCkgKiBpMi55IDogbjIueCA9IHIyLnggKyAobjIueSAtIHIyLnkpICogaTIueDtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIG1uKHQyLCBlMiwgbjIsIHIyKSB7XG4gICAgICAgIHZhciBpMiA9IHQyLnN0YXJ0UmVjdCwgbzIgPSB0Mi5zdGFydENvb3JkcywgYTIgPSB0Mi5yYXRpbywgczIgPSB0Mi5lZGdlU2lnbjtcbiAgICAgICAgaWYgKGUyKSB7XG4gICAgICAgICAgdmFyIGMyID0gcjIud2lkdGggLyBhMjtcbiAgICAgICAgICBuMi55ID0gbzIueSArIChjMiAtIGkyLmhlaWdodCkgKiBzMi55O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBsMiA9IHIyLmhlaWdodCAqIGEyO1xuICAgICAgICAgIG4yLnggPSBvMi54ICsgKGwyIC0gaTIud2lkdGgpICogczIueDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdmFyIHluID0gYmUodm4sIFwiYXNwZWN0UmF0aW9cIiksIGJuID0gZnVuY3Rpb24oKSB7XG4gICAgICB9O1xuICAgICAgYm4uX2RlZmF1bHRzID0ge307XG4gICAgICB2YXIgeG4gPSBibjtcbiAgICAgIGZ1bmN0aW9uIHduKHQyLCBlMiwgbjIpIHtcbiAgICAgICAgcmV0dXJuIHcuZnVuYyh0MikgPyBHKHQyLCBlMi5pbnRlcmFjdGFibGUsIGUyLmVsZW1lbnQsIFtuMi54LCBuMi55LCBlMl0pIDogRyh0MiwgZTIuaW50ZXJhY3RhYmxlLCBlMi5lbGVtZW50KTtcbiAgICAgIH1cbiAgICAgIHZhciBFbiA9IHsgc3RhcnQ6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHZhciBlMiA9IHQyLnJlY3QsIG4yID0gdDIuc3RhcnRPZmZzZXQsIHIyID0gdDIuc3RhdGUsIGkyID0gdDIuaW50ZXJhY3Rpb24sIG8yID0gdDIucGFnZUNvb3JkcywgYTIgPSByMi5vcHRpb25zLCBzMiA9IGEyLmVsZW1lbnRSZWN0LCBjMiA9IFYoeyBsZWZ0OiAwLCB0b3A6IDAsIHJpZ2h0OiAwLCBib3R0b206IDAgfSwgYTIub2Zmc2V0IHx8IHt9KTtcbiAgICAgICAgaWYgKGUyICYmIHMyKSB7XG4gICAgICAgICAgdmFyIGwyID0gd24oYTIucmVzdHJpY3Rpb24sIGkyLCBvMik7XG4gICAgICAgICAgaWYgKGwyKSB7XG4gICAgICAgICAgICB2YXIgdTIgPSBsMi5yaWdodCAtIGwyLmxlZnQgLSBlMi53aWR0aCwgcDIgPSBsMi5ib3R0b20gLSBsMi50b3AgLSBlMi5oZWlnaHQ7XG4gICAgICAgICAgICB1MiA8IDAgJiYgKGMyLmxlZnQgKz0gdTIsIGMyLnJpZ2h0ICs9IHUyKSwgcDIgPCAwICYmIChjMi50b3AgKz0gcDIsIGMyLmJvdHRvbSArPSBwMik7XG4gICAgICAgICAgfVxuICAgICAgICAgIGMyLmxlZnQgKz0gbjIubGVmdCAtIGUyLndpZHRoICogczIubGVmdCwgYzIudG9wICs9IG4yLnRvcCAtIGUyLmhlaWdodCAqIHMyLnRvcCwgYzIucmlnaHQgKz0gbjIucmlnaHQgLSBlMi53aWR0aCAqICgxIC0gczIucmlnaHQpLCBjMi5ib3R0b20gKz0gbjIuYm90dG9tIC0gZTIuaGVpZ2h0ICogKDEgLSBzMi5ib3R0b20pO1xuICAgICAgICB9XG4gICAgICAgIHIyLm9mZnNldCA9IGMyO1xuICAgICAgfSwgc2V0OiBmdW5jdGlvbih0Mikge1xuICAgICAgICB2YXIgZTIgPSB0Mi5jb29yZHMsIG4yID0gdDIuaW50ZXJhY3Rpb24sIHIyID0gdDIuc3RhdGUsIGkyID0gcjIub3B0aW9ucywgbzIgPSByMi5vZmZzZXQsIGEyID0gd24oaTIucmVzdHJpY3Rpb24sIG4yLCBlMik7XG4gICAgICAgIGlmIChhMikge1xuICAgICAgICAgIHZhciBzMiA9IGZ1bmN0aW9uKHQzKSB7XG4gICAgICAgICAgICByZXR1cm4gIXQzIHx8IFwibGVmdFwiIGluIHQzICYmIFwidG9wXCIgaW4gdDMgfHwgKCh0MyA9IFYoe30sIHQzKSkubGVmdCA9IHQzLnggfHwgMCwgdDMudG9wID0gdDMueSB8fCAwLCB0My5yaWdodCA9IHQzLnJpZ2h0IHx8IHQzLmxlZnQgKyB0My53aWR0aCwgdDMuYm90dG9tID0gdDMuYm90dG9tIHx8IHQzLnRvcCArIHQzLmhlaWdodCksIHQzO1xuICAgICAgICAgIH0oYTIpO1xuICAgICAgICAgIGUyLnggPSBNYXRoLm1heChNYXRoLm1pbihzMi5yaWdodCAtIG8yLnJpZ2h0LCBlMi54KSwgczIubGVmdCArIG8yLmxlZnQpLCBlMi55ID0gTWF0aC5tYXgoTWF0aC5taW4oczIuYm90dG9tIC0gbzIuYm90dG9tLCBlMi55KSwgczIudG9wICsgbzIudG9wKTtcbiAgICAgICAgfVxuICAgICAgfSwgZGVmYXVsdHM6IHsgcmVzdHJpY3Rpb246IG51bGwsIGVsZW1lbnRSZWN0OiBudWxsLCBvZmZzZXQ6IG51bGwsIGVuZE9ubHk6IGZhbHNlLCBlbmFibGVkOiBmYWxzZSB9IH0sIFRuID0gYmUoRW4sIFwicmVzdHJpY3RcIiksIFNuID0geyB0b3A6IDEgLyAwLCBsZWZ0OiAxIC8gMCwgYm90dG9tOiAtMSAvIDAsIHJpZ2h0OiAtMSAvIDAgfSwgX24gPSB7IHRvcDogLTEgLyAwLCBsZWZ0OiAtMSAvIDAsIGJvdHRvbTogMSAvIDAsIHJpZ2h0OiAxIC8gMCB9O1xuICAgICAgZnVuY3Rpb24gUG4odDIsIGUyKSB7XG4gICAgICAgIGZvciAodmFyIG4yID0gMCwgcjIgPSBbXCJ0b3BcIiwgXCJsZWZ0XCIsIFwiYm90dG9tXCIsIFwicmlnaHRcIl07IG4yIDwgcjIubGVuZ3RoOyBuMisrKSB7XG4gICAgICAgICAgdmFyIGkyID0gcjJbbjJdO1xuICAgICAgICAgIGkyIGluIHQyIHx8ICh0MltpMl0gPSBlMltpMl0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0MjtcbiAgICAgIH1cbiAgICAgIHZhciBPbiA9IHsgbm9Jbm5lcjogU24sIG5vT3V0ZXI6IF9uLCBzdGFydDogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyLCBuMiA9IHQyLmludGVyYWN0aW9uLCByMiA9IHQyLnN0YXJ0T2Zmc2V0LCBpMiA9IHQyLnN0YXRlLCBvMiA9IGkyLm9wdGlvbnM7XG4gICAgICAgIG8yICYmIChlMiA9IE4od24obzIub2Zmc2V0LCBuMiwgbjIuY29vcmRzLnN0YXJ0LnBhZ2UpKSksIGUyID0gZTIgfHwgeyB4OiAwLCB5OiAwIH0sIGkyLm9mZnNldCA9IHsgdG9wOiBlMi55ICsgcjIudG9wLCBsZWZ0OiBlMi54ICsgcjIubGVmdCwgYm90dG9tOiBlMi55IC0gcjIuYm90dG9tLCByaWdodDogZTIueCAtIHIyLnJpZ2h0IH07XG4gICAgICB9LCBzZXQ6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHZhciBlMiA9IHQyLmNvb3JkcywgbjIgPSB0Mi5lZGdlcywgcjIgPSB0Mi5pbnRlcmFjdGlvbiwgaTIgPSB0Mi5zdGF0ZSwgbzIgPSBpMi5vZmZzZXQsIGEyID0gaTIub3B0aW9ucztcbiAgICAgICAgaWYgKG4yKSB7XG4gICAgICAgICAgdmFyIHMyID0gVih7fSwgZTIpLCBjMiA9IHduKGEyLmlubmVyLCByMiwgczIpIHx8IHt9LCBsMiA9IHduKGEyLm91dGVyLCByMiwgczIpIHx8IHt9O1xuICAgICAgICAgIFBuKGMyLCBTbiksIFBuKGwyLCBfbiksIG4yLnRvcCA/IGUyLnkgPSBNYXRoLm1pbihNYXRoLm1heChsMi50b3AgKyBvMi50b3AsIHMyLnkpLCBjMi50b3AgKyBvMi50b3ApIDogbjIuYm90dG9tICYmIChlMi55ID0gTWF0aC5tYXgoTWF0aC5taW4obDIuYm90dG9tICsgbzIuYm90dG9tLCBzMi55KSwgYzIuYm90dG9tICsgbzIuYm90dG9tKSksIG4yLmxlZnQgPyBlMi54ID0gTWF0aC5taW4oTWF0aC5tYXgobDIubGVmdCArIG8yLmxlZnQsIHMyLngpLCBjMi5sZWZ0ICsgbzIubGVmdCkgOiBuMi5yaWdodCAmJiAoZTIueCA9IE1hdGgubWF4KE1hdGgubWluKGwyLnJpZ2h0ICsgbzIucmlnaHQsIHMyLngpLCBjMi5yaWdodCArIG8yLnJpZ2h0KSk7XG4gICAgICAgIH1cbiAgICAgIH0sIGRlZmF1bHRzOiB7IGlubmVyOiBudWxsLCBvdXRlcjogbnVsbCwgb2Zmc2V0OiBudWxsLCBlbmRPbmx5OiBmYWxzZSwgZW5hYmxlZDogZmFsc2UgfSB9LCBrbiA9IGJlKE9uLCBcInJlc3RyaWN0RWRnZXNcIiksIERuID0gVih7IGdldCBlbGVtZW50UmVjdCgpIHtcbiAgICAgICAgcmV0dXJuIHsgdG9wOiAwLCBsZWZ0OiAwLCBib3R0b206IDEsIHJpZ2h0OiAxIH07XG4gICAgICB9LCBzZXQgZWxlbWVudFJlY3QodDIpIHtcbiAgICAgIH0gfSwgRW4uZGVmYXVsdHMpLCBJbiA9IGJlKHsgc3RhcnQ6IEVuLnN0YXJ0LCBzZXQ6IEVuLnNldCwgZGVmYXVsdHM6IERuIH0sIFwicmVzdHJpY3RSZWN0XCIpLCBNbiA9IHsgd2lkdGg6IC0xIC8gMCwgaGVpZ2h0OiAtMSAvIDAgfSwgem4gPSB7IHdpZHRoOiAxIC8gMCwgaGVpZ2h0OiAxIC8gMCB9O1xuICAgICAgdmFyIEFuID0gYmUoeyBzdGFydDogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgcmV0dXJuIE9uLnN0YXJ0KHQyKTtcbiAgICAgIH0sIHNldDogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuaW50ZXJhY3Rpb24sIG4yID0gdDIuc3RhdGUsIHIyID0gdDIucmVjdCwgaTIgPSB0Mi5lZGdlcywgbzIgPSBuMi5vcHRpb25zO1xuICAgICAgICBpZiAoaTIpIHtcbiAgICAgICAgICB2YXIgYTIgPSBVKHduKG8yLm1pbiwgZTIsIHQyLmNvb3JkcykpIHx8IE1uLCBzMiA9IFUod24obzIubWF4LCBlMiwgdDIuY29vcmRzKSkgfHwgem47XG4gICAgICAgICAgbjIub3B0aW9ucyA9IHsgZW5kT25seTogbzIuZW5kT25seSwgaW5uZXI6IFYoe30sIE9uLm5vSW5uZXIpLCBvdXRlcjogVih7fSwgT24ubm9PdXRlcikgfSwgaTIudG9wID8gKG4yLm9wdGlvbnMuaW5uZXIudG9wID0gcjIuYm90dG9tIC0gYTIuaGVpZ2h0LCBuMi5vcHRpb25zLm91dGVyLnRvcCA9IHIyLmJvdHRvbSAtIHMyLmhlaWdodCkgOiBpMi5ib3R0b20gJiYgKG4yLm9wdGlvbnMuaW5uZXIuYm90dG9tID0gcjIudG9wICsgYTIuaGVpZ2h0LCBuMi5vcHRpb25zLm91dGVyLmJvdHRvbSA9IHIyLnRvcCArIHMyLmhlaWdodCksIGkyLmxlZnQgPyAobjIub3B0aW9ucy5pbm5lci5sZWZ0ID0gcjIucmlnaHQgLSBhMi53aWR0aCwgbjIub3B0aW9ucy5vdXRlci5sZWZ0ID0gcjIucmlnaHQgLSBzMi53aWR0aCkgOiBpMi5yaWdodCAmJiAobjIub3B0aW9ucy5pbm5lci5yaWdodCA9IHIyLmxlZnQgKyBhMi53aWR0aCwgbjIub3B0aW9ucy5vdXRlci5yaWdodCA9IHIyLmxlZnQgKyBzMi53aWR0aCksIE9uLnNldCh0MiksIG4yLm9wdGlvbnMgPSBvMjtcbiAgICAgICAgfVxuICAgICAgfSwgZGVmYXVsdHM6IHsgbWluOiBudWxsLCBtYXg6IG51bGwsIGVuZE9ubHk6IGZhbHNlLCBlbmFibGVkOiBmYWxzZSB9IH0sIFwicmVzdHJpY3RTaXplXCIpO1xuICAgICAgdmFyIFJuID0geyBzdGFydDogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyLCBuMiA9IHQyLmludGVyYWN0aW9uLCByMiA9IHQyLmludGVyYWN0YWJsZSwgaTIgPSB0Mi5lbGVtZW50LCBvMiA9IHQyLnJlY3QsIGEyID0gdDIuc3RhdGUsIHMyID0gdDIuc3RhcnRPZmZzZXQsIGMyID0gYTIub3B0aW9ucywgbDIgPSBjMi5vZmZzZXRXaXRoT3JpZ2luID8gZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICB2YXIgZTMgPSB0My5pbnRlcmFjdGlvbi5lbGVtZW50LCBuMyA9IE4oRyh0My5zdGF0ZS5vcHRpb25zLm9yaWdpbiwgbnVsbCwgbnVsbCwgW2UzXSkpLCByMyA9IG4zIHx8IEsodDMuaW50ZXJhY3RhYmxlLCBlMywgdDMuaW50ZXJhY3Rpb24ucHJlcGFyZWQubmFtZSk7XG4gICAgICAgICAgcmV0dXJuIHIzO1xuICAgICAgICB9KHQyKSA6IHsgeDogMCwgeTogMCB9O1xuICAgICAgICBpZiAoXCJzdGFydENvb3Jkc1wiID09PSBjMi5vZmZzZXQpIGUyID0geyB4OiBuMi5jb29yZHMuc3RhcnQucGFnZS54LCB5OiBuMi5jb29yZHMuc3RhcnQucGFnZS55IH07XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHZhciB1MiA9IEcoYzIub2Zmc2V0LCByMiwgaTIsIFtuMl0pO1xuICAgICAgICAgIChlMiA9IE4odTIpIHx8IHsgeDogMCwgeTogMCB9KS54ICs9IGwyLngsIGUyLnkgKz0gbDIueTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcDIgPSBjMi5yZWxhdGl2ZVBvaW50cztcbiAgICAgICAgYTIub2Zmc2V0cyA9IG8yICYmIHAyICYmIHAyLmxlbmd0aCA/IHAyLm1hcChmdW5jdGlvbih0MywgbjMpIHtcbiAgICAgICAgICByZXR1cm4geyBpbmRleDogbjMsIHJlbGF0aXZlUG9pbnQ6IHQzLCB4OiBzMi5sZWZ0IC0gbzIud2lkdGggKiB0My54ICsgZTIueCwgeTogczIudG9wIC0gbzIuaGVpZ2h0ICogdDMueSArIGUyLnkgfTtcbiAgICAgICAgfSkgOiBbeyBpbmRleDogMCwgcmVsYXRpdmVQb2ludDogbnVsbCwgeDogZTIueCwgeTogZTIueSB9XTtcbiAgICAgIH0sIHNldDogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuaW50ZXJhY3Rpb24sIG4yID0gdDIuY29vcmRzLCByMiA9IHQyLnN0YXRlLCBpMiA9IHIyLm9wdGlvbnMsIG8yID0gcjIub2Zmc2V0cywgYTIgPSBLKGUyLmludGVyYWN0YWJsZSwgZTIuZWxlbWVudCwgZTIucHJlcGFyZWQubmFtZSksIHMyID0gVih7fSwgbjIpLCBjMiA9IFtdO1xuICAgICAgICBpMi5vZmZzZXRXaXRoT3JpZ2luIHx8IChzMi54IC09IGEyLngsIHMyLnkgLT0gYTIueSk7XG4gICAgICAgIGZvciAodmFyIGwyID0gMCwgdTIgPSBvMjsgbDIgPCB1Mi5sZW5ndGg7IGwyKyspIGZvciAodmFyIHAyID0gdTJbbDJdLCBmMiA9IHMyLnggLSBwMi54LCBkMiA9IHMyLnkgLSBwMi55LCBoMiA9IDAsIHYyID0gaTIudGFyZ2V0cy5sZW5ndGg7IGgyIDwgdjI7IGgyKyspIHtcbiAgICAgICAgICB2YXIgZzIgPSBpMi50YXJnZXRzW2gyXSwgbTIgPSB2b2lkIDA7XG4gICAgICAgICAgKG0yID0gdy5mdW5jKGcyKSA/IGcyKGYyLCBkMiwgZTIuX3Byb3h5LCBwMiwgaDIpIDogZzIpICYmIGMyLnB1c2goeyB4OiAody5udW1iZXIobTIueCkgPyBtMi54IDogZjIpICsgcDIueCwgeTogKHcubnVtYmVyKG0yLnkpID8gbTIueSA6IGQyKSArIHAyLnksIHJhbmdlOiB3Lm51bWJlcihtMi5yYW5nZSkgPyBtMi5yYW5nZSA6IGkyLnJhbmdlLCBzb3VyY2U6IGcyLCBpbmRleDogaDIsIG9mZnNldDogcDIgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgeTIgPSB7IHRhcmdldDogbnVsbCwgaW5SYW5nZTogZmFsc2UsIGRpc3RhbmNlOiAwLCByYW5nZTogMCwgZGVsdGE6IHsgeDogMCwgeTogMCB9IH0sIGIyID0gMDsgYjIgPCBjMi5sZW5ndGg7IGIyKyspIHtcbiAgICAgICAgICB2YXIgeDIgPSBjMltiMl0sIEUyID0geDIucmFuZ2UsIFQyID0geDIueCAtIHMyLngsIFMyID0geDIueSAtIHMyLnksIF8yID0gUShUMiwgUzIpLCBQMiA9IF8yIDw9IEUyO1xuICAgICAgICAgIEUyID09PSAxIC8gMCAmJiB5Mi5pblJhbmdlICYmIHkyLnJhbmdlICE9PSAxIC8gMCAmJiAoUDIgPSBmYWxzZSksIHkyLnRhcmdldCAmJiAhKFAyID8geTIuaW5SYW5nZSAmJiBFMiAhPT0gMSAvIDAgPyBfMiAvIEUyIDwgeTIuZGlzdGFuY2UgLyB5Mi5yYW5nZSA6IEUyID09PSAxIC8gMCAmJiB5Mi5yYW5nZSAhPT0gMSAvIDAgfHwgXzIgPCB5Mi5kaXN0YW5jZSA6ICF5Mi5pblJhbmdlICYmIF8yIDwgeTIuZGlzdGFuY2UpIHx8ICh5Mi50YXJnZXQgPSB4MiwgeTIuZGlzdGFuY2UgPSBfMiwgeTIucmFuZ2UgPSBFMiwgeTIuaW5SYW5nZSA9IFAyLCB5Mi5kZWx0YS54ID0gVDIsIHkyLmRlbHRhLnkgPSBTMik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHkyLmluUmFuZ2UgJiYgKG4yLnggPSB5Mi50YXJnZXQueCwgbjIueSA9IHkyLnRhcmdldC55KSwgcjIuY2xvc2VzdCA9IHkyLCB5MjtcbiAgICAgIH0sIGRlZmF1bHRzOiB7IHJhbmdlOiAxIC8gMCwgdGFyZ2V0czogbnVsbCwgb2Zmc2V0OiBudWxsLCBvZmZzZXRXaXRoT3JpZ2luOiB0cnVlLCBvcmlnaW46IG51bGwsIHJlbGF0aXZlUG9pbnRzOiBudWxsLCBlbmRPbmx5OiBmYWxzZSwgZW5hYmxlZDogZmFsc2UgfSB9LCBDbiA9IGJlKFJuLCBcInNuYXBcIik7XG4gICAgICB2YXIgam4gPSB7IHN0YXJ0OiBmdW5jdGlvbih0Mikge1xuICAgICAgICB2YXIgZTIgPSB0Mi5zdGF0ZSwgbjIgPSB0Mi5lZGdlcywgcjIgPSBlMi5vcHRpb25zO1xuICAgICAgICBpZiAoIW4yKSByZXR1cm4gbnVsbDtcbiAgICAgICAgdDIuc3RhdGUgPSB7IG9wdGlvbnM6IHsgdGFyZ2V0czogbnVsbCwgcmVsYXRpdmVQb2ludHM6IFt7IHg6IG4yLmxlZnQgPyAwIDogMSwgeTogbjIudG9wID8gMCA6IDEgfV0sIG9mZnNldDogcjIub2Zmc2V0IHx8IFwic2VsZlwiLCBvcmlnaW46IHsgeDogMCwgeTogMCB9LCByYW5nZTogcjIucmFuZ2UgfSB9LCBlMi50YXJnZXRGaWVsZHMgPSBlMi50YXJnZXRGaWVsZHMgfHwgW1tcIndpZHRoXCIsIFwiaGVpZ2h0XCJdLCBbXCJ4XCIsIFwieVwiXV0sIFJuLnN0YXJ0KHQyKSwgZTIub2Zmc2V0cyA9IHQyLnN0YXRlLm9mZnNldHMsIHQyLnN0YXRlID0gZTI7XG4gICAgICB9LCBzZXQ6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHZhciBlMiA9IHQyLmludGVyYWN0aW9uLCBuMiA9IHQyLnN0YXRlLCByMiA9IHQyLmNvb3JkcywgaTIgPSBuMi5vcHRpb25zLCBvMiA9IG4yLm9mZnNldHMsIGEyID0geyB4OiByMi54IC0gbzJbMF0ueCwgeTogcjIueSAtIG8yWzBdLnkgfTtcbiAgICAgICAgbjIub3B0aW9ucyA9IFYoe30sIGkyKSwgbjIub3B0aW9ucy50YXJnZXRzID0gW107XG4gICAgICAgIGZvciAodmFyIHMyID0gMCwgYzIgPSBpMi50YXJnZXRzIHx8IFtdOyBzMiA8IGMyLmxlbmd0aDsgczIrKykge1xuICAgICAgICAgIHZhciBsMiA9IGMyW3MyXSwgdTIgPSB2b2lkIDA7XG4gICAgICAgICAgaWYgKHUyID0gdy5mdW5jKGwyKSA/IGwyKGEyLngsIGEyLnksIGUyKSA6IGwyKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBwMiA9IDAsIGYyID0gbjIudGFyZ2V0RmllbGRzOyBwMiA8IGYyLmxlbmd0aDsgcDIrKykge1xuICAgICAgICAgICAgICB2YXIgZDIgPSBmMltwMl0sIGgyID0gZDJbMF0sIHYyID0gZDJbMV07XG4gICAgICAgICAgICAgIGlmIChoMiBpbiB1MiB8fCB2MiBpbiB1Mikge1xuICAgICAgICAgICAgICAgIHUyLnggPSB1MltoMl0sIHUyLnkgPSB1Mlt2Ml07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG4yLm9wdGlvbnMudGFyZ2V0cy5wdXNoKHUyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGcyID0gUm4uc2V0KHQyKTtcbiAgICAgICAgcmV0dXJuIG4yLm9wdGlvbnMgPSBpMiwgZzI7XG4gICAgICB9LCBkZWZhdWx0czogeyByYW5nZTogMSAvIDAsIHRhcmdldHM6IG51bGwsIG9mZnNldDogbnVsbCwgZW5kT25seTogZmFsc2UsIGVuYWJsZWQ6IGZhbHNlIH0gfSwgRm4gPSBiZShqbiwgXCJzbmFwU2l6ZVwiKTtcbiAgICAgIHZhciBYbiA9IHsgYXNwZWN0UmF0aW86IHluLCByZXN0cmljdEVkZ2VzOiBrbiwgcmVzdHJpY3Q6IFRuLCByZXN0cmljdFJlY3Q6IEluLCByZXN0cmljdFNpemU6IEFuLCBzbmFwRWRnZXM6IGJlKHsgc3RhcnQ6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHZhciBlMiA9IHQyLmVkZ2VzO1xuICAgICAgICByZXR1cm4gZTIgPyAodDIuc3RhdGUudGFyZ2V0RmllbGRzID0gdDIuc3RhdGUudGFyZ2V0RmllbGRzIHx8IFtbZTIubGVmdCA/IFwibGVmdFwiIDogXCJyaWdodFwiLCBlMi50b3AgPyBcInRvcFwiIDogXCJib3R0b21cIl1dLCBqbi5zdGFydCh0MikpIDogbnVsbDtcbiAgICAgIH0sIHNldDogam4uc2V0LCBkZWZhdWx0czogVihnZShqbi5kZWZhdWx0cyksIHsgdGFyZ2V0czogdm9pZCAwLCByYW5nZTogdm9pZCAwLCBvZmZzZXQ6IHsgeDogMCwgeTogMCB9IH0pIH0sIFwic25hcEVkZ2VzXCIpLCBzbmFwOiBDbiwgc25hcFNpemU6IEZuLCBzcHJpbmc6IHhuLCBhdm9pZDogeG4sIHRyYW5zZm9ybTogeG4sIHJ1YmJlcmJhbmQ6IHhuIH0sIFluID0geyBpZDogXCJtb2RpZmllcnNcIiwgaW5zdGFsbDogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuaW50ZXJhY3RTdGF0aWM7XG4gICAgICAgIGZvciAodmFyIG4yIGluIHQyLnVzZVBsdWdpbihFZSksIHQyLnVzZVBsdWdpbihobiksIGUyLm1vZGlmaWVycyA9IFhuLCBYbikge1xuICAgICAgICAgIHZhciByMiA9IFhuW24yXSwgaTIgPSByMi5fZGVmYXVsdHMsIG8yID0gcjIuX21ldGhvZHM7XG4gICAgICAgICAgaTIuX21ldGhvZHMgPSBvMiwgdDIuZGVmYXVsdHMucGVyQWN0aW9uW24yXSA9IGkyO1xuICAgICAgICB9XG4gICAgICB9IH0sIExuID0gWW4sIHFuID0gZnVuY3Rpb24odDIpIHtcbiAgICAgICAgcyhuMiwgdDIpO1xuICAgICAgICB2YXIgZTIgPSBwKG4yKTtcbiAgICAgICAgZnVuY3Rpb24gbjIodDMsIGkyLCBvMiwgYTIsIHMyLCBjMikge1xuICAgICAgICAgIHZhciBsMjtcbiAgICAgICAgICBpZiAocih0aGlzLCBuMiksIHR0KHUobDIgPSBlMi5jYWxsKHRoaXMsIHMyKSksIG8yKSwgbzIgIT09IGkyICYmIHR0KHUobDIpLCBpMiksIGwyLnRpbWVTdGFtcCA9IGMyLCBsMi5vcmlnaW5hbEV2ZW50ID0gbzIsIGwyLnR5cGUgPSB0MywgbDIucG9pbnRlcklkID0gYXQoaTIpLCBsMi5wb2ludGVyVHlwZSA9IGR0KGkyKSwgbDIudGFyZ2V0ID0gYTIsIGwyLmN1cnJlbnRUYXJnZXQgPSBudWxsLCBcInRhcFwiID09PSB0Mykge1xuICAgICAgICAgICAgdmFyIHAyID0gczIuZ2V0UG9pbnRlckluZGV4KGkyKTtcbiAgICAgICAgICAgIGwyLmR0ID0gbDIudGltZVN0YW1wIC0gczIucG9pbnRlcnNbcDJdLmRvd25UaW1lO1xuICAgICAgICAgICAgdmFyIGYyID0gbDIudGltZVN0YW1wIC0gczIudGFwVGltZTtcbiAgICAgICAgICAgIGwyLmRvdWJsZSA9ICEhczIucHJldlRhcCAmJiBcImRvdWJsZXRhcFwiICE9PSBzMi5wcmV2VGFwLnR5cGUgJiYgczIucHJldlRhcC50YXJnZXQgPT09IGwyLnRhcmdldCAmJiBmMiA8IDUwMDtcbiAgICAgICAgICB9IGVsc2UgXCJkb3VibGV0YXBcIiA9PT0gdDMgJiYgKGwyLmR0ID0gaTIudGltZVN0YW1wIC0gczIudGFwVGltZSwgbDIuZG91YmxlID0gdHJ1ZSk7XG4gICAgICAgICAgcmV0dXJuIGwyO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvKG4yLCBbeyBrZXk6IFwiX3N1YnRyYWN0T3JpZ2luXCIsIHZhbHVlOiBmdW5jdGlvbih0Mykge1xuICAgICAgICAgIHZhciBlMyA9IHQzLngsIG4zID0gdDMueTtcbiAgICAgICAgICByZXR1cm4gdGhpcy5wYWdlWCAtPSBlMywgdGhpcy5wYWdlWSAtPSBuMywgdGhpcy5jbGllbnRYIC09IGUzLCB0aGlzLmNsaWVudFkgLT0gbjMsIHRoaXM7XG4gICAgICAgIH0gfSwgeyBrZXk6IFwiX2FkZE9yaWdpblwiLCB2YWx1ZTogZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICB2YXIgZTMgPSB0My54LCBuMyA9IHQzLnk7XG4gICAgICAgICAgcmV0dXJuIHRoaXMucGFnZVggKz0gZTMsIHRoaXMucGFnZVkgKz0gbjMsIHRoaXMuY2xpZW50WCArPSBlMywgdGhpcy5jbGllbnRZICs9IG4zLCB0aGlzO1xuICAgICAgICB9IH0sIHsga2V5OiBcInByZXZlbnREZWZhdWx0XCIsIHZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aGlzLm9yaWdpbmFsRXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfSB9XSksIG4yO1xuICAgICAgfSh2dCksIEJuID0geyBpZDogXCJwb2ludGVyLWV2ZW50cy9iYXNlXCIsIGJlZm9yZTogW1wiaW5lcnRpYVwiLCBcIm1vZGlmaWVyc1wiLCBcImF1dG8tc3RhcnRcIiwgXCJhY3Rpb25zXCJdLCBpbnN0YWxsOiBmdW5jdGlvbih0Mikge1xuICAgICAgICB0Mi5wb2ludGVyRXZlbnRzID0gQm4sIHQyLmRlZmF1bHRzLmFjdGlvbnMucG9pbnRlckV2ZW50cyA9IEJuLmRlZmF1bHRzLCBWKHQyLmFjdGlvbnMucGhhc2VsZXNzVHlwZXMsIEJuLnR5cGVzKTtcbiAgICAgIH0sIGxpc3RlbmVyczogeyBcImludGVyYWN0aW9uczpuZXdcIjogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuaW50ZXJhY3Rpb247XG4gICAgICAgIGUyLnByZXZUYXAgPSBudWxsLCBlMi50YXBUaW1lID0gMDtcbiAgICAgIH0sIFwiaW50ZXJhY3Rpb25zOnVwZGF0ZS1wb2ludGVyXCI6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHZhciBlMiA9IHQyLmRvd24sIG4yID0gdDIucG9pbnRlckluZm87XG4gICAgICAgIGlmICghZTIgJiYgbjIuaG9sZCkgcmV0dXJuO1xuICAgICAgICBuMi5ob2xkID0geyBkdXJhdGlvbjogMSAvIDAsIHRpbWVvdXQ6IG51bGwgfTtcbiAgICAgIH0sIFwiaW50ZXJhY3Rpb25zOm1vdmVcIjogZnVuY3Rpb24odDIsIGUyKSB7XG4gICAgICAgIHZhciBuMiA9IHQyLmludGVyYWN0aW9uLCByMiA9IHQyLnBvaW50ZXIsIGkyID0gdDIuZXZlbnQsIG8yID0gdDIuZXZlbnRUYXJnZXQ7XG4gICAgICAgIHQyLmR1cGxpY2F0ZSB8fCBuMi5wb2ludGVySXNEb3duICYmICFuMi5wb2ludGVyV2FzTW92ZWQgfHwgKG4yLnBvaW50ZXJJc0Rvd24gJiYgR24odDIpLCBWbih7IGludGVyYWN0aW9uOiBuMiwgcG9pbnRlcjogcjIsIGV2ZW50OiBpMiwgZXZlbnRUYXJnZXQ6IG8yLCB0eXBlOiBcIm1vdmVcIiB9LCBlMikpO1xuICAgICAgfSwgXCJpbnRlcmFjdGlvbnM6ZG93blwiOiBmdW5jdGlvbih0MiwgZTIpIHtcbiAgICAgICAgIWZ1bmN0aW9uKHQzLCBlMykge1xuICAgICAgICAgIGZvciAodmFyIG4yID0gdDMuaW50ZXJhY3Rpb24sIHIyID0gdDMucG9pbnRlciwgaTIgPSB0My5ldmVudCwgbzIgPSB0My5ldmVudFRhcmdldCwgYTIgPSB0My5wb2ludGVySW5kZXgsIHMyID0gbjIucG9pbnRlcnNbYTJdLmhvbGQsIGMyID0gcShvMiksIGwyID0geyBpbnRlcmFjdGlvbjogbjIsIHBvaW50ZXI6IHIyLCBldmVudDogaTIsIGV2ZW50VGFyZ2V0OiBvMiwgdHlwZTogXCJob2xkXCIsIHRhcmdldHM6IFtdLCBwYXRoOiBjMiwgbm9kZTogbnVsbCB9LCB1MiA9IDA7IHUyIDwgYzIubGVuZ3RoOyB1MisrKSB7XG4gICAgICAgICAgICB2YXIgcDIgPSBjMlt1Ml07XG4gICAgICAgICAgICBsMi5ub2RlID0gcDIsIGUzLmZpcmUoXCJwb2ludGVyRXZlbnRzOmNvbGxlY3QtdGFyZ2V0c1wiLCBsMik7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghbDIudGFyZ2V0cy5sZW5ndGgpIHJldHVybjtcbiAgICAgICAgICBmb3IgKHZhciBmMiA9IDEgLyAwLCBkMiA9IDAsIGgyID0gbDIudGFyZ2V0czsgZDIgPCBoMi5sZW5ndGg7IGQyKyspIHtcbiAgICAgICAgICAgIHZhciB2MiA9IGgyW2QyXS5ldmVudGFibGUub3B0aW9ucy5ob2xkRHVyYXRpb247XG4gICAgICAgICAgICB2MiA8IGYyICYmIChmMiA9IHYyKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgczIuZHVyYXRpb24gPSBmMiwgczIudGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBWbih7IGludGVyYWN0aW9uOiBuMiwgZXZlbnRUYXJnZXQ6IG8yLCBwb2ludGVyOiByMiwgZXZlbnQ6IGkyLCB0eXBlOiBcImhvbGRcIiB9LCBlMyk7XG4gICAgICAgICAgfSwgZjIpO1xuICAgICAgICB9KHQyLCBlMiksIFZuKHQyLCBlMik7XG4gICAgICB9LCBcImludGVyYWN0aW9uczp1cFwiOiBmdW5jdGlvbih0MiwgZTIpIHtcbiAgICAgICAgR24odDIpLCBWbih0MiwgZTIpLCBmdW5jdGlvbih0MywgZTMpIHtcbiAgICAgICAgICB2YXIgbjIgPSB0My5pbnRlcmFjdGlvbiwgcjIgPSB0My5wb2ludGVyLCBpMiA9IHQzLmV2ZW50LCBvMiA9IHQzLmV2ZW50VGFyZ2V0O1xuICAgICAgICAgIG4yLnBvaW50ZXJXYXNNb3ZlZCB8fCBWbih7IGludGVyYWN0aW9uOiBuMiwgZXZlbnRUYXJnZXQ6IG8yLCBwb2ludGVyOiByMiwgZXZlbnQ6IGkyLCB0eXBlOiBcInRhcFwiIH0sIGUzKTtcbiAgICAgICAgfSh0MiwgZTIpO1xuICAgICAgfSwgXCJpbnRlcmFjdGlvbnM6Y2FuY2VsXCI6IGZ1bmN0aW9uKHQyLCBlMikge1xuICAgICAgICBHbih0MiksIFZuKHQyLCBlMik7XG4gICAgICB9IH0sIFBvaW50ZXJFdmVudDogcW4sIGZpcmU6IFZuLCBjb2xsZWN0RXZlbnRUYXJnZXRzOiBXbiwgZGVmYXVsdHM6IHsgaG9sZER1cmF0aW9uOiA2MDAsIGlnbm9yZUZyb206IG51bGwsIGFsbG93RnJvbTogbnVsbCwgb3JpZ2luOiB7IHg6IDAsIHk6IDAgfSB9LCB0eXBlczogeyBkb3duOiB0cnVlLCBtb3ZlOiB0cnVlLCB1cDogdHJ1ZSwgY2FuY2VsOiB0cnVlLCB0YXA6IHRydWUsIGRvdWJsZXRhcDogdHJ1ZSwgaG9sZDogdHJ1ZSB9IH07XG4gICAgICBmdW5jdGlvbiBWbih0MiwgZTIpIHtcbiAgICAgICAgdmFyIG4yID0gdDIuaW50ZXJhY3Rpb24sIHIyID0gdDIucG9pbnRlciwgaTIgPSB0Mi5ldmVudCwgbzIgPSB0Mi5ldmVudFRhcmdldCwgYTIgPSB0Mi50eXBlLCBzMiA9IHQyLnRhcmdldHMsIGMyID0gdm9pZCAwID09PSBzMiA/IFduKHQyLCBlMikgOiBzMiwgbDIgPSBuZXcgcW4oYTIsIHIyLCBpMiwgbzIsIG4yLCBlMi5ub3coKSk7XG4gICAgICAgIGUyLmZpcmUoXCJwb2ludGVyRXZlbnRzOm5ld1wiLCB7IHBvaW50ZXJFdmVudDogbDIgfSk7XG4gICAgICAgIGZvciAodmFyIHUyID0geyBpbnRlcmFjdGlvbjogbjIsIHBvaW50ZXI6IHIyLCBldmVudDogaTIsIGV2ZW50VGFyZ2V0OiBvMiwgdGFyZ2V0czogYzIsIHR5cGU6IGEyLCBwb2ludGVyRXZlbnQ6IGwyIH0sIHAyID0gMDsgcDIgPCBjMi5sZW5ndGg7IHAyKyspIHtcbiAgICAgICAgICB2YXIgZjIgPSBjMltwMl07XG4gICAgICAgICAgZm9yICh2YXIgZDIgaW4gZjIucHJvcHMgfHwge30pIGwyW2QyXSA9IGYyLnByb3BzW2QyXTtcbiAgICAgICAgICB2YXIgaDIgPSBLKGYyLmV2ZW50YWJsZSwgZjIubm9kZSk7XG4gICAgICAgICAgaWYgKGwyLl9zdWJ0cmFjdE9yaWdpbihoMiksIGwyLmV2ZW50YWJsZSA9IGYyLmV2ZW50YWJsZSwgbDIuY3VycmVudFRhcmdldCA9IGYyLm5vZGUsIGYyLmV2ZW50YWJsZS5maXJlKGwyKSwgbDIuX2FkZE9yaWdpbihoMiksIGwyLmltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCB8fCBsMi5wcm9wYWdhdGlvblN0b3BwZWQgJiYgcDIgKyAxIDwgYzIubGVuZ3RoICYmIGMyW3AyICsgMV0ubm9kZSAhPT0gbDIuY3VycmVudFRhcmdldCkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUyLmZpcmUoXCJwb2ludGVyRXZlbnRzOmZpcmVkXCIsIHUyKSwgXCJ0YXBcIiA9PT0gYTIpIHtcbiAgICAgICAgICB2YXIgdjIgPSBsMi5kb3VibGUgPyBWbih7IGludGVyYWN0aW9uOiBuMiwgcG9pbnRlcjogcjIsIGV2ZW50OiBpMiwgZXZlbnRUYXJnZXQ6IG8yLCB0eXBlOiBcImRvdWJsZXRhcFwiIH0sIGUyKSA6IGwyO1xuICAgICAgICAgIG4yLnByZXZUYXAgPSB2MiwgbjIudGFwVGltZSA9IHYyLnRpbWVTdGFtcDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbDI7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBXbih0MiwgZTIpIHtcbiAgICAgICAgdmFyIG4yID0gdDIuaW50ZXJhY3Rpb24sIHIyID0gdDIucG9pbnRlciwgaTIgPSB0Mi5ldmVudCwgbzIgPSB0Mi5ldmVudFRhcmdldCwgYTIgPSB0Mi50eXBlLCBzMiA9IG4yLmdldFBvaW50ZXJJbmRleChyMiksIGMyID0gbjIucG9pbnRlcnNbczJdO1xuICAgICAgICBpZiAoXCJ0YXBcIiA9PT0gYTIgJiYgKG4yLnBvaW50ZXJXYXNNb3ZlZCB8fCAhYzIgfHwgYzIuZG93blRhcmdldCAhPT0gbzIpKSByZXR1cm4gW107XG4gICAgICAgIGZvciAodmFyIGwyID0gcShvMiksIHUyID0geyBpbnRlcmFjdGlvbjogbjIsIHBvaW50ZXI6IHIyLCBldmVudDogaTIsIGV2ZW50VGFyZ2V0OiBvMiwgdHlwZTogYTIsIHBhdGg6IGwyLCB0YXJnZXRzOiBbXSwgbm9kZTogbnVsbCB9LCBwMiA9IDA7IHAyIDwgbDIubGVuZ3RoOyBwMisrKSB7XG4gICAgICAgICAgdmFyIGYyID0gbDJbcDJdO1xuICAgICAgICAgIHUyLm5vZGUgPSBmMiwgZTIuZmlyZShcInBvaW50ZXJFdmVudHM6Y29sbGVjdC10YXJnZXRzXCIsIHUyKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXCJob2xkXCIgPT09IGEyICYmICh1Mi50YXJnZXRzID0gdTIudGFyZ2V0cy5maWx0ZXIoZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICB2YXIgZTMsIHIzO1xuICAgICAgICAgIHJldHVybiB0My5ldmVudGFibGUub3B0aW9ucy5ob2xkRHVyYXRpb24gPT09IChudWxsID09IChlMyA9IG4yLnBvaW50ZXJzW3MyXSkgfHwgbnVsbCA9PSAocjMgPSBlMy5ob2xkKSA/IHZvaWQgMCA6IHIzLmR1cmF0aW9uKTtcbiAgICAgICAgfSkpLCB1Mi50YXJnZXRzO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gR24odDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuaW50ZXJhY3Rpb24sIG4yID0gdDIucG9pbnRlckluZGV4LCByMiA9IGUyLnBvaW50ZXJzW24yXS5ob2xkO1xuICAgICAgICByMiAmJiByMi50aW1lb3V0ICYmIChjbGVhclRpbWVvdXQocjIudGltZW91dCksIHIyLnRpbWVvdXQgPSBudWxsKTtcbiAgICAgIH1cbiAgICAgIHZhciBObiA9IE9iamVjdC5mcmVlemUoeyBfX3Byb3RvX186IG51bGwsIGRlZmF1bHQ6IEJuIH0pO1xuICAgICAgZnVuY3Rpb24gVW4odDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuaW50ZXJhY3Rpb247XG4gICAgICAgIGUyLmhvbGRJbnRlcnZhbEhhbmRsZSAmJiAoY2xlYXJJbnRlcnZhbChlMi5ob2xkSW50ZXJ2YWxIYW5kbGUpLCBlMi5ob2xkSW50ZXJ2YWxIYW5kbGUgPSBudWxsKTtcbiAgICAgIH1cbiAgICAgIHZhciBIbiA9IHsgaWQ6IFwicG9pbnRlci1ldmVudHMvaG9sZFJlcGVhdFwiLCBpbnN0YWxsOiBmdW5jdGlvbih0Mikge1xuICAgICAgICB0Mi51c2VQbHVnaW4oQm4pO1xuICAgICAgICB2YXIgZTIgPSB0Mi5wb2ludGVyRXZlbnRzO1xuICAgICAgICBlMi5kZWZhdWx0cy5ob2xkUmVwZWF0SW50ZXJ2YWwgPSAwLCBlMi50eXBlcy5ob2xkcmVwZWF0ID0gdDIuYWN0aW9ucy5waGFzZWxlc3NUeXBlcy5ob2xkcmVwZWF0ID0gdHJ1ZTtcbiAgICAgIH0sIGxpc3RlbmVyczogW1wibW92ZVwiLCBcInVwXCIsIFwiY2FuY2VsXCIsIFwiZW5kYWxsXCJdLnJlZHVjZShmdW5jdGlvbih0MiwgZTIpIHtcbiAgICAgICAgcmV0dXJuIHQyW1wicG9pbnRlckV2ZW50czpcIi5jb25jYXQoZTIpXSA9IFVuLCB0MjtcbiAgICAgIH0sIHsgXCJwb2ludGVyRXZlbnRzOm5ld1wiOiBmdW5jdGlvbih0Mikge1xuICAgICAgICB2YXIgZTIgPSB0Mi5wb2ludGVyRXZlbnQ7XG4gICAgICAgIFwiaG9sZFwiID09PSBlMi50eXBlICYmIChlMi5jb3VudCA9IChlMi5jb3VudCB8fCAwKSArIDEpO1xuICAgICAgfSwgXCJwb2ludGVyRXZlbnRzOmZpcmVkXCI6IGZ1bmN0aW9uKHQyLCBlMikge1xuICAgICAgICB2YXIgbjIgPSB0Mi5pbnRlcmFjdGlvbiwgcjIgPSB0Mi5wb2ludGVyRXZlbnQsIGkyID0gdDIuZXZlbnRUYXJnZXQsIG8yID0gdDIudGFyZ2V0cztcbiAgICAgICAgaWYgKFwiaG9sZFwiID09PSByMi50eXBlICYmIG8yLmxlbmd0aCkge1xuICAgICAgICAgIHZhciBhMiA9IG8yWzBdLmV2ZW50YWJsZS5vcHRpb25zLmhvbGRSZXBlYXRJbnRlcnZhbDtcbiAgICAgICAgICBhMiA8PSAwIHx8IChuMi5ob2xkSW50ZXJ2YWxIYW5kbGUgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgZTIucG9pbnRlckV2ZW50cy5maXJlKHsgaW50ZXJhY3Rpb246IG4yLCBldmVudFRhcmdldDogaTIsIHR5cGU6IFwiaG9sZFwiLCBwb2ludGVyOiByMiwgZXZlbnQ6IHIyIH0sIGUyKTtcbiAgICAgICAgICB9LCBhMikpO1xuICAgICAgICB9XG4gICAgICB9IH0pIH0sIEtuID0gSG47XG4gICAgICB2YXIgJG4gPSB7IGlkOiBcInBvaW50ZXItZXZlbnRzL2ludGVyYWN0YWJsZVRhcmdldHNcIiwgaW5zdGFsbDogZnVuY3Rpb24odDIpIHtcbiAgICAgICAgdmFyIGUyID0gdDIuSW50ZXJhY3RhYmxlO1xuICAgICAgICBlMi5wcm90b3R5cGUucG9pbnRlckV2ZW50cyA9IGZ1bmN0aW9uKHQzKSB7XG4gICAgICAgICAgcmV0dXJuIFYodGhpcy5ldmVudHMub3B0aW9ucywgdDMpLCB0aGlzO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgbjIgPSBlMi5wcm90b3R5cGUuX2JhY2tDb21wYXRPcHRpb247XG4gICAgICAgIGUyLnByb3RvdHlwZS5fYmFja0NvbXBhdE9wdGlvbiA9IGZ1bmN0aW9uKHQzLCBlMykge1xuICAgICAgICAgIHZhciByMiA9IG4yLmNhbGwodGhpcywgdDMsIGUzKTtcbiAgICAgICAgICByZXR1cm4gcjIgPT09IHRoaXMgJiYgKHRoaXMuZXZlbnRzLm9wdGlvbnNbdDNdID0gZTMpLCByMjtcbiAgICAgICAgfTtcbiAgICAgIH0sIGxpc3RlbmVyczogeyBcInBvaW50ZXJFdmVudHM6Y29sbGVjdC10YXJnZXRzXCI6IGZ1bmN0aW9uKHQyLCBlMikge1xuICAgICAgICB2YXIgbjIgPSB0Mi50YXJnZXRzLCByMiA9IHQyLm5vZGUsIGkyID0gdDIudHlwZSwgbzIgPSB0Mi5ldmVudFRhcmdldDtcbiAgICAgICAgZTIuaW50ZXJhY3RhYmxlcy5mb3JFYWNoTWF0Y2gocjIsIGZ1bmN0aW9uKHQzKSB7XG4gICAgICAgICAgdmFyIGUzID0gdDMuZXZlbnRzLCBhMiA9IGUzLm9wdGlvbnM7XG4gICAgICAgICAgZTMudHlwZXNbaTJdICYmIGUzLnR5cGVzW2kyXS5sZW5ndGggJiYgdDMudGVzdElnbm9yZUFsbG93KGEyLCByMiwgbzIpICYmIG4yLnB1c2goeyBub2RlOiByMiwgZXZlbnRhYmxlOiBlMywgcHJvcHM6IHsgaW50ZXJhY3RhYmxlOiB0MyB9IH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0sIFwiaW50ZXJhY3RhYmxlOm5ld1wiOiBmdW5jdGlvbih0Mikge1xuICAgICAgICB2YXIgZTIgPSB0Mi5pbnRlcmFjdGFibGU7XG4gICAgICAgIGUyLmV2ZW50cy5nZXRSZWN0ID0gZnVuY3Rpb24odDMpIHtcbiAgICAgICAgICByZXR1cm4gZTIuZ2V0UmVjdCh0Myk7XG4gICAgICAgIH07XG4gICAgICB9LCBcImludGVyYWN0YWJsZTpzZXRcIjogZnVuY3Rpb24odDIsIGUyKSB7XG4gICAgICAgIHZhciBuMiA9IHQyLmludGVyYWN0YWJsZSwgcjIgPSB0Mi5vcHRpb25zO1xuICAgICAgICBWKG4yLmV2ZW50cy5vcHRpb25zLCBlMi5wb2ludGVyRXZlbnRzLmRlZmF1bHRzKSwgVihuMi5ldmVudHMub3B0aW9ucywgcjIucG9pbnRlckV2ZW50cyB8fCB7fSk7XG4gICAgICB9IH0gfSwgSm4gPSAkbiwgUW4gPSB7IGlkOiBcInBvaW50ZXItZXZlbnRzXCIsIGluc3RhbGw6IGZ1bmN0aW9uKHQyKSB7XG4gICAgICAgIHQyLnVzZVBsdWdpbihObiksIHQyLnVzZVBsdWdpbihLbiksIHQyLnVzZVBsdWdpbihKbik7XG4gICAgICB9IH0sIFpuID0gUW47XG4gICAgICB2YXIgdHIgPSB7IGlkOiBcInJlZmxvd1wiLCBpbnN0YWxsOiBmdW5jdGlvbih0Mikge1xuICAgICAgICB2YXIgZTIgPSB0Mi5JbnRlcmFjdGFibGU7XG4gICAgICAgIHQyLmFjdGlvbnMucGhhc2VzLnJlZmxvdyA9IHRydWUsIGUyLnByb3RvdHlwZS5yZWZsb3cgPSBmdW5jdGlvbihlMykge1xuICAgICAgICAgIHJldHVybiBmdW5jdGlvbih0MywgZTQsIG4yKSB7XG4gICAgICAgICAgICBmb3IgKHZhciByMiA9IHQzLmdldEFsbEVsZW1lbnRzKCksIGkyID0gbjIud2luZG93LlByb21pc2UsIG8yID0gaTIgPyBbXSA6IG51bGwsIGEyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHZhciBhMyA9IHIyW3MyXSwgYzIgPSB0My5nZXRSZWN0KGEzKTtcbiAgICAgICAgICAgICAgaWYgKCFjMikgcmV0dXJuIDE7XG4gICAgICAgICAgICAgIHZhciBsMiwgdTIgPSBidChuMi5pbnRlcmFjdGlvbnMubGlzdCwgZnVuY3Rpb24objMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbjMuaW50ZXJhY3RpbmcoKSAmJiBuMy5pbnRlcmFjdGFibGUgPT09IHQzICYmIG4zLmVsZW1lbnQgPT09IGEzICYmIG4zLnByZXBhcmVkLm5hbWUgPT09IGU0Lm5hbWU7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBpZiAodTIpIHUyLm1vdmUoKSwgbzIgJiYgKGwyID0gdTIuX3JlZmxvd1Byb21pc2UgfHwgbmV3IGkyKGZ1bmN0aW9uKHQ0KSB7XG4gICAgICAgICAgICAgICAgdTIuX3JlZmxvd1Jlc29sdmUgPSB0NDtcbiAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgcDIgPSBVKGMyKSwgZjIgPSAvKiBAX19QVVJFX18gKi8gZnVuY3Rpb24odDQpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB7IGNvb3JkczogdDQsIGdldCBwYWdlKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb29yZHMucGFnZTtcbiAgICAgICAgICAgICAgICAgIH0sIGdldCBjbGllbnQoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvb3Jkcy5jbGllbnQ7XG4gICAgICAgICAgICAgICAgICB9LCBnZXQgdGltZVN0YW1wKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb29yZHMudGltZVN0YW1wO1xuICAgICAgICAgICAgICAgICAgfSwgZ2V0IHBhZ2VYKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb29yZHMucGFnZS54O1xuICAgICAgICAgICAgICAgICAgfSwgZ2V0IHBhZ2VZKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb29yZHMucGFnZS55O1xuICAgICAgICAgICAgICAgICAgfSwgZ2V0IGNsaWVudFgoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvb3Jkcy5jbGllbnQueDtcbiAgICAgICAgICAgICAgICAgIH0sIGdldCBjbGllbnRZKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb29yZHMuY2xpZW50Lnk7XG4gICAgICAgICAgICAgICAgICB9LCBnZXQgcG9pbnRlcklkKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb29yZHMucG9pbnRlcklkO1xuICAgICAgICAgICAgICAgICAgfSwgZ2V0IHRhcmdldCgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29vcmRzLnRhcmdldDtcbiAgICAgICAgICAgICAgICAgIH0sIGdldCB0eXBlKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb29yZHMudHlwZTtcbiAgICAgICAgICAgICAgICAgIH0sIGdldCBwb2ludGVyVHlwZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29vcmRzLnBvaW50ZXJUeXBlO1xuICAgICAgICAgICAgICAgICAgfSwgZ2V0IGJ1dHRvbnMoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvb3Jkcy5idXR0b25zO1xuICAgICAgICAgICAgICAgICAgfSwgcHJldmVudERlZmF1bHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgfSB9O1xuICAgICAgICAgICAgICAgIH0oeyBwYWdlOiB7IHg6IHAyLngsIHk6IHAyLnkgfSwgY2xpZW50OiB7IHg6IHAyLngsIHk6IHAyLnkgfSwgdGltZVN0YW1wOiBuMi5ub3coKSB9KTtcbiAgICAgICAgICAgICAgICBsMiA9IGZ1bmN0aW9uKHQ0LCBlNSwgbjMsIHIzLCBpMykge1xuICAgICAgICAgICAgICAgICAgdmFyIG8zID0gdDQuaW50ZXJhY3Rpb25zLm5ldyh7IHBvaW50ZXJUeXBlOiBcInJlZmxvd1wiIH0pLCBhNCA9IHsgaW50ZXJhY3Rpb246IG8zLCBldmVudDogaTMsIHBvaW50ZXI6IGkzLCBldmVudFRhcmdldDogbjMsIHBoYXNlOiBcInJlZmxvd1wiIH07XG4gICAgICAgICAgICAgICAgICBvMy5pbnRlcmFjdGFibGUgPSBlNSwgbzMuZWxlbWVudCA9IG4zLCBvMy5wcmV2RXZlbnQgPSBpMywgbzMudXBkYXRlUG9pbnRlcihpMywgaTMsIG4zLCB0cnVlKSwgbnQobzMuY29vcmRzLmRlbHRhKSwgVXQobzMucHJlcGFyZWQsIHIzKSwgbzMuX2RvUGhhc2UoYTQpO1xuICAgICAgICAgICAgICAgICAgdmFyIHMzID0gdDQud2luZG93LCBjMyA9IHMzLlByb21pc2UsIGwzID0gYzMgPyBuZXcgYzMoZnVuY3Rpb24odDUpIHtcbiAgICAgICAgICAgICAgICAgICAgbzMuX3JlZmxvd1Jlc29sdmUgPSB0NTtcbiAgICAgICAgICAgICAgICAgIH0pIDogdm9pZCAwO1xuICAgICAgICAgICAgICAgICAgbzMuX3JlZmxvd1Byb21pc2UgPSBsMywgbzMuc3RhcnQocjMsIGU1LCBuMyksIG8zLl9pbnRlcmFjdGluZyA/IChvMy5tb3ZlKGE0KSwgbzMuZW5kKGkzKSkgOiAobzMuc3RvcCgpLCBvMy5fcmVmbG93UmVzb2x2ZSgpKTtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBvMy5yZW1vdmVQb2ludGVyKGkzLCBpMyksIGwzO1xuICAgICAgICAgICAgICAgIH0objIsIHQzLCBhMywgZTQsIGYyKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBvMiAmJiBvMi5wdXNoKGwyKTtcbiAgICAgICAgICAgIH0sIHMyID0gMDsgczIgPCByMi5sZW5ndGggJiYgIWEyKCk7IHMyKyspIDtcbiAgICAgICAgICAgIHJldHVybiBvMiAmJiBpMi5hbGwobzIpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0MztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0odGhpcywgZTMsIHQyKTtcbiAgICAgICAgfTtcbiAgICAgIH0sIGxpc3RlbmVyczogeyBcImludGVyYWN0aW9uczpzdG9wXCI6IGZ1bmN0aW9uKHQyLCBlMikge1xuICAgICAgICB2YXIgbjIgPSB0Mi5pbnRlcmFjdGlvbjtcbiAgICAgICAgXCJyZWZsb3dcIiA9PT0gbjIucG9pbnRlclR5cGUgJiYgKG4yLl9yZWZsb3dSZXNvbHZlICYmIG4yLl9yZWZsb3dSZXNvbHZlKCksIGZ1bmN0aW9uKHQzLCBlMykge1xuICAgICAgICAgIHQzLnNwbGljZSh0My5pbmRleE9mKGUzKSwgMSk7XG4gICAgICAgIH0oZTIuaW50ZXJhY3Rpb25zLmxpc3QsIG4yKSk7XG4gICAgICB9IH0gfSwgZXIgPSB0cjtcbiAgICAgIGlmICh1bi51c2UoaGUpLCB1bi51c2UoQ2UpLCB1bi51c2UoWm4pLCB1bi51c2UocWUpLCB1bi51c2UoTG4pLCB1bi51c2UocGUpLCB1bi51c2UoWHQpLCB1bi51c2UoR3QpLCB1bi51c2UoZXIpLCB1bi5kZWZhdWx0ID0gdW4sIFwib2JqZWN0XCIgPT09IG4obW9kdWxlKSAmJiBtb2R1bGUpIHRyeSB7XG4gICAgICAgIG1vZHVsZS5leHBvcnRzID0gdW47XG4gICAgICB9IGNhdGNoICh0Mikge1xuICAgICAgfVxuICAgICAgcmV0dXJuIHVuLmRlZmF1bHQgPSB1biwgdW47XG4gICAgfSk7XG4gIH0pKGludGVyYWN0X21pbiQxLCBpbnRlcmFjdF9taW4kMS5leHBvcnRzKTtcbiAgcmV0dXJuIGludGVyYWN0X21pbiQxLmV4cG9ydHM7XG59XG52YXIgaW50ZXJhY3RfbWluRXhwb3J0cyA9IC8qIEBfX1BVUkVfXyAqLyByZXF1aXJlSW50ZXJhY3RfbWluKCk7XG5jb25zdCBpbnRlcmFjdCA9IC8qIEBfX1BVUkVfXyAqLyBnZXREZWZhdWx0RXhwb3J0RnJvbUNqcyhpbnRlcmFjdF9taW5FeHBvcnRzKTtcbmV4cG9ydCB7XG4gIGludGVyYWN0IGFzIGlcbn07XG4iLCIvKiEgQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cblNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWRlc2lnbi1zeXN0ZW0vYmxvYi9kZXYvTElDRU5TRS5tZCBmb3IgZGV0YWlscy5cbnYzLjMuMyAqL1xuaW1wb3J0IHsgbWFrZUdlbmVyaWNDb250cm9sbGVyIH0gZnJvbSBcIkBhcmNnaXMvbHVtaW5hL2NvbnRyb2xsZXJzXCI7XG5sZXQgb3BlbmVkQ29tcG9uZW50Q291bnQgPSAwO1xubGV0IGluaXRpYWxEb2N1bWVudE92ZXJmbG93U3R5bGUgPSBcIlwiO1xuY29uc3QgdXNlUHJldmVudERvY3VtZW50U2Nyb2xsID0gKCkgPT4ge1xuICBmdW5jdGlvbiBhZGRPcGVuZWRDb21wb25lbnQoKSB7XG4gICAgb3BlbmVkQ29tcG9uZW50Q291bnQrKztcbiAgICBpZiAob3BlbmVkQ29tcG9uZW50Q291bnQgPT09IDEpIHtcbiAgICAgIGluaXRpYWxEb2N1bWVudE92ZXJmbG93U3R5bGUgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUub3ZlcmZsb3c7XG4gICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUub3ZlcmZsb3cgPSBcImhpZGRlblwiO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiByZW1vdmVPcGVuZWRDb21wb25lbnQoKSB7XG4gICAgb3BlbmVkQ29tcG9uZW50Q291bnQtLTtcbiAgICBpZiAob3BlbmVkQ29tcG9uZW50Q291bnQgPT09IDApIHtcbiAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5vdmVyZmxvdyA9IGluaXRpYWxEb2N1bWVudE92ZXJmbG93U3R5bGU7XG4gICAgfVxuICB9XG4gIHJldHVybiBtYWtlR2VuZXJpY0NvbnRyb2xsZXIoKGNvbXBvbmVudCwgY29udHJvbGxlcikgPT4ge1xuICAgIGNvbnRyb2xsZXIub25Db25uZWN0ZWQoKCkgPT4ge1xuICAgICAgaWYgKGNvbXBvbmVudC5vcGVuZWQgJiYgY29tcG9uZW50LnByZXZlbnREb2N1bWVudFNjcm9sbCkge1xuICAgICAgICBhZGRPcGVuZWRDb21wb25lbnQoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBjb250cm9sbGVyLm9uVXBkYXRlKChjaGFuZ2VzKSA9PiB7XG4gICAgICBpZiAoIWNvbXBvbmVudC5oYXNVcGRhdGVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChjaGFuZ2VzLmhhcyhcIm9wZW5lZFwiKSAmJiBjb21wb25lbnQucHJldmVudERvY3VtZW50U2Nyb2xsKSB7XG4gICAgICAgIGlmIChjb21wb25lbnQub3BlbmVkKSB7XG4gICAgICAgICAgYWRkT3BlbmVkQ29tcG9uZW50KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVtb3ZlT3BlbmVkQ29tcG9uZW50KCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoY2hhbmdlcy5oYXMoXCJwcmV2ZW50RG9jdW1lbnRTY3JvbGxcIikgJiYgY29tcG9uZW50Lm9wZW5lZCkge1xuICAgICAgICBpZiAoY29tcG9uZW50LnByZXZlbnREb2N1bWVudFNjcm9sbCkge1xuICAgICAgICAgIGFkZE9wZW5lZENvbXBvbmVudCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlbW92ZU9wZW5lZENvbXBvbmVudCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgY29udHJvbGxlci5vbkRpc2Nvbm5lY3RlZCgoKSA9PiB7XG4gICAgICBpZiAoY29tcG9uZW50Lm9wZW5lZCAmJiBjb21wb25lbnQucHJldmVudERvY3VtZW50U2Nyb2xsKSB7XG4gICAgICAgIHJlbW92ZU9wZW5lZENvbXBvbmVudCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn07XG5leHBvcnQge1xuICB1c2VQcmV2ZW50RG9jdW1lbnRTY3JvbGwgYXMgdVxufTtcbiIsIi8qISBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtZGVzaWduLXN5c3RlbS9ibG9iL2Rldi9MSUNFTlNFLm1kIGZvciBkZXRhaWxzLlxudjMuMy4zICovXG5pbXBvcnQgeyBhIGFzIHJlc2l6ZVNoaWZ0U3RlcCwgYyBhcyBjdXN0b21FbGVtZW50IH0gZnJvbSBcIi4uLy4uL2NodW5rcy9ydW50aW1lLmpzXCI7XG5pbXBvcnQgeyBrZXllZCB9IGZyb20gXCJsaXQvZGlyZWN0aXZlcy9rZXllZC5qc1wiO1xuaW1wb3J0IHsgaSBhcyBpbnRlcmFjdCB9IGZyb20gXCIuLi8uLi9jaHVua3MvaW50ZXJhY3QubWluLmpzXCI7XG5pbXBvcnQgeyBjc3MsIGh0bWwgfSBmcm9tIFwibGl0XCI7XG5pbXBvcnQgeyBjcmVhdGVSZWYsIHJlZiB9IGZyb20gXCJsaXQtaHRtbC9kaXJlY3RpdmVzL3JlZi5qc1wiO1xuaW1wb3J0IHsgTGl0RWxlbWVudCwgY3JlYXRlRXZlbnQsIHNhZmVDbGFzc01hcCB9IGZyb20gXCJAYXJjZ2lzL2x1bWluYVwiO1xuaW1wb3J0IHsgbyBhcyBnZXRTdHlsZVBpeGVsVmFsdWUgfSBmcm9tIFwiLi4vLi4vY2h1bmtzL2RvbS5qc1wiO1xuaW1wb3J0IHsgYyBhcyBjcmVhdGVPYnNlcnZlciB9IGZyb20gXCIuLi8uLi9jaHVua3Mvb2JzZXJ2ZXJzLmpzXCI7XG5pbXBvcnQgeyBnIGFzIGdldERpbWVuc2lvbkNsYXNzIH0gZnJvbSBcIi4uLy4uL2NodW5rcy9keW5hbWljQ2xhc3Nlcy5qc1wiO1xuaW1wb3J0IHsgdCBhcyB0b2dnbGVPcGVuQ2xvc2UgfSBmcm9tIFwiLi4vLi4vY2h1bmtzL29wZW5DbG9zZUNvbXBvbmVudC5qc1wiO1xuaW1wb3J0IHsgUyBhcyBTTE9UUyQxIH0gZnJvbSBcIi4uLy4uL2NodW5rcy9yZXNvdXJjZXMzLmpzXCI7XG5pbXBvcnQgeyB1IGFzIHVzZVQ5biB9IGZyb20gXCIuLi8uLi9jaHVua3MvdXNlVDluLmpzXCI7XG5pbXBvcnQgeyB1IGFzIHVzZUZvY3VzVHJhcCB9IGZyb20gXCIuLi8uLi9jaHVua3MvdXNlRm9jdXNUcmFwLmpzXCI7XG5pbXBvcnQgeyB1IGFzIHVzZVByZXZlbnREb2N1bWVudFNjcm9sbCB9IGZyb20gXCIuLi8uLi9jaHVua3MvdXNlUHJldmVudERvY3VtZW50U2Nyb2xsLmpzXCI7XG5pbXBvcnQgeyB1IGFzIHVzZVNldEZvY3VzIH0gZnJvbSBcIi4uLy4uL2NodW5rcy91c2VTZXRGb2N1cy5qc1wiO1xuY29uc3QgQ1NTID0ge1xuICBkaWFsb2c6IFwiZGlhbG9nXCIsXG4gIHBhbmVsOiBcInBhbmVsXCIsXG4gIHNjcmltOiBcInNjcmltXCIsXG4gIGNvbnRhaW5lcjogXCJjb250YWluZXJcIixcbiAgY29udGFpbmVyT3BlbjogXCJjb250YWluZXItLW9wZW5cIixcbiAgY29udGFpbmVyRW1iZWRkZWQ6IFwiY29udGFpbmVyLS1lbWJlZGRlZFwiLFxuICBhc3Npc3RpdmVUZXh0OiBcImFzc2lzdGl2ZS10ZXh0XCIsXG4gIG9wZW5pbmdBY3RpdmU6IFwiZGlhbG9nLS1vcGVuaW5nLWFjdGl2ZVwiXG59O1xuY29uc3QgU0xPVFMgPSB7XG4gIGFjdGlvbkJhcjogXCJhY3Rpb24tYmFyXCIsXG4gIGFsZXJ0czogXCJhbGVydHNcIixcbiAgY29udGVudDogXCJjb250ZW50XCIsXG4gIGN1c3RvbUNvbnRlbnQ6IFwiY3VzdG9tLWNvbnRlbnRcIixcbiAgY29udGVudFRvcDogXCJjb250ZW50LXRvcFwiLFxuICBjb250ZW50Qm90dG9tOiBcImNvbnRlbnQtYm90dG9tXCIsXG4gIGhlYWRlckFjdGlvbnNTdGFydDogXCJoZWFkZXItYWN0aW9ucy1zdGFydFwiLFxuICBoZWFkZXJBY3Rpb25zRW5kOiBcImhlYWRlci1hY3Rpb25zLWVuZFwiLFxuICBoZWFkZXJNZW51QWN0aW9uczogXCJoZWFkZXItbWVudS1hY3Rpb25zXCIsXG4gIGhlYWRlckNvbnRlbnQ6IFwiaGVhZGVyLWNvbnRlbnRcIixcbiAgZmFiOiBcImZhYlwiLFxuICBmb290ZXI6IFwiZm9vdGVyXCIsXG4gIGZvb3RlclN0YXJ0OiBcImZvb3Rlci1zdGFydFwiLFxuICBmb290ZXJFbmQ6IFwiZm9vdGVyLWVuZFwiXG59O1xuY29uc3QgaW5pdGlhbERyYWdQb3NpdGlvbiA9IHsgeDogbnVsbCwgeTogbnVsbCB9O1xuY29uc3QgaW5pdGlhbFJlc2l6ZVBvc2l0aW9uID0geyB0b3A6IG51bGwsIHJpZ2h0OiBudWxsLCBib3R0b206IG51bGwsIGxlZnQ6IG51bGwgfTtcbmNvbnN0IHN0eWxlcyA9IGNzc2A6aG9zdHstLWNhbGNpdGUtaW50ZXJuYWwtY29sb3ItZm9jdXM6IHZhciggLS1jYWxjaXRlLWNvbG9yLWZvY3VzLCB2YXIoLS1jYWxjaXRlLXVpLWZvY3VzLWNvbG9yLCB2YXIoLS1jYWxjaXRlLWNvbG9yLWJyYW5kKSkgKX06aG9zdHstLWNhbGNpdGUtZGlhbG9nLXNjcmltLWJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgLjg1KTtwb2ludGVyLWV2ZW50czpub25lO2luc2V0OjA7ei1pbmRleDp2YXIoLS1jYWxjaXRlLXotaW5kZXgtb3ZlcmxheSk7ZGlzcGxheTpmbGV4Oy0tY2FsY2l0ZS1pbnRlcm5hbC1kaWFsb2ctYW5pbWF0aW9uLW9mZnNldDogMjBweH06aG9zdChbbW9kYWxdKXtwb3NpdGlvbjphYnNvbHV0ZX0uY29udGFpbmVye3BvaW50ZXItZXZlbnRzOmF1dG87cG9zaXRpb246Zml4ZWQ7aW5zZXQ6MDt6LWluZGV4OnZhcigtLWNhbGNpdGUtei1pbmRleC1vdmVybGF5KTtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7b3ZlcmZsb3c6aGlkZGVuO2NvbG9yOnZhcigtLWNhbGNpdGUtY29sb3ItdGV4dC0yKTtvcGFjaXR5OjA7dmlzaWJpbGl0eTpoaWRkZW47dHJhbnNpdGlvbjp2aXNpYmlsaXR5IDBtcyBsaW5lYXIgdmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1hbmltYXRpb24tdGltaW5nLXNsb3cpLG9wYWNpdHkgdmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1hbmltYXRpb24tdGltaW5nLXNsb3cpIGN1YmljLWJlemllciguMjE1LC40NCwuNDIsLjg4KX06aG9zdChbcGxhY2VtZW50PXRvcF0pIC5jb250YWluZXJ7YWxpZ24taXRlbXM6ZmxleC1zdGFydDtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyfTpob3N0KFtwbGFjZW1lbnQ9dG9wLXN0YXJ0XSkgLmNvbnRhaW5lcnthbGlnbi1pdGVtczpmbGV4LXN0YXJ0O2p1c3RpZnktY29udGVudDpmbGV4LXN0YXJ0fTpob3N0KFtwbGFjZW1lbnQ9dG9wLWVuZF0pIC5jb250YWluZXJ7YWxpZ24taXRlbXM6ZmxleC1zdGFydDtqdXN0aWZ5LWNvbnRlbnQ6ZmxleC1lbmR9Omhvc3QoW3BsYWNlbWVudD1ib3R0b21dKSAuY29udGFpbmVye2FsaWduLWl0ZW1zOmZsZXgtZW5kO2p1c3RpZnktY29udGVudDpjZW50ZXJ9Omhvc3QoW3BsYWNlbWVudD1ib3R0b20tc3RhcnRdKSAuY29udGFpbmVye2FsaWduLWl0ZW1zOmZsZXgtZW5kO2p1c3RpZnktY29udGVudDpmbGV4LXN0YXJ0fTpob3N0KFtwbGFjZW1lbnQ9Ym90dG9tLWVuZF0pIC5jb250YWluZXJ7YWxpZ24taXRlbXM6ZmxleC1lbmQ7anVzdGlmeS1jb250ZW50OmZsZXgtZW5kfTpob3N0KDpub3QoW21vZGFsXSkpIC5jb250YWluZXJ7cG9pbnRlci1ldmVudHM6bm9uZX06aG9zdChbc2NhbGU9c10pey0tY2FsY2l0ZS1pbnRlcm5hbC1kaWFsb2ctY29udGVudC1wYWRkaW5nOiB2YXIoLS1jYWxjaXRlLWRpYWxvZy1jb250ZW50LXNwYWNlLCB2YXIoLS1jYWxjaXRlLXNwYWNpbmctc20pKTstLWNhbGNpdGUtaW50ZXJuYWwtZGlhbG9nLW1pbi1zaXplLXg6IDE5OHB4Oy0tY2FsY2l0ZS1pbnRlcm5hbC1kaWFsb2ctbWluLXNpemUteTogMTQwcHh9Omhvc3QoW3NjYWxlPW1dKXstLWNhbGNpdGUtaW50ZXJuYWwtZGlhbG9nLWNvbnRlbnQtcGFkZGluZzogdmFyKC0tY2FsY2l0ZS1kaWFsb2ctY29udGVudC1zcGFjZSwgdmFyKC0tY2FsY2l0ZS1zcGFjaW5nLW1kKSk7LS1jYWxjaXRlLWludGVybmFsLWRpYWxvZy1taW4tc2l6ZS14OiAyODhweDstLWNhbGNpdGUtaW50ZXJuYWwtZGlhbG9nLW1pbi1zaXplLXk6IDE4MHB4fTpob3N0KFtzY2FsZT1sXSl7LS1jYWxjaXRlLWludGVybmFsLWRpYWxvZy1jb250ZW50LXBhZGRpbmc6IHZhcigtLWNhbGNpdGUtZGlhbG9nLWNvbnRlbnQtc3BhY2UsIHZhcigtLWNhbGNpdGUtc3BhY2luZy1tZC1wbHVzKSk7LS1jYWxjaXRlLWludGVybmFsLWRpYWxvZy1taW4tc2l6ZS14OiAzODhweDstLWNhbGNpdGUtaW50ZXJuYWwtZGlhbG9nLW1pbi1zaXplLXk6IDIyMHB4fS5zY3JpbXstLWNhbGNpdGUtc2NyaW0tYmFja2dyb3VuZDogdmFyKC0tY2FsY2l0ZS1kaWFsb2ctc2NyaW0tYmFja2dyb3VuZC1jb2xvciwgdmFyKC0tY2FsY2l0ZS1jb2xvci10cmFuc3BhcmVudC1zY3JpbSkpOy0tY2FsY2l0ZS1zY3JpbS1iYWNrZ3JvdW5kLWNvbG9yOiB2YXIoIC0tY2FsY2l0ZS1kaWFsb2ctc2NyaW0tYmFja2dyb3VuZC1jb2xvciwgdmFyKC0tY2FsY2l0ZS1jb2xvci10cmFuc3BhcmVudC1zY3JpbSkgKTtwb3NpdGlvbjpmaXhlZDtpbnNldDowO2Rpc3BsYXk6ZmxleDtvdmVyZmxvdy15OmhpZGRlbn1jYWxjaXRlLXBhbmVsey0tY2FsY2l0ZS1wYW5lbC1jb250ZW50LXNwYWNlOiB2YXIoLS1jYWxjaXRlLWRpYWxvZy1jb250ZW50LXNwYWNlLCB2YXIoLS1jYWxjaXRlLWludGVybmFsLWRpYWxvZy1jb250ZW50LXBhZGRpbmcpKTstLWNhbGNpdGUtcGFuZWwtYm9yZGVyLWNvbG9yOiB2YXIoLS1jYWxjaXRlLWRpYWxvZy1ib3JkZXItY29sb3IpOy0tY2FsY2l0ZS1wYW5lbC1iYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1jYWxjaXRlLWRpYWxvZy1iYWNrZ3JvdW5kLWNvbG9yLCB2YXIoLS1jYWxjaXRlLWNvbG9yLWZvcmVncm91bmQtMSkpOy0tY2FsY2l0ZS1wYW5lbC1pY29uLWNvbG9yOiB2YXIoLS1jYWxjaXRlLWRpYWxvZy1pY29uLWNvbG9yKTstLWNhbGNpdGUtcGFuZWwtaGVhZGluZy10ZXh0LWNvbG9yOiB2YXIoLS1jYWxjaXRlLWRpYWxvZy1oZWFkaW5nLXRleHQtY29sb3IpOy0tY2FsY2l0ZS1wYW5lbC1kZXNjcmlwdGlvbi10ZXh0LWNvbG9yOiB2YXIoLS1jYWxjaXRlLWRpYWxvZy1kZXNjcmlwdGlvbi10ZXh0LWNvbG9yKTstLWNhbGNpdGUtcGFuZWwtaGVhZGVyLWJhY2tncm91bmQtY29sb3I6IHZhcigtLWNhbGNpdGUtZGlhbG9nLWhlYWRlci1iYWNrZ3JvdW5kLWNvbG9yKTstLWNhbGNpdGUtcGFuZWwtaGVhZGVyLWFjdGlvbi1iYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1jYWxjaXRlLWRpYWxvZy1oZWFkZXItYWN0aW9uLWJhY2tncm91bmQtY29sb3IpOy0tY2FsY2l0ZS1wYW5lbC1oZWFkZXItYWN0aW9uLWJhY2tncm91bmQtY29sb3ItaG92ZXI6IHZhcigtLWNhbGNpdGUtZGlhbG9nLWhlYWRlci1hY3Rpb24tYmFja2dyb3VuZC1jb2xvci1ob3Zlcik7LS1jYWxjaXRlLXBhbmVsLWhlYWRlci1hY3Rpb24tYmFja2dyb3VuZC1jb2xvci1wcmVzczogdmFyKC0tY2FsY2l0ZS1kaWFsb2ctaGVhZGVyLWFjdGlvbi1iYWNrZ3JvdW5kLWNvbG9yLXByZXNzKTstLWNhbGNpdGUtcGFuZWwtaGVhZGVyLWFjdGlvbi10ZXh0LWNvbG9yOiB2YXIoLS1jYWxjaXRlLWRpYWxvZy1oZWFkZXItYWN0aW9uLXRleHQtY29sb3IpOy0tY2FsY2l0ZS1wYW5lbC1oZWFkZXItYWN0aW9uLXRleHQtY29sb3ItcHJlc3M6IHZhcigtLWNhbGNpdGUtZGlhbG9nLWhlYWRlci1hY3Rpb24tdGV4dC1jb2xvci1wcmVzcyk7LS1jYWxjaXRlLXBhbmVsLWZvb3Rlci1iYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1jYWxjaXRlLWRpYWxvZy1mb290ZXItYmFja2dyb3VuZC1jb2xvcik7LS1jYWxjaXRlLXBhbmVsLXNwYWNlOiB2YXIoLS1jYWxjaXRlLWRpYWxvZy1zcGFjZSwgdmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1kaWFsb2ctY29udGVudC1wYWRkaW5nKSk7LS1jYWxjaXRlLXBhbmVsLWhlYWRlci1jb250ZW50LXNwYWNlOiB2YXIoLS1jYWxjaXRlLWRpYWxvZy1oZWFkZXItY29udGVudC1zcGFjZSwgdmFyKC0tY2FsY2l0ZS1kaWFsb2ctY29udGVudC1zcGFjZSkpOy0tY2FsY2l0ZS1wYW5lbC1mb290ZXItc3BhY2U6IHZhcigtLWNhbGNpdGUtZGlhbG9nLWZvb3Rlci1zcGFjZSk7LS1jYWxjaXRlLXBvcG92ZXItYm9yZGVyLWNvbG9yOiB2YXIoLS1jYWxjaXRlLWRpYWxvZy1hY3Rpb24tbWVudS1ib3JkZXItY29sb3IsIHZhcigtLWNhbGNpdGUtY29sb3ItYm9yZGVyLTEpKTstLWNhbGNpdGUtcGFuZWwtY29ybmVyLXJhZGl1czogdmFyKC0tY2FsY2l0ZS1kaWFsb2ctY29ybmVyLXJhZGl1cyl9Omhvc3QoW2tpbmQ9YnJhbmRdKSBjYWxjaXRlLXBhbmVsey0tY2FsY2l0ZS1wYW5lbC1pY29uLWNvbG9yOiB2YXIoLS1jYWxjaXRlLWRpYWxvZy1pY29uLWNvbG9yLCB2YXIoLS1jYWxjaXRlLWNvbG9yLWJyYW5kKSl9Omhvc3QoW2tpbmQ9ZGFuZ2VyXSkgY2FsY2l0ZS1wYW5lbHstLWNhbGNpdGUtcGFuZWwtaWNvbi1jb2xvcjogdmFyKC0tY2FsY2l0ZS1kaWFsb2ctaWNvbi1jb2xvciwgdmFyKC0tY2FsY2l0ZS1jb2xvci1zdGF0dXMtZGFuZ2VyKSl9Omhvc3QoW2tpbmQ9aW5mb10pIGNhbGNpdGUtcGFuZWx7LS1jYWxjaXRlLXBhbmVsLWljb24tY29sb3I6IHZhcigtLWNhbGNpdGUtZGlhbG9nLWljb24tY29sb3IsIHZhcigtLWNhbGNpdGUtY29sb3Itc3RhdHVzLWluZm8pKX06aG9zdChba2luZD1zdWNjZXNzXSkgY2FsY2l0ZS1wYW5lbHstLWNhbGNpdGUtcGFuZWwtaWNvbi1jb2xvcjogdmFyKC0tY2FsY2l0ZS1kaWFsb2ctaWNvbi1jb2xvciwgdmFyKC0tY2FsY2l0ZS1jb2xvci1zdGF0dXMtc3VjY2VzcykpfTpob3N0KFtraW5kPXdhcm5pbmddKSBjYWxjaXRlLXBhbmVsey0tY2FsY2l0ZS1wYW5lbC1pY29uLWNvbG9yOiB2YXIoLS1jYWxjaXRlLWRpYWxvZy1pY29uLWNvbG9yLCB2YXIoLS1jYWxjaXRlLWNvbG9yLXN0YXR1cy13YXJuaW5nKSl9OjpzbG90dGVkKCopey0tY2FsY2l0ZS1wYW5lbC1iYWNrZ3JvdW5kLWNvbG9yOiBpbml0aWFsfS5kaWFsb2d7cG9pbnRlci1ldmVudHM6bm9uZTtwb3NpdGlvbjpyZWxhdGl2ZTt6LWluZGV4OnZhcigtLWNhbGNpdGUtei1pbmRleC1tb2RhbCk7bWFyZ2luOjEuNXJlbTtib3gtc2l6aW5nOmJvcmRlci1ib3g7ZGlzcGxheTpmbGV4O2lubGluZS1zaXplOjEwMCU7ZmxleC1kaXJlY3Rpb246Y29sdW1uO29wYWNpdHk6MDstLXR3LXNoYWRvdzogMCAycHggMTJweCAtNHB4IHJnYmEoMCwgMCwgMCwgLjIpLCAwIDJweCA0cHggLTJweCByZ2JhKDAsIDAsIDAsIC4xNik7LS10dy1zaGFkb3ctY29sb3JlZDogMCAycHggMTJweCAtNHB4IHZhcigtLXR3LXNoYWRvdy1jb2xvciksIDAgMnB4IDRweCAtMnB4IHZhcigtLXR3LXNoYWRvdy1jb2xvcik7Ym94LXNoYWRvdzp2YXIoLS10dy1yaW5nLW9mZnNldC1zaGFkb3csIDAgMCAjMDAwMCksdmFyKC0tdHctcmluZy1zaGFkb3csIDAgMCAjMDAwMCksdmFyKC0tdHctc2hhZG93KTstd2Via2l0LW92ZXJmbG93LXNjcm9sbGluZzp0b3VjaDt2aXNpYmlsaXR5OmhpZGRlbjt0cmFuc2l0aW9uOmluc2V0LWJsb2NrIHZhcigtLWNhbGNpdGUtaW50ZXJuYWwtYW5pbWF0aW9uLXRpbWluZy1zbG93KSBjdWJpYy1iZXppZXIoLjIxNSwuNDQsLjQyLC44OCksb3BhY2l0eSB2YXIoLS1jYWxjaXRlLWludGVybmFsLWFuaW1hdGlvbi10aW1pbmctc2xvdykgY3ViaWMtYmV6aWVyKC4yMTUsLjQ0LC40MiwuODgpO2JvcmRlci1yYWRpdXM6dmFyKC0tY2FsY2l0ZS1kaWFsb2ctY29ybmVyLXJhZGl1cywgdmFyKC0tY2FsY2l0ZS1jb3JuZXItcmFkaXVzLXNtKSk7bWluLWlubGluZS1zaXplOnZhcigtLWNhbGNpdGUtZGlhbG9nLW1pbi1zaXplLXgsIHZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZGlhbG9nLW1pbi1zaXplLXgpKTttYXgtaW5saW5lLXNpemU6dmFyKC0tY2FsY2l0ZS1kaWFsb2ctbWF4LXNpemUteCwgMTAwJSk7bWluLWJsb2NrLXNpemU6dmFyKC0tY2FsY2l0ZS1kaWFsb2ctbWluLXNpemUteSwgdmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1kaWFsb2ctbWluLXNpemUteSkpO21heC1ibG9jay1zaXplOnZhcigtLWNhbGNpdGUtZGlhbG9nLW1heC1zaXplLXksIDEwMCUpOy0tY2FsY2l0ZS1pbnRlcm5hbC1kaWFsb2ctaGlkZGVuLXBvc2l0aW9uOiBjYWxjKCB2YXIoLS1jYWxjaXRlLWRpYWxvZy1vZmZzZXQteSwgMHB4KSArIHZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZGlhbG9nLWFuaW1hdGlvbi1vZmZzZXQpICk7LS1jYWxjaXRlLWludGVybmFsLWRpYWxvZy1zaG93bi1wb3NpdGlvbjogdmFyKC0tY2FsY2l0ZS1kaWFsb2ctb2Zmc2V0LXksIDApO2luc2V0LWlubGluZS1zdGFydDp2YXIoLS1jYWxjaXRlLWRpYWxvZy1vZmZzZXQteCwgMCk7aW5zZXQtYmxvY2stc3RhcnQ6dmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1kaWFsb2ctaGlkZGVuLXBvc2l0aW9uKX0uZGlhbG9nLS1vcGVuaW5nLWFjdGl2ZXtpbnNldC1ibG9jay1zdGFydDp2YXIoLS1jYWxjaXRlLWludGVybmFsLWRpYWxvZy1zaG93bi1wb3NpdGlvbil9Omhvc3QoW21lbnUtb3Blbl0pIC5kaWFsb2d7dHJhbnNpdGlvbjp2aXNpYmlsaXR5IDBtcyBsaW5lYXIgdmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1hbmltYXRpb24tdGltaW5nLXNsb3cpLG9wYWNpdHkgdmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1hbmltYXRpb24tdGltaW5nLXNsb3cpIGN1YmljLWJlemllciguMjE1LC40NCwuNDIsLjg4KX0ucGFuZWx7dmlzaWJpbGl0eTpoaWRkZW47b3BhY2l0eTowO2JvcmRlci1yYWRpdXM6dmFyKC0tY2FsY2l0ZS1kaWFsb2ctY29ybmVyLXJhZGl1cywgdmFyKC0tY2FsY2l0ZS1jb3JuZXItcmFkaXVzLXNtKSk7dHJhbnNpdGlvbjp2aXNpYmlsaXR5IDBtcyBsaW5lYXIgdmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1hbmltYXRpb24tdGltaW5nLXNsb3cpLG9wYWNpdHkgdmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1hbmltYXRpb24tdGltaW5nLXNsb3cpIGN1YmljLWJlemllciguMjE1LC40NCwuNDIsLjg4KX0uY29udGFpbmVyLS1vcGVuIC5wYW5lbHt2aXNpYmlsaXR5OnZpc2libGU7b3BhY2l0eToxO3RyYW5zaXRpb246dmlzaWJpbGl0eSAwbXMgbGluZWFyLG9wYWNpdHkgdmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1hbmltYXRpb24tdGltaW5nLXNsb3cpIGN1YmljLWJlemllciguMjE1LC40NCwuNDIsLjg4KX0uY29udGFpbmVyLS1vcGVue29wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7dHJhbnNpdGlvbi1kZWxheTowbXN9LmNvbnRhaW5lci0tb3BlbiAuZGlhbG9ne3BvaW50ZXItZXZlbnRzOmF1dG87dmlzaWJpbGl0eTp2aXNpYmxlO29wYWNpdHk6MTt0cmFuc2l0aW9uOmluc2V0LWJsb2NrIHZhcigtLWNhbGNpdGUtaW50ZXJuYWwtYW5pbWF0aW9uLXRpbWluZy1zbG93KSBjdWJpYy1iZXppZXIoLjIxNSwuNDQsLjQyLC44OCksb3BhY2l0eSB2YXIoLS1jYWxjaXRlLWludGVybmFsLWFuaW1hdGlvbi10aW1pbmctc2xvdykgY3ViaWMtYmV6aWVyKC4yMTUsLjQ0LC40MiwuODgpO3RyYW5zaXRpb24tZGVsYXk6MG1zfS53aWR0aC1ze2lubGluZS1zaXplOmF1dG87aW5saW5lLXNpemU6dmFyKC0tY2FsY2l0ZS1kaWFsb2ctc2l6ZS14LCAzMnJlbSk7YmxvY2stc2l6ZTp2YXIoLS1jYWxjaXRlLWRpYWxvZy1zaXplLXksIGF1dG8pfUBtZWRpYSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6IDM1cmVtKXsud2lkdGgtc3ttYXJnaW46MDtibG9jay1zaXplOjEwMCU7bWF4LWJsb2NrLXNpemU6MTAwJTtpbmxpbmUtc2l6ZToxMDAlO21heC1pbmxpbmUtc2l6ZToxMDAlO2luc2V0LWlubGluZS1zdGFydDowO2luc2V0LWJsb2NrLXN0YXJ0OnZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZGlhbG9nLWFuaW1hdGlvbi1vZmZzZXQpfS53aWR0aC1zLmRpYWxvZy0tb3BlbmluZy1hY3RpdmV7aW5zZXQtYmxvY2stc3RhcnQ6MH19LndpZHRoLW17aW5saW5lLXNpemU6dmFyKC0tY2FsY2l0ZS1kaWFsb2ctc2l6ZS14LCA0OHJlbSk7YmxvY2stc2l6ZTp2YXIoLS1jYWxjaXRlLWRpYWxvZy1zaXplLXksIGF1dG8pfUBtZWRpYSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6IDUxcmVtKXsud2lkdGgtbXttYXJnaW46MDtibG9jay1zaXplOjEwMCU7bWF4LWJsb2NrLXNpemU6MTAwJTtpbmxpbmUtc2l6ZToxMDAlO21heC1pbmxpbmUtc2l6ZToxMDAlO2luc2V0LWlubGluZS1zdGFydDowO2luc2V0LWJsb2NrLXN0YXJ0OnZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZGlhbG9nLWFuaW1hdGlvbi1vZmZzZXQpfS53aWR0aC1tLmRpYWxvZy0tb3BlbmluZy1hY3RpdmV7aW5zZXQtYmxvY2stc3RhcnQ6MH19LndpZHRoLWx7aW5saW5lLXNpemU6dmFyKC0tY2FsY2l0ZS1kaWFsb2ctc2l6ZS14LCA5NHJlbSk7YmxvY2stc2l6ZTp2YXIoLS1jYWxjaXRlLWRpYWxvZy1zaXplLXksIGF1dG8pfUBtZWRpYSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6IDk3cmVtKXsud2lkdGgtbHttYXJnaW46MDtibG9jay1zaXplOjEwMCU7bWF4LWJsb2NrLXNpemU6MTAwJTtpbmxpbmUtc2l6ZToxMDAlO21heC1pbmxpbmUtc2l6ZToxMDAlO2luc2V0LWlubGluZS1zdGFydDowO2luc2V0LWJsb2NrLXN0YXJ0OnZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZGlhbG9nLWFuaW1hdGlvbi1vZmZzZXQpfS53aWR0aC1sLmRpYWxvZy0tb3BlbmluZy1hY3RpdmV7aW5zZXQtYmxvY2stc3RhcnQ6MH19Omhvc3QoW3BsYWNlbWVudD1jb3Zlcl0pIC5kaWFsb2d7bWFyZ2luOjA7YmxvY2stc2l6ZToxMDAlO21heC1ibG9jay1zaXplOjEwMCU7aW5saW5lLXNpemU6MTAwJTttYXgtaW5saW5lLXNpemU6MTAwJTtib3JkZXItcmFkaXVzOjB9Omhvc3QoW3BsYWNlbWVudD1jb3Zlcl0pIC5wYW5lbHtib3JkZXItcmFkaXVzOjB9Omhvc3QoW2tpbmRdKSAucGFuZWx7Ym9yZGVyLXN0YXJ0LXN0YXJ0LXJhZGl1czowcHg7Ym9yZGVyLXN0YXJ0LWVuZC1yYWRpdXM6MHB4fTpob3N0KFtraW5kXSkgLmRpYWxvZ3tvdmVyZmxvdzpoaWRkZW59Omhvc3QoW2tpbmQ9YnJhbmRdKSAuZGlhbG9ne2JvcmRlci1jb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLWJyYW5kKX06aG9zdChba2luZD1kYW5nZXJdKSAuZGlhbG9ne2JvcmRlci1jb2xvcjp2YXIoLS1jYWxjaXRlLWRpYWxvZy1hY2NlbnQtY29sb3IsIHZhcigtLWNhbGNpdGUtY29sb3Itc3RhdHVzLWRhbmdlcikpfTpob3N0KFtraW5kPWluZm9dKSAuZGlhbG9ne2JvcmRlci1jb2xvcjp2YXIoLS1jYWxjaXRlLWRpYWxvZy1hY2NlbnQtY29sb3IsIHZhcigtLWNhbGNpdGUtY29sb3Itc3RhdHVzLWluZm8pKX06aG9zdChba2luZD1zdWNjZXNzXSkgLmRpYWxvZ3tib3JkZXItY29sb3I6dmFyKC0tY2FsY2l0ZS1kaWFsb2ctYWNjZW50LWNvbG9yLCB2YXIoLS1jYWxjaXRlLWNvbG9yLXN0YXR1cy1zdWNjZXNzKSl9Omhvc3QoW2tpbmQ9d2FybmluZ10pIC5kaWFsb2d7Ym9yZGVyLWNvbG9yOnZhcigtLWNhbGNpdGUtZGlhbG9nLWFjY2VudC1jb2xvciwgdmFyKC0tY2FsY2l0ZS1jb2xvci1zdGF0dXMtd2FybmluZykpfTpob3N0KFtraW5kPWJyYW5kXVtvcGVuXSkgLmRpYWxvZyw6aG9zdChba2luZD1kYW5nZXJdW29wZW5dKSAuZGlhbG9nLDpob3N0KFtraW5kPWluZm9dW29wZW5dKSAuZGlhbG9nLDpob3N0KFtraW5kPXN1Y2Nlc3NdW29wZW5dKSAuZGlhbG9nLDpob3N0KFtraW5kPXdhcm5pbmddW29wZW5dKSAuZGlhbG9ne2JvcmRlci13aWR0aDowcHg7Ym9yZGVyLWJsb2NrLXN0YXJ0LXdpZHRoOjRweDtib3JkZXItc3R5bGU6c29saWR9LmNvbnRhaW5lci0tZW1iZWRkZWR7cG9zaXRpb246YWJzb2x1dGU7cG9pbnRlci1ldmVudHM6YXV0b30uY29udGFpbmVyLS1lbWJlZGRlZCBjYWxjaXRlLXNjcmlte3Bvc2l0aW9uOmFic29sdXRlfS5hc3Npc3RpdmUtdGV4dHtwb3NpdGlvbjphYnNvbHV0ZTtpbmxpbmUtc2l6ZToxcHg7YmxvY2stc2l6ZToxcHg7cGFkZGluZzowO21hcmdpbjotMXB4O292ZXJmbG93OmhpZGRlbjtjbGlwOnJlY3QoMCwwLDAsMCk7d2hpdGUtc3BhY2U6bm93cmFwO2JvcmRlci13aWR0aDowfTpob3N0KFtoaWRkZW5dKXtkaXNwbGF5Om5vbmV9W2hpZGRlbl17ZGlzcGxheTpub25lfWA7XG5jbGFzcyBEaWFsb2cgZXh0ZW5kcyBMaXRFbGVtZW50IHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICB0aGlzLmRyYWdQb3NpdGlvbiA9IHsgLi4uaW5pdGlhbERyYWdQb3NpdGlvbiB9O1xuICAgIHRoaXMuZm9jdXNUcmFwID0gdXNlRm9jdXNUcmFwKHtcbiAgICAgIHRyaWdnZXJQcm9wOiBcIm9wZW5cIixcbiAgICAgIGZvY3VzVHJhcE9wdGlvbnM6IHtcbiAgICAgICAgLy8gc2NyaW0gY2xvc2VzIG9uIGNsaWNrLCBzbyB3ZSBsZXQgaXQgdGFrZSBvdmVyXG4gICAgICAgIGNsaWNrT3V0c2lkZURlYWN0aXZhdGVzOiAoKSA9PiAhdGhpcy5tb2RhbCB8fCB0aGlzLmVtYmVkZGVkLFxuICAgICAgICBlc2NhcGVEZWFjdGl2YXRlczogKGV2ZW50KSA9PiB7XG4gICAgICAgICAgaWYgKCFldmVudC5kZWZhdWx0UHJldmVudGVkICYmICF0aGlzLmVzY2FwZURpc2FibGVkKSB7XG4gICAgICAgICAgICB0aGlzLm9wZW4gPSBmYWxzZTtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pKHRoaXMpO1xuICAgIHRoaXMudXNlUHJldmVudERvY3VtZW50U2Nyb2xsID0gdXNlUHJldmVudERvY3VtZW50U2Nyb2xsKCkodGhpcyk7XG4gICAgdGhpcy5tdXRhdGlvbk9ic2VydmVyID0gY3JlYXRlT2JzZXJ2ZXIoXCJtdXRhdGlvblwiLCAoKSA9PiB0aGlzLmhhbmRsZU11dGF0aW9uT2JzZXJ2ZXIoKSk7XG4gICAgdGhpcy5fb3BlbiA9IGZhbHNlO1xuICAgIHRoaXMub3BlblByb3AgPSBcIm9wZW5lZFwiO1xuICAgIHRoaXMudHJhbnNpdGlvblByb3AgPSBcIm9wYWNpdHlcIjtcbiAgICB0aGlzLnBhbmVsRWwgPSBjcmVhdGVSZWYoKTtcbiAgICB0aGlzLnJlc2l6ZVBvc2l0aW9uID0geyAuLi5pbml0aWFsUmVzaXplUG9zaXRpb24gfTtcbiAgICB0aGlzLm1lc3NhZ2VzID0gdXNlVDluKCk7XG4gICAgdGhpcy5mb2N1c1NldHRlciA9IHVzZVNldEZvY3VzKCkodGhpcyk7XG4gICAgdGhpcy5hc3Npc3RpdmVUZXh0ID0gbnVsbDtcbiAgICB0aGlzLmhhc0NvbnRlbnRCb3R0b20gPSBmYWxzZTtcbiAgICB0aGlzLmhhc0NvbnRlbnRUb3AgPSBmYWxzZTtcbiAgICB0aGlzLmhhc0Zvb3RlciA9IHRydWU7XG4gICAgdGhpcy5vcGVuZWQgPSBmYWxzZTtcbiAgICB0aGlzLmNsb3NlRGlzYWJsZWQgPSBmYWxzZTtcbiAgICB0aGlzLmRyYWdFbmFibGVkID0gZmFsc2U7XG4gICAgdGhpcy5lbWJlZGRlZCA9IGZhbHNlO1xuICAgIHRoaXMuZXNjYXBlRGlzYWJsZWQgPSBmYWxzZTtcbiAgICB0aGlzLmljb25GbGlwUnRsID0gZmFsc2U7XG4gICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7XG4gICAgdGhpcy5tZW51T3BlbiA9IGZhbHNlO1xuICAgIHRoaXMubW9kYWwgPSBmYWxzZTtcbiAgICB0aGlzLmZvY3VzVHJhcERpc2FibGVkID0gZmFsc2U7XG4gICAgdGhpcy5vdXRzaWRlQ2xvc2VEaXNhYmxlZCA9IGZhbHNlO1xuICAgIHRoaXMub3ZlcmxheVBvc2l0aW9uaW5nID0gXCJhYnNvbHV0ZVwiO1xuICAgIHRoaXMucGxhY2VtZW50ID0gXCJjZW50ZXJcIjtcbiAgICB0aGlzLnJlc2l6YWJsZSA9IGZhbHNlO1xuICAgIHRoaXMuc2NhbGUgPSBcIm1cIjtcbiAgICB0aGlzLndpZHRoU2NhbGUgPSBcIm1cIjtcbiAgICB0aGlzLmNhbGNpdGVEaWFsb2dCZWZvcmVDbG9zZSA9IGNyZWF0ZUV2ZW50KHsgY2FuY2VsYWJsZTogZmFsc2UgfSk7XG4gICAgdGhpcy5jYWxjaXRlRGlhbG9nQmVmb3JlT3BlbiA9IGNyZWF0ZUV2ZW50KHsgY2FuY2VsYWJsZTogZmFsc2UgfSk7XG4gICAgdGhpcy5jYWxjaXRlRGlhbG9nQ2xvc2UgPSBjcmVhdGVFdmVudCh7IGNhbmNlbGFibGU6IGZhbHNlIH0pO1xuICAgIHRoaXMuY2FsY2l0ZURpYWxvZ09wZW4gPSBjcmVhdGVFdmVudCh7IGNhbmNlbGFibGU6IGZhbHNlIH0pO1xuICAgIHRoaXMuY2FsY2l0ZURpYWxvZ1Njcm9sbCA9IGNyZWF0ZUV2ZW50KHsgY2FuY2VsYWJsZTogZmFsc2UgfSk7XG4gIH1cbiAgc3RhdGljIHtcbiAgICB0aGlzLnByb3BlcnRpZXMgPSB7IGFzc2lzdGl2ZVRleHQ6IFsxNiwge30sIHsgc3RhdGU6IHRydWUgfV0sIGhhc0NvbnRlbnRCb3R0b206IFsxNiwge30sIHsgc3RhdGU6IHRydWUgfV0sIGhhc0NvbnRlbnRUb3A6IFsxNiwge30sIHsgc3RhdGU6IHRydWUgfV0sIGhhc0Zvb3RlcjogWzE2LCB7fSwgeyBzdGF0ZTogdHJ1ZSB9XSwgb3BlbmVkOiBbMTYsIHt9LCB7IHN0YXRlOiB0cnVlIH1dLCBiZWZvcmVDbG9zZTogWzAsIHt9LCB7IGF0dHJpYnV0ZTogZmFsc2UgfV0sIGNsb3NlRGlzYWJsZWQ6IFs3LCB7fSwgeyByZWZsZWN0OiB0cnVlLCB0eXBlOiBCb29sZWFuIH1dLCBkZXNjcmlwdGlvbjogMSwgZHJhZ0VuYWJsZWQ6IFs3LCB7fSwgeyByZWZsZWN0OiB0cnVlLCB0eXBlOiBCb29sZWFuIH1dLCBlbWJlZGRlZDogWzUsIHt9LCB7IHR5cGU6IEJvb2xlYW4gfV0sIGVzY2FwZURpc2FibGVkOiBbNywge30sIHsgcmVmbGVjdDogdHJ1ZSwgdHlwZTogQm9vbGVhbiB9XSwgZm9jdXNUcmFwT3B0aW9uczogWzAsIHt9LCB7IGF0dHJpYnV0ZTogZmFsc2UgfV0sIGhlYWRpbmc6IDEsIGhlYWRpbmdMZXZlbDogWzExLCB7fSwgeyB0eXBlOiBOdW1iZXIsIHJlZmxlY3Q6IHRydWUgfV0sIGtpbmQ6IFszLCB7fSwgeyByZWZsZWN0OiB0cnVlIH1dLCBpY29uOiBbMywge30sIHsgcmVmbGVjdDogdHJ1ZSB9XSwgaWNvbkZsaXBSdGw6IFs3LCB7fSwgeyByZWZsZWN0OiB0cnVlLCB0eXBlOiBCb29sZWFuIH1dLCBsb2FkaW5nOiBbNywge30sIHsgcmVmbGVjdDogdHJ1ZSwgdHlwZTogQm9vbGVhbiB9XSwgbWVudU9wZW46IFs3LCB7fSwgeyByZWZsZWN0OiB0cnVlLCB0eXBlOiBCb29sZWFuIH1dLCBtZXNzYWdlT3ZlcnJpZGVzOiBbMCwge30sIHsgYXR0cmlidXRlOiBmYWxzZSB9XSwgbW9kYWw6IFs3LCB7fSwgeyByZWZsZWN0OiB0cnVlLCB0eXBlOiBCb29sZWFuIH1dLCBmb2N1c1RyYXBEaXNhYmxlZDogWzcsIHt9LCB7IHJlZmxlY3Q6IHRydWUsIHR5cGU6IEJvb2xlYW4gfV0sIG9wZW46IFs3LCB7fSwgeyByZWZsZWN0OiB0cnVlLCB0eXBlOiBCb29sZWFuIH1dLCBvdXRzaWRlQ2xvc2VEaXNhYmxlZDogWzcsIHt9LCB7IHJlZmxlY3Q6IHRydWUsIHR5cGU6IEJvb2xlYW4gfV0sIG92ZXJsYXlQb3NpdGlvbmluZzogWzMsIHt9LCB7IHJlZmxlY3Q6IHRydWUgfV0sIHBsYWNlbWVudDogWzMsIHt9LCB7IHJlZmxlY3Q6IHRydWUgfV0sIHJlc2l6YWJsZTogWzcsIHt9LCB7IHJlZmxlY3Q6IHRydWUsIHR5cGU6IEJvb2xlYW4gfV0sIHNjYWxlOiBbMywge30sIHsgcmVmbGVjdDogdHJ1ZSB9XSwgd2lkdGhTY2FsZTogWzMsIHt9LCB7IHJlZmxlY3Q6IHRydWUgfV0sIHdpZHRoOiBbMywge30sIHsgcmVmbGVjdDogdHJ1ZSB9XSB9O1xuICB9XG4gIHN0YXRpYyB7XG4gICAgdGhpcy5zdHlsZXMgPSBzdHlsZXM7XG4gIH1cbiAgZ2V0IHByZXZlbnREb2N1bWVudFNjcm9sbCgpIHtcbiAgICByZXR1cm4gIXRoaXMuZW1iZWRkZWQgJiYgdGhpcy5tb2RhbDtcbiAgfVxuICBnZXQgb3BlbigpIHtcbiAgICByZXR1cm4gdGhpcy5fb3BlbjtcbiAgfVxuICBzZXQgb3Blbih2YWx1ZSkge1xuICAgIGNvbnN0IG9sZFZhbHVlID0gdGhpcy5fb3BlbjtcbiAgICBpZiAodmFsdWUgIT09IG9sZFZhbHVlKSB7XG4gICAgICB0aGlzLnNldE9wZW5TdGF0ZSh2YWx1ZSk7XG4gICAgfVxuICB9XG4gIGFzeW5jIHNjcm9sbENvbnRlbnRUbyhvcHRpb25zKSB7XG4gICAgYXdhaXQgdGhpcy5wYW5lbEVsLnZhbHVlPy5zY3JvbGxDb250ZW50VG8ob3B0aW9ucyk7XG4gIH1cbiAgYXN5bmMgc2V0Rm9jdXMob3B0aW9ucykge1xuICAgIHJldHVybiB0aGlzLmZvY3VzU2V0dGVyKCgpID0+IHtcbiAgICAgIHJldHVybiB0aGlzLnBhbmVsRWwudmFsdWUgPz8gdGhpcy5lbDtcbiAgICB9LCBvcHRpb25zKTtcbiAgfVxuICBhc3luYyB1cGRhdGVGb2N1c1RyYXBFbGVtZW50cyhleHRyYUNvbnRhaW5lcnMpIHtcbiAgICB0aGlzLmZvY3VzVHJhcC5zZXRFeHRyYUNvbnRhaW5lcnMoZXh0cmFDb250YWluZXJzKTtcbiAgICB0aGlzLmZvY3VzVHJhcC51cGRhdGVDb250YWluZXJFbGVtZW50cygpO1xuICB9XG4gIGNvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIHN1cGVyLmNvbm5lY3RlZENhbGxiYWNrKCk7XG4gICAgdGhpcy5tdXRhdGlvbk9ic2VydmVyPy5vYnNlcnZlKHRoaXMuZWwsIHsgY2hpbGRMaXN0OiB0cnVlLCBzdWJ0cmVlOiB0cnVlIH0pO1xuICAgIHRoaXMuc2V0dXBJbnRlcmFjdGlvbnMoKTtcbiAgfVxuICB3aWxsVXBkYXRlKGNoYW5nZXMpIHtcbiAgICBpZiAoY2hhbmdlcy5oYXMoXCJvcGVuXCIpICYmICh0aGlzLmhhc1VwZGF0ZWQgfHwgdGhpcy5vcGVuICE9PSBmYWxzZSkgfHwgY2hhbmdlcy5oYXMoXCJwbGFjZW1lbnRcIikgJiYgKHRoaXMuaGFzVXBkYXRlZCB8fCB0aGlzLnBsYWNlbWVudCAhPT0gXCJjZW50ZXJcIikgfHwgY2hhbmdlcy5oYXMoXCJyZXNpemFibGVcIikgJiYgKHRoaXMuaGFzVXBkYXRlZCB8fCB0aGlzLnJlc2l6YWJsZSAhPT0gZmFsc2UpIHx8IGNoYW5nZXMuaGFzKFwiZHJhZ0VuYWJsZWRcIikgJiYgKHRoaXMuaGFzVXBkYXRlZCB8fCB0aGlzLmRyYWdFbmFibGVkICE9PSBmYWxzZSkpIHtcbiAgICAgIHRoaXMuc2V0dXBJbnRlcmFjdGlvbnMoKTtcbiAgICB9XG4gICAgaWYgKGNoYW5nZXMuaGFzKFwibWVzc2FnZXNcIikgfHwgY2hhbmdlcy5oYXMoXCJkcmFnRW5hYmxlZFwiKSAmJiAodGhpcy5oYXNVcGRhdGVkIHx8IHRoaXMuZHJhZ0VuYWJsZWQgIT09IGZhbHNlKSB8fCBjaGFuZ2VzLmhhcyhcInJlc2l6YWJsZVwiKSAmJiAodGhpcy5oYXNVcGRhdGVkIHx8IHRoaXMucmVzaXphYmxlICE9PSBmYWxzZSkpIHtcbiAgICAgIHRoaXMudXBkYXRlQXNzaXN0aXZlVGV4dCgpO1xuICAgIH1cbiAgICBpZiAoY2hhbmdlcy5oYXMoXCJvcGVuZWRcIikgJiYgKHRoaXMuaGFzVXBkYXRlZCB8fCB0aGlzLm9wZW5lZCAhPT0gZmFsc2UpKSB7XG4gICAgICB0aGlzLmhhbmRsZU9wZW5lZENoYW5nZSh0aGlzLm9wZW5lZCk7XG4gICAgfVxuICB9XG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIHN1cGVyLmRpc2Nvbm5lY3RlZENhbGxiYWNrKCk7XG4gICAgdGhpcy5tdXRhdGlvbk9ic2VydmVyPy5kaXNjb25uZWN0KCk7XG4gICAgdGhpcy5lbWJlZGRlZCA9IGZhbHNlO1xuICAgIHRoaXMuY2xlYW51cEludGVyYWN0aW9ucygpO1xuICB9XG4gIGZvY3VzVHJhcERpc2FibGVkT3ZlcnJpZGUoKSB7XG4gICAgcmV0dXJuICF0aGlzLm1vZGFsICYmIHRoaXMuZm9jdXNUcmFwRGlzYWJsZWQ7XG4gIH1cbiAgdXBkYXRlQXNzaXN0aXZlVGV4dCgpIHtcbiAgICBjb25zdCB7IG1lc3NhZ2VzIH0gPSB0aGlzO1xuICAgIHRoaXMuYXNzaXN0aXZlVGV4dCA9IG1lc3NhZ2VzICYmICh0aGlzLmRyYWdFbmFibGVkIHx8IHRoaXMucmVzaXphYmxlKSA/IGAke3RoaXMuZHJhZ0VuYWJsZWQgPyBtZXNzYWdlcy5kcmFnRW5hYmxlZCA6IFwiXCJ9ICR7dGhpcy5yZXNpemFibGUgPyBtZXNzYWdlcy5yZXNpemVFbmFibGVkIDogXCJcIn1gIDogbnVsbDtcbiAgfVxuICBvbkJlZm9yZU9wZW4oKSB7XG4gICAgdGhpcy5jYWxjaXRlRGlhbG9nQmVmb3JlT3Blbi5lbWl0KCk7XG4gIH1cbiAgb25PcGVuKCkge1xuICAgIGlmICh0aGlzLmZvY3VzVHJhcERpc2FibGVkKSB7XG4gICAgICB0aGlzLnNldEZvY3VzKCk7XG4gICAgfVxuICAgIHRoaXMuZm9jdXNUcmFwLmFjdGl2YXRlKCk7XG4gICAgdGhpcy5jYWxjaXRlRGlhbG9nT3Blbi5lbWl0KCk7XG4gIH1cbiAgb25CZWZvcmVDbG9zZSgpIHtcbiAgICB0aGlzLmNhbGNpdGVEaWFsb2dCZWZvcmVDbG9zZS5lbWl0KCk7XG4gIH1cbiAgb25DbG9zZSgpIHtcbiAgICB0aGlzLmZvY3VzVHJhcC5kZWFjdGl2YXRlKCk7XG4gICAgdGhpcy5jYWxjaXRlRGlhbG9nQ2xvc2UuZW1pdCgpO1xuICB9XG4gIGFzeW5jIHNldE9wZW5TdGF0ZSh2YWx1ZSkge1xuICAgIGlmICh0aGlzLmJlZm9yZUNsb3NlICYmICF2YWx1ZSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgdGhpcy5iZWZvcmVDbG9zZT8uKCk7XG4gICAgICB9IGNhdGNoIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLl9vcGVuID0gdmFsdWU7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICBhd2FpdCB0aGlzLmNvbXBvbmVudE9uUmVhZHkoKTtcbiAgICB9XG4gICAgdGhpcy5vcGVuZWQgPSB2YWx1ZTtcbiAgfVxuICBoYW5kbGVPcGVuZWRDaGFuZ2UodmFsdWUpIHtcbiAgICBjb25zdCB7IHRyYW5zaXRpb25FbCB9ID0gdGhpcztcbiAgICBpZiAoIXRyYW5zaXRpb25FbCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0cmFuc2l0aW9uRWwuY2xhc3NMaXN0LnRvZ2dsZShDU1Mub3BlbmluZ0FjdGl2ZSwgdmFsdWUpO1xuICAgIHRvZ2dsZU9wZW5DbG9zZSh0aGlzKTtcbiAgfVxuICBhc3luYyB0cmlnZ2VySW50ZXJhY3RNb2RpZmllcnMoKSB7XG4gICAgY29uc3QgeyBpbnRlcmFjdGlvbiB9ID0gdGhpcztcbiAgICBpZiAoIWludGVyYWN0aW9uKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGF3YWl0IGludGVyYWN0aW9uLnJlZmxvdyh7XG4gICAgICBuYW1lOiBcImRyYWdcIlxuICAgIH0pO1xuICAgIGF3YWl0IGludGVyYWN0aW9uLnJlZmxvdyh7XG4gICAgICBuYW1lOiBcInJlc2l6ZVwiXG4gICAgfSk7XG4gIH1cbiAgZ2V0VHJhbnNpdGlvbkVsRE9NUmVjdCgpIHtcbiAgICByZXR1cm4gdGhpcy50cmFuc2l0aW9uRWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gIH1cbiAgaGFuZGxlS2V5RG93bihldmVudCkge1xuICAgIGNvbnN0IHsga2V5LCBzaGlmdEtleSwgZGVmYXVsdFByZXZlbnRlZCB9ID0gZXZlbnQ7XG4gICAgY29uc3QgeyBkcmFnRW5hYmxlZCwgcmVzaXphYmxlLCByZXNpemVQb3NpdGlvbiwgZHJhZ1Bvc2l0aW9uLCB0cmFuc2l0aW9uRWwgfSA9IHRoaXM7XG4gICAgY29uc3Qga2V5cyA9IFtcIkFycm93VXBcIiwgXCJBcnJvd0Rvd25cIiwgXCJBcnJvd0xlZnRcIiwgXCJBcnJvd1JpZ2h0XCJdO1xuICAgIGlmIChkZWZhdWx0UHJldmVudGVkIHx8ICFrZXlzLmluY2x1ZGVzKGtleSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgc3dpdGNoIChrZXkpIHtcbiAgICAgIGNhc2UgXCJBcnJvd1VwXCI6XG4gICAgICAgIGlmIChzaGlmdEtleSAmJiByZXNpemFibGUgJiYgdHJhbnNpdGlvbkVsKSB7XG4gICAgICAgICAgY29uc3QgeyBtaW5CbG9ja1NpemUgfSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRyYW5zaXRpb25FbCk7XG4gICAgICAgICAgY29uc3QgbWluSGVpZ2h0ID0gZ2V0U3R5bGVQaXhlbFZhbHVlKG1pbkJsb2NrU2l6ZSk7XG4gICAgICAgICAgY29uc3QgaGVpZ2h0ID0gdGhpcy5nZXRUcmFuc2l0aW9uRWxET01SZWN0KCkuaGVpZ2h0O1xuICAgICAgICAgIGlmIChoZWlnaHQgPD0gbWluSGVpZ2h0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMudXBkYXRlU2l6ZSh7XG4gICAgICAgICAgICBzaXplOiBoZWlnaHQgLSByZXNpemVTaGlmdFN0ZXAsXG4gICAgICAgICAgICB0eXBlOiBcImJsb2NrU2l6ZVwiXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmVzaXplUG9zaXRpb24uYm90dG9tIC09IHJlc2l6ZVNoaWZ0U3RlcDtcbiAgICAgICAgICB0aGlzLnVwZGF0ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgIHRoaXMudHJpZ2dlckludGVyYWN0TW9kaWZpZXJzKCk7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfSBlbHNlIGlmIChkcmFnRW5hYmxlZCkge1xuICAgICAgICAgIGRyYWdQb3NpdGlvbi55IC09IHJlc2l6ZVNoaWZ0U3RlcDtcbiAgICAgICAgICB0aGlzLnVwZGF0ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgIHRoaXMudHJpZ2dlckludGVyYWN0TW9kaWZpZXJzKCk7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJBcnJvd0Rvd25cIjpcbiAgICAgICAgaWYgKHNoaWZ0S2V5ICYmIHJlc2l6YWJsZSAmJiB0cmFuc2l0aW9uRWwpIHtcbiAgICAgICAgICB0aGlzLnVwZGF0ZVNpemUoe1xuICAgICAgICAgICAgc2l6ZTogdGhpcy5nZXRUcmFuc2l0aW9uRWxET01SZWN0KCkuaGVpZ2h0ICsgcmVzaXplU2hpZnRTdGVwLFxuICAgICAgICAgICAgdHlwZTogXCJibG9ja1NpemVcIlxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJlc2l6ZVBvc2l0aW9uLmJvdHRvbSArPSByZXNpemVTaGlmdFN0ZXA7XG4gICAgICAgICAgdGhpcy51cGRhdGVUcmFuc2Zvcm0oKTtcbiAgICAgICAgICB0aGlzLnRyaWdnZXJJbnRlcmFjdE1vZGlmaWVycygpO1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH0gZWxzZSBpZiAoZHJhZ0VuYWJsZWQpIHtcbiAgICAgICAgICBkcmFnUG9zaXRpb24ueSArPSByZXNpemVTaGlmdFN0ZXA7XG4gICAgICAgICAgdGhpcy51cGRhdGVUcmFuc2Zvcm0oKTtcbiAgICAgICAgICB0aGlzLnRyaWdnZXJJbnRlcmFjdE1vZGlmaWVycygpO1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwiQXJyb3dMZWZ0XCI6XG4gICAgICAgIGlmIChzaGlmdEtleSAmJiByZXNpemFibGUgJiYgdHJhbnNpdGlvbkVsKSB7XG4gICAgICAgICAgY29uc3QgeyBtaW5JbmxpbmVTaXplIH0gPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0cmFuc2l0aW9uRWwpO1xuICAgICAgICAgIGNvbnN0IG1pbldpZHRoID0gZ2V0U3R5bGVQaXhlbFZhbHVlKG1pbklubGluZVNpemUpO1xuICAgICAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy5nZXRUcmFuc2l0aW9uRWxET01SZWN0KCkud2lkdGg7XG4gICAgICAgICAgaWYgKHdpZHRoIDw9IG1pbldpZHRoKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMudXBkYXRlU2l6ZSh7XG4gICAgICAgICAgICBzaXplOiB3aWR0aCAtIHJlc2l6ZVNoaWZ0U3RlcCxcbiAgICAgICAgICAgIHR5cGU6IFwiaW5saW5lU2l6ZVwiXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmVzaXplUG9zaXRpb24ucmlnaHQgLT0gcmVzaXplU2hpZnRTdGVwO1xuICAgICAgICAgIHRoaXMudXBkYXRlVHJhbnNmb3JtKCk7XG4gICAgICAgICAgdGhpcy50cmlnZ2VySW50ZXJhY3RNb2RpZmllcnMoKTtcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9IGVsc2UgaWYgKGRyYWdFbmFibGVkKSB7XG4gICAgICAgICAgZHJhZ1Bvc2l0aW9uLnggLT0gcmVzaXplU2hpZnRTdGVwO1xuICAgICAgICAgIHRoaXMudXBkYXRlVHJhbnNmb3JtKCk7XG4gICAgICAgICAgdGhpcy50cmlnZ2VySW50ZXJhY3RNb2RpZmllcnMoKTtcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcIkFycm93UmlnaHRcIjpcbiAgICAgICAgaWYgKHNoaWZ0S2V5ICYmIHJlc2l6YWJsZSAmJiB0cmFuc2l0aW9uRWwpIHtcbiAgICAgICAgICB0aGlzLnVwZGF0ZVNpemUoe1xuICAgICAgICAgICAgc2l6ZTogdGhpcy5nZXRUcmFuc2l0aW9uRWxET01SZWN0KCkud2lkdGggKyByZXNpemVTaGlmdFN0ZXAsXG4gICAgICAgICAgICB0eXBlOiBcImlubGluZVNpemVcIlxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJlc2l6ZVBvc2l0aW9uLnJpZ2h0ICs9IHJlc2l6ZVNoaWZ0U3RlcDtcbiAgICAgICAgICB0aGlzLnVwZGF0ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgIHRoaXMudHJpZ2dlckludGVyYWN0TW9kaWZpZXJzKCk7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfSBlbHNlIGlmIChkcmFnRW5hYmxlZCkge1xuICAgICAgICAgIGRyYWdQb3NpdGlvbi54ICs9IHJlc2l6ZVNoaWZ0U3RlcDtcbiAgICAgICAgICB0aGlzLnVwZGF0ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgIHRoaXMudHJpZ2dlckludGVyYWN0TW9kaWZpZXJzKCk7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICB9XG4gIH1cbiAgdXBkYXRlVHJhbnNmb3JtKCkge1xuICAgIGNvbnN0IHsgZHJhZ1Bvc2l0aW9uOiB7IHgsIHkgfSwgcmVzaXplUG9zaXRpb24sIHRyYW5zaXRpb25FbCwgZHJhZ0VuYWJsZWQsIHJlc2l6YWJsZSB9ID0gdGhpcztcbiAgICBpZiAoIXRyYW5zaXRpb25FbCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoIWRyYWdFbmFibGVkICYmICFyZXNpemFibGUpIHtcbiAgICAgIHRyYW5zaXRpb25FbC5zdHlsZS50cmFuc2Zvcm0gPSBudWxsO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCB7IHRvcCwgcmlnaHQsIGJvdHRvbSwgbGVmdCB9ID0gdGhpcy5nZXRBZGp1c3RlZFJlc2l6ZVBvc2l0aW9uKHJlc2l6ZVBvc2l0aW9uKTtcbiAgICBjb25zdCB0cmFuc2xhdGVYID0gTWF0aC5yb3VuZCh4ICsgbGVmdCArIHJpZ2h0KTtcbiAgICBjb25zdCB0cmFuc2xhdGVZID0gTWF0aC5yb3VuZCh5ICsgdG9wICsgYm90dG9tKTtcbiAgICB0cmFuc2l0aW9uRWwuc3R5bGUudHJhbnNmb3JtID0gdHJhbnNsYXRlWCB8fCB0cmFuc2xhdGVZID8gYHRyYW5zbGF0ZSgke3RyYW5zbGF0ZVh9cHgsICR7dHJhbnNsYXRlWX1weClgIDogbnVsbDtcbiAgfVxuICB1cGRhdGVTaXplKHsgdHlwZSwgc2l6ZSB9KSB7XG4gICAgY29uc3QgeyB0cmFuc2l0aW9uRWwgfSA9IHRoaXM7XG4gICAgaWYgKCF0cmFuc2l0aW9uRWwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdHJhbnNpdGlvbkVsLnN0eWxlW3R5cGVdID0gc2l6ZSAhPT0gbnVsbCA/IGAke01hdGgucm91bmQoc2l6ZSl9cHhgIDogbnVsbDtcbiAgfVxuICBjbGVhbnVwSW50ZXJhY3Rpb25zKCkge1xuICAgIHRoaXMuaW50ZXJhY3Rpb24/LnVuc2V0KCk7XG4gICAgdGhpcy51cGRhdGVTaXplKHsgc2l6ZTogbnVsbCwgdHlwZTogXCJpbmxpbmVTaXplXCIgfSk7XG4gICAgdGhpcy51cGRhdGVTaXplKHsgc2l6ZTogbnVsbCwgdHlwZTogXCJibG9ja1NpemVcIiB9KTtcbiAgICB0aGlzLmRyYWdQb3NpdGlvbiA9IHsgLi4uaW5pdGlhbERyYWdQb3NpdGlvbiB9O1xuICAgIHRoaXMucmVzaXplUG9zaXRpb24gPSB7IC4uLmluaXRpYWxSZXNpemVQb3NpdGlvbiB9O1xuICAgIHRoaXMudXBkYXRlVHJhbnNmb3JtKCk7XG4gIH1cbiAgYXN5bmMgc2V0dXBJbnRlcmFjdGlvbnMoKSB7XG4gICAgdGhpcy5jbGVhbnVwSW50ZXJhY3Rpb25zKCk7XG4gICAgY29uc3QgeyBlbCwgdHJhbnNpdGlvbkVsLCByZXNpemFibGUsIGRyYWdFbmFibGVkLCByZXNpemVQb3NpdGlvbiwgZHJhZ1Bvc2l0aW9uIH0gPSB0aGlzO1xuICAgIGlmICghdHJhbnNpdGlvbkVsIHx8ICF0aGlzLm9wZW4pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHJlc2l6YWJsZSB8fCBkcmFnRW5hYmxlZCkge1xuICAgICAgdGhpcy5pbnRlcmFjdGlvbiA9IGludGVyYWN0KHRyYW5zaXRpb25FbCwgeyBjb250ZXh0OiBlbC5vd25lckRvY3VtZW50IH0pO1xuICAgIH1cbiAgICBpZiAocmVzaXphYmxlKSB7XG4gICAgICBhd2FpdCB0aGlzLmVsLmNvbXBvbmVudE9uUmVhZHkoKTtcbiAgICAgIGNvbnN0IHsgbWluSW5saW5lU2l6ZSwgbWluQmxvY2tTaXplLCBtYXhJbmxpbmVTaXplLCBtYXhCbG9ja1NpemUgfSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRyYW5zaXRpb25FbCk7XG4gICAgICB0aGlzLmludGVyYWN0aW9uLnJlc2l6YWJsZSh7XG4gICAgICAgIGVkZ2VzOiB7XG4gICAgICAgICAgdG9wOiB0cnVlLFxuICAgICAgICAgIHJpZ2h0OiB0cnVlLFxuICAgICAgICAgIGJvdHRvbTogdHJ1ZSxcbiAgICAgICAgICBsZWZ0OiB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIG1vZGlmaWVyczogW1xuICAgICAgICAgIGludGVyYWN0Lm1vZGlmaWVycy5yZXN0cmljdFNpemUoe1xuICAgICAgICAgICAgbWluOiB7XG4gICAgICAgICAgICAgIHdpZHRoOiBnZXRTdHlsZVBpeGVsVmFsdWUobWluSW5saW5lU2l6ZSksXG4gICAgICAgICAgICAgIGhlaWdodDogZ2V0U3R5bGVQaXhlbFZhbHVlKG1pbkJsb2NrU2l6ZSlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtYXg6IHtcbiAgICAgICAgICAgICAgd2lkdGg6IGdldFN0eWxlUGl4ZWxWYWx1ZShtYXhJbmxpbmVTaXplKSB8fCB3aW5kb3cuaW5uZXJXaWR0aCxcbiAgICAgICAgICAgICAgaGVpZ2h0OiBnZXRTdHlsZVBpeGVsVmFsdWUobWF4QmxvY2tTaXplKSB8fCB3aW5kb3cuaW5uZXJIZWlnaHRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KSxcbiAgICAgICAgICBpbnRlcmFjdC5tb2RpZmllcnMucmVzdHJpY3Qoe1xuICAgICAgICAgICAgcmVzdHJpY3Rpb246IFwicGFyZW50XCJcbiAgICAgICAgICB9KVxuICAgICAgICBdLFxuICAgICAgICBsaXN0ZW5lcnM6IHtcbiAgICAgICAgICBtb3ZlOiAoeyByZWN0LCBkZWx0YVJlY3QgfSkgPT4ge1xuICAgICAgICAgICAgaWYgKGRlbHRhUmVjdCkge1xuICAgICAgICAgICAgICByZXNpemVQb3NpdGlvbi50b3AgKz0gZGVsdGFSZWN0LnRvcDtcbiAgICAgICAgICAgICAgcmVzaXplUG9zaXRpb24ucmlnaHQgKz0gZGVsdGFSZWN0LnJpZ2h0O1xuICAgICAgICAgICAgICByZXNpemVQb3NpdGlvbi5ib3R0b20gKz0gZGVsdGFSZWN0LmJvdHRvbTtcbiAgICAgICAgICAgICAgcmVzaXplUG9zaXRpb24ubGVmdCArPSBkZWx0YVJlY3QubGVmdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudXBkYXRlU2l6ZSh7IHNpemU6IHJlY3Qud2lkdGgsIHR5cGU6IFwiaW5saW5lU2l6ZVwiIH0pO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTaXplKHsgc2l6ZTogcmVjdC5oZWlnaHQsIHR5cGU6IFwiYmxvY2tTaXplXCIgfSk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChkcmFnRW5hYmxlZCkge1xuICAgICAgdGhpcy5pbnRlcmFjdGlvbi5kcmFnZ2FibGUoe1xuICAgICAgICBtb2RpZmllcnM6IFtcbiAgICAgICAgICBpbnRlcmFjdC5tb2RpZmllcnMucmVzdHJpY3RSZWN0KHtcbiAgICAgICAgICAgIHJlc3RyaWN0aW9uOiBcInBhcmVudFwiXG4gICAgICAgICAgfSlcbiAgICAgICAgXSxcbiAgICAgICAgbGlzdGVuZXJzOiB7XG4gICAgICAgICAgbW92ZTogKHsgZHgsIGR5IH0pID0+IHtcbiAgICAgICAgICAgIGRyYWdQb3NpdGlvbi54ICs9IGR4O1xuICAgICAgICAgICAgZHJhZ1Bvc2l0aW9uLnkgKz0gZHk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVRyYW5zZm9ybSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIGdldEFkanVzdGVkUmVzaXplUG9zaXRpb24oeyB0b3AsIHJpZ2h0LCBib3R0b20sIGxlZnQgfSkge1xuICAgIGNvbnN0IGhhbGZUb3AgPSB0b3AgLyAyO1xuICAgIGNvbnN0IGhhbGZSaWdodCA9IHJpZ2h0IC8gMjtcbiAgICBjb25zdCBoYWxmQm90dG9tID0gYm90dG9tIC8gMjtcbiAgICBjb25zdCBoYWxmTGVmdCA9IGxlZnQgLyAyO1xuICAgIHN3aXRjaCAodGhpcy5wbGFjZW1lbnQpIHtcbiAgICAgIGNhc2UgXCJ0b3BcIjpcbiAgICAgICAgcmV0dXJuIHsgdG9wLCByaWdodDogaGFsZlJpZ2h0LCBib3R0b206IDAsIGxlZnQ6IGhhbGZMZWZ0IH07XG4gICAgICBjYXNlIFwidG9wLXN0YXJ0XCI6XG4gICAgICAgIHJldHVybiB7IHRvcCwgcmlnaHQ6IDAsIGJvdHRvbTogMCwgbGVmdCB9O1xuICAgICAgY2FzZSBcInRvcC1lbmRcIjpcbiAgICAgICAgcmV0dXJuIHsgdG9wLCByaWdodCwgYm90dG9tOiAwLCBsZWZ0OiAwIH07XG4gICAgICBjYXNlIFwiYm90dG9tXCI6XG4gICAgICAgIHJldHVybiB7IHRvcDogMCwgcmlnaHQ6IGhhbGZSaWdodCwgYm90dG9tLCBsZWZ0OiBoYWxmTGVmdCB9O1xuICAgICAgY2FzZSBcImJvdHRvbS1zdGFydFwiOlxuICAgICAgICByZXR1cm4geyB0b3A6IDAsIHJpZ2h0OiAwLCBib3R0b20sIGxlZnQgfTtcbiAgICAgIGNhc2UgXCJib3R0b20tZW5kXCI6XG4gICAgICAgIHJldHVybiB7IHRvcDogMCwgcmlnaHQsIGJvdHRvbSwgbGVmdDogMCB9O1xuICAgICAgY2FzZSBcImNvdmVyXCI6XG4gICAgICBjYXNlIFwiY2VudGVyXCI6XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHRvcDogaGFsZlRvcCxcbiAgICAgICAgICByaWdodDogaGFsZlJpZ2h0LFxuICAgICAgICAgIGJvdHRvbTogaGFsZkJvdHRvbSxcbiAgICAgICAgICBsZWZ0OiBoYWxmTGVmdFxuICAgICAgICB9O1xuICAgIH1cbiAgfVxuICBzZXRUcmFuc2l0aW9uRWwoZWwpIHtcbiAgICBpZiAoIWVsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMudHJhbnNpdGlvbkVsID0gZWw7XG4gICAgdGhpcy5zZXR1cEludGVyYWN0aW9ucygpO1xuICB9XG4gIGhhbmRsZUludGVybmFsUGFuZWxTY3JvbGwoZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQudGFyZ2V0ICE9PSB0aGlzLnBhbmVsRWwudmFsdWUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgdGhpcy5jYWxjaXRlRGlhbG9nU2Nyb2xsLmVtaXQoKTtcbiAgfVxuICBoYW5kbGVJbnRlcm5hbFBhbmVsQ2xvc2VDbGljayhldmVudCkge1xuICAgIGlmIChldmVudC50YXJnZXQgIT09IHRoaXMucGFuZWxFbC52YWx1ZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIHRoaXMub3BlbiA9IGZhbHNlO1xuICB9XG4gIGhhbmRsZVBhbmVsS2V5RG93bihldmVudCkge1xuICAgIGlmICh0aGlzLmVzY2FwZURpc2FibGVkICYmIGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gIH1cbiAgaGFuZGxlT3V0c2lkZUNsb3NlKCkge1xuICAgIGlmICh0aGlzLm91dHNpZGVDbG9zZURpc2FibGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMub3BlbiA9IGZhbHNlO1xuICB9XG4gIGhhbmRsZU11dGF0aW9uT2JzZXJ2ZXIoKSB7XG4gICAgdGhpcy5mb2N1c1RyYXAudXBkYXRlQ29udGFpbmVyRWxlbWVudHMoKTtcbiAgfVxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyBhc3Npc3RpdmVUZXh0LCBkZXNjcmlwdGlvbiwgaGVhZGluZywgb3BlbmVkLCBpY29uLCBpY29uRmxpcFJ0bCB9ID0gdGhpcztcbiAgICByZXR1cm4gaHRtbGA8ZGl2IGNsYXNzPSR7c2FmZUNsYXNzTWFwKHtcbiAgICAgIFtDU1MuY29udGFpbmVyXTogdHJ1ZSxcbiAgICAgIFtDU1MuY29udGFpbmVyT3Blbl06IG9wZW5lZCxcbiAgICAgIFtDU1MuY29udGFpbmVyRW1iZWRkZWRdOiB0aGlzLmVtYmVkZGVkXG4gICAgfSl9PiR7dGhpcy5tb2RhbCA/IGh0bWxgPGNhbGNpdGUtc2NyaW0gY2xhc3M9JHtzYWZlQ2xhc3NNYXAoQ1NTLnNjcmltKX0gQGNsaWNrPSR7dGhpcy5oYW5kbGVPdXRzaWRlQ2xvc2V9PjwvY2FsY2l0ZS1zY3JpbT5gIDogbnVsbH08ZGl2IC5hcmlhRGVzY3JpcHRpb249JHtkZXNjcmlwdGlvbn0gLmFyaWFMYWJlbD0ke2hlYWRpbmd9IC5hcmlhTW9kYWw9JHt0aGlzLm1vZGFsfSBjbGFzcz0ke3NhZmVDbGFzc01hcCh7XG4gICAgICBbQ1NTLmRpYWxvZ106IHRydWUsXG4gICAgICBbZ2V0RGltZW5zaW9uQ2xhc3MoXCJ3aWR0aFwiLCB0aGlzLndpZHRoLCB0aGlzLndpZHRoU2NhbGUpXTogISEodGhpcy53aWR0aCB8fCB0aGlzLndpZHRoU2NhbGUpXG4gICAgfSl9IEBrZXlkb3duPSR7dGhpcy5oYW5kbGVLZXlEb3dufSByb2xlPWRpYWxvZyAke3JlZih0aGlzLnNldFRyYW5zaXRpb25FbCl9PiR7YXNzaXN0aXZlVGV4dCA/IGtleWVkKFwiYXNzaXN0aXZlLXRleHRcIiwgaHRtbGA8ZGl2IGFyaWEtbGl2ZT1wb2xpdGUgY2xhc3M9JHtzYWZlQ2xhc3NNYXAoQ1NTLmFzc2lzdGl2ZVRleHQpfT4ke2Fzc2lzdGl2ZVRleHR9PC9kaXY+YCkgOiBudWxsfTxzbG90IG5hbWU9JHtTTE9UUy5jdXN0b21Db250ZW50fT48c2xvdCBuYW1lPSR7U0xPVFMuY29udGVudH0+PGNhbGNpdGUtcGFuZWwgY2xhc3M9JHtzYWZlQ2xhc3NNYXAoQ1NTLnBhbmVsKX0gLmNsb3NhYmxlPSR7IXRoaXMuY2xvc2VEaXNhYmxlZH0gLmRlc2NyaXB0aW9uPSR7ZGVzY3JpcHRpb259IC5oZWFkaW5nPSR7aGVhZGluZ30gLmhlYWRpbmdMZXZlbD0ke3RoaXMuaGVhZGluZ0xldmVsfSAuaGlkZGVuPSR7IXRoaXMub3BlbmVkfSAuaWNvbj0ke2ljb259IC5pY29uRmxpcFJ0bD0ke2ljb25GbGlwUnRsfSAubG9hZGluZz0ke3RoaXMubG9hZGluZ30gLm1lbnVPcGVuPSR7dGhpcy5tZW51T3Blbn0gLm1lc3NhZ2VPdmVycmlkZXM9JHt0aGlzLm1lc3NhZ2VPdmVycmlkZXN9IEBrZXlkb3duPSR7dGhpcy5oYW5kbGVQYW5lbEtleURvd259IEBjYWxjaXRlUGFuZWxDbG9zZT0ke3RoaXMuaGFuZGxlSW50ZXJuYWxQYW5lbENsb3NlQ2xpY2t9IEBjYWxjaXRlUGFuZWxTY3JvbGw9JHt0aGlzLmhhbmRsZUludGVybmFsUGFuZWxTY3JvbGx9IC5vdmVybGF5UG9zaXRpb25pbmc9JHt0aGlzLm92ZXJsYXlQb3NpdGlvbmluZ30gLnNjYWxlPSR7dGhpcy5zY2FsZX0gJHtyZWYodGhpcy5wYW5lbEVsKX0+PHNsb3QgbmFtZT0ke1NMT1RTLmFjdGlvbkJhcn0gc2xvdD0ke1NMT1RTJDEuYWN0aW9uQmFyfT48L3Nsb3Q+PHNsb3QgbmFtZT0ke1NMT1RTLmFsZXJ0c30gc2xvdD0ke1NMT1RTJDEuYWxlcnRzfT48L3Nsb3Q+PHNsb3QgbmFtZT0ke1NMT1RTLmhlYWRlckFjdGlvbnNTdGFydH0gc2xvdD0ke1NMT1RTJDEuaGVhZGVyQWN0aW9uc1N0YXJ0fT48L3Nsb3Q+PHNsb3QgbmFtZT0ke1NMT1RTLmhlYWRlckFjdGlvbnNFbmR9IHNsb3Q9JHtTTE9UUyQxLmhlYWRlckFjdGlvbnNFbmR9Pjwvc2xvdD48c2xvdCBuYW1lPSR7U0xPVFMuaGVhZGVyQ29udGVudH0gc2xvdD0ke1NMT1RTJDEuaGVhZGVyQ29udGVudH0+PC9zbG90PjxzbG90IG5hbWU9JHtTTE9UUy5oZWFkZXJNZW51QWN0aW9uc30gc2xvdD0ke1NMT1RTJDEuaGVhZGVyTWVudUFjdGlvbnN9Pjwvc2xvdD48c2xvdCBuYW1lPSR7U0xPVFMuZmFifSBzbG90PSR7U0xPVFMkMS5mYWJ9Pjwvc2xvdD48c2xvdCBuYW1lPSR7U0xPVFMuY29udGVudFRvcH0gc2xvdD0ke1NMT1RTJDEuY29udGVudFRvcH0+PC9zbG90PjxzbG90IG5hbWU9JHtTTE9UUy5jb250ZW50Qm90dG9tfSBzbG90PSR7U0xPVFMkMS5jb250ZW50Qm90dG9tfT48L3Nsb3Q+PHNsb3QgbmFtZT0ke1NMT1RTLmZvb3RlclN0YXJ0fSBzbG90PSR7U0xPVFMkMS5mb290ZXJTdGFydH0+PC9zbG90PjxzbG90IG5hbWU9JHtTTE9UUy5mb290ZXJ9IHNsb3Q9JHtTTE9UUyQxLmZvb3Rlcn0+PC9zbG90PjxzbG90IG5hbWU9JHtTTE9UUy5mb290ZXJFbmR9IHNsb3Q9JHtTTE9UUyQxLmZvb3RlckVuZH0+PC9zbG90PjxzbG90Pjwvc2xvdD48L2NhbGNpdGUtcGFuZWw+PC9zbG90Pjwvc2xvdD48L2Rpdj48L2Rpdj5gO1xuICB9XG59XG5jdXN0b21FbGVtZW50KFwiY2FsY2l0ZS1kaWFsb2dcIiwgRGlhbG9nKTtcbmV4cG9ydCB7XG4gIERpYWxvZ1xufTtcbiIsImltcG9ydCBcIi4uL2NhbGNpdGUtc2NyaW0vaW5kZXguanNcIjtcbmltcG9ydCBcIi4uL2NhbGNpdGUtcGFuZWwvaW5kZXguanNcIjtcbmV4cG9ydCAqIGZyb20gXCIuL2N1c3RvbUVsZW1lbnQuanNcIjsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=