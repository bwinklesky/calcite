export const __webpack_id__ = "vendors-node_modules_esri_calcite-components_dist_components_calcite-flow_index_js";
export const __webpack_ids__ = ["vendors-node_modules_esri_calcite-components_dist_components_calcite-flow_index_js"];
export const __webpack_modules__ = {

/***/ "./node_modules/@esri/calcite-components/dist/chunks/component.js":
/*!************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/chunks/component.js ***!
  \************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ componentFocusable),
/* harmony export */   g: () => (/* binding */ getIconScale),
/* harmony export */   i: () => (/* binding */ isHidden),
/* harmony export */   w: () => (/* binding */ warnIfMissingRequiredProp)
/* harmony export */ });
/* harmony import */ var _logger_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./logger.js */ "./node_modules/@esri/calcite-components/dist/chunks/logger.js");
/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */

function getIconScale(componentScale) {
  return componentScale === "l" ? "m" : "s";
}
function warnIfMissingRequiredProp(component, newProp, deprecatedProp) {
  if (!component[newProp] && !component[deprecatedProp]) {
    _logger_js__WEBPACK_IMPORTED_MODULE_0__.l.warn(`[${component.el.localName}] "${newProp.toString()}" or "${deprecatedProp.toString()}" is required.`);
  }
}
function isHidden(el) {
  return el.hidden || el.itemHidden;
}
async function componentFocusable(component) {
  await component.componentOnReady();
  await component.updateComplete;
}



/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/chunks/logger.js":
/*!*********************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/chunks/logger.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   l: () => (/* binding */ logger)
/* harmony export */ });
/* harmony import */ var _runtime_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./runtime.js */ "./node_modules/@esri/calcite-components/dist/chunks/runtime.js");
/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */

const loggedDeprecations = /* @__PURE__ */ new Set();
const logLevels = {
  trace: 0,
  debug: 1,
  info: 2,
  warn: 4,
  error: 8,
  off: 10
};
function willLog(level) {
  return logLevels[level] >= logLevels[_runtime_js__WEBPACK_IMPORTED_MODULE_0__.l];
}
function forwardToConsole(level, ...data) {
  if (!willLog(level)) {
    return;
  }
  const badgeTemplate = "%ccalcite";
  const badgeStyle = "background: #007AC2; color: #fff; border-radius: 4px; padding: 2px 4px;";
  console[level].call(this, badgeTemplate, badgeStyle, ...data);
}
let listFormatter;
const logger = {
  debug: (message) => forwardToConsole("debug", message),
  info: (message) => forwardToConsole("info", message),
  warn: (message) => forwardToConsole("warn", message),
  error: (message) => forwardToConsole("error", message),
  trace: (message) => forwardToConsole("trace", message),
  deprecated
};
function deprecated(context, { component, name, suggested, removalVersion }) {
  const key = `${context}:${context === "component" ? "" : component}${name}`;
  if (loggedDeprecations.has(key)) {
    return;
  }
  loggedDeprecations.add(key);
  const multiSuggestions = Array.isArray(suggested);
  if (multiSuggestions && !listFormatter) {
    listFormatter = new Intl.ListFormat("en", { style: "long", type: "disjunction" });
  }
  const message = `[${name}] ${context} is deprecated and will be removed in ${removalVersion === "future" ? `a future version` : `v${removalVersion}`}.${suggested ? ` Use ${multiSuggestions ? listFormatter.format(suggested.map((suggestion) => `"${suggestion}"`)) : `"${suggested}"`} instead.` : ""}`;
  forwardToConsole("warn", message);
}



/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/chunks/observers.js":
/*!************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/chunks/observers.js ***!
  \************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ createObserver),
/* harmony export */   u: () => (/* binding */ updateRefObserver)
/* harmony export */ });
/* harmony import */ var lit__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit */ "./node_modules/lit/index.js");
/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */

function createObserver(type, callback, options) {
  if (lit__WEBPACK_IMPORTED_MODULE_0__.isServer) {
    return void 0;
  }
  const Observer = getObserver(type);
  return new Observer(callback, options);
}
function getObserver(type) {
  class ExtendedMutationObserver extends window.MutationObserver {
    constructor(callback) {
      super(callback);
      this.observedEntry = [];
      this.callback = callback;
    }
    observe(target, options) {
      this.observedEntry.push({ target, options });
      return super.observe(target, options);
    }
    unobserve(target) {
      const newObservedEntries = this.observedEntry.filter((observed) => observed.target !== target);
      this.observedEntry = [];
      this.callback(super.takeRecords(), this);
      this.disconnect();
      newObservedEntries.forEach((observed) => this.observe(observed.target, observed.options));
    }
  }
  return function() {
    return type === "intersection" ? window.IntersectionObserver : type === "mutation" ? ExtendedMutationObserver : window.ResizeObserver;
  }();
}
function updateRefObserver(observer, oldTarget, target, options) {
  if (!observer) {
    return;
  }
  if (oldTarget) {
    observer.unobserve(oldTarget);
  }
  if (!target) {
    return;
  }
  if (observer instanceof MutationObserver) {
    observer.observe(target, options);
    return;
  }
  observer.observe(target);
}



/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/chunks/useSetFocus.js":
/*!**************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/chunks/useSetFocus.js ***!
  \**************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   u: () => (/* binding */ useSetFocus)
/* harmony export */ });
/* harmony import */ var _arcgis_lumina_controllers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @arcgis/lumina/controllers */ "./node_modules/@arcgis/lumina/dist/controllers/index.js");
/* harmony import */ var _component_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./component.js */ "./node_modules/@esri/calcite-components/dist/chunks/component.js");
/* harmony import */ var _dom_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./dom.js */ "./node_modules/@esri/calcite-components/dist/chunks/dom.js");
/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */



const useSetFocus = () => {
  return (0,_arcgis_lumina_controllers__WEBPACK_IMPORTED_MODULE_0__.makeGenericController)((component, controller) => {
    let abortController;
    function handleFocusOut() {
      abortController?.abort();
    }
    controller.onLoad(() => {
      component.listen("focus", () => {
        abortController = new AbortController();
        component.el.addEventListener("focusout", handleFocusOut, { signal: abortController.signal });
      });
    });
    controller.onDisconnected(() => {
      component.el.removeEventListener("focusout", handleFocusOut);
    });
    return async (getFocusTarget, options) => {
      if (component.disabled) {
        return;
      }
      const focusConfig = toFocusConfig(getFocusTarget());
      if (!focusConfig) {
        return;
      }
      const { target, includeContainer, strategy } = focusConfig;
      const rootNode = (0,_dom_js__WEBPACK_IMPORTED_MODULE_2__.k)(component.el);
      const currentActiveElement = rootNode.activeElement;
      await (0,_component_js__WEBPACK_IMPORTED_MODULE_1__.c)(component);
      const focusAlreadyChanged = currentActiveElement !== rootNode.activeElement;
      if (focusAlreadyChanged || abortController && !abortController?.signal.aborted) {
        return;
      }
      component.el.removeEventListener("focus", handleFocusOut);
      return (0,_dom_js__WEBPACK_IMPORTED_MODULE_2__.b)(target, includeContainer, strategy, component.el, options);
    };
  });
};
function isFocusOverride(focusTarget) {
  return "target" in focusTarget && ("includeContainer" in focusTarget || "strategy" in focusTarget);
}
function toFocusConfig(focusTarget) {
  if (!focusTarget) {
    return;
  }
  return isFocusOverride(focusTarget) ? focusTarget : { target: focusTarget };
}



/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/components/calcite-flow/customElement.js":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/components/calcite-flow/customElement.js ***!
  \*********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Flow: () => (/* binding */ Flow)
/* harmony export */ });
/* harmony import */ var _chunks_runtime_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../chunks/runtime.js */ "./node_modules/@esri/calcite-components/dist/chunks/runtime.js");
/* harmony import */ var lit__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lit */ "./node_modules/lit/index.js");
/* harmony import */ var _arcgis_lumina__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @arcgis/lumina */ "./node_modules/@arcgis/lumina/dist/index.js");
/* harmony import */ var lit_html_directives_ref_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lit-html/directives/ref.js */ "./node_modules/lit-html/development/directives/ref.js");
/* harmony import */ var _chunks_observers_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../chunks/observers.js */ "./node_modules/@esri/calcite-components/dist/chunks/observers.js");
/* harmony import */ var _chunks_dom_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../chunks/dom.js */ "./node_modules/@esri/calcite-components/dist/chunks/dom.js");
/* harmony import */ var _chunks_useSetFocus_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../chunks/useSetFocus.js */ "./node_modules/@esri/calcite-components/dist/chunks/useSetFocus.js");
/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */







const CSS = {
  frame: "frame",
  frameAdvancing: "frame--advancing",
  frameRetreating: "frame--retreating"
};
const styles = (0,lit__WEBPACK_IMPORTED_MODULE_1__.css)`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{box-sizing:border-box;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-2);font-size:var(--calcite-font-size--1)}:host *{box-sizing:border-box}:host{position:relative;display:flex;inline-size:100%;flex:1 1 auto;align-items:stretch;overflow:hidden;background-color:transparent}:host .frame{position:relative;margin:0;display:flex;inline-size:100%;flex:1 1 auto;flex-direction:column;align-items:stretch;padding:0;animation-name:none;animation-duration:var(--calcite-animation-timing);background-color:var(--calcite-flow-background-color)}:host ::slotted(*){display:none;block-size:100%}:host ::slotted(*[selected]){display:flex}:host ::slotted(.calcite-match-height:last-child){display:flex;flex:1 1 auto;overflow:hidden}:host .frame--advancing{animation-name:calcite-frame-advance}:host .frame--retreating{animation-name:calcite-frame-retreat}@keyframes calcite-frame-advance{0%{--tw-bg-opacity: .5;transform:translate3d(50px,0,0)}to{--tw-bg-opacity: 1;transform:translateZ(0)}}@keyframes calcite-frame-retreat{0%{--tw-bg-opacity: .5;transform:translate3d(-50px,0,0)}to{--tw-bg-opacity: 1;transform:translateZ(0)}}:host([hidden]){display:none}[hidden]{display:none}`;
class Flow extends _arcgis_lumina__WEBPACK_IMPORTED_MODULE_2__.LitElement {
  constructor() {
    super();
    this.frameRef = (0,lit_html_directives_ref_js__WEBPACK_IMPORTED_MODULE_3__.createRef)();
    this.itemMutationObserver = (0,_chunks_observers_js__WEBPACK_IMPORTED_MODULE_4__.c)("mutation", () => this.updateItemsAndProps());
    this.items = [];
    this.selectedIndex = -1;
    this.focusSetter = (0,_chunks_useSetFocus_js__WEBPACK_IMPORTED_MODULE_6__.u)()(this);
    this.flowDirection = "standby";
    this.listen("calciteInternalFlowItemChange", this.handleCalciteInternalFlowItemChange);
    this.listen("calciteFlowItemBack", this.handleItemBackClick);
  }
  static {
    this.properties = { flowDirection: [16, {}, { state: true }], customItemSelectors: 1 };
  }
  static {
    this.styles = styles;
  }
  async back() {
    const { items, selectedIndex } = this;
    const selectedItem = items[selectedIndex];
    const nextSelectedItem = items[selectedIndex - 1];
    if (!selectedItem || !nextSelectedItem) {
      return;
    }
    const beforeBack = selectedItem.beforeBack ? selectedItem.beforeBack : () => Promise.resolve();
    try {
      await beforeBack.call(selectedItem);
    } catch {
      return;
    }
    selectedItem.selected = false;
    nextSelectedItem.selected = true;
    return nextSelectedItem;
  }
  async setFocus(options) {
    return this.focusSetter(() => this.items[this.selectedIndex], options);
  }
  connectedCallback() {
    super.connectedCallback();
    this.itemMutationObserver?.observe(this.el, { childList: true, subtree: true });
  }
  willUpdate(changes) {
    if (changes.has("flowDirection") && (this.hasUpdated || this.flowDirection !== "standby")) {
      this.handleFlowDirectionChange(this.flowDirection);
    }
  }
  loaded() {
    this.updateItemsAndProps();
  }
  disconnectedCallback() {
    super.disconnectedCallback();
    this.itemMutationObserver?.disconnect();
  }
  async handleFlowDirectionChange(flowDirection) {
    if (flowDirection === "standby" || !this.frameRef.value) {
      return;
    }
    await (0,_chunks_dom_js__WEBPACK_IMPORTED_MODULE_5__.y)(this.frameRef.value, flowDirection === "retreating" ? "calcite-frame-retreat" : "calcite-frame-advance");
    this.resetFlowDirection();
  }
  handleCalciteInternalFlowItemChange(event) {
    event.stopPropagation();
    this.updateFlowProps();
  }
  async handleItemBackClick(event) {
    if (event.defaultPrevented) {
      return;
    }
    await this.back();
    return this.setFocus();
  }
  resetFlowDirection() {
    this.flowDirection = "standby";
  }
  getFlowDirection(oldSelectedIndex, newSelectedIndex) {
    const allowRetreatingDirection = oldSelectedIndex > 0;
    const allowAdvancingDirection = oldSelectedIndex > -1 && newSelectedIndex > 0;
    if (!allowAdvancingDirection && !allowRetreatingDirection) {
      return "standby";
    }
    return newSelectedIndex < oldSelectedIndex ? "retreating" : "advancing";
  }
  updateItemsAndProps() {
    const { customItemSelectors, el } = this;
    const newItems = Array.from(el.querySelectorAll(`calcite-flow-item${customItemSelectors ? `,${customItemSelectors}` : ""}`)).filter((flowItem) => flowItem.closest("calcite-flow") === el);
    this.items = newItems;
    this.ensureSelectedFlowItemExists();
    this.updateFlowProps();
  }
  updateFlowProps() {
    const { selectedIndex, items } = this;
    const foundSelectedIndex = this.findSelectedFlowItemIndex(items);
    items.forEach((flowItem, index) => {
      const currentlySelected = index === foundSelectedIndex;
      if (!currentlySelected) {
        flowItem.menuOpen = false;
      }
      flowItem.showBackButton = currentlySelected && foundSelectedIndex > 0;
    });
    if (foundSelectedIndex === -1) {
      return;
    }
    if (selectedIndex !== foundSelectedIndex) {
      this.flowDirection = this.getFlowDirection(selectedIndex, foundSelectedIndex);
    }
    this.selectedIndex = foundSelectedIndex;
  }
  findSelectedFlowItemIndex(items) {
    const selectedItem = items.slice(0).reverse().find((item) => !!item.selected);
    return items.indexOf(selectedItem);
  }
  ensureSelectedFlowItemExists() {
    const { items } = this;
    const foundSelectedIndex = this.findSelectedFlowItemIndex(items);
    if (foundSelectedIndex !== -1) {
      return;
    }
    const lastItem = items[items.length - 1];
    if (lastItem) {
      lastItem.selected = true;
    }
  }
  render() {
    const { flowDirection } = this;
    const frameDirectionClasses = {
      [CSS.frame]: true,
      [CSS.frameAdvancing]: flowDirection === "advancing",
      [CSS.frameRetreating]: flowDirection === "retreating"
    };
    return (0,lit__WEBPACK_IMPORTED_MODULE_1__.html)`<div class=${(0,_arcgis_lumina__WEBPACK_IMPORTED_MODULE_2__.safeClassMap)(frameDirectionClasses)} ${(0,lit_html_directives_ref_js__WEBPACK_IMPORTED_MODULE_3__.ref)(this.frameRef)}><slot></slot></div>`;
  }
}
(0,_chunks_runtime_js__WEBPACK_IMPORTED_MODULE_0__.c)("calcite-flow", Flow);



/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/components/calcite-flow/index.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/components/calcite-flow/index.js ***!
  \*************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Flow: () => (/* reexport safe */ _customElement_js__WEBPACK_IMPORTED_MODULE_0__.Flow)
/* harmony export */ });
/* harmony import */ var _customElement_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./customElement.js */ "./node_modules/@esri/calcite-components/dist/components/calcite-flow/customElement.js");


/***/ })

};

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVuZG9ycy1ub2RlX21vZHVsZXNfZXNyaV9jYWxjaXRlLWNvbXBvbmVudHNfZGlzdF9jb21wb25lbnRzX2NhbGNpdGUtZmxvd19pbmRleF9qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDMEM7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUkseUNBQU0sVUFBVSx1QkFBdUIsS0FBSyxtQkFBbUIsUUFBUSwwQkFBMEI7QUFDckc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTUU7Ozs7Ozs7Ozs7Ozs7Ozs7QUN4QkY7QUFDQTtBQUNBO0FBQzZDO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLDBDQUFRO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxhQUFhLG9CQUFvQixpQkFBaUI7QUFDN0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw0Q0FBNEM7QUFDM0UsaUJBQWlCLFFBQVEsR0FBRyx5Q0FBeUMsRUFBRSxLQUFLO0FBQzVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCxvQ0FBb0M7QUFDcEY7QUFDQSxzQkFBc0IsS0FBSyxJQUFJLFNBQVMsdUNBQXVDLHVEQUF1RCxlQUFlLEVBQUUsR0FBRyxvQkFBb0IsMEVBQTBFLFdBQVcsV0FBVyxVQUFVLElBQUksZUFBZTtBQUMzUztBQUNBO0FBR0U7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDaERGO0FBQ0E7QUFDQTtBQUMrQjtBQUMvQjtBQUNBLE1BQU0seUNBQVE7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxpQkFBaUI7QUFDakQ7QUFDQTtBQUNBO0FB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLGdCQUFnQjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyx5Q0FBSSxjQUFjLDREQUFZLHlCQUF5QixFQUFFLCtEQUFHLGdCQUFnQjtBQUN2RjtBQUNBO0FBQ0EscURBQWE7QUFHWCIsInNvdXJjZXMiOlsid2VicGFjazovL3ByZWNpc2lvbmZhcm1zLy4vbm9kZV9tb2R1bGVzL0Blc3JpL2NhbGNpdGUtY29tcG9uZW50cy9kaXN0L2NodW5rcy9jb21wb25lbnQuanMiLCJ3ZWJwYWNrOi8vcHJlY2lzaW9uZmFybXMvLi9ub2RlX21vZHVsZXMvQGVzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Rpc3QvY2h1bmtzL2xvZ2dlci5qcyIsIndlYnBhY2s6Ly9wcmVjaXNpb25mYXJtcy8uL25vZGVfbW9kdWxlcy9AZXNyaS9jYWxjaXRlLWNvbXBvbmVudHMvZGlzdC9jaHVua3Mvb2JzZXJ2ZXJzLmpzIiwid2VicGFjazovL3ByZWNpc2lvbmZhcm1zLy4vbm9kZV9tb2R1bGVzL0Blc3JpL2NhbGNpdGUtY29tcG9uZW50cy9kaXN0L2NodW5rcy91c2VTZXRGb2N1cy5qcyIsIndlYnBhY2s6Ly9wcmVjaXNpb25mYXJtcy8uL25vZGVfbW9kdWxlcy9AZXNyaS9jYWxjaXRlLWNvbXBvbmVudHMvZGlzdC9jb21wb25lbnRzL2NhbGNpdGUtZmxvdy9jdXN0b21FbGVtZW50LmpzIiwid2VicGFjazovL3ByZWNpc2lvbmZhcm1zLy4vbm9kZV9tb2R1bGVzL0Blc3JpL2NhbGNpdGUtY29tcG9uZW50cy9kaXN0L2NvbXBvbmVudHMvY2FsY2l0ZS1mbG93L2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qISBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtZGVzaWduLXN5c3RlbS9ibG9iL2Rldi9MSUNFTlNFLm1kIGZvciBkZXRhaWxzLlxudjMuMy4zICovXG5pbXBvcnQgeyBsIGFzIGxvZ2dlciB9IGZyb20gXCIuL2xvZ2dlci5qc1wiO1xuZnVuY3Rpb24gZ2V0SWNvblNjYWxlKGNvbXBvbmVudFNjYWxlKSB7XG4gIHJldHVybiBjb21wb25lbnRTY2FsZSA9PT0gXCJsXCIgPyBcIm1cIiA6IFwic1wiO1xufVxuZnVuY3Rpb24gd2FybklmTWlzc2luZ1JlcXVpcmVkUHJvcChjb21wb25lbnQsIG5ld1Byb3AsIGRlcHJlY2F0ZWRQcm9wKSB7XG4gIGlmICghY29tcG9uZW50W25ld1Byb3BdICYmICFjb21wb25lbnRbZGVwcmVjYXRlZFByb3BdKSB7XG4gICAgbG9nZ2VyLndhcm4oYFske2NvbXBvbmVudC5lbC5sb2NhbE5hbWV9XSBcIiR7bmV3UHJvcC50b1N0cmluZygpfVwiIG9yIFwiJHtkZXByZWNhdGVkUHJvcC50b1N0cmluZygpfVwiIGlzIHJlcXVpcmVkLmApO1xuICB9XG59XG5mdW5jdGlvbiBpc0hpZGRlbihlbCkge1xuICByZXR1cm4gZWwuaGlkZGVuIHx8IGVsLml0ZW1IaWRkZW47XG59XG5hc3luYyBmdW5jdGlvbiBjb21wb25lbnRGb2N1c2FibGUoY29tcG9uZW50KSB7XG4gIGF3YWl0IGNvbXBvbmVudC5jb21wb25lbnRPblJlYWR5KCk7XG4gIGF3YWl0IGNvbXBvbmVudC51cGRhdGVDb21wbGV0ZTtcbn1cbmV4cG9ydCB7XG4gIGNvbXBvbmVudEZvY3VzYWJsZSBhcyBjLFxuICBnZXRJY29uU2NhbGUgYXMgZyxcbiAgaXNIaWRkZW4gYXMgaSxcbiAgd2FybklmTWlzc2luZ1JlcXVpcmVkUHJvcCBhcyB3XG59O1xuIiwiLyohIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG5TZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1kZXNpZ24tc3lzdGVtL2Jsb2IvZGV2L0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG52My4zLjMgKi9cbmltcG9ydCB7IGwgYXMgbG9nTGV2ZWwgfSBmcm9tIFwiLi9ydW50aW1lLmpzXCI7XG5jb25zdCBsb2dnZWREZXByZWNhdGlvbnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuY29uc3QgbG9nTGV2ZWxzID0ge1xuICB0cmFjZTogMCxcbiAgZGVidWc6IDEsXG4gIGluZm86IDIsXG4gIHdhcm46IDQsXG4gIGVycm9yOiA4LFxuICBvZmY6IDEwXG59O1xuZnVuY3Rpb24gd2lsbExvZyhsZXZlbCkge1xuICByZXR1cm4gbG9nTGV2ZWxzW2xldmVsXSA+PSBsb2dMZXZlbHNbbG9nTGV2ZWxdO1xufVxuZnVuY3Rpb24gZm9yd2FyZFRvQ29uc29sZShsZXZlbCwgLi4uZGF0YSkge1xuICBpZiAoIXdpbGxMb2cobGV2ZWwpKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGJhZGdlVGVtcGxhdGUgPSBcIiVjY2FsY2l0ZVwiO1xuICBjb25zdCBiYWRnZVN0eWxlID0gXCJiYWNrZ3JvdW5kOiAjMDA3QUMyOyBjb2xvcjogI2ZmZjsgYm9yZGVyLXJhZGl1czogNHB4OyBwYWRkaW5nOiAycHggNHB4O1wiO1xuICBjb25zb2xlW2xldmVsXS5jYWxsKHRoaXMsIGJhZGdlVGVtcGxhdGUsIGJhZGdlU3R5bGUsIC4uLmRhdGEpO1xufVxubGV0IGxpc3RGb3JtYXR0ZXI7XG5jb25zdCBsb2dnZXIgPSB7XG4gIGRlYnVnOiAobWVzc2FnZSkgPT4gZm9yd2FyZFRvQ29uc29sZShcImRlYnVnXCIsIG1lc3NhZ2UpLFxuICBpbmZvOiAobWVzc2FnZSkgPT4gZm9yd2FyZFRvQ29uc29sZShcImluZm9cIiwgbWVzc2FnZSksXG4gIHdhcm46IChtZXNzYWdlKSA9PiBmb3J3YXJkVG9Db25zb2xlKFwid2FyblwiLCBtZXNzYWdlKSxcbiAgZXJyb3I6IChtZXNzYWdlKSA9PiBmb3J3YXJkVG9Db25zb2xlKFwiZXJyb3JcIiwgbWVzc2FnZSksXG4gIHRyYWNlOiAobWVzc2FnZSkgPT4gZm9yd2FyZFRvQ29uc29sZShcInRyYWNlXCIsIG1lc3NhZ2UpLFxuICBkZXByZWNhdGVkXG59O1xuZnVuY3Rpb24gZGVwcmVjYXRlZChjb250ZXh0LCB7IGNvbXBvbmVudCwgbmFtZSwgc3VnZ2VzdGVkLCByZW1vdmFsVmVyc2lvbiB9KSB7XG4gIGNvbnN0IGtleSA9IGAke2NvbnRleHR9OiR7Y29udGV4dCA9PT0gXCJjb21wb25lbnRcIiA/IFwiXCIgOiBjb21wb25lbnR9JHtuYW1lfWA7XG4gIGlmIChsb2dnZWREZXByZWNhdGlvbnMuaGFzKGtleSkpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgbG9nZ2VkRGVwcmVjYXRpb25zLmFkZChrZXkpO1xuICBjb25zdCBtdWx0aVN1Z2dlc3Rpb25zID0gQXJyYXkuaXNBcnJheShzdWdnZXN0ZWQpO1xuICBpZiAobXVsdGlTdWdnZXN0aW9ucyAmJiAhbGlzdEZvcm1hdHRlcikge1xuICAgIGxpc3RGb3JtYXR0ZXIgPSBuZXcgSW50bC5MaXN0Rm9ybWF0KFwiZW5cIiwgeyBzdHlsZTogXCJsb25nXCIsIHR5cGU6IFwiZGlzanVuY3Rpb25cIiB9KTtcbiAgfVxuICBjb25zdCBtZXNzYWdlID0gYFske25hbWV9XSAke2NvbnRleHR9IGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiAke3JlbW92YWxWZXJzaW9uID09PSBcImZ1dHVyZVwiID8gYGEgZnV0dXJlIHZlcnNpb25gIDogYHYke3JlbW92YWxWZXJzaW9ufWB9LiR7c3VnZ2VzdGVkID8gYCBVc2UgJHttdWx0aVN1Z2dlc3Rpb25zID8gbGlzdEZvcm1hdHRlci5mb3JtYXQoc3VnZ2VzdGVkLm1hcCgoc3VnZ2VzdGlvbikgPT4gYFwiJHtzdWdnZXN0aW9ufVwiYCkpIDogYFwiJHtzdWdnZXN0ZWR9XCJgfSBpbnN0ZWFkLmAgOiBcIlwifWA7XG4gIGZvcndhcmRUb0NvbnNvbGUoXCJ3YXJuXCIsIG1lc3NhZ2UpO1xufVxuZXhwb3J0IHtcbiAgbG9nZ2VyIGFzIGxcbn07XG4iLCIvKiEgQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cblNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWRlc2lnbi1zeXN0ZW0vYmxvYi9kZXYvTElDRU5TRS5tZCBmb3IgZGV0YWlscy5cbnYzLjMuMyAqL1xuaW1wb3J0IHsgaXNTZXJ2ZXIgfSBmcm9tIFwibGl0XCI7XG5mdW5jdGlvbiBjcmVhdGVPYnNlcnZlcih0eXBlLCBjYWxsYmFjaywgb3B0aW9ucykge1xuICBpZiAoaXNTZXJ2ZXIpIHtcbiAgICByZXR1cm4gdm9pZCAwO1xuICB9XG4gIGNvbnN0IE9ic2VydmVyID0gZ2V0T2JzZXJ2ZXIodHlwZSk7XG4gIHJldHVybiBuZXcgT2JzZXJ2ZXIoY2FsbGJhY2ssIG9wdGlvbnMpO1xufVxuZnVuY3Rpb24gZ2V0T2JzZXJ2ZXIodHlwZSkge1xuICBjbGFzcyBFeHRlbmRlZE11dGF0aW9uT2JzZXJ2ZXIgZXh0ZW5kcyB3aW5kb3cuTXV0YXRpb25PYnNlcnZlciB7XG4gICAgY29uc3RydWN0b3IoY2FsbGJhY2spIHtcbiAgICAgIHN1cGVyKGNhbGxiYWNrKTtcbiAgICAgIHRoaXMub2JzZXJ2ZWRFbnRyeSA9IFtdO1xuICAgICAgdGhpcy5jYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgIH1cbiAgICBvYnNlcnZlKHRhcmdldCwgb3B0aW9ucykge1xuICAgICAgdGhpcy5vYnNlcnZlZEVudHJ5LnB1c2goeyB0YXJnZXQsIG9wdGlvbnMgfSk7XG4gICAgICByZXR1cm4gc3VwZXIub2JzZXJ2ZSh0YXJnZXQsIG9wdGlvbnMpO1xuICAgIH1cbiAgICB1bm9ic2VydmUodGFyZ2V0KSB7XG4gICAgICBjb25zdCBuZXdPYnNlcnZlZEVudHJpZXMgPSB0aGlzLm9ic2VydmVkRW50cnkuZmlsdGVyKChvYnNlcnZlZCkgPT4gb2JzZXJ2ZWQudGFyZ2V0ICE9PSB0YXJnZXQpO1xuICAgICAgdGhpcy5vYnNlcnZlZEVudHJ5ID0gW107XG4gICAgICB0aGlzLmNhbGxiYWNrKHN1cGVyLnRha2VSZWNvcmRzKCksIHRoaXMpO1xuICAgICAgdGhpcy5kaXNjb25uZWN0KCk7XG4gICAgICBuZXdPYnNlcnZlZEVudHJpZXMuZm9yRWFjaCgob2JzZXJ2ZWQpID0+IHRoaXMub2JzZXJ2ZShvYnNlcnZlZC50YXJnZXQsIG9ic2VydmVkLm9wdGlvbnMpKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0eXBlID09PSBcImludGVyc2VjdGlvblwiID8gd2luZG93LkludGVyc2VjdGlvbk9ic2VydmVyIDogdHlwZSA9PT0gXCJtdXRhdGlvblwiID8gRXh0ZW5kZWRNdXRhdGlvbk9ic2VydmVyIDogd2luZG93LlJlc2l6ZU9ic2VydmVyO1xuICB9KCk7XG59XG5mdW5jdGlvbiB1cGRhdGVSZWZPYnNlcnZlcihvYnNlcnZlciwgb2xkVGFyZ2V0LCB0YXJnZXQsIG9wdGlvbnMpIHtcbiAgaWYgKCFvYnNlcnZlcikge1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAob2xkVGFyZ2V0KSB7XG4gICAgb2JzZXJ2ZXIudW5vYnNlcnZlKG9sZFRhcmdldCk7XG4gIH1cbiAgaWYgKCF0YXJnZXQpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKG9ic2VydmVyIGluc3RhbmNlb2YgTXV0YXRpb25PYnNlcnZlcikge1xuICAgIG9ic2VydmVyLm9ic2VydmUodGFyZ2V0LCBvcHRpb25zKTtcbiAgICByZXR1cm47XG4gIH1cbiAgb2JzZXJ2ZXIub2JzZXJ2ZSh0YXJnZXQpO1xufVxuZXhwb3J0IHtcbiAgY3JlYXRlT2JzZXJ2ZXIgYXMgYyxcbiAgdXBkYXRlUmVmT2JzZXJ2ZXIgYXMgdVxufTtcbiIsIi8qISBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtZGVzaWduLXN5c3RlbS9ibG9iL2Rldi9MSUNFTlNFLm1kIGZvciBkZXRhaWxzLlxudjMuMy4zICovXG5pbXBvcnQgeyBtYWtlR2VuZXJpY0NvbnRyb2xsZXIgfSBmcm9tIFwiQGFyY2dpcy9sdW1pbmEvY29udHJvbGxlcnNcIjtcbmltcG9ydCB7IGMgYXMgY29tcG9uZW50Rm9jdXNhYmxlIH0gZnJvbSBcIi4vY29tcG9uZW50LmpzXCI7XG5pbXBvcnQgeyBrIGFzIGdldFJvb3ROb2RlLCBiIGFzIGZvY3VzRWxlbWVudCB9IGZyb20gXCIuL2RvbS5qc1wiO1xuY29uc3QgdXNlU2V0Rm9jdXMgPSAoKSA9PiB7XG4gIHJldHVybiBtYWtlR2VuZXJpY0NvbnRyb2xsZXIoKGNvbXBvbmVudCwgY29udHJvbGxlcikgPT4ge1xuICAgIGxldCBhYm9ydENvbnRyb2xsZXI7XG4gICAgZnVuY3Rpb24gaGFuZGxlRm9jdXNPdXQoKSB7XG4gICAgICBhYm9ydENvbnRyb2xsZXI/LmFib3J0KCk7XG4gICAgfVxuICAgIGNvbnRyb2xsZXIub25Mb2FkKCgpID0+IHtcbiAgICAgIGNvbXBvbmVudC5saXN0ZW4oXCJmb2N1c1wiLCAoKSA9PiB7XG4gICAgICAgIGFib3J0Q29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgICAgICAgY29tcG9uZW50LmVsLmFkZEV2ZW50TGlzdGVuZXIoXCJmb2N1c291dFwiLCBoYW5kbGVGb2N1c091dCwgeyBzaWduYWw6IGFib3J0Q29udHJvbGxlci5zaWduYWwgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICBjb250cm9sbGVyLm9uRGlzY29ubmVjdGVkKCgpID0+IHtcbiAgICAgIGNvbXBvbmVudC5lbC5yZW1vdmVFdmVudExpc3RlbmVyKFwiZm9jdXNvdXRcIiwgaGFuZGxlRm9jdXNPdXQpO1xuICAgIH0pO1xuICAgIHJldHVybiBhc3luYyAoZ2V0Rm9jdXNUYXJnZXQsIG9wdGlvbnMpID0+IHtcbiAgICAgIGlmIChjb21wb25lbnQuZGlzYWJsZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3QgZm9jdXNDb25maWcgPSB0b0ZvY3VzQ29uZmlnKGdldEZvY3VzVGFyZ2V0KCkpO1xuICAgICAgaWYgKCFmb2N1c0NvbmZpZykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCB7IHRhcmdldCwgaW5jbHVkZUNvbnRhaW5lciwgc3RyYXRlZ3kgfSA9IGZvY3VzQ29uZmlnO1xuICAgICAgY29uc3Qgcm9vdE5vZGUgPSBnZXRSb290Tm9kZShjb21wb25lbnQuZWwpO1xuICAgICAgY29uc3QgY3VycmVudEFjdGl2ZUVsZW1lbnQgPSByb290Tm9kZS5hY3RpdmVFbGVtZW50O1xuICAgICAgYXdhaXQgY29tcG9uZW50Rm9jdXNhYmxlKGNvbXBvbmVudCk7XG4gICAgICBjb25zdCBmb2N1c0FscmVhZHlDaGFuZ2VkID0gY3VycmVudEFjdGl2ZUVsZW1lbnQgIT09IHJvb3ROb2RlLmFjdGl2ZUVsZW1lbnQ7XG4gICAgICBpZiAoZm9jdXNBbHJlYWR5Q2hhbmdlZCB8fCBhYm9ydENvbnRyb2xsZXIgJiYgIWFib3J0Q29udHJvbGxlcj8uc2lnbmFsLmFib3J0ZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29tcG9uZW50LmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJmb2N1c1wiLCBoYW5kbGVGb2N1c091dCk7XG4gICAgICByZXR1cm4gZm9jdXNFbGVtZW50KHRhcmdldCwgaW5jbHVkZUNvbnRhaW5lciwgc3RyYXRlZ3ksIGNvbXBvbmVudC5lbCwgb3B0aW9ucyk7XG4gICAgfTtcbiAgfSk7XG59O1xuZnVuY3Rpb24gaXNGb2N1c092ZXJyaWRlKGZvY3VzVGFyZ2V0KSB7XG4gIHJldHVybiBcInRhcmdldFwiIGluIGZvY3VzVGFyZ2V0ICYmIChcImluY2x1ZGVDb250YWluZXJcIiBpbiBmb2N1c1RhcmdldCB8fCBcInN0cmF0ZWd5XCIgaW4gZm9jdXNUYXJnZXQpO1xufVxuZnVuY3Rpb24gdG9Gb2N1c0NvbmZpZyhmb2N1c1RhcmdldCkge1xuICBpZiAoIWZvY3VzVGFyZ2V0KSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHJldHVybiBpc0ZvY3VzT3ZlcnJpZGUoZm9jdXNUYXJnZXQpID8gZm9jdXNUYXJnZXQgOiB7IHRhcmdldDogZm9jdXNUYXJnZXQgfTtcbn1cbmV4cG9ydCB7XG4gIHVzZVNldEZvY3VzIGFzIHVcbn07XG4iLCIvKiEgQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cblNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWRlc2lnbi1zeXN0ZW0vYmxvYi9kZXYvTElDRU5TRS5tZCBmb3IgZGV0YWlscy5cbnYzLjMuMyAqL1xuaW1wb3J0IHsgYyBhcyBjdXN0b21FbGVtZW50IH0gZnJvbSBcIi4uLy4uL2NodW5rcy9ydW50aW1lLmpzXCI7XG5pbXBvcnQgeyBjc3MsIGh0bWwgfSBmcm9tIFwibGl0XCI7XG5pbXBvcnQgeyBMaXRFbGVtZW50LCBzYWZlQ2xhc3NNYXAgfSBmcm9tIFwiQGFyY2dpcy9sdW1pbmFcIjtcbmltcG9ydCB7IGNyZWF0ZVJlZiwgcmVmIH0gZnJvbSBcImxpdC1odG1sL2RpcmVjdGl2ZXMvcmVmLmpzXCI7XG5pbXBvcnQgeyBjIGFzIGNyZWF0ZU9ic2VydmVyIH0gZnJvbSBcIi4uLy4uL2NodW5rcy9vYnNlcnZlcnMuanNcIjtcbmltcG9ydCB7IHkgYXMgd2hlbkFuaW1hdGlvbkRvbmUgfSBmcm9tIFwiLi4vLi4vY2h1bmtzL2RvbS5qc1wiO1xuaW1wb3J0IHsgdSBhcyB1c2VTZXRGb2N1cyB9IGZyb20gXCIuLi8uLi9jaHVua3MvdXNlU2V0Rm9jdXMuanNcIjtcbmNvbnN0IENTUyA9IHtcbiAgZnJhbWU6IFwiZnJhbWVcIixcbiAgZnJhbWVBZHZhbmNpbmc6IFwiZnJhbWUtLWFkdmFuY2luZ1wiLFxuICBmcmFtZVJldHJlYXRpbmc6IFwiZnJhbWUtLXJldHJlYXRpbmdcIlxufTtcbmNvbnN0IHN0eWxlcyA9IGNzc2A6aG9zdHstLWNhbGNpdGUtaW50ZXJuYWwtY29sb3ItZm9jdXM6IHZhciggLS1jYWxjaXRlLWNvbG9yLWZvY3VzLCB2YXIoLS1jYWxjaXRlLXVpLWZvY3VzLWNvbG9yLCB2YXIoLS1jYWxjaXRlLWNvbG9yLWJyYW5kKSkgKX06aG9zdHtib3gtc2l6aW5nOmJvcmRlci1ib3g7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLWZvcmVncm91bmQtMSk7Y29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci10ZXh0LTIpO2ZvbnQtc2l6ZTp2YXIoLS1jYWxjaXRlLWZvbnQtc2l6ZS0tMSl9Omhvc3QgKntib3gtc2l6aW5nOmJvcmRlci1ib3h9Omhvc3R7cG9zaXRpb246cmVsYXRpdmU7ZGlzcGxheTpmbGV4O2lubGluZS1zaXplOjEwMCU7ZmxleDoxIDEgYXV0bzthbGlnbi1pdGVtczpzdHJldGNoO292ZXJmbG93OmhpZGRlbjtiYWNrZ3JvdW5kLWNvbG9yOnRyYW5zcGFyZW50fTpob3N0IC5mcmFtZXtwb3NpdGlvbjpyZWxhdGl2ZTttYXJnaW46MDtkaXNwbGF5OmZsZXg7aW5saW5lLXNpemU6MTAwJTtmbGV4OjEgMSBhdXRvO2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjthbGlnbi1pdGVtczpzdHJldGNoO3BhZGRpbmc6MDthbmltYXRpb24tbmFtZTpub25lO2FuaW1hdGlvbi1kdXJhdGlvbjp2YXIoLS1jYWxjaXRlLWFuaW1hdGlvbi10aW1pbmcpO2JhY2tncm91bmQtY29sb3I6dmFyKC0tY2FsY2l0ZS1mbG93LWJhY2tncm91bmQtY29sb3IpfTpob3N0IDo6c2xvdHRlZCgqKXtkaXNwbGF5Om5vbmU7YmxvY2stc2l6ZToxMDAlfTpob3N0IDo6c2xvdHRlZCgqW3NlbGVjdGVkXSl7ZGlzcGxheTpmbGV4fTpob3N0IDo6c2xvdHRlZCguY2FsY2l0ZS1tYXRjaC1oZWlnaHQ6bGFzdC1jaGlsZCl7ZGlzcGxheTpmbGV4O2ZsZXg6MSAxIGF1dG87b3ZlcmZsb3c6aGlkZGVufTpob3N0IC5mcmFtZS0tYWR2YW5jaW5ne2FuaW1hdGlvbi1uYW1lOmNhbGNpdGUtZnJhbWUtYWR2YW5jZX06aG9zdCAuZnJhbWUtLXJldHJlYXRpbmd7YW5pbWF0aW9uLW5hbWU6Y2FsY2l0ZS1mcmFtZS1yZXRyZWF0fUBrZXlmcmFtZXMgY2FsY2l0ZS1mcmFtZS1hZHZhbmNlezAley0tdHctYmctb3BhY2l0eTogLjU7dHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDUwcHgsMCwwKX10b3stLXR3LWJnLW9wYWNpdHk6IDE7dHJhbnNmb3JtOnRyYW5zbGF0ZVooMCl9fUBrZXlmcmFtZXMgY2FsY2l0ZS1mcmFtZS1yZXRyZWF0ezAley0tdHctYmctb3BhY2l0eTogLjU7dHJhbnNmb3JtOnRyYW5zbGF0ZTNkKC01MHB4LDAsMCl9dG97LS10dy1iZy1vcGFjaXR5OiAxO3RyYW5zZm9ybTp0cmFuc2xhdGVaKDApfX06aG9zdChbaGlkZGVuXSl7ZGlzcGxheTpub25lfVtoaWRkZW5de2Rpc3BsYXk6bm9uZX1gO1xuY2xhc3MgRmxvdyBleHRlbmRzIExpdEVsZW1lbnQge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuZnJhbWVSZWYgPSBjcmVhdGVSZWYoKTtcbiAgICB0aGlzLml0ZW1NdXRhdGlvbk9ic2VydmVyID0gY3JlYXRlT2JzZXJ2ZXIoXCJtdXRhdGlvblwiLCAoKSA9PiB0aGlzLnVwZGF0ZUl0ZW1zQW5kUHJvcHMoKSk7XG4gICAgdGhpcy5pdGVtcyA9IFtdO1xuICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IC0xO1xuICAgIHRoaXMuZm9jdXNTZXR0ZXIgPSB1c2VTZXRGb2N1cygpKHRoaXMpO1xuICAgIHRoaXMuZmxvd0RpcmVjdGlvbiA9IFwic3RhbmRieVwiO1xuICAgIHRoaXMubGlzdGVuKFwiY2FsY2l0ZUludGVybmFsRmxvd0l0ZW1DaGFuZ2VcIiwgdGhpcy5oYW5kbGVDYWxjaXRlSW50ZXJuYWxGbG93SXRlbUNoYW5nZSk7XG4gICAgdGhpcy5saXN0ZW4oXCJjYWxjaXRlRmxvd0l0ZW1CYWNrXCIsIHRoaXMuaGFuZGxlSXRlbUJhY2tDbGljayk7XG4gIH1cbiAgc3RhdGljIHtcbiAgICB0aGlzLnByb3BlcnRpZXMgPSB7IGZsb3dEaXJlY3Rpb246IFsxNiwge30sIHsgc3RhdGU6IHRydWUgfV0sIGN1c3RvbUl0ZW1TZWxlY3RvcnM6IDEgfTtcbiAgfVxuICBzdGF0aWMge1xuICAgIHRoaXMuc3R5bGVzID0gc3R5bGVzO1xuICB9XG4gIGFzeW5jIGJhY2soKSB7XG4gICAgY29uc3QgeyBpdGVtcywgc2VsZWN0ZWRJbmRleCB9ID0gdGhpcztcbiAgICBjb25zdCBzZWxlY3RlZEl0ZW0gPSBpdGVtc1tzZWxlY3RlZEluZGV4XTtcbiAgICBjb25zdCBuZXh0U2VsZWN0ZWRJdGVtID0gaXRlbXNbc2VsZWN0ZWRJbmRleCAtIDFdO1xuICAgIGlmICghc2VsZWN0ZWRJdGVtIHx8ICFuZXh0U2VsZWN0ZWRJdGVtKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGJlZm9yZUJhY2sgPSBzZWxlY3RlZEl0ZW0uYmVmb3JlQmFjayA/IHNlbGVjdGVkSXRlbS5iZWZvcmVCYWNrIDogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGJlZm9yZUJhY2suY2FsbChzZWxlY3RlZEl0ZW0pO1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBzZWxlY3RlZEl0ZW0uc2VsZWN0ZWQgPSBmYWxzZTtcbiAgICBuZXh0U2VsZWN0ZWRJdGVtLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICByZXR1cm4gbmV4dFNlbGVjdGVkSXRlbTtcbiAgfVxuICBhc3luYyBzZXRGb2N1cyhvcHRpb25zKSB7XG4gICAgcmV0dXJuIHRoaXMuZm9jdXNTZXR0ZXIoKCkgPT4gdGhpcy5pdGVtc1t0aGlzLnNlbGVjdGVkSW5kZXhdLCBvcHRpb25zKTtcbiAgfVxuICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICBzdXBlci5jb25uZWN0ZWRDYWxsYmFjaygpO1xuICAgIHRoaXMuaXRlbU11dGF0aW9uT2JzZXJ2ZXI/Lm9ic2VydmUodGhpcy5lbCwgeyBjaGlsZExpc3Q6IHRydWUsIHN1YnRyZWU6IHRydWUgfSk7XG4gIH1cbiAgd2lsbFVwZGF0ZShjaGFuZ2VzKSB7XG4gICAgaWYgKGNoYW5nZXMuaGFzKFwiZmxvd0RpcmVjdGlvblwiKSAmJiAodGhpcy5oYXNVcGRhdGVkIHx8IHRoaXMuZmxvd0RpcmVjdGlvbiAhPT0gXCJzdGFuZGJ5XCIpKSB7XG4gICAgICB0aGlzLmhhbmRsZUZsb3dEaXJlY3Rpb25DaGFuZ2UodGhpcy5mbG93RGlyZWN0aW9uKTtcbiAgICB9XG4gIH1cbiAgbG9hZGVkKCkge1xuICAgIHRoaXMudXBkYXRlSXRlbXNBbmRQcm9wcygpO1xuICB9XG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIHN1cGVyLmRpc2Nvbm5lY3RlZENhbGxiYWNrKCk7XG4gICAgdGhpcy5pdGVtTXV0YXRpb25PYnNlcnZlcj8uZGlzY29ubmVjdCgpO1xuICB9XG4gIGFzeW5jIGhhbmRsZUZsb3dEaXJlY3Rpb25DaGFuZ2UoZmxvd0RpcmVjdGlvbikge1xuICAgIGlmIChmbG93RGlyZWN0aW9uID09PSBcInN0YW5kYnlcIiB8fCAhdGhpcy5mcmFtZVJlZi52YWx1ZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBhd2FpdCB3aGVuQW5pbWF0aW9uRG9uZSh0aGlzLmZyYW1lUmVmLnZhbHVlLCBmbG93RGlyZWN0aW9uID09PSBcInJldHJlYXRpbmdcIiA/IFwiY2FsY2l0ZS1mcmFtZS1yZXRyZWF0XCIgOiBcImNhbGNpdGUtZnJhbWUtYWR2YW5jZVwiKTtcbiAgICB0aGlzLnJlc2V0Rmxvd0RpcmVjdGlvbigpO1xuICB9XG4gIGhhbmRsZUNhbGNpdGVJbnRlcm5hbEZsb3dJdGVtQ2hhbmdlKGV2ZW50KSB7XG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgdGhpcy51cGRhdGVGbG93UHJvcHMoKTtcbiAgfVxuICBhc3luYyBoYW5kbGVJdGVtQmFja0NsaWNrKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LmRlZmF1bHRQcmV2ZW50ZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgYXdhaXQgdGhpcy5iYWNrKCk7XG4gICAgcmV0dXJuIHRoaXMuc2V0Rm9jdXMoKTtcbiAgfVxuICByZXNldEZsb3dEaXJlY3Rpb24oKSB7XG4gICAgdGhpcy5mbG93RGlyZWN0aW9uID0gXCJzdGFuZGJ5XCI7XG4gIH1cbiAgZ2V0Rmxvd0RpcmVjdGlvbihvbGRTZWxlY3RlZEluZGV4LCBuZXdTZWxlY3RlZEluZGV4KSB7XG4gICAgY29uc3QgYWxsb3dSZXRyZWF0aW5nRGlyZWN0aW9uID0gb2xkU2VsZWN0ZWRJbmRleCA+IDA7XG4gICAgY29uc3QgYWxsb3dBZHZhbmNpbmdEaXJlY3Rpb24gPSBvbGRTZWxlY3RlZEluZGV4ID4gLTEgJiYgbmV3U2VsZWN0ZWRJbmRleCA+IDA7XG4gICAgaWYgKCFhbGxvd0FkdmFuY2luZ0RpcmVjdGlvbiAmJiAhYWxsb3dSZXRyZWF0aW5nRGlyZWN0aW9uKSB7XG4gICAgICByZXR1cm4gXCJzdGFuZGJ5XCI7XG4gICAgfVxuICAgIHJldHVybiBuZXdTZWxlY3RlZEluZGV4IDwgb2xkU2VsZWN0ZWRJbmRleCA/IFwicmV0cmVhdGluZ1wiIDogXCJhZHZhbmNpbmdcIjtcbiAgfVxuICB1cGRhdGVJdGVtc0FuZFByb3BzKCkge1xuICAgIGNvbnN0IHsgY3VzdG9tSXRlbVNlbGVjdG9ycywgZWwgfSA9IHRoaXM7XG4gICAgY29uc3QgbmV3SXRlbXMgPSBBcnJheS5mcm9tKGVsLnF1ZXJ5U2VsZWN0b3JBbGwoYGNhbGNpdGUtZmxvdy1pdGVtJHtjdXN0b21JdGVtU2VsZWN0b3JzID8gYCwke2N1c3RvbUl0ZW1TZWxlY3RvcnN9YCA6IFwiXCJ9YCkpLmZpbHRlcigoZmxvd0l0ZW0pID0+IGZsb3dJdGVtLmNsb3Nlc3QoXCJjYWxjaXRlLWZsb3dcIikgPT09IGVsKTtcbiAgICB0aGlzLml0ZW1zID0gbmV3SXRlbXM7XG4gICAgdGhpcy5lbnN1cmVTZWxlY3RlZEZsb3dJdGVtRXhpc3RzKCk7XG4gICAgdGhpcy51cGRhdGVGbG93UHJvcHMoKTtcbiAgfVxuICB1cGRhdGVGbG93UHJvcHMoKSB7XG4gICAgY29uc3QgeyBzZWxlY3RlZEluZGV4LCBpdGVtcyB9ID0gdGhpcztcbiAgICBjb25zdCBmb3VuZFNlbGVjdGVkSW5kZXggPSB0aGlzLmZpbmRTZWxlY3RlZEZsb3dJdGVtSW5kZXgoaXRlbXMpO1xuICAgIGl0ZW1zLmZvckVhY2goKGZsb3dJdGVtLCBpbmRleCkgPT4ge1xuICAgICAgY29uc3QgY3VycmVudGx5U2VsZWN0ZWQgPSBpbmRleCA9PT0gZm91bmRTZWxlY3RlZEluZGV4O1xuICAgICAgaWYgKCFjdXJyZW50bHlTZWxlY3RlZCkge1xuICAgICAgICBmbG93SXRlbS5tZW51T3BlbiA9IGZhbHNlO1xuICAgICAgfVxuICAgICAgZmxvd0l0ZW0uc2hvd0JhY2tCdXR0b24gPSBjdXJyZW50bHlTZWxlY3RlZCAmJiBmb3VuZFNlbGVjdGVkSW5kZXggPiAwO1xuICAgIH0pO1xuICAgIGlmIChmb3VuZFNlbGVjdGVkSW5kZXggPT09IC0xKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChzZWxlY3RlZEluZGV4ICE9PSBmb3VuZFNlbGVjdGVkSW5kZXgpIHtcbiAgICAgIHRoaXMuZmxvd0RpcmVjdGlvbiA9IHRoaXMuZ2V0Rmxvd0RpcmVjdGlvbihzZWxlY3RlZEluZGV4LCBmb3VuZFNlbGVjdGVkSW5kZXgpO1xuICAgIH1cbiAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSBmb3VuZFNlbGVjdGVkSW5kZXg7XG4gIH1cbiAgZmluZFNlbGVjdGVkRmxvd0l0ZW1JbmRleChpdGVtcykge1xuICAgIGNvbnN0IHNlbGVjdGVkSXRlbSA9IGl0ZW1zLnNsaWNlKDApLnJldmVyc2UoKS5maW5kKChpdGVtKSA9PiAhIWl0ZW0uc2VsZWN0ZWQpO1xuICAgIHJldHVybiBpdGVtcy5pbmRleE9mKHNlbGVjdGVkSXRlbSk7XG4gIH1cbiAgZW5zdXJlU2VsZWN0ZWRGbG93SXRlbUV4aXN0cygpIHtcbiAgICBjb25zdCB7IGl0ZW1zIH0gPSB0aGlzO1xuICAgIGNvbnN0IGZvdW5kU2VsZWN0ZWRJbmRleCA9IHRoaXMuZmluZFNlbGVjdGVkRmxvd0l0ZW1JbmRleChpdGVtcyk7XG4gICAgaWYgKGZvdW5kU2VsZWN0ZWRJbmRleCAhPT0gLTEpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgbGFzdEl0ZW0gPSBpdGVtc1tpdGVtcy5sZW5ndGggLSAxXTtcbiAgICBpZiAobGFzdEl0ZW0pIHtcbiAgICAgIGxhc3RJdGVtLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgZmxvd0RpcmVjdGlvbiB9ID0gdGhpcztcbiAgICBjb25zdCBmcmFtZURpcmVjdGlvbkNsYXNzZXMgPSB7XG4gICAgICBbQ1NTLmZyYW1lXTogdHJ1ZSxcbiAgICAgIFtDU1MuZnJhbWVBZHZhbmNpbmddOiBmbG93RGlyZWN0aW9uID09PSBcImFkdmFuY2luZ1wiLFxuICAgICAgW0NTUy5mcmFtZVJldHJlYXRpbmddOiBmbG93RGlyZWN0aW9uID09PSBcInJldHJlYXRpbmdcIlxuICAgIH07XG4gICAgcmV0dXJuIGh0bWxgPGRpdiBjbGFzcz0ke3NhZmVDbGFzc01hcChmcmFtZURpcmVjdGlvbkNsYXNzZXMpfSAke3JlZih0aGlzLmZyYW1lUmVmKX0+PHNsb3Q+PC9zbG90PjwvZGl2PmA7XG4gIH1cbn1cbmN1c3RvbUVsZW1lbnQoXCJjYWxjaXRlLWZsb3dcIiwgRmxvdyk7XG5leHBvcnQge1xuICBGbG93XG59O1xuIiwiZXhwb3J0ICogZnJvbSBcIi4vY3VzdG9tRWxlbWVudC5qc1wiOyJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==