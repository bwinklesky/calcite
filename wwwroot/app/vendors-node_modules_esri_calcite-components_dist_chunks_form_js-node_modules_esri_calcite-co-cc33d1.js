export const __webpack_id__ = "vendors-node_modules_esri_calcite-components_dist_chunks_form_js-node_modules_esri_calcite-co-cc33d1";
export const __webpack_ids__ = ["vendors-node_modules_esri_calcite-components_dist_chunks_form_js-node_modules_esri_calcite-co-cc33d1"];
export const __webpack_modules__ = {

/***/ "./node_modules/@esri/calcite-components/dist/chunks/component.js":
/*!************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/chunks/component.js ***!
  \************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ componentFocusable),
/* harmony export */   g: () => (/* binding */ getIconScale),
/* harmony export */   i: () => (/* binding */ isHidden),
/* harmony export */   w: () => (/* binding */ warnIfMissingRequiredProp)
/* harmony export */ });
/* harmony import */ var _logger_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./logger.js */ "./node_modules/@esri/calcite-components/dist/chunks/logger.js");
/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */

function getIconScale(componentScale) {
  return componentScale === "l" ? "m" : "s";
}
function warnIfMissingRequiredProp(component, newProp, deprecatedProp) {
  if (!component[newProp] && !component[deprecatedProp]) {
    _logger_js__WEBPACK_IMPORTED_MODULE_0__.l.warn(`[${component.el.localName}] "${newProp.toString()}" or "${deprecatedProp.toString()}" is required.`);
  }
}
function isHidden(el) {
  return el.hidden || el.itemHidden;
}
async function componentFocusable(component) {
  await component.componentOnReady();
  await component.updateComplete;
}



/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/chunks/form.js":
/*!*******************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/chunks/form.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   H: () => (/* binding */ HiddenFormInputSlot),
/* harmony export */   a: () => (/* binding */ afterConnectDefaultValueSet),
/* harmony export */   c: () => (/* binding */ connectForm),
/* harmony export */   d: () => (/* binding */ disconnectForm),
/* harmony export */   f: () => (/* binding */ findAssociatedForm),
/* harmony export */   i: () => (/* binding */ internalHiddenInputInputEvent),
/* harmony export */   r: () => (/* binding */ resetForm),
/* harmony export */   s: () => (/* binding */ submitForm)
/* harmony export */ });
/* harmony import */ var lit__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit */ "./node_modules/lit/index.js");
/* harmony import */ var _dom_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./dom.js */ "./node_modules/@esri/calcite-components/dist/chunks/dom.js");
/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */


const componentsWithInputEvent = [
  "calcite-input",
  "calcite-input-number",
  "calcite-input-text",
  "calcite-text-area"
];
function getClearValidationEventName(componentTag) {
  const componentTagCamelCase = componentTag.split("-").map((part, index) => index === 0 ? part : `${part[0].toUpperCase()}${part.slice(1)}`).join("");
  const clearValidationEvent = `${componentTagCamelCase}${componentsWithInputEvent.includes(componentTag) ? "Input" : "Change"}`;
  return clearValidationEvent;
}
const hiddenFormInputSlotName = "hidden-form-input";
function isCheckable(component) {
  return "checked" in component;
}
const onFormResetMap = /* @__PURE__ */ new WeakMap();
const formComponentSet = /* @__PURE__ */ new WeakSet();
function hasRegisteredFormComponentParent(form, formComponentEl) {
  const hasParentComponentWithFormIdSet = (0,_dom_js__WEBPACK_IMPORTED_MODULE_1__.l)(formComponentEl.parentElement, "[form]");
  if (hasParentComponentWithFormIdSet) {
    return true;
  }
  const formComponentRegisterEventName = "calciteInternalFormComponentRegister";
  let hasRegisteredFormComponentParent2 = false;
  form.addEventListener(formComponentRegisterEventName, (event) => {
    hasRegisteredFormComponentParent2 = event.composedPath().some((element) => formComponentSet.has(element));
    event.stopPropagation();
  }, { once: true });
  formComponentEl.dispatchEvent(new CustomEvent(formComponentRegisterEventName, {
    bubbles: true,
    composed: true
  }));
  return hasRegisteredFormComponentParent2;
}
function displayValidationMessage(component, { status, message, icon }) {
  if ("status" in component) {
    component.status = status;
  }
  if ("validationIcon" in component && typeof component.validationIcon !== "string") {
    component.validationIcon = icon;
  }
  if ("validationMessage" in component && !component.validationMessage) {
    component.validationMessage = message;
  }
}
function getValidationComponent(el) {
  if (el.nodeName === "CALCITE-RADIO-BUTTON") {
    return (0,_dom_js__WEBPACK_IMPORTED_MODULE_1__.l)(el, "calcite-radio-button-group");
  }
  return el;
}
const invalidEvent = new CustomEvent("calciteInvalid", { bubbles: true, composed: true });
function invalidHandler(event) {
  const hiddenInput = event?.target;
  const hiddenInputMessage = hiddenInput?.validationMessage;
  const formComponent = getValidationComponent(hiddenInput?.parentElement);
  if (!formComponent) {
    return;
  }
  const componentTag = formComponent?.nodeName?.toLowerCase();
  const componentTagParts = componentTag?.split("-");
  if (componentTagParts.length < 2 || componentTagParts[0] !== "calcite") {
    return;
  }
  event?.preventDefault();
  if ("validity" in formComponent) {
    formComponent.validity = hiddenInput?.validity;
  }
  formComponent.dispatchEvent(invalidEvent);
  displayValidationMessage(formComponent, {
    message: hiddenInputMessage,
    icon: true,
    status: "invalid"
  });
  const clearValidationEvent = getClearValidationEventName(componentTag);
  formComponent.addEventListener(clearValidationEvent, () => {
    if ("status" in formComponent) {
      formComponent.status = "idle";
    }
    if ("validationIcon" in formComponent && (formComponent.validationIcon === "" || formComponent.validationIcon === true)) {
      formComponent.validationIcon = false;
    }
    if ("validationMessage" in formComponent && formComponent.validationMessage === hiddenInputMessage) {
      formComponent.validationMessage = "";
    }
    if ("validity" in formComponent) {
      formComponent.validity = hiddenInput?.validity;
    }
  }, { once: true });
}
function submitForm(component) {
  const { formEl } = component;
  if (!formEl) {
    return false;
  }
  formEl.addEventListener("invalid", invalidHandler, true);
  formEl.requestSubmit();
  formEl.removeEventListener("invalid", invalidHandler, true);
  requestAnimationFrame(() => {
    const invalidEls = formEl.querySelectorAll("[status=invalid]");
    for (const el of invalidEls) {
      if (el?.validationMessage) {
        el?.setFocus();
        break;
      }
    }
  });
  return true;
}
function resetForm(component) {
  component.formEl?.reset();
}
function connectForm(component) {
  const { el, value } = component;
  const associatedForm = findAssociatedForm(component);
  if (!associatedForm || hasRegisteredFormComponentParent(associatedForm, el)) {
    return;
  }
  component.formEl = associatedForm;
  component.defaultValue = value;
  if (isCheckable(component)) {
    component.defaultChecked = component.checked;
  }
  const boundOnFormReset = onFormReset.bind(component);
  associatedForm.addEventListener("reset", boundOnFormReset);
  onFormResetMap.set(component.el, boundOnFormReset);
  formComponentSet.add(el);
}
function findAssociatedForm(component) {
  const { el, form } = component;
  return form ? (0,_dom_js__WEBPACK_IMPORTED_MODULE_1__.q)(el, { id: form }) : (0,_dom_js__WEBPACK_IMPORTED_MODULE_1__.l)(el, "form");
}
function onFormReset() {
  if ("status" in this) {
    this.status = "idle";
  }
  if ("validationIcon" in this) {
    this.validationIcon = false;
  }
  if ("validationMessage" in this) {
    this.validationMessage = "";
  }
  if (isCheckable(this)) {
    this.checked = this.defaultChecked;
    return;
  }
  this.value = this.defaultValue;
  this.onFormReset?.();
}
function disconnectForm(component) {
  const { el, formEl } = component;
  if (!formEl) {
    return;
  }
  const boundOnFormReset = onFormResetMap.get(el);
  formEl.removeEventListener("reset", boundOnFormReset);
  onFormResetMap.delete(el);
  component.formEl = null;
  formComponentSet.delete(el);
}
function afterConnectDefaultValueSet(component, value) {
  component.defaultValue = value;
}
const internalHiddenInputInputEvent = "calciteInternalHiddenInputInput";
const hiddenInputInputHandler = (event) => {
  event.target.dispatchEvent(new CustomEvent(internalHiddenInputInputEvent, { bubbles: true }));
};
const removeHiddenInputChangeEventListener = (input) => input.removeEventListener("input", hiddenInputInputHandler);
function syncHiddenFormInput(component) {
  const { el, formEl, name, value } = component;
  const { ownerDocument } = el;
  if (lit__WEBPACK_IMPORTED_MODULE_0__.isServer) {
    return;
  }
  const inputs = el.querySelectorAll(`input[slot="${hiddenFormInputSlotName}"]`);
  if (!formEl || !name) {
    inputs.forEach((input) => {
      removeHiddenInputChangeEventListener(input);
      input.remove();
    });
    return;
  }
  const values = Array.isArray(value) ? value : [value];
  const extra = [];
  const seen = /* @__PURE__ */ new Set();
  inputs.forEach((input) => {
    const valueMatch = values.find((val) => (
      /* intentional non-strict equality check */
      val == input.value
    ));
    if (valueMatch != null) {
      seen.add(valueMatch);
      defaultSyncHiddenFormInput(component, input, valueMatch);
    } else {
      extra.push(input);
    }
  });
  let docFrag;
  values.forEach((value2) => {
    if (seen.has(value2)) {
      return;
    }
    let input = extra.pop();
    if (!input) {
      input = ownerDocument.createElement("input");
      input.ariaHidden = "true";
      input.slot = hiddenFormInputSlotName;
    }
    if (!docFrag) {
      docFrag = ownerDocument.createDocumentFragment();
    }
    docFrag.append(input);
    input.addEventListener("input", hiddenInputInputHandler);
    defaultSyncHiddenFormInput(component, input, value2);
  });
  if (docFrag) {
    el.append(docFrag);
  }
  extra.forEach((input) => {
    removeHiddenInputChangeEventListener(input);
    input.remove();
  });
}
function defaultSyncHiddenFormInput(component, input, value) {
  const { defaultValue, disabled, form, name, required } = component;
  input.defaultValue = defaultValue;
  input.disabled = disabled;
  input.name = name;
  input.required = required;
  input.tabIndex = -1;
  if (form) {
    input.setAttribute("form", form);
  } else {
    input.removeAttribute("form");
  }
  if (isCheckable(component)) {
    input.checked = component.checked;
    input.defaultChecked = component.defaultChecked;
    input.value = component.checked ? value || "on" : "";
  } else {
    input.value = value || "";
  }
  component.syncHiddenFormInput?.(input);
  const validationComponent = getValidationComponent(component.el);
  if (validationComponent && "validity" in validationComponent) {
    for (const key in { ...input?.validity }) {
      validationComponent.validity[key] = input.validity[key];
    }
  }
}
const HiddenFormInputSlot = ({ component }) => {
  syncHiddenFormInput(component);
  return (0,lit__WEBPACK_IMPORTED_MODULE_0__.html)`<slot name=${hiddenFormInputSlotName}></slot>`;
};



/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/chunks/interactive.js":
/*!**************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/chunks/interactive.js ***!
  \**************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   I: () => (/* binding */ InteractiveContainer),
/* harmony export */   u: () => (/* binding */ updateHostInteraction)
/* harmony export */ });
/* harmony import */ var lit_html__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-html */ "./node_modules/lit-html/development/lit-html.js");
/* harmony import */ var _arcgis_lumina__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @arcgis/lumina */ "./node_modules/@arcgis/lumina/dist/index.js");
/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */


function interceptedClick() {
  const { disabled } = this;
  if (!disabled) {
    HTMLElement.prototype.click.call(this);
  }
}
function onPointerDown(event) {
  const interactiveElement = event.target;
  if (interactiveElement.disabled) {
    event.preventDefault();
  }
}
const nonBubblingWhenDisabledMouseEvents = ["mousedown", "mouseup", "click"];
function onNonBubblingWhenDisabledMouseEvent(event) {
  const interactiveElement = event.target;
  if (interactiveElement.disabled) {
    event.stopImmediatePropagation();
    event.preventDefault();
  }
}
const captureOnlyOptions = { capture: true };
function updateHostInteraction(component) {
  if (component.disabled) {
    component.el.setAttribute("aria-disabled", "true");
    if (component.el.contains(document.activeElement)) {
      document.activeElement.blur();
    }
    blockInteraction(component);
    return;
  }
  restoreInteraction(component);
  component.el.removeAttribute("aria-disabled");
}
function blockInteraction(component) {
  component.el.click = interceptedClick;
  addInteractionListeners(component.el);
}
function addInteractionListeners(element) {
  element.addEventListener("pointerdown", onPointerDown, captureOnlyOptions);
  nonBubblingWhenDisabledMouseEvents.forEach((event) => element.addEventListener(event, onNonBubblingWhenDisabledMouseEvent, captureOnlyOptions));
}
function restoreInteraction(component) {
  delete component.el.click;
  removeInteractionListeners(component.el);
}
function removeInteractionListeners(element) {
  element.removeEventListener("pointerdown", onPointerDown, captureOnlyOptions);
  nonBubblingWhenDisabledMouseEvents.forEach((event) => element.removeEventListener(event, onNonBubblingWhenDisabledMouseEvent, captureOnlyOptions));
}
const CSS = {
  container: "interaction-container"
};
const InteractiveContainer = ({ children, disabled }) => (0,lit_html__WEBPACK_IMPORTED_MODULE_0__.html)`<div class=${(0,_arcgis_lumina__WEBPACK_IMPORTED_MODULE_1__.safeClassMap)(CSS.container)} .inert=${disabled}>${children}</div>`;



/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/chunks/logger.js":
/*!*********************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/chunks/logger.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   l: () => (/* binding */ logger)
/* harmony export */ });
/* harmony import */ var _runtime_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./runtime.js */ "./node_modules/@esri/calcite-components/dist/chunks/runtime.js");
/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */

const loggedDeprecations = /* @__PURE__ */ new Set();
const logLevels = {
  trace: 0,
  debug: 1,
  info: 2,
  warn: 4,
  error: 8,
  off: 10
};
function willLog(level) {
  return logLevels[level] >= logLevels[_runtime_js__WEBPACK_IMPORTED_MODULE_0__.l];
}
function forwardToConsole(level, ...data) {
  if (!willLog(level)) {
    return;
  }
  const badgeTemplate = "%ccalcite";
  const badgeStyle = "background: #007AC2; color: #fff; border-radius: 4px; padding: 2px 4px;";
  console[level].call(this, badgeTemplate, badgeStyle, ...data);
}
let listFormatter;
const logger = {
  debug: (message) => forwardToConsole("debug", message),
  info: (message) => forwardToConsole("info", message),
  warn: (message) => forwardToConsole("warn", message),
  error: (message) => forwardToConsole("error", message),
  trace: (message) => forwardToConsole("trace", message),
  deprecated
};
function deprecated(context, { component, name, suggested, removalVersion }) {
  const key = `${context}:${context === "component" ? "" : component}${name}`;
  if (loggedDeprecations.has(key)) {
    return;
  }
  loggedDeprecations.add(key);
  const multiSuggestions = Array.isArray(suggested);
  if (multiSuggestions && !listFormatter) {
    listFormatter = new Intl.ListFormat("en", { style: "long", type: "disjunction" });
  }
  const message = `[${name}] ${context} is deprecated and will be removed in ${removalVersion === "future" ? `a future version` : `v${removalVersion}`}.${suggested ? ` Use ${multiSuggestions ? listFormatter.format(suggested.map((suggestion) => `"${suggestion}"`)) : `"${suggested}"`} instead.` : ""}`;
  forwardToConsole("warn", message);
}



/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/chunks/useSetFocus.js":
/*!**************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/chunks/useSetFocus.js ***!
  \**************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   u: () => (/* binding */ useSetFocus)
/* harmony export */ });
/* harmony import */ var _arcgis_lumina_controllers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @arcgis/lumina/controllers */ "./node_modules/@arcgis/lumina/dist/controllers/index.js");
/* harmony import */ var _component_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./component.js */ "./node_modules/@esri/calcite-components/dist/chunks/component.js");
/* harmony import */ var _dom_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./dom.js */ "./node_modules/@esri/calcite-components/dist/chunks/dom.js");
/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */



const useSetFocus = () => {
  return (0,_arcgis_lumina_controllers__WEBPACK_IMPORTED_MODULE_0__.makeGenericController)((component, controller) => {
    let abortController;
    function handleFocusOut() {
      abortController?.abort();
    }
    controller.onLoad(() => {
      component.listen("focus", () => {
        abortController = new AbortController();
        component.el.addEventListener("focusout", handleFocusOut, { signal: abortController.signal });
      });
    });
    controller.onDisconnected(() => {
      component.el.removeEventListener("focusout", handleFocusOut);
    });
    return async (getFocusTarget, options) => {
      if (component.disabled) {
        return;
      }
      const focusConfig = toFocusConfig(getFocusTarget());
      if (!focusConfig) {
        return;
      }
      const { target, includeContainer, strategy } = focusConfig;
      const rootNode = (0,_dom_js__WEBPACK_IMPORTED_MODULE_2__.k)(component.el);
      const currentActiveElement = rootNode.activeElement;
      await (0,_component_js__WEBPACK_IMPORTED_MODULE_1__.c)(component);
      const focusAlreadyChanged = currentActiveElement !== rootNode.activeElement;
      if (focusAlreadyChanged || abortController && !abortController?.signal.aborted) {
        return;
      }
      component.el.removeEventListener("focus", handleFocusOut);
      return (0,_dom_js__WEBPACK_IMPORTED_MODULE_2__.b)(target, includeContainer, strategy, component.el, options);
    };
  });
};
function isFocusOverride(focusTarget) {
  return "target" in focusTarget && ("includeContainer" in focusTarget || "strategy" in focusTarget);
}
function toFocusConfig(focusTarget) {
  if (!focusTarget) {
    return;
  }
  return isFocusOverride(focusTarget) ? focusTarget : { target: focusTarget };
}



/***/ })

};

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVuZG9ycy1ub2RlX21vZHVsZXNfZXNyaV9jYWxjaXRlLWNvbXBvbmVudHNfZGlzdF9jaHVua3NfZm9ybV9qcy1ub2RlX21vZHVsZXNfZXNyaV9jYWxjaXRlLWNvLWNjMzNkMS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDMEM7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUkseUNBQU0sVUFBVSx1QkFBdUIsS0FBSyxtQkFBbUIsUUFBUSwwQkFBMEI7QUFDckc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTUU7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3hCRjtBQUNBO0FBQ0E7QUFDcUM7QUFDcUQ7QUFDMUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxR0FBcUcsc0JBQXNCLEVBQUUsY0FBYztBQUMzSSxrQ0FBa0Msc0JBQXNCLEVBQUUscUVBQXFFO0FBQy9IO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQywwQ0FBaUM7QUFDM0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsSUFBSSxZQUFZO0FBQ25CO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsK0NBQStDLHVCQUF1QjtBQUN0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLDBDQUFpQztBQUM1QztBQUNBO0FBQ0E7QUFDQSx5REFBeUQsK0JBQStCO0FBQ3hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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eUNBQXlDLEVBQUUsS0FBSztBQUM1RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0Qsb0NBQW9DO0FBQ3BGO0FBQ0Esc0JBQXNCLEtBQUssSUFBSSxTQUFTLHVDQUF1Qyx1REFBdUQsZUFBZSxFQUFFLEdBQUcsb0JBQW9CLDBFQUEwRSxXQUFXLFdBQVcsVUFBVSxJQUFJLGVBQWU7QUFDM1M7QUFDQTtBQUdFOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNoREY7QUFDQTtBQUNBO0FBQ21FO0FBQ1Y7QUFDTTtBQUMvRDtBQUNBLFNBQVMsaUZBQXFCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0VBQW9FLGdDQUFnQztBQUNwRyxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMscUNBQXFDO0FBQ25ELHVCQUF1QiwwQ0FBVztBQUNsQztBQUNBLFlBQVksZ0RBQWtCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLDBDQUFZO0FBQ3pCO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3REFBd0Q7QUFDeEQ7QUFHRSIsInNvdXJjZXMiOlsid2VicGFjazovL3ByZWNpc2lvbmZhcm1zLy4vbm9kZV9tb2R1bGVzL0Blc3JpL2NhbGNpdGUtY29tcG9uZW50cy9kaXN0L2NodW5rcy9jb21wb25lbnQuanMiLCJ3ZWJwYWNrOi8vcHJlY2lzaW9uZmFybXMvLi9ub2RlX21vZHVsZXMvQGVzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Rpc3QvY2h1bmtzL2Zvcm0uanMiLCJ3ZWJwYWNrOi8vcHJlY2lzaW9uZmFybXMvLi9ub2RlX21vZHVsZXMvQGVzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Rpc3QvY2h1bmtzL2ludGVyYWN0aXZlLmpzIiwid2VicGFjazovL3ByZWNpc2lvbmZhcm1zLy4vbm9kZV9tb2R1bGVzL0Blc3JpL2NhbGNpdGUtY29tcG9uZW50cy9kaXN0L2NodW5rcy9sb2dnZXIuanMiLCJ3ZWJwYWNrOi8vcHJlY2lzaW9uZmFybXMvLi9ub2RlX21vZHVsZXMvQGVzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Rpc3QvY2h1bmtzL3VzZVNldEZvY3VzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qISBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtZGVzaWduLXN5c3RlbS9ibG9iL2Rldi9MSUNFTlNFLm1kIGZvciBkZXRhaWxzLlxudjMuMy4zICovXG5pbXBvcnQgeyBsIGFzIGxvZ2dlciB9IGZyb20gXCIuL2xvZ2dlci5qc1wiO1xuZnVuY3Rpb24gZ2V0SWNvblNjYWxlKGNvbXBvbmVudFNjYWxlKSB7XG4gIHJldHVybiBjb21wb25lbnRTY2FsZSA9PT0gXCJsXCIgPyBcIm1cIiA6IFwic1wiO1xufVxuZnVuY3Rpb24gd2FybklmTWlzc2luZ1JlcXVpcmVkUHJvcChjb21wb25lbnQsIG5ld1Byb3AsIGRlcHJlY2F0ZWRQcm9wKSB7XG4gIGlmICghY29tcG9uZW50W25ld1Byb3BdICYmICFjb21wb25lbnRbZGVwcmVjYXRlZFByb3BdKSB7XG4gICAgbG9nZ2VyLndhcm4oYFske2NvbXBvbmVudC5lbC5sb2NhbE5hbWV9XSBcIiR7bmV3UHJvcC50b1N0cmluZygpfVwiIG9yIFwiJHtkZXByZWNhdGVkUHJvcC50b1N0cmluZygpfVwiIGlzIHJlcXVpcmVkLmApO1xuICB9XG59XG5mdW5jdGlvbiBpc0hpZGRlbihlbCkge1xuICByZXR1cm4gZWwuaGlkZGVuIHx8IGVsLml0ZW1IaWRkZW47XG59XG5hc3luYyBmdW5jdGlvbiBjb21wb25lbnRGb2N1c2FibGUoY29tcG9uZW50KSB7XG4gIGF3YWl0IGNvbXBvbmVudC5jb21wb25lbnRPblJlYWR5KCk7XG4gIGF3YWl0IGNvbXBvbmVudC51cGRhdGVDb21wbGV0ZTtcbn1cbmV4cG9ydCB7XG4gIGNvbXBvbmVudEZvY3VzYWJsZSBhcyBjLFxuICBnZXRJY29uU2NhbGUgYXMgZyxcbiAgaXNIaWRkZW4gYXMgaSxcbiAgd2FybklmTWlzc2luZ1JlcXVpcmVkUHJvcCBhcyB3XG59O1xuIiwiLyohIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG5TZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1kZXNpZ24tc3lzdGVtL2Jsb2IvZGV2L0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG52My4zLjMgKi9cbmltcG9ydCB7IGh0bWwsIGlzU2VydmVyIH0gZnJvbSBcImxpdFwiO1xuaW1wb3J0IHsgcSBhcyBxdWVyeUVsZW1lbnRSb290cywgbCBhcyBjbG9zZXN0RWxlbWVudENyb3NzU2hhZG93Qm91bmRhcnkgfSBmcm9tIFwiLi9kb20uanNcIjtcbmNvbnN0IGNvbXBvbmVudHNXaXRoSW5wdXRFdmVudCA9IFtcbiAgXCJjYWxjaXRlLWlucHV0XCIsXG4gIFwiY2FsY2l0ZS1pbnB1dC1udW1iZXJcIixcbiAgXCJjYWxjaXRlLWlucHV0LXRleHRcIixcbiAgXCJjYWxjaXRlLXRleHQtYXJlYVwiXG5dO1xuZnVuY3Rpb24gZ2V0Q2xlYXJWYWxpZGF0aW9uRXZlbnROYW1lKGNvbXBvbmVudFRhZykge1xuICBjb25zdCBjb21wb25lbnRUYWdDYW1lbENhc2UgPSBjb21wb25lbnRUYWcuc3BsaXQoXCItXCIpLm1hcCgocGFydCwgaW5kZXgpID0+IGluZGV4ID09PSAwID8gcGFydCA6IGAke3BhcnRbMF0udG9VcHBlckNhc2UoKX0ke3BhcnQuc2xpY2UoMSl9YCkuam9pbihcIlwiKTtcbiAgY29uc3QgY2xlYXJWYWxpZGF0aW9uRXZlbnQgPSBgJHtjb21wb25lbnRUYWdDYW1lbENhc2V9JHtjb21wb25lbnRzV2l0aElucHV0RXZlbnQuaW5jbHVkZXMoY29tcG9uZW50VGFnKSA/IFwiSW5wdXRcIiA6IFwiQ2hhbmdlXCJ9YDtcbiAgcmV0dXJuIGNsZWFyVmFsaWRhdGlvbkV2ZW50O1xufVxuY29uc3QgaGlkZGVuRm9ybUlucHV0U2xvdE5hbWUgPSBcImhpZGRlbi1mb3JtLWlucHV0XCI7XG5mdW5jdGlvbiBpc0NoZWNrYWJsZShjb21wb25lbnQpIHtcbiAgcmV0dXJuIFwiY2hlY2tlZFwiIGluIGNvbXBvbmVudDtcbn1cbmNvbnN0IG9uRm9ybVJlc2V0TWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7XG5jb25zdCBmb3JtQ29tcG9uZW50U2V0ID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrU2V0KCk7XG5mdW5jdGlvbiBoYXNSZWdpc3RlcmVkRm9ybUNvbXBvbmVudFBhcmVudChmb3JtLCBmb3JtQ29tcG9uZW50RWwpIHtcbiAgY29uc3QgaGFzUGFyZW50Q29tcG9uZW50V2l0aEZvcm1JZFNldCA9IGNsb3Nlc3RFbGVtZW50Q3Jvc3NTaGFkb3dCb3VuZGFyeShmb3JtQ29tcG9uZW50RWwucGFyZW50RWxlbWVudCwgXCJbZm9ybV1cIik7XG4gIGlmIChoYXNQYXJlbnRDb21wb25lbnRXaXRoRm9ybUlkU2V0KSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgY29uc3QgZm9ybUNvbXBvbmVudFJlZ2lzdGVyRXZlbnROYW1lID0gXCJjYWxjaXRlSW50ZXJuYWxGb3JtQ29tcG9uZW50UmVnaXN0ZXJcIjtcbiAgbGV0IGhhc1JlZ2lzdGVyZWRGb3JtQ29tcG9uZW50UGFyZW50MiA9IGZhbHNlO1xuICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoZm9ybUNvbXBvbmVudFJlZ2lzdGVyRXZlbnROYW1lLCAoZXZlbnQpID0+IHtcbiAgICBoYXNSZWdpc3RlcmVkRm9ybUNvbXBvbmVudFBhcmVudDIgPSBldmVudC5jb21wb3NlZFBhdGgoKS5zb21lKChlbGVtZW50KSA9PiBmb3JtQ29tcG9uZW50U2V0LmhhcyhlbGVtZW50KSk7XG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gIH0sIHsgb25jZTogdHJ1ZSB9KTtcbiAgZm9ybUNvbXBvbmVudEVsLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KGZvcm1Db21wb25lbnRSZWdpc3RlckV2ZW50TmFtZSwge1xuICAgIGJ1YmJsZXM6IHRydWUsXG4gICAgY29tcG9zZWQ6IHRydWVcbiAgfSkpO1xuICByZXR1cm4gaGFzUmVnaXN0ZXJlZEZvcm1Db21wb25lbnRQYXJlbnQyO1xufVxuZnVuY3Rpb24gZGlzcGxheVZhbGlkYXRpb25NZXNzYWdlKGNvbXBvbmVudCwgeyBzdGF0dXMsIG1lc3NhZ2UsIGljb24gfSkge1xuICBpZiAoXCJzdGF0dXNcIiBpbiBjb21wb25lbnQpIHtcbiAgICBjb21wb25lbnQuc3RhdHVzID0gc3RhdHVzO1xuICB9XG4gIGlmIChcInZhbGlkYXRpb25JY29uXCIgaW4gY29tcG9uZW50ICYmIHR5cGVvZiBjb21wb25lbnQudmFsaWRhdGlvbkljb24gIT09IFwic3RyaW5nXCIpIHtcbiAgICBjb21wb25lbnQudmFsaWRhdGlvbkljb24gPSBpY29uO1xuICB9XG4gIGlmIChcInZhbGlkYXRpb25NZXNzYWdlXCIgaW4gY29tcG9uZW50ICYmICFjb21wb25lbnQudmFsaWRhdGlvbk1lc3NhZ2UpIHtcbiAgICBjb21wb25lbnQudmFsaWRhdGlvbk1lc3NhZ2UgPSBtZXNzYWdlO1xuICB9XG59XG5mdW5jdGlvbiBnZXRWYWxpZGF0aW9uQ29tcG9uZW50KGVsKSB7XG4gIGlmIChlbC5ub2RlTmFtZSA9PT0gXCJDQUxDSVRFLVJBRElPLUJVVFRPTlwiKSB7XG4gICAgcmV0dXJuIGNsb3Nlc3RFbGVtZW50Q3Jvc3NTaGFkb3dCb3VuZGFyeShlbCwgXCJjYWxjaXRlLXJhZGlvLWJ1dHRvbi1ncm91cFwiKTtcbiAgfVxuICByZXR1cm4gZWw7XG59XG5jb25zdCBpbnZhbGlkRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoXCJjYWxjaXRlSW52YWxpZFwiLCB7IGJ1YmJsZXM6IHRydWUsIGNvbXBvc2VkOiB0cnVlIH0pO1xuZnVuY3Rpb24gaW52YWxpZEhhbmRsZXIoZXZlbnQpIHtcbiAgY29uc3QgaGlkZGVuSW5wdXQgPSBldmVudD8udGFyZ2V0O1xuICBjb25zdCBoaWRkZW5JbnB1dE1lc3NhZ2UgPSBoaWRkZW5JbnB1dD8udmFsaWRhdGlvbk1lc3NhZ2U7XG4gIGNvbnN0IGZvcm1Db21wb25lbnQgPSBnZXRWYWxpZGF0aW9uQ29tcG9uZW50KGhpZGRlbklucHV0Py5wYXJlbnRFbGVtZW50KTtcbiAgaWYgKCFmb3JtQ29tcG9uZW50KSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGNvbXBvbmVudFRhZyA9IGZvcm1Db21wb25lbnQ/Lm5vZGVOYW1lPy50b0xvd2VyQ2FzZSgpO1xuICBjb25zdCBjb21wb25lbnRUYWdQYXJ0cyA9IGNvbXBvbmVudFRhZz8uc3BsaXQoXCItXCIpO1xuICBpZiAoY29tcG9uZW50VGFnUGFydHMubGVuZ3RoIDwgMiB8fCBjb21wb25lbnRUYWdQYXJ0c1swXSAhPT0gXCJjYWxjaXRlXCIpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgZXZlbnQ/LnByZXZlbnREZWZhdWx0KCk7XG4gIGlmIChcInZhbGlkaXR5XCIgaW4gZm9ybUNvbXBvbmVudCkge1xuICAgIGZvcm1Db21wb25lbnQudmFsaWRpdHkgPSBoaWRkZW5JbnB1dD8udmFsaWRpdHk7XG4gIH1cbiAgZm9ybUNvbXBvbmVudC5kaXNwYXRjaEV2ZW50KGludmFsaWRFdmVudCk7XG4gIGRpc3BsYXlWYWxpZGF0aW9uTWVzc2FnZShmb3JtQ29tcG9uZW50LCB7XG4gICAgbWVzc2FnZTogaGlkZGVuSW5wdXRNZXNzYWdlLFxuICAgIGljb246IHRydWUsXG4gICAgc3RhdHVzOiBcImludmFsaWRcIlxuICB9KTtcbiAgY29uc3QgY2xlYXJWYWxpZGF0aW9uRXZlbnQgPSBnZXRDbGVhclZhbGlkYXRpb25FdmVudE5hbWUoY29tcG9uZW50VGFnKTtcbiAgZm9ybUNvbXBvbmVudC5hZGRFdmVudExpc3RlbmVyKGNsZWFyVmFsaWRhdGlvbkV2ZW50LCAoKSA9PiB7XG4gICAgaWYgKFwic3RhdHVzXCIgaW4gZm9ybUNvbXBvbmVudCkge1xuICAgICAgZm9ybUNvbXBvbmVudC5zdGF0dXMgPSBcImlkbGVcIjtcbiAgICB9XG4gICAgaWYgKFwidmFsaWRhdGlvbkljb25cIiBpbiBmb3JtQ29tcG9uZW50ICYmIChmb3JtQ29tcG9uZW50LnZhbGlkYXRpb25JY29uID09PSBcIlwiIHx8IGZvcm1Db21wb25lbnQudmFsaWRhdGlvbkljb24gPT09IHRydWUpKSB7XG4gICAgICBmb3JtQ29tcG9uZW50LnZhbGlkYXRpb25JY29uID0gZmFsc2U7XG4gICAgfVxuICAgIGlmIChcInZhbGlkYXRpb25NZXNzYWdlXCIgaW4gZm9ybUNvbXBvbmVudCAmJiBmb3JtQ29tcG9uZW50LnZhbGlkYXRpb25NZXNzYWdlID09PSBoaWRkZW5JbnB1dE1lc3NhZ2UpIHtcbiAgICAgIGZvcm1Db21wb25lbnQudmFsaWRhdGlvbk1lc3NhZ2UgPSBcIlwiO1xuICAgIH1cbiAgICBpZiAoXCJ2YWxpZGl0eVwiIGluIGZvcm1Db21wb25lbnQpIHtcbiAgICAgIGZvcm1Db21wb25lbnQudmFsaWRpdHkgPSBoaWRkZW5JbnB1dD8udmFsaWRpdHk7XG4gICAgfVxuICB9LCB7IG9uY2U6IHRydWUgfSk7XG59XG5mdW5jdGlvbiBzdWJtaXRGb3JtKGNvbXBvbmVudCkge1xuICBjb25zdCB7IGZvcm1FbCB9ID0gY29tcG9uZW50O1xuICBpZiAoIWZvcm1FbCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBmb3JtRWwuYWRkRXZlbnRMaXN0ZW5lcihcImludmFsaWRcIiwgaW52YWxpZEhhbmRsZXIsIHRydWUpO1xuICBmb3JtRWwucmVxdWVzdFN1Ym1pdCgpO1xuICBmb3JtRWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImludmFsaWRcIiwgaW52YWxpZEhhbmRsZXIsIHRydWUpO1xuICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgIGNvbnN0IGludmFsaWRFbHMgPSBmb3JtRWwucXVlcnlTZWxlY3RvckFsbChcIltzdGF0dXM9aW52YWxpZF1cIik7XG4gICAgZm9yIChjb25zdCBlbCBvZiBpbnZhbGlkRWxzKSB7XG4gICAgICBpZiAoZWw/LnZhbGlkYXRpb25NZXNzYWdlKSB7XG4gICAgICAgIGVsPy5zZXRGb2N1cygpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICByZXR1cm4gdHJ1ZTtcbn1cbmZ1bmN0aW9uIHJlc2V0Rm9ybShjb21wb25lbnQpIHtcbiAgY29tcG9uZW50LmZvcm1FbD8ucmVzZXQoKTtcbn1cbmZ1bmN0aW9uIGNvbm5lY3RGb3JtKGNvbXBvbmVudCkge1xuICBjb25zdCB7IGVsLCB2YWx1ZSB9ID0gY29tcG9uZW50O1xuICBjb25zdCBhc3NvY2lhdGVkRm9ybSA9IGZpbmRBc3NvY2lhdGVkRm9ybShjb21wb25lbnQpO1xuICBpZiAoIWFzc29jaWF0ZWRGb3JtIHx8IGhhc1JlZ2lzdGVyZWRGb3JtQ29tcG9uZW50UGFyZW50KGFzc29jaWF0ZWRGb3JtLCBlbCkpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29tcG9uZW50LmZvcm1FbCA9IGFzc29jaWF0ZWRGb3JtO1xuICBjb21wb25lbnQuZGVmYXVsdFZhbHVlID0gdmFsdWU7XG4gIGlmIChpc0NoZWNrYWJsZShjb21wb25lbnQpKSB7XG4gICAgY29tcG9uZW50LmRlZmF1bHRDaGVja2VkID0gY29tcG9uZW50LmNoZWNrZWQ7XG4gIH1cbiAgY29uc3QgYm91bmRPbkZvcm1SZXNldCA9IG9uRm9ybVJlc2V0LmJpbmQoY29tcG9uZW50KTtcbiAgYXNzb2NpYXRlZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInJlc2V0XCIsIGJvdW5kT25Gb3JtUmVzZXQpO1xuICBvbkZvcm1SZXNldE1hcC5zZXQoY29tcG9uZW50LmVsLCBib3VuZE9uRm9ybVJlc2V0KTtcbiAgZm9ybUNvbXBvbmVudFNldC5hZGQoZWwpO1xufVxuZnVuY3Rpb24gZmluZEFzc29jaWF0ZWRGb3JtKGNvbXBvbmVudCkge1xuICBjb25zdCB7IGVsLCBmb3JtIH0gPSBjb21wb25lbnQ7XG4gIHJldHVybiBmb3JtID8gcXVlcnlFbGVtZW50Um9vdHMoZWwsIHsgaWQ6IGZvcm0gfSkgOiBjbG9zZXN0RWxlbWVudENyb3NzU2hhZG93Qm91bmRhcnkoZWwsIFwiZm9ybVwiKTtcbn1cbmZ1bmN0aW9uIG9uRm9ybVJlc2V0KCkge1xuICBpZiAoXCJzdGF0dXNcIiBpbiB0aGlzKSB7XG4gICAgdGhpcy5zdGF0dXMgPSBcImlkbGVcIjtcbiAgfVxuICBpZiAoXCJ2YWxpZGF0aW9uSWNvblwiIGluIHRoaXMpIHtcbiAgICB0aGlzLnZhbGlkYXRpb25JY29uID0gZmFsc2U7XG4gIH1cbiAgaWYgKFwidmFsaWRhdGlvbk1lc3NhZ2VcIiBpbiB0aGlzKSB7XG4gICAgdGhpcy52YWxpZGF0aW9uTWVzc2FnZSA9IFwiXCI7XG4gIH1cbiAgaWYgKGlzQ2hlY2thYmxlKHRoaXMpKSB7XG4gICAgdGhpcy5jaGVja2VkID0gdGhpcy5kZWZhdWx0Q2hlY2tlZDtcbiAgICByZXR1cm47XG4gIH1cbiAgdGhpcy52YWx1ZSA9IHRoaXMuZGVmYXVsdFZhbHVlO1xuICB0aGlzLm9uRm9ybVJlc2V0Py4oKTtcbn1cbmZ1bmN0aW9uIGRpc2Nvbm5lY3RGb3JtKGNvbXBvbmVudCkge1xuICBjb25zdCB7IGVsLCBmb3JtRWwgfSA9IGNvbXBvbmVudDtcbiAgaWYgKCFmb3JtRWwpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgYm91bmRPbkZvcm1SZXNldCA9IG9uRm9ybVJlc2V0TWFwLmdldChlbCk7XG4gIGZvcm1FbC5yZW1vdmVFdmVudExpc3RlbmVyKFwicmVzZXRcIiwgYm91bmRPbkZvcm1SZXNldCk7XG4gIG9uRm9ybVJlc2V0TWFwLmRlbGV0ZShlbCk7XG4gIGNvbXBvbmVudC5mb3JtRWwgPSBudWxsO1xuICBmb3JtQ29tcG9uZW50U2V0LmRlbGV0ZShlbCk7XG59XG5mdW5jdGlvbiBhZnRlckNvbm5lY3REZWZhdWx0VmFsdWVTZXQoY29tcG9uZW50LCB2YWx1ZSkge1xuICBjb21wb25lbnQuZGVmYXVsdFZhbHVlID0gdmFsdWU7XG59XG5jb25zdCBpbnRlcm5hbEhpZGRlbklucHV0SW5wdXRFdmVudCA9IFwiY2FsY2l0ZUludGVybmFsSGlkZGVuSW5wdXRJbnB1dFwiO1xuY29uc3QgaGlkZGVuSW5wdXRJbnB1dEhhbmRsZXIgPSAoZXZlbnQpID0+IHtcbiAgZXZlbnQudGFyZ2V0LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KGludGVybmFsSGlkZGVuSW5wdXRJbnB1dEV2ZW50LCB7IGJ1YmJsZXM6IHRydWUgfSkpO1xufTtcbmNvbnN0IHJlbW92ZUhpZGRlbklucHV0Q2hhbmdlRXZlbnRMaXN0ZW5lciA9IChpbnB1dCkgPT4gaW5wdXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGhpZGRlbklucHV0SW5wdXRIYW5kbGVyKTtcbmZ1bmN0aW9uIHN5bmNIaWRkZW5Gb3JtSW5wdXQoY29tcG9uZW50KSB7XG4gIGNvbnN0IHsgZWwsIGZvcm1FbCwgbmFtZSwgdmFsdWUgfSA9IGNvbXBvbmVudDtcbiAgY29uc3QgeyBvd25lckRvY3VtZW50IH0gPSBlbDtcbiAgaWYgKGlzU2VydmVyKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGlucHV0cyA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoYGlucHV0W3Nsb3Q9XCIke2hpZGRlbkZvcm1JbnB1dFNsb3ROYW1lfVwiXWApO1xuICBpZiAoIWZvcm1FbCB8fCAhbmFtZSkge1xuICAgIGlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgcmVtb3ZlSGlkZGVuSW5wdXRDaGFuZ2VFdmVudExpc3RlbmVyKGlucHV0KTtcbiAgICAgIGlucHV0LnJlbW92ZSgpO1xuICAgIH0pO1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCB2YWx1ZXMgPSBBcnJheS5pc0FycmF5KHZhbHVlKSA/IHZhbHVlIDogW3ZhbHVlXTtcbiAgY29uc3QgZXh0cmEgPSBbXTtcbiAgY29uc3Qgc2VlbiA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7XG4gIGlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgIGNvbnN0IHZhbHVlTWF0Y2ggPSB2YWx1ZXMuZmluZCgodmFsKSA9PiAoXG4gICAgICAvKiBpbnRlbnRpb25hbCBub24tc3RyaWN0IGVxdWFsaXR5IGNoZWNrICovXG4gICAgICB2YWwgPT0gaW5wdXQudmFsdWVcbiAgICApKTtcbiAgICBpZiAodmFsdWVNYXRjaCAhPSBudWxsKSB7XG4gICAgICBzZWVuLmFkZCh2YWx1ZU1hdGNoKTtcbiAgICAgIGRlZmF1bHRTeW5jSGlkZGVuRm9ybUlucHV0KGNvbXBvbmVudCwgaW5wdXQsIHZhbHVlTWF0Y2gpO1xuICAgIH0gZWxzZSB7XG4gICAgICBleHRyYS5wdXNoKGlucHV0KTtcbiAgICB9XG4gIH0pO1xuICBsZXQgZG9jRnJhZztcbiAgdmFsdWVzLmZvckVhY2goKHZhbHVlMikgPT4ge1xuICAgIGlmIChzZWVuLmhhcyh2YWx1ZTIpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGxldCBpbnB1dCA9IGV4dHJhLnBvcCgpO1xuICAgIGlmICghaW5wdXQpIHtcbiAgICAgIGlucHV0ID0gb3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG4gICAgICBpbnB1dC5hcmlhSGlkZGVuID0gXCJ0cnVlXCI7XG4gICAgICBpbnB1dC5zbG90ID0gaGlkZGVuRm9ybUlucHV0U2xvdE5hbWU7XG4gICAgfVxuICAgIGlmICghZG9jRnJhZykge1xuICAgICAgZG9jRnJhZyA9IG93bmVyRG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgIH1cbiAgICBkb2NGcmFnLmFwcGVuZChpbnB1dCk7XG4gICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGhpZGRlbklucHV0SW5wdXRIYW5kbGVyKTtcbiAgICBkZWZhdWx0U3luY0hpZGRlbkZvcm1JbnB1dChjb21wb25lbnQsIGlucHV0LCB2YWx1ZTIpO1xuICB9KTtcbiAgaWYgKGRvY0ZyYWcpIHtcbiAgICBlbC5hcHBlbmQoZG9jRnJhZyk7XG4gIH1cbiAgZXh0cmEuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICByZW1vdmVIaWRkZW5JbnB1dENoYW5nZUV2ZW50TGlzdGVuZXIoaW5wdXQpO1xuICAgIGlucHV0LnJlbW92ZSgpO1xuICB9KTtcbn1cbmZ1bmN0aW9uIGRlZmF1bHRTeW5jSGlkZGVuRm9ybUlucHV0KGNvbXBvbmVudCwgaW5wdXQsIHZhbHVlKSB7XG4gIGNvbnN0IHsgZGVmYXVsdFZhbHVlLCBkaXNhYmxlZCwgZm9ybSwgbmFtZSwgcmVxdWlyZWQgfSA9IGNvbXBvbmVudDtcbiAgaW5wdXQuZGVmYXVsdFZhbHVlID0gZGVmYXVsdFZhbHVlO1xuICBpbnB1dC5kaXNhYmxlZCA9IGRpc2FibGVkO1xuICBpbnB1dC5uYW1lID0gbmFtZTtcbiAgaW5wdXQucmVxdWlyZWQgPSByZXF1aXJlZDtcbiAgaW5wdXQudGFiSW5kZXggPSAtMTtcbiAgaWYgKGZvcm0pIHtcbiAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoXCJmb3JtXCIsIGZvcm0pO1xuICB9IGVsc2Uge1xuICAgIGlucHV0LnJlbW92ZUF0dHJpYnV0ZShcImZvcm1cIik7XG4gIH1cbiAgaWYgKGlzQ2hlY2thYmxlKGNvbXBvbmVudCkpIHtcbiAgICBpbnB1dC5jaGVja2VkID0gY29tcG9uZW50LmNoZWNrZWQ7XG4gICAgaW5wdXQuZGVmYXVsdENoZWNrZWQgPSBjb21wb25lbnQuZGVmYXVsdENoZWNrZWQ7XG4gICAgaW5wdXQudmFsdWUgPSBjb21wb25lbnQuY2hlY2tlZCA/IHZhbHVlIHx8IFwib25cIiA6IFwiXCI7XG4gIH0gZWxzZSB7XG4gICAgaW5wdXQudmFsdWUgPSB2YWx1ZSB8fCBcIlwiO1xuICB9XG4gIGNvbXBvbmVudC5zeW5jSGlkZGVuRm9ybUlucHV0Py4oaW5wdXQpO1xuICBjb25zdCB2YWxpZGF0aW9uQ29tcG9uZW50ID0gZ2V0VmFsaWRhdGlvbkNvbXBvbmVudChjb21wb25lbnQuZWwpO1xuICBpZiAodmFsaWRhdGlvbkNvbXBvbmVudCAmJiBcInZhbGlkaXR5XCIgaW4gdmFsaWRhdGlvbkNvbXBvbmVudCkge1xuICAgIGZvciAoY29uc3Qga2V5IGluIHsgLi4uaW5wdXQ/LnZhbGlkaXR5IH0pIHtcbiAgICAgIHZhbGlkYXRpb25Db21wb25lbnQudmFsaWRpdHlba2V5XSA9IGlucHV0LnZhbGlkaXR5W2tleV07XG4gICAgfVxuICB9XG59XG5jb25zdCBIaWRkZW5Gb3JtSW5wdXRTbG90ID0gKHsgY29tcG9uZW50IH0pID0+IHtcbiAgc3luY0hpZGRlbkZvcm1JbnB1dChjb21wb25lbnQpO1xuICByZXR1cm4gaHRtbGA8c2xvdCBuYW1lPSR7aGlkZGVuRm9ybUlucHV0U2xvdE5hbWV9Pjwvc2xvdD5gO1xufTtcbmV4cG9ydCB7XG4gIEhpZGRlbkZvcm1JbnB1dFNsb3QgYXMgSCxcbiAgYWZ0ZXJDb25uZWN0RGVmYXVsdFZhbHVlU2V0IGFzIGEsXG4gIGNvbm5lY3RGb3JtIGFzIGMsXG4gIGRpc2Nvbm5lY3RGb3JtIGFzIGQsXG4gIGZpbmRBc3NvY2lhdGVkRm9ybSBhcyBmLFxuICBpbnRlcm5hbEhpZGRlbklucHV0SW5wdXRFdmVudCBhcyBpLFxuICByZXNldEZvcm0gYXMgcixcbiAgc3VibWl0Rm9ybSBhcyBzXG59O1xuIiwiLyohIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG5TZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1kZXNpZ24tc3lzdGVtL2Jsb2IvZGV2L0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG52My4zLjMgKi9cbmltcG9ydCB7IGh0bWwgfSBmcm9tIFwibGl0LWh0bWxcIjtcbmltcG9ydCB7IHNhZmVDbGFzc01hcCB9IGZyb20gXCJAYXJjZ2lzL2x1bWluYVwiO1xuZnVuY3Rpb24gaW50ZXJjZXB0ZWRDbGljaygpIHtcbiAgY29uc3QgeyBkaXNhYmxlZCB9ID0gdGhpcztcbiAgaWYgKCFkaXNhYmxlZCkge1xuICAgIEhUTUxFbGVtZW50LnByb3RvdHlwZS5jbGljay5jYWxsKHRoaXMpO1xuICB9XG59XG5mdW5jdGlvbiBvblBvaW50ZXJEb3duKGV2ZW50KSB7XG4gIGNvbnN0IGludGVyYWN0aXZlRWxlbWVudCA9IGV2ZW50LnRhcmdldDtcbiAgaWYgKGludGVyYWN0aXZlRWxlbWVudC5kaXNhYmxlZCkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIH1cbn1cbmNvbnN0IG5vbkJ1YmJsaW5nV2hlbkRpc2FibGVkTW91c2VFdmVudHMgPSBbXCJtb3VzZWRvd25cIiwgXCJtb3VzZXVwXCIsIFwiY2xpY2tcIl07XG5mdW5jdGlvbiBvbk5vbkJ1YmJsaW5nV2hlbkRpc2FibGVkTW91c2VFdmVudChldmVudCkge1xuICBjb25zdCBpbnRlcmFjdGl2ZUVsZW1lbnQgPSBldmVudC50YXJnZXQ7XG4gIGlmIChpbnRlcmFjdGl2ZUVsZW1lbnQuZGlzYWJsZWQpIHtcbiAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICB9XG59XG5jb25zdCBjYXB0dXJlT25seU9wdGlvbnMgPSB7IGNhcHR1cmU6IHRydWUgfTtcbmZ1bmN0aW9uIHVwZGF0ZUhvc3RJbnRlcmFjdGlvbihjb21wb25lbnQpIHtcbiAgaWYgKGNvbXBvbmVudC5kaXNhYmxlZCkge1xuICAgIGNvbXBvbmVudC5lbC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWRpc2FibGVkXCIsIFwidHJ1ZVwiKTtcbiAgICBpZiAoY29tcG9uZW50LmVsLmNvbnRhaW5zKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpKSB7XG4gICAgICBkb2N1bWVudC5hY3RpdmVFbGVtZW50LmJsdXIoKTtcbiAgICB9XG4gICAgYmxvY2tJbnRlcmFjdGlvbihjb21wb25lbnQpO1xuICAgIHJldHVybjtcbiAgfVxuICByZXN0b3JlSW50ZXJhY3Rpb24oY29tcG9uZW50KTtcbiAgY29tcG9uZW50LmVsLnJlbW92ZUF0dHJpYnV0ZShcImFyaWEtZGlzYWJsZWRcIik7XG59XG5mdW5jdGlvbiBibG9ja0ludGVyYWN0aW9uKGNvbXBvbmVudCkge1xuICBjb21wb25lbnQuZWwuY2xpY2sgPSBpbnRlcmNlcHRlZENsaWNrO1xuICBhZGRJbnRlcmFjdGlvbkxpc3RlbmVycyhjb21wb25lbnQuZWwpO1xufVxuZnVuY3Rpb24gYWRkSW50ZXJhY3Rpb25MaXN0ZW5lcnMoZWxlbWVudCkge1xuICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVyZG93blwiLCBvblBvaW50ZXJEb3duLCBjYXB0dXJlT25seU9wdGlvbnMpO1xuICBub25CdWJibGluZ1doZW5EaXNhYmxlZE1vdXNlRXZlbnRzLmZvckVhY2goKGV2ZW50KSA9PiBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIG9uTm9uQnViYmxpbmdXaGVuRGlzYWJsZWRNb3VzZUV2ZW50LCBjYXB0dXJlT25seU9wdGlvbnMpKTtcbn1cbmZ1bmN0aW9uIHJlc3RvcmVJbnRlcmFjdGlvbihjb21wb25lbnQpIHtcbiAgZGVsZXRlIGNvbXBvbmVudC5lbC5jbGljaztcbiAgcmVtb3ZlSW50ZXJhY3Rpb25MaXN0ZW5lcnMoY29tcG9uZW50LmVsKTtcbn1cbmZ1bmN0aW9uIHJlbW92ZUludGVyYWN0aW9uTGlzdGVuZXJzKGVsZW1lbnQpIHtcbiAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwicG9pbnRlcmRvd25cIiwgb25Qb2ludGVyRG93biwgY2FwdHVyZU9ubHlPcHRpb25zKTtcbiAgbm9uQnViYmxpbmdXaGVuRGlzYWJsZWRNb3VzZUV2ZW50cy5mb3JFYWNoKChldmVudCkgPT4gZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBvbk5vbkJ1YmJsaW5nV2hlbkRpc2FibGVkTW91c2VFdmVudCwgY2FwdHVyZU9ubHlPcHRpb25zKSk7XG59XG5jb25zdCBDU1MgPSB7XG4gIGNvbnRhaW5lcjogXCJpbnRlcmFjdGlvbi1jb250YWluZXJcIlxufTtcbmNvbnN0IEludGVyYWN0aXZlQ29udGFpbmVyID0gKHsgY2hpbGRyZW4sIGRpc2FibGVkIH0pID0+IGh0bWxgPGRpdiBjbGFzcz0ke3NhZmVDbGFzc01hcChDU1MuY29udGFpbmVyKX0gLmluZXJ0PSR7ZGlzYWJsZWR9PiR7Y2hpbGRyZW59PC9kaXY+YDtcbmV4cG9ydCB7XG4gIEludGVyYWN0aXZlQ29udGFpbmVyIGFzIEksXG4gIHVwZGF0ZUhvc3RJbnRlcmFjdGlvbiBhcyB1XG59O1xuIiwiLyohIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG5TZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1kZXNpZ24tc3lzdGVtL2Jsb2IvZGV2L0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG52My4zLjMgKi9cbmltcG9ydCB7IGwgYXMgbG9nTGV2ZWwgfSBmcm9tIFwiLi9ydW50aW1lLmpzXCI7XG5jb25zdCBsb2dnZWREZXByZWNhdGlvbnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuY29uc3QgbG9nTGV2ZWxzID0ge1xuICB0cmFjZTogMCxcbiAgZGVidWc6IDEsXG4gIGluZm86IDIsXG4gIHdhcm46IDQsXG4gIGVycm9yOiA4LFxuICBvZmY6IDEwXG59O1xuZnVuY3Rpb24gd2lsbExvZyhsZXZlbCkge1xuICByZXR1cm4gbG9nTGV2ZWxzW2xldmVsXSA+PSBsb2dMZXZlbHNbbG9nTGV2ZWxdO1xufVxuZnVuY3Rpb24gZm9yd2FyZFRvQ29uc29sZShsZXZlbCwgLi4uZGF0YSkge1xuICBpZiAoIXdpbGxMb2cobGV2ZWwpKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGJhZGdlVGVtcGxhdGUgPSBcIiVjY2FsY2l0ZVwiO1xuICBjb25zdCBiYWRnZVN0eWxlID0gXCJiYWNrZ3JvdW5kOiAjMDA3QUMyOyBjb2xvcjogI2ZmZjsgYm9yZGVyLXJhZGl1czogNHB4OyBwYWRkaW5nOiAycHggNHB4O1wiO1xuICBjb25zb2xlW2xldmVsXS5jYWxsKHRoaXMsIGJhZGdlVGVtcGxhdGUsIGJhZGdlU3R5bGUsIC4uLmRhdGEpO1xufVxubGV0IGxpc3RGb3JtYXR0ZXI7XG5jb25zdCBsb2dnZXIgPSB7XG4gIGRlYnVnOiAobWVzc2FnZSkgPT4gZm9yd2FyZFRvQ29uc29sZShcImRlYnVnXCIsIG1lc3NhZ2UpLFxuICBpbmZvOiAobWVzc2FnZSkgPT4gZm9yd2FyZFRvQ29uc29sZShcImluZm9cIiwgbWVzc2FnZSksXG4gIHdhcm46IChtZXNzYWdlKSA9PiBmb3J3YXJkVG9Db25zb2xlKFwid2FyblwiLCBtZXNzYWdlKSxcbiAgZXJyb3I6IChtZXNzYWdlKSA9PiBmb3J3YXJkVG9Db25zb2xlKFwiZXJyb3JcIiwgbWVzc2FnZSksXG4gIHRyYWNlOiAobWVzc2FnZSkgPT4gZm9yd2FyZFRvQ29uc29sZShcInRyYWNlXCIsIG1lc3NhZ2UpLFxuICBkZXByZWNhdGVkXG59O1xuZnVuY3Rpb24gZGVwcmVjYXRlZChjb250ZXh0LCB7IGNvbXBvbmVudCwgbmFtZSwgc3VnZ2VzdGVkLCByZW1vdmFsVmVyc2lvbiB9KSB7XG4gIGNvbnN0IGtleSA9IGAke2NvbnRleHR9OiR7Y29udGV4dCA9PT0gXCJjb21wb25lbnRcIiA/IFwiXCIgOiBjb21wb25lbnR9JHtuYW1lfWA7XG4gIGlmIChsb2dnZWREZXByZWNhdGlvbnMuaGFzKGtleSkpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgbG9nZ2VkRGVwcmVjYXRpb25zLmFkZChrZXkpO1xuICBjb25zdCBtdWx0aVN1Z2dlc3Rpb25zID0gQXJyYXkuaXNBcnJheShzdWdnZXN0ZWQpO1xuICBpZiAobXVsdGlTdWdnZXN0aW9ucyAmJiAhbGlzdEZvcm1hdHRlcikge1xuICAgIGxpc3RGb3JtYXR0ZXIgPSBuZXcgSW50bC5MaXN0Rm9ybWF0KFwiZW5cIiwgeyBzdHlsZTogXCJsb25nXCIsIHR5cGU6IFwiZGlzanVuY3Rpb25cIiB9KTtcbiAgfVxuICBjb25zdCBtZXNzYWdlID0gYFske25hbWV9XSAke2NvbnRleHR9IGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiAke3JlbW92YWxWZXJzaW9uID09PSBcImZ1dHVyZVwiID8gYGEgZnV0dXJlIHZlcnNpb25gIDogYHYke3JlbW92YWxWZXJzaW9ufWB9LiR7c3VnZ2VzdGVkID8gYCBVc2UgJHttdWx0aVN1Z2dlc3Rpb25zID8gbGlzdEZvcm1hdHRlci5mb3JtYXQoc3VnZ2VzdGVkLm1hcCgoc3VnZ2VzdGlvbikgPT4gYFwiJHtzdWdnZXN0aW9ufVwiYCkpIDogYFwiJHtzdWdnZXN0ZWR9XCJgfSBpbnN0ZWFkLmAgOiBcIlwifWA7XG4gIGZvcndhcmRUb0NvbnNvbGUoXCJ3YXJuXCIsIG1lc3NhZ2UpO1xufVxuZXhwb3J0IHtcbiAgbG9nZ2VyIGFzIGxcbn07XG4iLCIvKiEgQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cblNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWRlc2lnbi1zeXN0ZW0vYmxvYi9kZXYvTElDRU5TRS5tZCBmb3IgZGV0YWlscy5cbnYzLjMuMyAqL1xuaW1wb3J0IHsgbWFrZUdlbmVyaWNDb250cm9sbGVyIH0gZnJvbSBcIkBhcmNnaXMvbHVtaW5hL2NvbnRyb2xsZXJzXCI7XG5pbXBvcnQgeyBjIGFzIGNvbXBvbmVudEZvY3VzYWJsZSB9IGZyb20gXCIuL2NvbXBvbmVudC5qc1wiO1xuaW1wb3J0IHsgayBhcyBnZXRSb290Tm9kZSwgYiBhcyBmb2N1c0VsZW1lbnQgfSBmcm9tIFwiLi9kb20uanNcIjtcbmNvbnN0IHVzZVNldEZvY3VzID0gKCkgPT4ge1xuICByZXR1cm4gbWFrZUdlbmVyaWNDb250cm9sbGVyKChjb21wb25lbnQsIGNvbnRyb2xsZXIpID0+IHtcbiAgICBsZXQgYWJvcnRDb250cm9sbGVyO1xuICAgIGZ1bmN0aW9uIGhhbmRsZUZvY3VzT3V0KCkge1xuICAgICAgYWJvcnRDb250cm9sbGVyPy5hYm9ydCgpO1xuICAgIH1cbiAgICBjb250cm9sbGVyLm9uTG9hZCgoKSA9PiB7XG4gICAgICBjb21wb25lbnQubGlzdGVuKFwiZm9jdXNcIiwgKCkgPT4ge1xuICAgICAgICBhYm9ydENvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG4gICAgICAgIGNvbXBvbmVudC5lbC5hZGRFdmVudExpc3RlbmVyKFwiZm9jdXNvdXRcIiwgaGFuZGxlRm9jdXNPdXQsIHsgc2lnbmFsOiBhYm9ydENvbnRyb2xsZXIuc2lnbmFsIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgY29udHJvbGxlci5vbkRpc2Nvbm5lY3RlZCgoKSA9PiB7XG4gICAgICBjb21wb25lbnQuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImZvY3Vzb3V0XCIsIGhhbmRsZUZvY3VzT3V0KTtcbiAgICB9KTtcbiAgICByZXR1cm4gYXN5bmMgKGdldEZvY3VzVGFyZ2V0LCBvcHRpb25zKSA9PiB7XG4gICAgICBpZiAoY29tcG9uZW50LmRpc2FibGVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGZvY3VzQ29uZmlnID0gdG9Gb2N1c0NvbmZpZyhnZXRGb2N1c1RhcmdldCgpKTtcbiAgICAgIGlmICghZm9jdXNDb25maWcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3QgeyB0YXJnZXQsIGluY2x1ZGVDb250YWluZXIsIHN0cmF0ZWd5IH0gPSBmb2N1c0NvbmZpZztcbiAgICAgIGNvbnN0IHJvb3ROb2RlID0gZ2V0Um9vdE5vZGUoY29tcG9uZW50LmVsKTtcbiAgICAgIGNvbnN0IGN1cnJlbnRBY3RpdmVFbGVtZW50ID0gcm9vdE5vZGUuYWN0aXZlRWxlbWVudDtcbiAgICAgIGF3YWl0IGNvbXBvbmVudEZvY3VzYWJsZShjb21wb25lbnQpO1xuICAgICAgY29uc3QgZm9jdXNBbHJlYWR5Q2hhbmdlZCA9IGN1cnJlbnRBY3RpdmVFbGVtZW50ICE9PSByb290Tm9kZS5hY3RpdmVFbGVtZW50O1xuICAgICAgaWYgKGZvY3VzQWxyZWFkeUNoYW5nZWQgfHwgYWJvcnRDb250cm9sbGVyICYmICFhYm9ydENvbnRyb2xsZXI/LnNpZ25hbC5hYm9ydGVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbXBvbmVudC5lbC5yZW1vdmVFdmVudExpc3RlbmVyKFwiZm9jdXNcIiwgaGFuZGxlRm9jdXNPdXQpO1xuICAgICAgcmV0dXJuIGZvY3VzRWxlbWVudCh0YXJnZXQsIGluY2x1ZGVDb250YWluZXIsIHN0cmF0ZWd5LCBjb21wb25lbnQuZWwsIG9wdGlvbnMpO1xuICAgIH07XG4gIH0pO1xufTtcbmZ1bmN0aW9uIGlzRm9jdXNPdmVycmlkZShmb2N1c1RhcmdldCkge1xuICByZXR1cm4gXCJ0YXJnZXRcIiBpbiBmb2N1c1RhcmdldCAmJiAoXCJpbmNsdWRlQ29udGFpbmVyXCIgaW4gZm9jdXNUYXJnZXQgfHwgXCJzdHJhdGVneVwiIGluIGZvY3VzVGFyZ2V0KTtcbn1cbmZ1bmN0aW9uIHRvRm9jdXNDb25maWcoZm9jdXNUYXJnZXQpIHtcbiAgaWYgKCFmb2N1c1RhcmdldCkge1xuICAgIHJldHVybjtcbiAgfVxuICByZXR1cm4gaXNGb2N1c092ZXJyaWRlKGZvY3VzVGFyZ2V0KSA/IGZvY3VzVGFyZ2V0IDogeyB0YXJnZXQ6IGZvY3VzVGFyZ2V0IH07XG59XG5leHBvcnQge1xuICB1c2VTZXRGb2N1cyBhcyB1XG59O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9