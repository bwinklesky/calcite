export const __webpack_id__ = "vendors-node_modules_arcgis_core_views_interactive_snapping_FeatureSnappingEngine_js";
export const __webpack_ids__ = ["vendors-node_modules_arcgis_core_views_interactive_snapping_FeatureSnappingEngine_js"];
export const __webpack_modules__ = {

/***/ "./node_modules/@arcgis/core/views/interactive/snapping/FeatureSnappingEngine.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/interactive/snapping/FeatureSnappingEngine.js ***!
  \***************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FeatureSnappingEngine: () => (/* binding */ P)
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _core_Accessor_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../core/Accessor.js */ "./node_modules/@arcgis/core/core/Accessor.js");
/* harmony import */ var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../core/arrayUtils.js */ "./node_modules/@arcgis/core/core/arrayUtils.js");
/* harmony import */ var _core_handleUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../core/handleUtils.js */ "./node_modules/@arcgis/core/core/handleUtils.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_mapCollectionUtils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../core/mapCollectionUtils.js */ "./node_modules/@arcgis/core/core/mapCollectionUtils.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../core/reactiveUtils.js */ "./node_modules/@arcgis/core/core/reactiveUtils.js");
/* harmony import */ var _core_unitUtils_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../core/unitUtils.js */ "./node_modules/@arcgis/core/core/unitUtils.js");
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/property.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../core/Logger.js */ "./node_modules/@arcgis/core/core/Logger.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/* harmony import */ var _core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../core/libs/gl-matrix-2/math/vec2.js */ "./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/vec2.js");
/* harmony import */ var _chunks_vec32_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../chunks/vec32.js */ "./node_modules/@arcgis/core/chunks/vec32.js");
/* harmony import */ var _core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../core/libs/gl-matrix-2/factories/vec3f64.js */ "./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/vec3f64.js");
/* harmony import */ var _core_libs_gl_matrix_2_math_common_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../core/libs/gl-matrix-2/math/common.js */ "./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/common.js");
/* harmony import */ var _core_support_UpdatingHandles_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../../core/support/UpdatingHandles.js */ "./node_modules/@arcgis/core/core/support/UpdatingHandles.js");
/* harmony import */ var _support_elevationInfoUtils_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../../support/elevationInfoUtils.js */ "./node_modules/@arcgis/core/support/elevationInfoUtils.js");
/* harmony import */ var _sketch_constraints_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../sketch/constraints.js */ "./node_modules/@arcgis/core/views/interactive/sketch/constraints.js");
/* harmony import */ var _sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../sketch/normalizedPoint.js */ "./node_modules/@arcgis/core/views/interactive/sketch/normalizedPoint.js");
/* harmony import */ var _FeatureSnappingSourceInfo_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./FeatureSnappingSourceInfo.js */ "./node_modules/@arcgis/core/views/interactive/snapping/FeatureSnappingSourceInfo.js");
/* harmony import */ var _SnappingDomain_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./SnappingDomain.js */ "./node_modules/@arcgis/core/views/interactive/snapping/SnappingDomain.js");
/* harmony import */ var _snappingUtils_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./snappingUtils.js */ "./node_modules/@arcgis/core/views/interactive/snapping/snappingUtils.js");
/* harmony import */ var _candidates_DrapedEdgeSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./candidates/DrapedEdgeSnappingCandidate.js */ "./node_modules/@arcgis/core/views/interactive/snapping/candidates/DrapedEdgeSnappingCandidate.js");
/* harmony import */ var _candidates_EdgeSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./candidates/EdgeSnappingCandidate.js */ "./node_modules/@arcgis/core/views/interactive/snapping/candidates/EdgeSnappingCandidate.js");
/* harmony import */ var _candidates_FeatureSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./candidates/FeatureSnappingCandidate.js */ "./node_modules/@arcgis/core/views/interactive/snapping/candidates/FeatureSnappingCandidate.js");
/* harmony import */ var _candidates_RightAngleSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./candidates/RightAngleSnappingCandidate.js */ "./node_modules/@arcgis/core/views/interactive/snapping/candidates/RightAngleSnappingCandidate.js");
/* harmony import */ var _support_viewUtils_js__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../support/viewUtils.js */ "./node_modules/@arcgis/core/views/interactive/support/viewUtils.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
let P=class extends _core_Accessor_js__WEBPACK_IMPORTED_MODULE_1__["default"]{get updating(){return this._snappingSources.some((e=>null==e?.valid||!0===e.valid&&!0===e.snappingSource?.updating))||this._updatingHandles.updating}constructor(e){super(e),this.options=null,this._domain=_SnappingDomain_js__WEBPACK_IMPORTED_MODULE_21__.SnappingDomain.FEATURE,this._updatingHandles=new _core_support_UpdatingHandles_js__WEBPACK_IMPORTED_MODULE_16__.UpdatingHandles,this._sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null},notes:{module:null,loader:null},scene:{module:null,loader:null}}}initialize(){const e=(0,_core_mapCollectionUtils_js__WEBPACK_IMPORTED_MODULE_5__.mapCollectionAsync)((()=>this.options?._effectiveFeatureSources),((e,t)=>this._createSourceInfo(e,t)));this._snappingSources=e,this.addHandles([(0,_core_handleUtils_js__WEBPACK_IMPORTED_MODULE_3__.destroyHandle)(e),(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_7__.watch)((()=>({rulesEnabled:!!this.options?.attributeRulesEnabled,sources:this._snappingSources.filter(_core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_2__.isSome)})),(({rulesEnabled:e,sources:t})=>{for(const r of t)r.attributeRulesEnabled=e}),_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_7__.sync)])}destroy(){this._set("options",null),this._updatingHandles.destroy()}async fetchCandidates(e,t,r,a){if(!(t&this._domain&&null!=this.options&&this.options.effectiveFeatureEnabled))return[];const n=[],i=this._computeScreenSizeDistanceParameters(e,r);for(const s of this._snappingSources){if(!s?.valid||!s.snappingSource?.layerSource?.enabled||s.layerView?.suspended)continue;const t=s.getFetchCandidatesParameters(e,r,i);for(const e of t)n.push(s.snappingSource.fetchCandidates(e,a).then((e=>e.filter((e=>!this._candidateIsExcluded(s.snappingSource,e,r.excludeFeature))))))}const c=(await (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.allSettledValues)(n)).flat();return this._addRightAngleCandidates(c,e,i,r),(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.throwIfAborted)(a),(0,_snappingUtils_js__WEBPACK_IMPORTED_MODULE_22__.sortCandidatesInPlace)(e,c),c}_addRightAngleCandidates(e,t,r,a){const n=null!=a.vertexHandle?a.vertexHandle.rightEdge?.rightVertex?.pos:null!=a.editGeometryOperations&&"polygon"===a.editGeometryOperations.data.type?a.editGeometryOperations.data.components[0]?.getFirstVertex()?.pos:null,s=null!=a.vertexHandle?a.vertexHandle.leftEdge?.leftVertex?.pos:null!=a.editGeometryOperations?a.editGeometryOperations.data.components[0]?.getLastVertex()?.pos:null,{view:o}=this,i=(0,_sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_19__.fromAnyMapPoint)(n,o,a),c=(0,_sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_19__.fromAnyMapPoint)(s,o,a),u=e.length;for(let l=0;l<u;l++)this._addRightAngleCandidate(e[l],c,t,r,e),this._addRightAngleCandidate(e[l],i,t,r,e)}_addRightAngleCandidate(e,t,r,a,n){if(null==t||!U(e))return;const s=e.constraint.closestTo(t),o=(s[0]-r[0])/a.x,i=(s[1]-r[1])/a.y,{start:c,end:u}=e.constraint;if(o*o+i*i<=1){const r=(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_12__.squaredDistance)((0,_sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_19__.asVec2)(s),(0,_sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_19__.asVec2)(c))>(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_12__.squaredDistance)((0,_sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_19__.asVec2)(s),(0,_sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_19__.asVec2)(u))?c:u,a=new _candidates_RightAngleSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_26__.RightAngleSnappingCandidate({targetPoint:(0,_sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_19__.markAsTarget)(s),otherVertex:t,otherVertexType:_candidates_RightAngleSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_26__.OtherVertexType.NEXT,previousVertex:r,constraint:new _sketch_constraints_js__WEBPACK_IMPORTED_MODULE_18__.VerticalHalfPlaneConstraint(t,s),objectId:e.objectId,isDraped:e.isDraped,domain:_SnappingDomain_js__WEBPACK_IMPORTED_MODULE_21__.SnappingDomain.FEATURE});n.push(a)}}_computeScreenSizeDistanceParameters(e,t){let r=null!=this.options?this.options.distance*("touch"===t.pointer?this.options.touchSensitivityMultiplier:1):0;return null==this.view?{x:r,y:r,z:r,distance:r}:"2d"===this.view.type?(r*=this.view.resolution,{x:r,y:r,z:r,distance:r}):this._computeScreenSizeDistanceParameters3D(e,r,this.view,t)}_computeScreenSizeDistanceParameters3D(e,t,r,a){const{spatialReference:n}=a;r.renderCoordsHelper.toRenderCoords(e,n,D);const s=r.state.camera.computeScreenPixelSizeAt(D),o=s*r.renderCoordsHelper.unitInMeters,i=o/(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_8__.getMetersPerUnitForSR)(n),c=o/(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_8__.getMetersPerVerticalUnitForSR)(n),p=t*i,d=t*c,m=(0,_support_viewUtils_js__WEBPACK_IMPORTED_MODULE_27__.vectorToScreenPoint)(e,n,_support_elevationInfoUtils_js__WEBPACK_IMPORTED_MODULE_17__.absoluteHeightElevationInfo,r),g=m?z(m,e,i,0,0,r,a):0,h=m?z(m,e,0,i,0,r,a):0,S=m?z(m,e,0,0,c,r,a):0;return{x:0===g?0:p/g,y:0===h?0:p/h,z:0===S?0:d/S,distance:s*t}}_candidateIsExcluded(e,t,r){if(null==r)return!1;const a=this._getCandidateObjectId(t);if(null==a)return!1;const n=e.layerSource.layer;return"graphics"===n.type?r.uid===a:r.sourceLayer===n&&(!(!r.attributes||!("objectIdField"in n))&&r.attributes[n.objectIdField]===a)}_getCandidateObjectId(e){return e instanceof _candidates_FeatureSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_25__.FeatureSnappingCandidate?e.objectId:null}async _createSourceInfo(e,t){const r=e.layer;r.loaded||(await r.load(),(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.throwIfAborted)(t));const{view:a}=this,n=await this._createFeatureSnappingSourceType(e);return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.throwIfAborted)(t),new _FeatureSnappingSourceInfo_js__WEBPACK_IMPORTED_MODULE_20__.FeatureSnappingSourceInfo(null==n?{}:{snappingSource:n,view:a,layer:r})}async _createFeatureSnappingSourceType(e){switch(e.layer.type){case"feature":case"geojson":case"csv":case"oriented-imagery":case"subtype-group":case"wfs":return this._createFeatureSnappingSourceFeatureLayer(e);case"graphics":return this._createFeatureSnappingSourceGraphicsLayer(e);case"map-notes":return this._createFeatureSnappingSourceMapNotesLayer(e);case"scene":case"building-scene":return this._createFeatureSnappingSourceSceneLayer(e)}return null}async _createFeatureSnappingSourceSceneLayer(e){const{view:t}=this;if(null==t||"3d"!==t.type)return null;return new((await this._getSourceModule("scene")).SceneLayerSnappingSource)({layerSource:e,view:t})}async _createFeatureSnappingSourceFeatureLayer(e){switch(e.layer.source?.type){case"feature-layer":case"oriented-imagery":return new((await this._getSourceModule("featureService")).FeatureServiceSnappingSource)({spatialReference:this.spatialReference,view:this.view,layerSource:e});case"memory":case"csv":case"geojson":case"wfs":if("mesh"===e.layer.geometryType)return null;return new((await this._getSourceModule("featureCollection")).FeatureCollectionSnappingSource)({layerSource:e,view:this.view})}return null}async _createFeatureSnappingSourceGraphicsLayer(e){return new((await this._getSourceModule("graphics")).GraphicsSnappingSource)({getGraphicsLayers:()=>[e.layer],spatialReference:this.spatialReference,view:this.view,layerSource:e})}async _createFeatureSnappingSourceMapNotesLayer(e){return new((await this._getSourceModule("notes")).GraphicsSnappingSource)({getGraphicsLayers:()=>e.layer.sublayers?.toArray()??[],spatialReference:this.spatialReference,view:this.view,layerSource:e})}async _getSourceModule(e){const t=this._sourceModules[e];if(null==t.loader){const t=this._loadSourceModule(e),r={module:null,loader:t};this._sourceModules[e]=r;const a=await t,n={module:a,loader:t};return this._sourceModules[e]=n,a}return null==t.module?t.loader:t.module}_loadSourceModule(e){const t=this._updatingHandles;switch(e){case"featureService":return t.addPromise(__webpack_require__.e(/*! import() */ "vendors-node_modules_arcgis_core_views_interactive_snapping_featureSources_FeatureServiceSnap-1bf472").then(__webpack_require__.bind(__webpack_require__, /*! ./featureSources/FeatureServiceSnappingSource.js */ "./node_modules/@arcgis/core/views/interactive/snapping/featureSources/FeatureServiceSnappingSource.js")));case"featureCollection":return t.addPromise(__webpack_require__.e(/*! import() */ "vendors-node_modules_arcgis_core_views_interactive_snapping_featureSources_FeatureCollectionS-8652c2").then(__webpack_require__.bind(__webpack_require__, /*! ./featureSources/FeatureCollectionSnappingSource.js */ "./node_modules/@arcgis/core/views/interactive/snapping/featureSources/FeatureCollectionSnappingSource.js")));case"graphics":case"notes":return t.addPromise(Promise.all(/*! import() */[__webpack_require__.e("vendors-node_modules_arcgis_core_core_sql_WhereClause_js"), __webpack_require__.e("vendors-node_modules_arcgis_core_layers_graphics_data_queryUtils_js-node_modules_arcgis_core_-c9d3ae"), __webpack_require__.e("vendors-node_modules_arcgis_core_smartMapping_statistics_support_utils_js"), __webpack_require__.e("vendors-node_modules_arcgis_core_layers_graphics_data_QueryEngine_js-node_modules_arcgis_core-a924a7"), __webpack_require__.e("vendors-node_modules_arcgis_core_layers_graphics_data_FeatureStore_js-node_modules_arcgis_cor-a1e4fb"), __webpack_require__.e("vendors-node_modules_arcgis_core_views_interactive_snapping_featureSources_GraphicsSnappingSo-96a037")]).then(__webpack_require__.bind(__webpack_require__, /*! ./featureSources/GraphicsSnappingSource.js */ "./node_modules/@arcgis/core/views/interactive/snapping/featureSources/GraphicsSnappingSource.js")));case"scene":return t.addPromise(Promise.all(/*! import() */[__webpack_require__.e("vendors-node_modules_arcgis_core_views_3d_webgl-engine_lib_edgeRendering_edgeProcessing_js"), __webpack_require__.e("vendors-node_modules_arcgis_core_views_interactive_snapping_featureSources_SceneLayerSnapping-11a16e")]).then(__webpack_require__.bind(__webpack_require__, /*! ./featureSources/SceneLayerSnappingSource.js */ "./node_modules/@arcgis/core/views/interactive/snapping/featureSources/SceneLayerSnappingSource.js")))}}get test(){}};function U(e){return(e instanceof _candidates_EdgeSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_24__.EdgeSnappingCandidate||e instanceof _candidates_DrapedEdgeSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_23__.DrapedEdgeSnappingCandidate)&&!A(e)}function A({constraint:{start:e,end:t}}){const r=(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_13__.s)(e,t),a=(0,_core_libs_gl_matrix_2_math_vec2_js__WEBPACK_IMPORTED_MODULE_12__.squaredDistance)((0,_sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_19__.asVec2)(e),(0,_sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_19__.asVec2)(t));return r<(0,_core_libs_gl_matrix_2_math_common_js__WEBPACK_IMPORTED_MODULE_15__.getEpsilon)()||a/r<T}function z(e,t,r,a,n,s,{spatialReference:o}){const i=(0,_chunks_vec32_js__WEBPACK_IMPORTED_MODULE_13__.c)(O,t);i[0]+=r,i[1]+=a,i[2]+=n;const c=(0,_support_viewUtils_js__WEBPACK_IMPORTED_MODULE_27__.vectorToScreenPoint)(i,o,_support_elevationInfoUtils_js__WEBPACK_IMPORTED_MODULE_17__.absoluteHeightElevationInfo,s);return c?(0,_snappingUtils_js__WEBPACK_IMPORTED_MODULE_22__.screenDistance)(c,e):1/0}(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_9__.property)({constructOnly:!0})],P.prototype,"spatialReference",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_9__.property)({constructOnly:!0})],P.prototype,"view",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_9__.property)()],P.prototype,"options",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_9__.property)({readOnly:!0})],P.prototype,"updating",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_9__.property)()],P.prototype,"_snappingSources",void 0),P=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_11__.subclass)("esri.views.interactive.snapping.FeatureSnappingEngine")],P);const D=(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_14__.create)(),O=(0,_core_libs_gl_matrix_2_factories_vec3f64_js__WEBPACK_IMPORTED_MODULE_14__.create)(),T=1e-4;


/***/ }),

/***/ "./node_modules/@arcgis/core/views/interactive/snapping/FeatureSnappingSourceInfo.js":
/*!*******************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/interactive/snapping/FeatureSnappingSourceInfo.js ***!
  \*******************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FeatureSnappingSourceInfo: () => (/* binding */ f)
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _core_Accessor_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../core/Accessor.js */ "./node_modules/@arcgis/core/core/Accessor.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../core/Logger.js */ "./node_modules/@arcgis/core/core/Logger.js");
/* harmony import */ var _core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../core/reactiveUtils.js */ "./node_modules/@arcgis/core/core/reactiveUtils.js");
/* harmony import */ var _core_sql_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../core/sql.js */ "./node_modules/@arcgis/core/core/sql.js");
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/property.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");
/* harmony import */ var _core_RandomLCG_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../core/RandomLCG.js */ "./node_modules/@arcgis/core/core/RandomLCG.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/* harmony import */ var _layers_support_FeatureFilter_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../layers/support/FeatureFilter.js */ "./node_modules/@arcgis/core/layers/support/FeatureFilter.js");
/* harmony import */ var _layers_support_floorFilterUtils_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../layers/support/floorFilterUtils.js */ "./node_modules/@arcgis/core/layers/support/floorFilterUtils.js");
/* harmony import */ var _layers_support_layerUtils_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../layers/support/layerUtils.js */ "./node_modules/@arcgis/core/layers/support/layerUtils.js");
/* harmony import */ var _snappingUtils_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./snappingUtils.js */ "./node_modules/@arcgis/core/views/interactive/snapping/snappingUtils.js");
/* harmony import */ var _support_layerViewUtils_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../support/layerViewUtils.js */ "./node_modules/@arcgis/core/views/support/layerViewUtils.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
let f=class extends _core_Accessor_js__WEBPACK_IMPORTED_MODULE_1__["default"]{set attributeRulesEnabled(e){this._set("attributeRulesEnabled",e),e&&this.loadRules()}get layerView(){return this.view?.allLayerViews?.find((e=>e.layer===this.layer))}get valid(){const{_valid:e,snappingSource:t,layer:r}=this;return!(!t||!r)&&e}get subtypeFilter(){const{layer:e,snappingSource:t}=this;if(!(0,_layers_support_layerUtils_js__WEBPACK_IMPORTED_MODULE_11__.isSubtypeGroupLayer)(e)||!e.subtypes?.length||!t)return{mode:"not-in-use",filter:null};const r=t.layerSource.sublayerSources.filter((e=>e.enabled&&e.layer.visible&&(0,_support_layerViewUtils_js__WEBPACK_IMPORTED_MODULE_13__.scaleBoundsPredicate)(this.view?.scale,e.layer.effectiveScaleRange.minScale,e.layer.effectiveScaleRange.maxScale))).map((e=>e.layer.subtypeCode));if(!r.length)return{mode:"none-visible",filter:null};if(r.length===e.subtypes.length)return{mode:"all-visible",filter:null};const i=e.fieldsIndex.get(e.subtypeField)?.name??e.subtypeField;return 1===r.length?{mode:"in-use",filter:`${i} = ${r.getItemAt(0)}`}:{mode:"in-use",filter:`${i} IN (${r.join(", ")})`}}get floorFilter(){const{view:e,layer:t}=this;return e&&t?(0,_layers_support_floorFilterUtils_js__WEBPACK_IMPORTED_MODULE_10__.getFloorFilterClause)({view:e,layer:t}):null}constructor(e){super(e),this.layer=null,this.snappingSource=null,this.rulesTable=null,this._valid=null}initialize(){if(!this.snappingSource||!this.layer)return void(this._valid=!1);const{layer:e,snappingSource:t}=this;if("refresh"in e){const r=e;this.addHandles(r.on("refresh",(()=>t.refresh())))}this.loadRules(),this.addHandles([(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_4__.watch)((()=>t.updating),(e=>t.layerSource.updating=e),_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_4__.syncAndInitial),(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_4__.watch)((()=>t.availability),(e=>t.layerSource.availability=e),_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_4__.syncAndInitial)])}getFetchCandidatesParameters(e,t,r){if(!this.valid)return[];const{layer:i,layerView:l,floorFilter:o,rulesTable:a,subtypeFilter:u}=this,y={distance:r,mode:this.view?.type??"2d",point:e,coordinateHelper:t.coordinateHelper,...h(),filter:l&&"filter"in l?l.filter:null};if(o&&(y.filter=m(y.filter,o)),"not-in-use"!==u.mode&&"all-visible"!==u.mode){if("none-visible"===u.mode)return[];y.filter?y.filter.where=(0,_core_sql_js__WEBPACK_IMPORTED_MODULE_5__.sqlAnd)(y.filter.where,u.mode):y.filter=new _layers_support_FeatureFilter_js__WEBPACK_IMPORTED_MODULE_9__["default"]({where:u.filter})}if(!this.attributeRulesEnabled)return[y];const f=t.feature,v="subtype-sublayer"===f?.sourceLayer?.type?f.sourceLayer.parent:f?.sourceLayer;if(a&&f&&(0,_snappingUtils_js__WEBPACK_IMPORTED_MODULE_12__.isUtilityNetworkWebMap)(this.view?.map)&&((0,_layers_support_layerUtils_js__WEBPACK_IMPORTED_MODULE_11__.isFeatureLayer)(i)||(0,_layers_support_layerUtils_js__WEBPACK_IMPORTED_MODULE_11__.isSubtypeGroupLayer)(i))&&((0,_layers_support_layerUtils_js__WEBPACK_IMPORTED_MODULE_11__.isFeatureLayer)(v)||(0,_layers_support_layerUtils_js__WEBPACK_IMPORTED_MODULE_11__.isSubtypeGroupLayer)(v))&&this.view.map.utilityNetworks?.find((e=>e.isUtilityLayer(v)))){if("loaded"!==a.loadStatus)return[];const e=[],t=i.layerId,r=a.getFeatureSQL(v,f)?.[t];if(!r)return[];const l=r.anyVertex;let s=r.endVertex;return s&&l&&s===l&&(s=""),s&&e.push({...y,returnEdge:!1,vertexMode:"ends",filter:m(y.filter,s)}),l&&e.push({...y,returnEdge:(0,_core_has_js__WEBPACK_IMPORTED_MODULE_2__["default"])("snapping-include-edges-when-applying-any-vertex-rule")??!1,vertexMode:"all",filter:m(y.filter,l)}),e}return[y]}async loadRules(){this._valid=null;const{layer:e,view:t,attributeRulesEnabled:i}=this;if(i&&e&&t&&(0,_snappingUtils_js__WEBPACK_IMPORTED_MODULE_12__.isUtilityNetworkWebMap)(t?.map)&&((0,_layers_support_layerUtils_js__WEBPACK_IMPORTED_MODULE_11__.isFeatureLayer)(e)||(0,_layers_support_layerUtils_js__WEBPACK_IMPORTED_MODULE_11__.isSubtypeGroupLayer)(e)))try{await Promise.allSettled(t.map.utilityNetworks?.map((e=>e.load()))??[]);const r=t.map.utilityNetworks?.find((t=>t.isUtilityLayer(e)));r&&(this.rulesTable=await r.getRulesTable(),await(this.rulesTable?.load()))}catch(l){return this._valid=!1,void _core_Logger_js__WEBPACK_IMPORTED_MODULE_3__["default"].getLogger("esri.views.interactive.snapping.FeatureSnappingSourceInfo").error("Failed to load rules table for snapping source",e.title)}this._valid=!0}remove(){this.destroy()}destroy(){this.snappingSource?.destroy()}};function h(){return{returnEdge:!0,vertexMode:"all"}}function m(e,t){return null==e?new _layers_support_FeatureFilter_js__WEBPACK_IMPORTED_MODULE_9__["default"]({where:t}):e.where?new _layers_support_FeatureFilter_js__WEBPACK_IMPORTED_MODULE_9__["default"]({where:(0,_core_sql_js__WEBPACK_IMPORTED_MODULE_5__.sqlAnd)(e.where,t)}):new _layers_support_FeatureFilter_js__WEBPACK_IMPORTED_MODULE_9__["default"]({where:t})}(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_6__.property)({constructOnly:!0})],f.prototype,"layer",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_6__.property)({constructOnly:!0})],f.prototype,"snappingSource",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_6__.property)({constructOnly:!0})],f.prototype,"view",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_6__.property)({value:!1})],f.prototype,"attributeRulesEnabled",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_6__.property)()],f.prototype,"layerView",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_6__.property)()],f.prototype,"rulesTable",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_6__.property)()],f.prototype,"valid",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_6__.property)()],f.prototype,"subtypeFilter",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_6__.property)()],f.prototype,"floorFilter",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_6__.property)()],f.prototype,"_valid",void 0),f=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_8__.subclass)("esri.views.interactive.snapping.FeatureSnappingSourceInfo")],f);


/***/ })

};

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVuZG9ycy1ub2RlX21vZHVsZXNfYXJjZ2lzX2NvcmVfdmlld3NfaW50ZXJhY3RpdmVfc25hcHBpbmdfRmVhdHVyZVNuYXBwaW5nRW5naW5lX2pzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ284RCxvQkFBb0IseURBQUMsQ0FBQyxlQUFlLHNJQUFzSSxlQUFlLHdDQUF3QywrREFBQyxtQ0FBbUMsOEVBQUMsc0JBQXNCLGdCQUFnQix3QkFBd0Isb0JBQW9CLHdCQUF3QixXQUFXLHdCQUF3QixRQUFRLHdCQUF3QixRQUFRLDBCQUEwQixhQUFhLFFBQVEsK0VBQUMsb0ZBQW9GLHlDQUF5QyxtRUFBQyxJQUFJLDZEQUFDLFFBQVEsd0ZBQXdGLHVEQUFDLEVBQUUsTUFBTSx5QkFBeUIsSUFBSSwyQ0FBMkMsRUFBRSx3REFBQyxJQUFJLFVBQVUsMERBQTBELCtCQUErQix3RkFBd0YsNERBQTRELHNDQUFzQyx1RkFBdUYsOENBQThDLHlKQUF5SixlQUFlLHVFQUFDLFlBQVksOENBQThDLHFFQUFDLElBQUkseUVBQUMsUUFBUSxrQ0FBa0Msc1lBQXNZLE9BQU8sUUFBUSw0RUFBQyxVQUFVLDRFQUFDLG1CQUFtQixZQUFZLElBQUksMEZBQTBGLG1DQUFtQyx5QkFBeUIsdUVBQXVFLGNBQWMsY0FBYyxlQUFlLFFBQVEscUZBQUMsQ0FBQyxtRUFBQyxJQUFJLG1FQUFDLEtBQUsscUZBQUMsQ0FBQyxtRUFBQyxJQUFJLG1FQUFDLGVBQWUsb0dBQUMsRUFBRSxZQUFZLHlFQUFDLGtDQUFrQyx3RkFBQyxzQ0FBc0MsZ0ZBQUMscURBQXFELCtEQUFDLFNBQVMsRUFBRSxXQUFXLDBDQUEwQyxpSEFBaUgsd0JBQXdCLHVCQUF1QixpREFBaUQsdUJBQXVCLCtEQUErRCxnREFBZ0QsTUFBTSxtQkFBbUIsR0FBRywyQ0FBMkMsNkZBQTZGLHlFQUFDLFFBQVEsaUZBQUMsa0JBQWtCLDJF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LDJCQUEyQix1REFBQyx3SUFBd0ksZUFBZSxTQUFTLGVBQWUsVUFBVSxpQ0FBaUMsYUFBYSxPQUFPLGdDQUFnQyxnQkFBZ0IsbUJBQW1CLHdFQUFDLEVBQUUsUUFBUSxjQUFjLHdFQUFDLEVBQUUsTUFBTSxvREFBQyxZQUFZLE1BQU0sd0VBQUMsRUFBRSxRQUFRLEVBQUUsdURBQUMsRUFBRSxzRkFBQyxFQUFFLGlCQUFpQiwrQkFBK0IsdURBQUMsRUFBRSxzRkFBQyxFQUFFLGlCQUFpQix3Q0FBd0MsdURBQUMsRUFBRSxzRkFBQyxFQUFFLGlCQUFpQiw4QkFBOEIsdURBQUMsRUFBRSxzRkFBQyxFQUFFLFNBQVMsNkNBQTZDLHVEQUFDLEVBQUUsc0ZBQUMsa0NBQWtDLHVEQUFDLEVBQUUsc0ZBQUMscUNBQXFDLHVEQUFDLEVBQUUsc0ZBQUMsOEJBQThCLHVEQUFDLEVBQUUsc0ZBQUMsc0NBQXNDLHVEQUFDLEVBQUUsc0ZBQUMsb0NBQW9DLHVEQUFDLEVBQUUsc0ZBQUMsbUNBQW1DLHVEQUFDLEVBQUUsc0ZBQUMsa0VBQXlHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJlY2lzaW9uZmFybXMvLi9ub2RlX21vZHVsZXMvQGFyY2dpcy9jb3JlL3ZpZXdzL2ludGVyYWN0aXZlL3NuYXBwaW5nL0ZlYXR1cmVTbmFwcGluZ0VuZ2luZS5qcyIsIndlYnBhY2s6Ly9wcmVjaXNpb25mYXJtcy8uL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2NvcmUvdmlld3MvaW50ZXJhY3RpdmUvc25hcHBpbmcvRmVhdHVyZVNuYXBwaW5nU291cmNlSW5mby5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cblNlZSBodHRwczovL2pzLmFyY2dpcy5jb20vNC4zMy9lc3JpL2NvcHlyaWdodC50eHQgZm9yIGRldGFpbHMuXG4qL1xuaW1wb3J0e18gYXMgZX1mcm9tXCIuLi8uLi8uLi9jaHVua3MvdHNsaWIuZXM2LmpzXCI7aW1wb3J0IHQgZnJvbVwiLi4vLi4vLi4vY29yZS9BY2Nlc3Nvci5qc1wiO2ltcG9ydHtpc1NvbWUgYXMgcn1mcm9tXCIuLi8uLi8uLi9jb3JlL2FycmF5VXRpbHMuanNcIjtpbXBvcnR7ZGVzdHJveUhhbmRsZSBhcyBhfWZyb21cIi4uLy4uLy4uL2NvcmUvaGFuZGxlVXRpbHMuanNcIjtpbXBvcnRcIi4uLy4uLy4uL2NvcmUvaGFzLmpzXCI7aW1wb3J0e21hcENvbGxlY3Rpb25Bc3luYyBhcyBufWZyb21cIi4uLy4uLy4uL2NvcmUvbWFwQ29sbGVjdGlvblV0aWxzLmpzXCI7aW1wb3J0e2FsbFNldHRsZWRWYWx1ZXMgYXMgcyx0aHJvd0lmQWJvcnRlZCBhcyBvfWZyb21cIi4uLy4uLy4uL2NvcmUvcHJvbWlzZVV0aWxzLmpzXCI7aW1wb3J0e3dhdGNoIGFzIGksc3luYyBhcyBjfWZyb21cIi4uLy4uLy4uL2NvcmUvcmVhY3RpdmVVdGlscy5qc1wiO2ltcG9ydHtnZXRNZXRlcnNQZXJVbml0Rm9yU1IgYXMgdSxnZXRNZXRlcnNQZXJWZXJ0aWNhbFVuaXRGb3JTUiBhcyBsfWZyb21cIi4uLy4uLy4uL2NvcmUvdW5pdFV0aWxzLmpzXCI7aW1wb3J0e3Byb3BlcnR5IGFzIHB9ZnJvbVwiLi4vLi4vLi4vY29yZS9hY2Nlc3NvclN1cHBvcnQvZGVjb3JhdG9ycy9wcm9wZXJ0eS5qc1wiO2ltcG9ydFwiLi4vLi4vLi4vY29yZS9Mb2dnZXIuanNcIjtpbXBvcnR7c3ViY2xhc3MgYXMgZH1mcm9tXCIuLi8uLi8uLi9jb3JlL2FjY2Vzc29yU3VwcG9ydC9kZWNvcmF0b3JzL3N1YmNsYXNzLmpzXCI7aW1wb3J0e3NxdWFyZWREaXN0YW5jZSBhcyBtfWZyb21cIi4uLy4uLy4uL2NvcmUvbGlicy9nbC1tYXRyaXgtMi9tYXRoL3ZlYzIuanNcIjtpbXBvcnR7YyBhcyBnLHMgYXMgaH1mcm9tXCIuLi8uLi8uLi9jaHVua3MvdmVjMzIuanNcIjtpbXBvcnR7Y3JlYXRlIGFzIFN9ZnJvbVwiLi4vLi4vLi4vY29yZS9saWJzL2dsLW1hdHJpeC0yL2ZhY3Rvcmllcy92ZWMzZjY0LmpzXCI7aW1wb3J0e2dldEVwc2lsb24gYXMgZn1mcm9tXCIuLi8uLi8uLi9jb3JlL2xpYnMvZ2wtbWF0cml4LTIvbWF0aC9jb21tb24uanNcIjtpbXBvcnR7VXBkYXRpbmdIYW5kbGVzIGFzIHl9ZnJvbVwiLi4vLi4vLi4vY29yZS9zdXBwb3J0L1VwZGF0aW5nSGFuZGxlcy5qc1wiO2ltcG9ydHthYnNvbHV0ZUhlaWdodEVsZXZhdGlvbkluZm8gYXMgX31mcm9tXCIuLi8uLi8uLi9zdXBwb3J0L2VsZXZhdGlvbkluZm9VdGlscy5qc1wiO2ltcG9ydHtWZXJ0aWNhbEhhbGZQbGFuZUNvbnN0cmFpbnQgYXMgdn1mcm9tXCIuLi9za2V0Y2gvY29uc3RyYWludHMuanNcIjtpbXBvcnR7ZnJvbUFueU1hcFBvaW50IGFzIHcsYXNWZWMyIGFzIGosbWFya0FzVGFyZ2V0IGFzIEZ9ZnJvbVwiLi4vc2tldGNoL25vcm1hbGl6ZWRQb2ludC5qc1wiO2ltcG9ydHtGZWF0dXJlU25hcHBpbmdTb3VyY2VJbmZvIGFzIGJ9ZnJvbVwiLi9GZWF0dXJlU25hcHBpbmdTb3VyY2VJbmZvLmpzXCI7aW1wb3J0e1NuYXBwaW5nRG9tYWluIGFzIHh9ZnJvbVwiLi9TbmFwcGluZ0RvbWFpbi5qc1wiO2ltcG9ydHtzb3J0Q2FuZGlkYXRlc0luUGxhY2UgYXMgQyxzY3JlZW5EaXN0YW5jZSBhcyBSfWZyb21cIi4vc25hcHBpbmdVdGlscy5qc1wiO2ltcG9ydHtEcmFwZWRFZGdlU25hcHBpbmdDYW5kaWRhdGUgYXMgRX1mcm9tXCIuL2NhbmRpZGF0ZXMvRHJhcGVkRWRnZVNuYXBwaW5nQ2FuZGlkYXRlLmpzXCI7aW1wb3J0e0VkZ2VTbmFwcGluZ0NhbmRpZGF0ZSBhcyBNfWZyb21cIi4vY2FuZGlkYXRlcy9FZGdlU25hcHBpbmdDYW5kaWRhdGUuanNcIjtpbXBvcnR7RmVhdHVyZVNuYXBwaW5nQ2FuZGlkYXRlIGFzIEx9ZnJvbVwiLi9jYW5kaWRhdGVzL0ZlYXR1cmVTbmFwcGluZ0NhbmRpZGF0ZS5qc1wiO2ltcG9ydHtSaWdodEFuZ2xlU25hcHBpbmdDYW5kaWRhdGUgYXMgSSxPdGhlclZlcnRleFR5cGUgYXMgR31mcm9tXCIuL2NhbmRpZGF0ZXMvUmlnaHRBbmdsZVNuYXBwaW5nQ2FuZGlkYXRlLmpzXCI7aW1wb3J0e3ZlY3RvclRvU2NyZWVuUG9pbnQgYXMgSH1mcm9tXCIuLi9zdXBwb3J0L3ZpZXdVdGlscy5qc1wiO2xldCBQPWNsYXNzIGV4dGVuZHMgdHtnZXQgdXBkYXRpbmcoKXtyZXR1cm4gdGhpcy5fc25hcHBpbmdTb3VyY2VzLnNvbWUoKGU9Pm51bGw9PWU/LnZhbGlkfHwhMD09PWUudmFsaWQmJiEwPT09ZS5zbmFwcGluZ1NvdXJjZT8udXBkYXRpbmcpKXx8dGhpcy5fdXBkYXRpbmdIYW5kbGVzLnVwZGF0aW5nfWNvbnN0cnVjdG9yKGUpe3N1cGVyKGUpLHRoaXMub3B0aW9ucz1udWxsLHRoaXMuX2RvbWFpbj14LkZFQVRVUkUsdGhpcy5fdXBkYXRpbmdIYW5kbGVzPW5ldyB5LHRoaXMuX3NvdXJjZU1vZHVsZXM9e2ZlYXR1cmVTZXJ2aWNlOnttb2R1bGU6bnVsbCxsb2FkZXI6bnVsbH0sZmVhdHVyZUNvbGxlY3Rpb246e21vZHVsZTpudWxsLGxvYWRlcjpudWxsfSxncmFwaGljczp7bW9kdWxlOm51bGwsbG9hZGVyOm51bGx9LG5vdGVzOnttb2R1bGU6bnVsbCxsb2FkZXI6bnVsbH0sc2NlbmU6e21vZHVsZTpudWxsLGxvYWRlcjpudWxsfX19aW5pdGlhbGl6ZSgpe2NvbnN0IGU9bigoKCk9PnRoaXMub3B0aW9ucz8uX2VmZmVjdGl2ZUZlYXR1cmVTb3VyY2VzKSwoKGUsdCk9PnRoaXMuX2NyZWF0ZVNvdXJjZUluZm8oZSx0KSkpO3RoaXMuX3NuYXBwaW5nU291cmNlcz1lLHRoaXMuYWRkSGFuZGxlcyhbYShlKSxpKCgoKT0+KHtydWxlc0VuYWJsZWQ6ISF0aGlzLm9wdGlvbnM/LmF0dHJpYnV0ZVJ1bGVzRW5hYmxlZCxzb3VyY2VzOnRoaXMuX3NuYXBwaW5nU291cmNlcy5maWx0ZXIocil9KSksKCh7cnVsZXNFbmFibGVkOmUsc291cmNlczp0fSk9Pntmb3IoY29uc3QgciBvZiB0KXIuYXR0cmlidXRlUnVsZXNFbmFibGVkPWV9KSxjKV0pfWRlc3Ryb3koKXt0aGlzLl9zZXQoXCJvcHRpb25zXCIsbnVsbCksdGhpcy5fdXBkYXRpbmdIYW5kbGVzLmRlc3Ryb3koKX1hc3luYyBmZXRjaENhbmRpZGF0ZXMoZSx0LHIsYSl7aWYoISh0JnRoaXMuX2RvbWFpbiYmbnVsbCE9dGhpcy5vcHRpb25zJiZ0aGlzLm9wdGlvbnMuZWZmZWN0aXZlRmVhdHVyZUVuYWJsZWQpKXJldHVybltdO2NvbnN0IG49W10saT10aGlzLl9jb21wdXRlU2NyZWVuU2l6ZURpc3RhbmNlUGFyYW1ldGVycyhlLHIpO2Zvcihjb25zdCBzIG9mIHRoaXMuX3NuYXBwaW5nU291cmNlcyl7aWYoIXM/LnZhbGlkfHwhcy5zbmFwcGluZ1NvdXJjZT8ubGF5ZXJTb3VyY2U/LmVuYWJsZWR8fHMubGF5ZXJWaWV3Py5zdXNwZW5kZWQpY29udGludWU7Y29uc3QgdD1zLmdldEZldGNoQ2FuZGlkYXRlc1BhcmFtZXRlcnMoZSxyLGkpO2Zvcihjb25zdCBlIG9mIHQpbi5wdXNoKHMuc25hcHBpbmdTb3VyY2UuZmV0Y2hDYW5kaWRhdGVzKGUsYSkudGhlbigoZT0+ZS5maWx0ZXIoKGU9PiF0aGlzLl9jYW5kaWRhdGVJc0V4Y2x1ZGVkKHMuc25hcHBpbmdTb3VyY2UsZSxyLmV4Y2x1ZGVGZWF0dXJlKSkpKSkpfWNvbnN0IGM9KGF3YWl0IHMobikpLmZsYXQoKTtyZXR1cm4gdGhpcy5fYWRkUmlnaHRBbmdsZUNhbmRpZGF0ZXMoYyxlLGksciksbyhhKSxDKGUsYyksY31fYWRkUmlnaHRBbmdsZUNhbmRpZGF0ZXMoZSx0LHIsYSl7Y29uc3Qgbj1udWxsIT1hLnZlcnRleEhhbmRsZT9hLnZlcnRleEhhbmRsZS5yaWdodEVkZ2U/LnJpZ2h0VmVydGV4Py5wb3M6bnVsbCE9YS5lZGl0R2VvbWV0cnlPcGVyYXRpb25zJiZcInBvbHlnb25cIj09PWEuZWRpdEdlb21ldHJ5T3BlcmF0aW9ucy5kYXRhLnR5cGU/YS5lZGl0R2VvbWV0cnlPcGVyYXRpb25zLmRhdGEuY29tcG9uZW50c1swXT8uZ2V0Rmlyc3RWZXJ0ZXgoKT8ucG9zOm51bGwscz1udWxsIT1hLnZlcnRleEhhbmRsZT9hLnZlcnRleEhhbmRsZS5sZWZ0RWRnZT8ubGVmdFZlcnRleD8ucG9zOm51bGwhPWEuZWRpdEdlb21ldHJ5T3BlcmF0aW9ucz9hLmVkaXRHZW9tZXRyeU9wZXJhdGlvbnMuZGF0YS5jb21wb25lbnRzWzBdPy5nZXRMYXN0VmVydGV4KCk/LnBvczpudWxsLHt2aWV3Om99PXRoaXMsaT13KG4sbyxhKSxjPXcocyxvLGEpLHU9ZS5sZW5ndGg7Zm9yKGxldCBsPTA7bDx1O2wrKyl0aGlzLl9hZGRSaWdodEFuZ2xlQ2FuZGlkYXRlKGVbbF0sYyx0LHIsZSksdGhpcy5fYWRkUmlnaHRBbmdsZUNhbmRpZGF0ZShlW2xdLGksdCxyLGUpfV9hZGRSaWdodEFuZ2xlQ2FuZGlkYXRlKGUsdCxyLGEsbil7aWYobnVsbD09dHx8IVUoZSkpcmV0dXJuO2NvbnN0IHM9ZS5jb25zdHJhaW50LmNsb3Nlc3RUbyh0KSxvPShzWzBdLXJbMF0pL2EueCxpPShzWzFdLXJbMV0pL2EueSx7c3RhcnQ6YyxlbmQ6dX09ZS5jb25zdHJhaW50O2lmKG8qbytpKmk8PTEpe2NvbnN0IHI9bShqKHMpLGooYykpPm0oaihzKSxqKHUpKT9jOnUsYT1uZXcgSSh7dGFyZ2V0UG9pbnQ6RihzKSxvdGhlclZlcnRleDp0LG90aGVyVmVydGV4VHlwZTpHLk5FWFQscHJldmlvdXNWZXJ0ZXg6cixjb25zdHJhaW50Om5ldyB2KHQscyksb2JqZWN0SWQ6ZS5vYmplY3RJZCxpc0RyYXBlZDplLmlzRHJhcGVkLGRvbWFpbjp4LkZFQVRVUkV9KTtuLnB1c2goYSl9fV9jb21wdXRlU2NyZWVuU2l6ZURpc3RhbmNlUGFyYW1ldGVycyhlLHQpe2xldCByPW51bGwhPXRoaXMub3B0aW9ucz90aGlzLm9wdGlvbnMuZGlzdGFuY2UqKFwidG91Y2hcIj09PXQucG9pbnRlcj90aGlzLm9wdGlvbnMudG91Y2hTZW5zaXRpdml0eU11bHRpcGxpZXI6MSk6MDtyZXR1cm4gbnVsbD09dGhpcy52aWV3P3t4OnIseTpyLHo6cixkaXN0YW5jZTpyfTpcIjJkXCI9PT10aGlzLnZpZXcudHlwZT8ocio9dGhpcy52aWV3LnJlc29sdXRpb24se3g6cix5OnIsejpyLGRpc3RhbmNlOnJ9KTp0aGlzLl9jb21wdXRlU2NyZWVuU2l6ZURpc3RhbmNlUGFyYW1ldGVyczNEKGUscix0aGlzLnZpZXcsdCl9X2NvbXB1dGVTY3JlZW5TaXplRGlzdGFuY2VQYXJhbWV0ZXJzM0QoZSx0LHIsYSl7Y29uc3R7c3BhdGlhbFJlZmVyZW5jZTpufT1hO3IucmVuZGVyQ29vcmRzSGVscGVyLnRvUmVuZGVyQ29vcmRzKGUsbixEKTtjb25zdCBzPXIuc3RhdGUuY2FtZXJhLmNvbXB1dGVTY3JlZW5QaXhlbFNpemVBdChEKSxvPXMqci5yZW5kZXJDb29yZHNIZWxwZXIudW5pdEluTWV0ZXJzLGk9by91KG4pLGM9by9sKG4pLHA9dCppLGQ9dCpjLG09SChlLG4sXyxyKSxnPW0/eihtLGUsaSwwLDAscixhKTowLGg9bT96KG0sZSwwLGksMCxyLGEpOjAsUz1tP3oobSxlLDAsMCxjLHIsYSk6MDtyZXR1cm57eDowPT09Zz8wOnAvZyx5OjA9PT1oPzA6cC9oLHo6MD09PVM/MDpkL1MsZGlzdGFuY2U6cyp0fX1fY2FuZGlkYXRlSXNFeGNsdWRlZChlLHQscil7aWYobnVsbD09cilyZXR1cm4hMTtjb25zdCBhPXRoaXMuX2dldENhbmRpZGF0ZU9iamVjdElkKHQpO2lmKG51bGw9PWEpcmV0dXJuITE7Y29uc3Qgbj1lLmxheWVyU291cmNlLmxheWVyO3JldHVyblwiZ3JhcGhpY3NcIj09PW4udHlwZT9yLnVpZD09PWE6ci5zb3VyY2VMYXllcj09PW4mJighKCFyLmF0dHJpYnV0ZXN8fCEoXCJvYmplY3RJZEZpZWxkXCJpbiBuKSkmJnIuYXR0cmlidXRlc1tuLm9iamVjdElkRmllbGRdPT09YSl9X2dldENhbmRpZGF0ZU9iamVjdElkKGUpe3JldHVybiBlIGluc3RhbmNlb2YgTD9lLm9iamVjdElkOm51bGx9YXN5bmMgX2NyZWF0ZVNvdXJjZUluZm8oZSx0KXtjb25zdCByPWUubGF5ZXI7ci5sb2FkZWR8fChhd2FpdCByLmxvYWQoKSxvKHQpKTtjb25zdHt2aWV3OmF9PXRoaXMsbj1hd2FpdCB0aGlzLl9jcmVhdGVGZWF0dXJlU25hcHBpbmdTb3VyY2VUeXBlKGUpO3JldHVybiBvKHQpLG5ldyBiKG51bGw9PW4/e306e3NuYXBwaW5nU291cmNlOm4sdmlldzphLGxheWVyOnJ9KX1hc3luYyBfY3JlYXRlRmVhdHVyZVNuYXBwaW5nU291cmNlVHlwZShlKXtzd2l0Y2goZS5sYXllci50eXBlKXtjYXNlXCJmZWF0dXJlXCI6Y2FzZVwiZ2VvanNvblwiOmNhc2VcImNzdlwiOmNhc2VcIm9yaWVudGVkLWltYWdlcnlcIjpjYXNlXCJzdWJ0eXBlLWdyb3VwXCI6Y2FzZVwid2ZzXCI6cmV0dXJuIHRoaXMuX2NyZWF0ZUZlYXR1cmVTbmFwcGluZ1NvdXJjZUZlYXR1cmVMYXllcihlKTtjYXNlXCJncmFwaGljc1wiOnJldHVybiB0aGlzLl9jcmVhdGVGZWF0dXJlU25hcHBpbmdTb3VyY2VHcmFwaGljc0xheWVyKGUpO2Nhc2VcIm1hcC1ub3Rlc1wiOnJldHVybiB0aGlzLl9jcmVhdGVGZWF0dXJlU25hcHBpbmdTb3VyY2VNYXBOb3Rlc0xheWVyKGUpO2Nhc2VcInNjZW5lXCI6Y2FzZVwiYnVpbGRpbmctc2NlbmVcIjpyZXR1cm4gdGhpcy5fY3JlYXRlRmVhdHVyZVNuYXBwaW5nU291cmNlU2NlbmVMYXllcihlKX1yZXR1cm4gbnVsbH1hc3luYyBfY3JlYXRlRmVhdHVyZVNuYXBwaW5nU291cmNlU2NlbmVMYXllcihlKXtjb25zdHt2aWV3OnR9PXRoaXM7aWYobnVsbD09dHx8XCIzZFwiIT09dC50eXBlKXJldHVybiBudWxsO3JldHVybiBuZXcoKGF3YWl0IHRoaXMuX2dldFNvdXJjZU1vZHVsZShcInNjZW5lXCIpKS5TY2VuZUxheWVyU25hcHBpbmdTb3VyY2UpKHtsYXllclNvdXJjZTplLHZpZXc6dH0pfWFzeW5jIF9jcmVhdGVGZWF0dXJlU25hcHBpbmdTb3VyY2VGZWF0dXJlTGF5ZXIoZSl7c3dpdGNoKGUubGF5ZXIuc291cmNlPy50eXBlKXtjYXNlXCJmZWF0dXJlLWxheWVyXCI6Y2FzZVwib3JpZW50ZWQtaW1hZ2VyeVwiOnJldHVybiBuZXcoKGF3YWl0IHRoaXMuX2dldFNvdXJjZU1vZHVsZShcImZlYXR1cmVTZXJ2aWNlXCIpKS5GZWF0dXJlU2VydmljZVNuYXBwaW5nU291cmNlKSh7c3BhdGlhbFJlZmVyZW5jZTp0aGlzLnNwYXRpYWxSZWZlcmVuY2Usdmlldzp0aGlzLnZpZXcsbGF5ZXJTb3VyY2U6ZX0pO2Nhc2VcIm1lbW9yeVwiOmNhc2VcImNzdlwiOmNhc2VcImdlb2pzb25cIjpjYXNlXCJ3ZnNcIjppZihcIm1lc2hcIj09PWUubGF5ZXIuZ2VvbWV0cnlUeXBlKXJldHVybiBudWxsO3JldHVybiBuZXcoKGF3YWl0IHRoaXMuX2dldFNvdXJjZU1vZHVsZShcImZlYXR1cmVDb2xsZWN0aW9uXCIpKS5GZWF0dXJlQ29sbGVjdGlvblNuYXBwaW5nU291cmNlKSh7bGF5ZXJTb3VyY2U6ZSx2aWV3OnRoaXMudmlld30pfXJldHVybiBudWxsfWFzeW5jIF9jcmVhdGVGZWF0dXJlU25hcHBpbmdTb3VyY2VHcmFwaGljc0xheWVyKGUpe3JldHVybiBuZXcoKGF3YWl0IHRoaXMuX2dldFNvdXJjZU1vZHVsZShcImdyYXBoaWNzXCIpKS5HcmFwaGljc1NuYXBwaW5nU291cmNlKSh7Z2V0R3JhcGhpY3NMYXllcnM6KCk9PltlLmxheWVyXSxzcGF0aWFsUmVmZXJlbmNlOnRoaXMuc3BhdGlhbFJlZmVyZW5jZSx2aWV3OnRoaXMudmlldyxsYXllclNvdXJjZTplfSl9YXN5bmMgX2NyZWF0ZUZlYXR1cmVTbmFwcGluZ1NvdXJjZU1hcE5vdGVzTGF5ZXIoZSl7cmV0dXJuIG5ldygoYXdhaXQgdGhpcy5fZ2V0U291cmNlTW9kdWxlKFwibm90ZXNcIikpLkdyYXBoaWNzU25hcHBpbmdTb3VyY2UpKHtnZXRHcmFwaGljc0xheWVyczooKT0+ZS5sYXllci5zdWJsYXllcnM/LnRvQXJyYXkoKT8/W10sc3BhdGlhbFJlZmVyZW5jZTp0aGlzLnNwYXRpYWxSZWZlcmVuY2Usdmlldzp0aGlzLnZpZXcsbGF5ZXJTb3VyY2U6ZX0pfWFzeW5jIF9nZXRTb3VyY2VNb2R1bGUoZSl7Y29uc3QgdD10aGlzLl9zb3VyY2VNb2R1bGVzW2VdO2lmKG51bGw9PXQubG9hZGVyKXtjb25zdCB0PXRoaXMuX2xvYWRTb3VyY2VNb2R1bGUoZSkscj17bW9kdWxlOm51bGwsbG9hZGVyOnR9O3RoaXMuX3NvdXJjZU1vZHVsZXNbZV09cjtjb25zdCBhPWF3YWl0IHQsbj17bW9kdWxlOmEsbG9hZGVyOnR9O3JldHVybiB0aGlzLl9zb3VyY2VNb2R1bGVzW2VdPW4sYX1yZXR1cm4gbnVsbD09dC5tb2R1bGU/dC5sb2FkZXI6dC5tb2R1bGV9X2xvYWRTb3VyY2VNb2R1bGUoZSl7Y29uc3QgdD10aGlzLl91cGRhdGluZ0hhbmRsZXM7c3dpdGNoKGUpe2Nhc2VcImZlYXR1cmVTZXJ2aWNlXCI6cmV0dXJuIHQuYWRkUHJvbWlzZShpbXBvcnQoXCIuL2ZlYXR1cmVTb3VyY2VzL0ZlYXR1cmVTZXJ2aWNlU25hcHBpbmdTb3VyY2UuanNcIikpO2Nhc2VcImZlYXR1cmVDb2xsZWN0aW9uXCI6cmV0dXJuIHQuYWRkUHJvbWlzZShpbXBvcnQoXCIuL2ZlYXR1cmVTb3VyY2VzL0ZlYXR1cmVDb2xsZWN0aW9uU25hcHBpbmdTb3VyY2UuanNcIikpO2Nhc2VcImdyYXBoaWNzXCI6Y2FzZVwibm90ZXNcIjpyZXR1cm4gdC5hZGRQcm9taXNlKGltcG9ydChcIi4vZmVhdHVyZVNvdXJjZXMvR3JhcGhpY3NTbmFwcGluZ1NvdXJjZS5qc1wiKSk7Y2FzZVwic2NlbmVcIjpyZXR1cm4gdC5hZGRQcm9taXNlKGltcG9ydChcIi4vZmVhdHVyZVNvdXJjZXMvU2NlbmVMYXllclNuYXBwaW5nU291cmNlLmpzXCIpKX19Z2V0IHRlc3QoKXt9fTtmdW5jdGlvbiBVKGUpe3JldHVybihlIGluc3RhbmNlb2YgTXx8ZSBpbnN0YW5jZW9mIEUpJiYhQShlKX1mdW5jdGlvbiBBKHtjb25zdHJhaW50OntzdGFydDplLGVuZDp0fX0pe2NvbnN0IHI9aChlLHQpLGE9bShqKGUpLGoodCkpO3JldHVybiByPGYoKXx8YS9yPFR9ZnVuY3Rpb24geihlLHQscixhLG4scyx7c3BhdGlhbFJlZmVyZW5jZTpvfSl7Y29uc3QgaT1nKE8sdCk7aVswXSs9cixpWzFdKz1hLGlbMl0rPW47Y29uc3QgYz1IKGksbyxfLHMpO3JldHVybiBjP1IoYyxlKToxLzB9ZShbcCh7Y29uc3RydWN0T25seTohMH0pXSxQLnByb3RvdHlwZSxcInNwYXRpYWxSZWZlcmVuY2VcIix2b2lkIDApLGUoW3Aoe2NvbnN0cnVjdE9ubHk6ITB9KV0sUC5wcm90b3R5cGUsXCJ2aWV3XCIsdm9pZCAwKSxlKFtwKCldLFAucHJvdG90eXBlLFwib3B0aW9uc1wiLHZvaWQgMCksZShbcCh7cmVhZE9ubHk6ITB9KV0sUC5wcm90b3R5cGUsXCJ1cGRhdGluZ1wiLG51bGwpLGUoW3AoKV0sUC5wcm90b3R5cGUsXCJfc25hcHBpbmdTb3VyY2VzXCIsdm9pZCAwKSxQPWUoW2QoXCJlc3JpLnZpZXdzLmludGVyYWN0aXZlLnNuYXBwaW5nLkZlYXR1cmVTbmFwcGluZ0VuZ2luZVwiKV0sUCk7Y29uc3QgRD1TKCksTz1TKCksVD0xZS00O2V4cG9ydHtQIGFzIEZlYXR1cmVTbmFwcGluZ0VuZ2luZX07XG4iLCIvKlxuQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cblNlZSBodHRwczovL2pzLmFyY2dpcy5jb20vNC4zMy9lc3JpL2NvcHlyaWdodC50eHQgZm9yIGRldGFpbHMuXG4qL1xuaW1wb3J0e18gYXMgZX1mcm9tXCIuLi8uLi8uLi9jaHVua3MvdHNsaWIuZXM2LmpzXCI7aW1wb3J0IHQgZnJvbVwiLi4vLi4vLi4vY29yZS9BY2Nlc3Nvci5qc1wiO2ltcG9ydCBoYXMgZnJvbVwiLi4vLi4vLi4vY29yZS9oYXMuanNcIjtpbXBvcnQgciBmcm9tXCIuLi8uLi8uLi9jb3JlL0xvZ2dlci5qc1wiO2ltcG9ydHt3YXRjaCBhcyBpLHN5bmNBbmRJbml0aWFsIGFzIGx9ZnJvbVwiLi4vLi4vLi4vY29yZS9yZWFjdGl2ZVV0aWxzLmpzXCI7aW1wb3J0e3NxbEFuZCBhcyBzfWZyb21cIi4uLy4uLy4uL2NvcmUvc3FsLmpzXCI7aW1wb3J0e3Byb3BlcnR5IGFzIG99ZnJvbVwiLi4vLi4vLi4vY29yZS9hY2Nlc3NvclN1cHBvcnQvZGVjb3JhdG9ycy9wcm9wZXJ0eS5qc1wiO2ltcG9ydFwiLi4vLi4vLi4vY29yZS9SYW5kb21MQ0cuanNcIjtpbXBvcnR7c3ViY2xhc3MgYXMgYX1mcm9tXCIuLi8uLi8uLi9jb3JlL2FjY2Vzc29yU3VwcG9ydC9kZWNvcmF0b3JzL3N1YmNsYXNzLmpzXCI7aW1wb3J0IG4gZnJvbVwiLi4vLi4vLi4vbGF5ZXJzL3N1cHBvcnQvRmVhdHVyZUZpbHRlci5qc1wiO2ltcG9ydHtnZXRGbG9vckZpbHRlckNsYXVzZSBhcyB1fWZyb21cIi4uLy4uLy4uL2xheWVycy9zdXBwb3J0L2Zsb29yRmlsdGVyVXRpbHMuanNcIjtpbXBvcnR7aXNTdWJ0eXBlR3JvdXBMYXllciBhcyBwLGlzRmVhdHVyZUxheWVyIGFzIGR9ZnJvbVwiLi4vLi4vLi4vbGF5ZXJzL3N1cHBvcnQvbGF5ZXJVdGlscy5qc1wiO2ltcG9ydHtpc1V0aWxpdHlOZXR3b3JrV2ViTWFwIGFzIGN9ZnJvbVwiLi9zbmFwcGluZ1V0aWxzLmpzXCI7aW1wb3J0e3NjYWxlQm91bmRzUHJlZGljYXRlIGFzIHl9ZnJvbVwiLi4vLi4vc3VwcG9ydC9sYXllclZpZXdVdGlscy5qc1wiO2xldCBmPWNsYXNzIGV4dGVuZHMgdHtzZXQgYXR0cmlidXRlUnVsZXNFbmFibGVkKGUpe3RoaXMuX3NldChcImF0dHJpYnV0ZVJ1bGVzRW5hYmxlZFwiLGUpLGUmJnRoaXMubG9hZFJ1bGVzKCl9Z2V0IGxheWVyVmlldygpe3JldHVybiB0aGlzLnZpZXc/LmFsbExheWVyVmlld3M/LmZpbmQoKGU9PmUubGF5ZXI9PT10aGlzLmxheWVyKSl9Z2V0IHZhbGlkKCl7Y29uc3R7X3ZhbGlkOmUsc25hcHBpbmdTb3VyY2U6dCxsYXllcjpyfT10aGlzO3JldHVybiEoIXR8fCFyKSYmZX1nZXQgc3VidHlwZUZpbHRlcigpe2NvbnN0e2xheWVyOmUsc25hcHBpbmdTb3VyY2U6dH09dGhpcztpZighcChlKXx8IWUuc3VidHlwZXM/Lmxlbmd0aHx8IXQpcmV0dXJue21vZGU6XCJub3QtaW4tdXNlXCIsZmlsdGVyOm51bGx9O2NvbnN0IHI9dC5sYXllclNvdXJjZS5zdWJsYXllclNvdXJjZXMuZmlsdGVyKChlPT5lLmVuYWJsZWQmJmUubGF5ZXIudmlzaWJsZSYmeSh0aGlzLnZpZXc/LnNjYWxlLGUubGF5ZXIuZWZmZWN0aXZlU2NhbGVSYW5nZS5taW5TY2FsZSxlLmxheWVyLmVmZmVjdGl2ZVNjYWxlUmFuZ2UubWF4U2NhbGUpKSkubWFwKChlPT5lLmxheWVyLnN1YnR5cGVDb2RlKSk7aWYoIXIubGVuZ3RoKXJldHVybnttb2RlOlwibm9uZS12aXNpYmxlXCIsZmlsdGVyOm51bGx9O2lmKHIubGVuZ3RoPT09ZS5zdWJ0eXBlcy5sZW5ndGgpcmV0dXJue21vZGU6XCJhbGwtdmlzaWJsZVwiLGZpbHRlcjpudWxsfTtjb25zdCBpPWUuZmllbGRzSW5kZXguZ2V0KGUuc3VidHlwZUZpZWxkKT8ubmFtZT8/ZS5zdWJ0eXBlRmllbGQ7cmV0dXJuIDE9PT1yLmxlbmd0aD97bW9kZTpcImluLXVzZVwiLGZpbHRlcjpgJHtpfSA9ICR7ci5nZXRJdGVtQXQoMCl9YH06e21vZGU6XCJpbi11c2VcIixmaWx0ZXI6YCR7aX0gSU4gKCR7ci5qb2luKFwiLCBcIil9KWB9fWdldCBmbG9vckZpbHRlcigpe2NvbnN0e3ZpZXc6ZSxsYXllcjp0fT10aGlzO3JldHVybiBlJiZ0P3Uoe3ZpZXc6ZSxsYXllcjp0fSk6bnVsbH1jb25zdHJ1Y3RvcihlKXtzdXBlcihlKSx0aGlzLmxheWVyPW51bGwsdGhpcy5zbmFwcGluZ1NvdXJjZT1udWxsLHRoaXMucnVsZXNUYWJsZT1udWxsLHRoaXMuX3ZhbGlkPW51bGx9aW5pdGlhbGl6ZSgpe2lmKCF0aGlzLnNuYXBwaW5nU291cmNlfHwhdGhpcy5sYXllcilyZXR1cm4gdm9pZCh0aGlzLl92YWxpZD0hMSk7Y29uc3R7bGF5ZXI6ZSxzbmFwcGluZ1NvdXJjZTp0fT10aGlzO2lmKFwicmVmcmVzaFwiaW4gZSl7Y29uc3Qgcj1lO3RoaXMuYWRkSGFuZGxlcyhyLm9uKFwicmVmcmVzaFwiLCgoKT0+dC5yZWZyZXNoKCkpKSl9dGhpcy5sb2FkUnVsZXMoKSx0aGlzLmFkZEhhbmRsZXMoW2koKCgpPT50LnVwZGF0aW5nKSwoZT0+dC5sYXllclNvdXJjZS51cGRhdGluZz1lKSxsKSxpKCgoKT0+dC5hdmFpbGFiaWxpdHkpLChlPT50LmxheWVyU291cmNlLmF2YWlsYWJpbGl0eT1lKSxsKV0pfWdldEZldGNoQ2FuZGlkYXRlc1BhcmFtZXRlcnMoZSx0LHIpe2lmKCF0aGlzLnZhbGlkKXJldHVybltdO2NvbnN0e2xheWVyOmksbGF5ZXJWaWV3OmwsZmxvb3JGaWx0ZXI6byxydWxlc1RhYmxlOmEsc3VidHlwZUZpbHRlcjp1fT10aGlzLHk9e2Rpc3RhbmNlOnIsbW9kZTp0aGlzLnZpZXc/LnR5cGU/P1wiMmRcIixwb2ludDplLGNvb3JkaW5hdGVIZWxwZXI6dC5jb29yZGluYXRlSGVscGVyLC4uLmgoKSxmaWx0ZXI6bCYmXCJmaWx0ZXJcImluIGw/bC5maWx0ZXI6bnVsbH07aWYobyYmKHkuZmlsdGVyPW0oeS5maWx0ZXIsbykpLFwibm90LWluLXVzZVwiIT09dS5tb2RlJiZcImFsbC12aXNpYmxlXCIhPT11Lm1vZGUpe2lmKFwibm9uZS12aXNpYmxlXCI9PT11Lm1vZGUpcmV0dXJuW107eS5maWx0ZXI/eS5maWx0ZXIud2hlcmU9cyh5LmZpbHRlci53aGVyZSx1Lm1vZGUpOnkuZmlsdGVyPW5ldyBuKHt3aGVyZTp1LmZpbHRlcn0pfWlmKCF0aGlzLmF0dHJpYnV0ZVJ1bGVzRW5hYmxlZClyZXR1cm5beV07Y29uc3QgZj10LmZlYXR1cmUsdj1cInN1YnR5cGUtc3VibGF5ZXJcIj09PWY/LnNvdXJjZUxheWVyPy50eXBlP2Yuc291cmNlTGF5ZXIucGFyZW50OmY/LnNvdXJjZUxheWVyO2lmKGEmJmYmJmModGhpcy52aWV3Py5tYXApJiYoZChpKXx8cChpKSkmJihkKHYpfHxwKHYpKSYmdGhpcy52aWV3Lm1hcC51dGlsaXR5TmV0d29ya3M/LmZpbmQoKGU9PmUuaXNVdGlsaXR5TGF5ZXIodikpKSl7aWYoXCJsb2FkZWRcIiE9PWEubG9hZFN0YXR1cylyZXR1cm5bXTtjb25zdCBlPVtdLHQ9aS5sYXllcklkLHI9YS5nZXRGZWF0dXJlU1FMKHYsZik/Llt0XTtpZighcilyZXR1cm5bXTtjb25zdCBsPXIuYW55VmVydGV4O2xldCBzPXIuZW5kVmVydGV4O3JldHVybiBzJiZsJiZzPT09bCYmKHM9XCJcIikscyYmZS5wdXNoKHsuLi55LHJldHVybkVkZ2U6ITEsdmVydGV4TW9kZTpcImVuZHNcIixmaWx0ZXI6bSh5LmZpbHRlcixzKX0pLGwmJmUucHVzaCh7Li4ueSxyZXR1cm5FZGdlOmhhcyhcInNuYXBwaW5nLWluY2x1ZGUtZWRnZXMtd2hlbi1hcHBseWluZy1hbnktdmVydGV4LXJ1bGVcIik/PyExLHZlcnRleE1vZGU6XCJhbGxcIixmaWx0ZXI6bSh5LmZpbHRlcixsKX0pLGV9cmV0dXJuW3ldfWFzeW5jIGxvYWRSdWxlcygpe3RoaXMuX3ZhbGlkPW51bGw7Y29uc3R7bGF5ZXI6ZSx2aWV3OnQsYXR0cmlidXRlUnVsZXNFbmFibGVkOml9PXRoaXM7aWYoaSYmZSYmdCYmYyh0Py5tYXApJiYoZChlKXx8cChlKSkpdHJ5e2F3YWl0IFByb21pc2UuYWxsU2V0dGxlZCh0Lm1hcC51dGlsaXR5TmV0d29ya3M/Lm1hcCgoZT0+ZS5sb2FkKCkpKT8/W10pO2NvbnN0IHI9dC5tYXAudXRpbGl0eU5ldHdvcmtzPy5maW5kKCh0PT50LmlzVXRpbGl0eUxheWVyKGUpKSk7ciYmKHRoaXMucnVsZXNUYWJsZT1hd2FpdCByLmdldFJ1bGVzVGFibGUoKSxhd2FpdCh0aGlzLnJ1bGVzVGFibGU/LmxvYWQoKSkpfWNhdGNoKGwpe3JldHVybiB0aGlzLl92YWxpZD0hMSx2b2lkIHIuZ2V0TG9nZ2VyKFwiZXNyaS52aWV3cy5pbnRlcmFjdGl2ZS5zbmFwcGluZy5GZWF0dXJlU25hcHBpbmdTb3VyY2VJbmZvXCIpLmVycm9yKFwiRmFpbGVkIHRvIGxvYWQgcnVsZXMgdGFibGUgZm9yIHNuYXBwaW5nIHNvdXJjZVwiLGUudGl0bGUpfXRoaXMuX3ZhbGlkPSEwfXJlbW92ZSgpe3RoaXMuZGVzdHJveSgpfWRlc3Ryb3koKXt0aGlzLnNuYXBwaW5nU291cmNlPy5kZXN0cm95KCl9fTtmdW5jdGlvbiBoKCl7cmV0dXJue3JldHVybkVkZ2U6ITAsdmVydGV4TW9kZTpcImFsbFwifX1mdW5jdGlvbiBtKGUsdCl7cmV0dXJuIG51bGw9PWU/bmV3IG4oe3doZXJlOnR9KTplLndoZXJlP25ldyBuKHt3aGVyZTpzKGUud2hlcmUsdCl9KTpuZXcgbih7d2hlcmU6dH0pfWUoW28oe2NvbnN0cnVjdE9ubHk6ITB9KV0sZi5wcm90b3R5cGUsXCJsYXllclwiLHZvaWQgMCksZShbbyh7Y29uc3RydWN0T25seTohMH0pXSxmLnByb3RvdHlwZSxcInNuYXBwaW5nU291cmNlXCIsdm9pZCAwKSxlKFtvKHtjb25zdHJ1Y3RPbmx5OiEwfSldLGYucHJvdG90eXBlLFwidmlld1wiLHZvaWQgMCksZShbbyh7dmFsdWU6ITF9KV0sZi5wcm90b3R5cGUsXCJhdHRyaWJ1dGVSdWxlc0VuYWJsZWRcIixudWxsKSxlKFtvKCldLGYucHJvdG90eXBlLFwibGF5ZXJWaWV3XCIsbnVsbCksZShbbygpXSxmLnByb3RvdHlwZSxcInJ1bGVzVGFibGVcIix2b2lkIDApLGUoW28oKV0sZi5wcm90b3R5cGUsXCJ2YWxpZFwiLG51bGwpLGUoW28oKV0sZi5wcm90b3R5cGUsXCJzdWJ0eXBlRmlsdGVyXCIsbnVsbCksZShbbygpXSxmLnByb3RvdHlwZSxcImZsb29yRmlsdGVyXCIsbnVsbCksZShbbygpXSxmLnByb3RvdHlwZSxcIl92YWxpZFwiLHZvaWQgMCksZj1lKFthKFwiZXNyaS52aWV3cy5pbnRlcmFjdGl2ZS5zbmFwcGluZy5GZWF0dXJlU25hcHBpbmdTb3VyY2VJbmZvXCIpXSxmKTtleHBvcnR7ZiBhcyBGZWF0dXJlU25hcHBpbmdTb3VyY2VJbmZvfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==